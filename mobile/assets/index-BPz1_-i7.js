var gu=Object.defineProperty;var Il=es=>{throw TypeError(es)};var ju=(es,ts,ss)=>ts in es?gu(es,ts,{enumerable:!0,configurable:!0,writable:!0,value:ss}):es[ts]=ss;var eo=(es,ts,ss)=>ju(es,typeof ts!="symbol"?ts+"":ts,ss),$o=(es,ts,ss)=>ts.has(es)||Il("Cannot "+ss);var ks=(es,ts,ss)=>($o(es,ts,"read from private field"),ss?ss.call(es):ts.get(es)),mr=(es,ts,ss)=>ts.has(es)?Il("Cannot add the same private member more than once"):ts instanceof WeakSet?ts.add(es):ts.set(es,ss),fr=(es,ts,ss,ns)=>($o(es,ts,"write to private field"),ns?ns.call(es,ss):ts.set(es,ss),ss),ar=(es,ts,ss)=>($o(es,ts,"access private method"),ss);var go=(es,ts,ss,ns)=>({set _(rs){fr(es,ts,rs,ss)},get _(){return ks(es,ts,ns)}});(function(){const ts=document.createElement("link").relList;if(ts&&ts.supports&&ts.supports("modulepreload"))return;for(const rs of document.querySelectorAll('link[rel="modulepreload"]'))ns(rs);new MutationObserver(rs=>{for(const os of rs)if(os.type==="childList")for(const as of os.addedNodes)as.tagName==="LINK"&&as.rel==="modulepreload"&&ns(as)}).observe(document,{childList:!0,subtree:!0});function ss(rs){const os={};return rs.integrity&&(os.integrity=rs.integrity),rs.referrerPolicy&&(os.referrerPolicy=rs.referrerPolicy),rs.crossOrigin==="use-credentials"?os.credentials="include":rs.crossOrigin==="anonymous"?os.credentials="omit":os.credentials="same-origin",os}function ns(rs){if(rs.ep)return;rs.ep=!0;const os=ss(rs);fetch(rs.href,os)}})();function getDefaultExportFromCjs(es){return es&&es.__esModule&&Object.prototype.hasOwnProperty.call(es,"default")?es.default:es}function getAugmentedNamespace(es){if(es.__esModule)return es;var ts=es.default;if(typeof ts=="function"){var ss=function ns(){return this instanceof ns?Reflect.construct(ts,arguments,this.constructor):ts.apply(this,arguments)};ss.prototype=ts.prototype}else ss={};return Object.defineProperty(ss,"__esModule",{value:!0}),Object.keys(es).forEach(function(ns){var rs=Object.getOwnPropertyDescriptor(es,ns);Object.defineProperty(ss,ns,rs.get?rs:{enumerable:!0,get:function(){return es[ns]}})}),ss}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r$2=Symbol.for("react.profiler"),t$1=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$2(es){return es===null||typeof es!="object"?null:(es=z$2&&es[z$2]||es["@@iterator"],typeof es=="function"?es:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$2(es,ts,ss){this.props=es,this.context=ts,this.refs=D$2,this.updater=ss||B$2}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(es,ts){if(typeof es!="object"&&typeof es!="function"&&es!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,es,ts,"setState")};E$2.prototype.forceUpdate=function(es){this.updater.enqueueForceUpdate(this,es,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$2(es,ts,ss){this.props=es,this.context=ts,this.refs=D$2,this.updater=ss||B$2}var H$2=G$2.prototype=new F$1;H$2.constructor=G$2;C$2(H$2,E$2.prototype);H$2.isPureReactComponent=!0;var I$2=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$2={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$2(es,ts,ss){var ns,rs={},os=null,as=null;if(ts!=null)for(ns in ts.ref!==void 0&&(as=ts.ref),ts.key!==void 0&&(os=""+ts.key),ts)J$1.call(ts,ns)&&!L$2.hasOwnProperty(ns)&&(rs[ns]=ts[ns]);var cs=arguments.length-2;if(cs===1)rs.children=ss;else if(1<cs){for(var ls=Array(cs),us=0;us<cs;us++)ls[us]=arguments[us+2];rs.children=ls}if(es&&es.defaultProps)for(ns in cs=es.defaultProps,cs)rs[ns]===void 0&&(rs[ns]=cs[ns]);return{$$typeof:l$2,type:es,key:os,ref:as,props:rs,_owner:K$2.current}}function N$2(es,ts){return{$$typeof:l$2,type:es.type,key:ts,ref:es.ref,props:es.props,_owner:es._owner}}function O$2(es){return typeof es=="object"&&es!==null&&es.$$typeof===l$2}function escape$1(es){var ts={"=":"=0",":":"=2"};return"$"+es.replace(/[=:]/g,function(ss){return ts[ss]})}var P$2=/\/+/g;function Q$2(es,ts){return typeof es=="object"&&es!==null&&es.key!=null?escape$1(""+es.key):ts.toString(36)}function R$2(es,ts,ss,ns,rs){var os=typeof es;(os==="undefined"||os==="boolean")&&(es=null);var as=!1;if(es===null)as=!0;else switch(os){case"string":case"number":as=!0;break;case"object":switch(es.$$typeof){case l$2:case n$2:as=!0}}if(as)return as=es,rs=rs(as),es=ns===""?"."+Q$2(as,0):ns,I$2(rs)?(ss="",es!=null&&(ss=es.replace(P$2,"$&/")+"/"),R$2(rs,ts,ss,"",function(us){return us})):rs!=null&&(O$2(rs)&&(rs=N$2(rs,ss+(!rs.key||as&&as.key===rs.key?"":(""+rs.key).replace(P$2,"$&/")+"/")+es)),ts.push(rs)),1;if(as=0,ns=ns===""?".":ns+":",I$2(es))for(var cs=0;cs<es.length;cs++){os=es[cs];var ls=ns+Q$2(os,cs);as+=R$2(os,ts,ss,ls,rs)}else if(ls=A$2(es),typeof ls=="function")for(es=ls.call(es),cs=0;!(os=es.next()).done;)os=os.value,ls=ns+Q$2(os,cs++),as+=R$2(os,ts,ss,ls,rs);else if(os==="object")throw ts=String(es),Error("Objects are not valid as a React child (found: "+(ts==="[object Object]"?"object with keys {"+Object.keys(es).join(", ")+"}":ts)+"). If you meant to render a collection of children, use an array instead.");return as}function S$2(es,ts,ss){if(es==null)return es;var ns=[],rs=0;return R$2(es,ns,"","",function(os){return ts.call(ss,os,rs++)}),ns}function T$2(es){if(es._status===-1){var ts=es._result;ts=ts(),ts.then(function(ss){(es._status===0||es._status===-1)&&(es._status=1,es._result=ss)},function(ss){(es._status===0||es._status===-1)&&(es._status=2,es._result=ss)}),es._status===-1&&(es._status=0,es._result=ts)}if(es._status===1)return es._result.default;throw es._result}var U$2={current:null},V$2={transition:null},W$2={ReactCurrentDispatcher:U$2,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$2};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$2,forEach:function(es,ts,ss){S$2(es,function(){ts.apply(this,arguments)},ss)},count:function(es){var ts=0;return S$2(es,function(){ts++}),ts},toArray:function(es){return S$2(es,function(ts){return ts})||[]},only:function(es){if(!O$2(es))throw Error("React.Children.only expected to receive a single React element child.");return es}};react_production_min.Component=E$2;react_production_min.Fragment=p$3;react_production_min.Profiler=r$2;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$2;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.act=X$2;react_production_min.cloneElement=function(es,ts,ss){if(es==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+es+".");var ns=C$2({},es.props),rs=es.key,os=es.ref,as=es._owner;if(ts!=null){if(ts.ref!==void 0&&(os=ts.ref,as=K$2.current),ts.key!==void 0&&(rs=""+ts.key),es.type&&es.type.defaultProps)var cs=es.type.defaultProps;for(ls in ts)J$1.call(ts,ls)&&!L$2.hasOwnProperty(ls)&&(ns[ls]=ts[ls]===void 0&&cs!==void 0?cs[ls]:ts[ls])}var ls=arguments.length-2;if(ls===1)ns.children=ss;else if(1<ls){cs=Array(ls);for(var us=0;us<ls;us++)cs[us]=arguments[us+2];ns.children=cs}return{$$typeof:l$2,type:es.type,key:rs,ref:os,props:ns,_owner:as}};react_production_min.createContext=function(es){return es={$$typeof:u$1,_currentValue:es,_currentValue2:es,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},es.Provider={$$typeof:t$1,_context:es},es.Consumer=es};react_production_min.createElement=M$2;react_production_min.createFactory=function(es){var ts=M$2.bind(null,es);return ts.type=es,ts};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(es){return{$$typeof:v$2,render:es}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(es){return{$$typeof:y$1,_payload:{_status:-1,_result:es},_init:T$2}};react_production_min.memo=function(es,ts){return{$$typeof:x$1,type:es,compare:ts===void 0?null:ts}};react_production_min.startTransition=function(es){var ts=V$2.transition;V$2.transition={};try{es()}finally{V$2.transition=ts}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(es,ts){return U$2.current.useCallback(es,ts)};react_production_min.useContext=function(es){return U$2.current.useContext(es)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(es){return U$2.current.useDeferredValue(es)};react_production_min.useEffect=function(es,ts){return U$2.current.useEffect(es,ts)};react_production_min.useId=function(){return U$2.current.useId()};react_production_min.useImperativeHandle=function(es,ts,ss){return U$2.current.useImperativeHandle(es,ts,ss)};react_production_min.useInsertionEffect=function(es,ts){return U$2.current.useInsertionEffect(es,ts)};react_production_min.useLayoutEffect=function(es,ts){return U$2.current.useLayoutEffect(es,ts)};react_production_min.useMemo=function(es,ts){return U$2.current.useMemo(es,ts)};react_production_min.useReducer=function(es,ts,ss){return U$2.current.useReducer(es,ts,ss)};react_production_min.useRef=function(es){return U$2.current.useRef(es)};react_production_min.useState=function(es){return U$2.current.useState(es)};react_production_min.useSyncExternalStore=function(es,ts,ss){return U$2.current.useSyncExternalStore(es,ts,ss)};react_production_min.useTransition=function(){return U$2.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React$2=getDefaultExportFromCjs(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$1=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$1=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$1(es,ts,ss){var ns,rs={},os=null,as=null;ss!==void 0&&(os=""+ss),ts.key!==void 0&&(os=""+ts.key),ts.ref!==void 0&&(as=ts.ref);for(ns in ts)m$2.call(ts,ns)&&!p$2.hasOwnProperty(ns)&&(rs[ns]=ts[ns]);if(es&&es.defaultProps)for(ns in ts=es.defaultProps,ts)rs[ns]===void 0&&(rs[ns]=ts[ns]);return{$$typeof:k$1,type:es,key:os,ref:as,props:rs,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(es){function ts(Ks,Ds){var $s=Ks.length;Ks.push(Ds);e:for(;0<$s;){var Xs=$s-1>>>1,Fs=Ks[Xs];if(0<rs(Fs,Ds))Ks[Xs]=Ds,Ks[$s]=Fs,$s=Xs;else break e}}function ss(Ks){return Ks.length===0?null:Ks[0]}function ns(Ks){if(Ks.length===0)return null;var Ds=Ks[0],$s=Ks.pop();if($s!==Ds){Ks[0]=$s;e:for(var Xs=0,Fs=Ks.length,As=Fs>>>1;Xs<As;){var _s=2*(Xs+1)-1,Ps=Ks[_s],Hs=_s+1,Ls=Ks[Hs];if(0>rs(Ps,$s))Hs<Fs&&0>rs(Ls,Ps)?(Ks[Xs]=Ls,Ks[Hs]=$s,Xs=Hs):(Ks[Xs]=Ps,Ks[_s]=$s,Xs=_s);else if(Hs<Fs&&0>rs(Ls,$s))Ks[Xs]=Ls,Ks[Hs]=$s,Xs=Hs;else break e}}return Ds}function rs(Ks,Ds){var $s=Ks.sortIndex-Ds.sortIndex;return $s!==0?$s:Ks.id-Ds.id}if(typeof performance=="object"&&typeof performance.now=="function"){var os=performance;es.unstable_now=function(){return os.now()}}else{var as=Date,cs=as.now();es.unstable_now=function(){return as.now()-cs}}var ls=[],us=[],ds=1,xs=null,fs=3,gs=!1,Es=!1,js=!1,ps=typeof setTimeout=="function"?setTimeout:null,ms=typeof clearTimeout=="function"?clearTimeout:null,hs=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function vs(Ks){for(var Ds=ss(us);Ds!==null;){if(Ds.callback===null)ns(us);else if(Ds.startTime<=Ks)ns(us),Ds.sortIndex=Ds.expirationTime,ts(ls,Ds);else break;Ds=ss(us)}}function ws(Ks){if(js=!1,vs(Ks),!Es)if(ss(ls)!==null)Es=!0,Zs(ys);else{var Ds=ss(us);Ds!==null&&Vs(ws,Ds.startTime-Ks)}}function ys(Ks,Ds){Es=!1,js&&(js=!1,ms(Ns),Ns=-1),gs=!0;var $s=fs;try{for(vs(Ds),xs=ss(ls);xs!==null&&(!(xs.expirationTime>Ds)||Ks&&!Cs());){var Xs=xs.callback;if(typeof Xs=="function"){xs.callback=null,fs=xs.priorityLevel;var Fs=Xs(xs.expirationTime<=Ds);Ds=es.unstable_now(),typeof Fs=="function"?xs.callback=Fs:xs===ss(ls)&&ns(ls),vs(Ds)}else ns(ls);xs=ss(ls)}if(xs!==null)var As=!0;else{var _s=ss(us);_s!==null&&Vs(ws,_s.startTime-Ds),As=!1}return As}finally{xs=null,fs=$s,gs=!1}}var Rs=!1,bs=null,Ns=-1,Ss=5,Ts=-1;function Cs(){return!(es.unstable_now()-Ts<Ss)}function Ms(){if(bs!==null){var Ks=es.unstable_now();Ts=Ks;var Ds=!0;try{Ds=bs(!0,Ks)}finally{Ds?Is():(Rs=!1,bs=null)}}else Rs=!1}var Is;if(typeof hs=="function")Is=function(){hs(Ms)};else if(typeof MessageChannel<"u"){var Qs=new MessageChannel,Ys=Qs.port2;Qs.port1.onmessage=Ms,Is=function(){Ys.postMessage(null)}}else Is=function(){ps(Ms,0)};function Zs(Ks){bs=Ks,Rs||(Rs=!0,Is())}function Vs(Ks,Ds){Ns=ps(function(){Ks(es.unstable_now())},Ds)}es.unstable_IdlePriority=5,es.unstable_ImmediatePriority=1,es.unstable_LowPriority=4,es.unstable_NormalPriority=3,es.unstable_Profiling=null,es.unstable_UserBlockingPriority=2,es.unstable_cancelCallback=function(Ks){Ks.callback=null},es.unstable_continueExecution=function(){Es||gs||(Es=!0,Zs(ys))},es.unstable_forceFrameRate=function(Ks){0>Ks||125<Ks?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ss=0<Ks?Math.floor(1e3/Ks):5},es.unstable_getCurrentPriorityLevel=function(){return fs},es.unstable_getFirstCallbackNode=function(){return ss(ls)},es.unstable_next=function(Ks){switch(fs){case 1:case 2:case 3:var Ds=3;break;default:Ds=fs}var $s=fs;fs=Ds;try{return Ks()}finally{fs=$s}},es.unstable_pauseExecution=function(){},es.unstable_requestPaint=function(){},es.unstable_runWithPriority=function(Ks,Ds){switch(Ks){case 1:case 2:case 3:case 4:case 5:break;default:Ks=3}var $s=fs;fs=Ks;try{return Ds()}finally{fs=$s}},es.unstable_scheduleCallback=function(Ks,Ds,$s){var Xs=es.unstable_now();switch(typeof $s=="object"&&$s!==null?($s=$s.delay,$s=typeof $s=="number"&&0<$s?Xs+$s:Xs):$s=Xs,Ks){case 1:var Fs=-1;break;case 2:Fs=250;break;case 5:Fs=1073741823;break;case 4:Fs=1e4;break;default:Fs=5e3}return Fs=$s+Fs,Ks={id:ds++,callback:Ds,priorityLevel:Ks,startTime:$s,expirationTime:Fs,sortIndex:-1},$s>Xs?(Ks.sortIndex=$s,ts(us,Ks),ss(ls)===null&&Ks===ss(us)&&(js?(ms(Ns),Ns=-1):js=!0,Vs(ws,$s-Xs))):(Ks.sortIndex=Fs,ts(ls,Ks),Es||gs||(Es=!0,Zs(ys))),Ks},es.unstable_shouldYield=Cs,es.unstable_wrapCallback=function(Ks){var Ds=fs;return function(){var $s=fs;fs=Ds;try{return Ks.apply(this,arguments)}finally{fs=$s}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1(es){for(var ts="https://reactjs.org/docs/error-decoder.html?invariant="+es,ss=1;ss<arguments.length;ss++)ts+="&args[]="+encodeURIComponent(arguments[ss]);return"Minified React error #"+es+"; visit "+ts+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(es,ts){ha(es,ts),ha(es+"Capture",ts)}function ha(es,ts){for(ea[es]=ts,es=0;es<ts.length;es++)da.add(ts[es])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(es){return ja.call(ma,es)?!0:ja.call(la,es)?!1:ka.test(es)?ma[es]=!0:(la[es]=!0,!1)}function pa(es,ts,ss,ns){if(ss!==null&&ss.type===0)return!1;switch(typeof ts){case"function":case"symbol":return!0;case"boolean":return ns?!1:ss!==null?!ss.acceptsBooleans:(es=es.toLowerCase().slice(0,5),es!=="data-"&&es!=="aria-");default:return!1}}function qa(es,ts,ss,ns){if(ts===null||typeof ts>"u"||pa(es,ts,ss,ns))return!0;if(ns)return!1;if(ss!==null)switch(ss.type){case 3:return!ts;case 4:return ts===!1;case 5:return isNaN(ts);case 6:return isNaN(ts)||1>ts}return!1}function v$1(es,ts,ss,ns,rs,os,as){this.acceptsBooleans=ts===2||ts===3||ts===4,this.attributeName=ns,this.attributeNamespace=rs,this.mustUseProperty=ss,this.propertyName=es,this.type=ts,this.sanitizeURL=os,this.removeEmptyString=as}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(es){z$1[es]=new v$1(es,0,!1,es,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(es){var ts=es[0];z$1[ts]=new v$1(ts,1,!1,es[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(es){z$1[es]=new v$1(es,2,!1,es.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(es){z$1[es]=new v$1(es,2,!1,es,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(es){z$1[es]=new v$1(es,3,!1,es.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(es){z$1[es]=new v$1(es,3,!0,es,null,!1,!1)});["capture","download"].forEach(function(es){z$1[es]=new v$1(es,4,!1,es,null,!1,!1)});["cols","rows","size","span"].forEach(function(es){z$1[es]=new v$1(es,6,!1,es,null,!1,!1)});["rowSpan","start"].forEach(function(es){z$1[es]=new v$1(es,5,!1,es.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(es){return es[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(es){var ts=es.replace(ra,sa);z$1[ts]=new v$1(ts,1,!1,es,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(es){var ts=es.replace(ra,sa);z$1[ts]=new v$1(ts,1,!1,es,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(es){var ts=es.replace(ra,sa);z$1[ts]=new v$1(ts,1,!1,es,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(es){z$1[es]=new v$1(es,1,!1,es.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(es){z$1[es]=new v$1(es,1,!1,es.toLowerCase(),null,!0,!0)});function ta(es,ts,ss,ns){var rs=z$1.hasOwnProperty(ts)?z$1[ts]:null;(rs!==null?rs.type!==0:ns||!(2<ts.length)||ts[0]!=="o"&&ts[0]!=="O"||ts[1]!=="n"&&ts[1]!=="N")&&(qa(ts,ss,rs,ns)&&(ss=null),ns||rs===null?oa(ts)&&(ss===null?es.removeAttribute(ts):es.setAttribute(ts,""+ss)):rs.mustUseProperty?es[rs.propertyName]=ss===null?rs.type===3?!1:"":ss:(ts=rs.attributeName,ns=rs.attributeNamespace,ss===null?es.removeAttribute(ts):(rs=rs.type,ss=rs===3||rs===4&&ss===!0?"":""+ss,ns?es.setAttributeNS(ns,ts,ss):es.setAttribute(ts,ss))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(es){return es===null||typeof es!="object"?null:(es=Ja&&es[Ja]||es["@@iterator"],typeof es=="function"?es:null)}var A$1=Object.assign,La;function Ma(es){if(La===void 0)try{throw Error()}catch(ss){var ts=ss.stack.trim().match(/\n( *(at )?)/);La=ts&&ts[1]||""}return`
`+La+es}var Na=!1;function Oa(es,ts){if(!es||Na)return"";Na=!0;var ss=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(ts)if(ts=function(){throw Error()},Object.defineProperty(ts.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ts,[])}catch(us){var ns=us}Reflect.construct(es,[],ts)}else{try{ts.call()}catch(us){ns=us}es.call(ts.prototype)}else{try{throw Error()}catch(us){ns=us}es()}}catch(us){if(us&&ns&&typeof us.stack=="string"){for(var rs=us.stack.split(`
`),os=ns.stack.split(`
`),as=rs.length-1,cs=os.length-1;1<=as&&0<=cs&&rs[as]!==os[cs];)cs--;for(;1<=as&&0<=cs;as--,cs--)if(rs[as]!==os[cs]){if(as!==1||cs!==1)do if(as--,cs--,0>cs||rs[as]!==os[cs]){var ls=`
`+rs[as].replace(" at new "," at ");return es.displayName&&ls.includes("<anonymous>")&&(ls=ls.replace("<anonymous>",es.displayName)),ls}while(1<=as&&0<=cs);break}}}finally{Na=!1,Error.prepareStackTrace=ss}return(es=es?es.displayName||es.name:"")?Ma(es):""}function Pa(es){switch(es.tag){case 5:return Ma(es.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return es=Oa(es.type,!1),es;case 11:return es=Oa(es.type.render,!1),es;case 1:return es=Oa(es.type,!0),es;default:return""}}function Qa(es){if(es==null)return null;if(typeof es=="function")return es.displayName||es.name||null;if(typeof es=="string")return es;switch(es){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof es=="object")switch(es.$$typeof){case Ca:return(es.displayName||"Context")+".Consumer";case Ba:return(es._context.displayName||"Context")+".Provider";case Da:var ts=es.render;return es=es.displayName,es||(es=ts.displayName||ts.name||"",es=es!==""?"ForwardRef("+es+")":"ForwardRef"),es;case Ga:return ts=es.displayName||null,ts!==null?ts:Qa(es.type)||"Memo";case Ha:ts=es._payload,es=es._init;try{return Qa(es(ts))}catch{}}return null}function Ra(es){var ts=es.type;switch(es.tag){case 24:return"Cache";case 9:return(ts.displayName||"Context")+".Consumer";case 10:return(ts._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return es=ts.render,es=es.displayName||es.name||"",ts.displayName||(es!==""?"ForwardRef("+es+")":"ForwardRef");case 7:return"Fragment";case 5:return ts;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(ts);case 8:return ts===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof ts=="function")return ts.displayName||ts.name||null;if(typeof ts=="string")return ts}return null}function Sa(es){switch(typeof es){case"boolean":case"number":case"string":case"undefined":return es;case"object":return es;default:return""}}function Ta(es){var ts=es.type;return(es=es.nodeName)&&es.toLowerCase()==="input"&&(ts==="checkbox"||ts==="radio")}function Ua(es){var ts=Ta(es)?"checked":"value",ss=Object.getOwnPropertyDescriptor(es.constructor.prototype,ts),ns=""+es[ts];if(!es.hasOwnProperty(ts)&&typeof ss<"u"&&typeof ss.get=="function"&&typeof ss.set=="function"){var rs=ss.get,os=ss.set;return Object.defineProperty(es,ts,{configurable:!0,get:function(){return rs.call(this)},set:function(as){ns=""+as,os.call(this,as)}}),Object.defineProperty(es,ts,{enumerable:ss.enumerable}),{getValue:function(){return ns},setValue:function(as){ns=""+as},stopTracking:function(){es._valueTracker=null,delete es[ts]}}}}function Va(es){es._valueTracker||(es._valueTracker=Ua(es))}function Wa(es){if(!es)return!1;var ts=es._valueTracker;if(!ts)return!0;var ss=ts.getValue(),ns="";return es&&(ns=Ta(es)?es.checked?"true":"false":es.value),es=ns,es!==ss?(ts.setValue(es),!0):!1}function Xa(es){if(es=es||(typeof document<"u"?document:void 0),typeof es>"u")return null;try{return es.activeElement||es.body}catch{return es.body}}function Ya(es,ts){var ss=ts.checked;return A$1({},ts,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:ss??es._wrapperState.initialChecked})}function Za(es,ts){var ss=ts.defaultValue==null?"":ts.defaultValue,ns=ts.checked!=null?ts.checked:ts.defaultChecked;ss=Sa(ts.value!=null?ts.value:ss),es._wrapperState={initialChecked:ns,initialValue:ss,controlled:ts.type==="checkbox"||ts.type==="radio"?ts.checked!=null:ts.value!=null}}function ab(es,ts){ts=ts.checked,ts!=null&&ta(es,"checked",ts,!1)}function bb(es,ts){ab(es,ts);var ss=Sa(ts.value),ns=ts.type;if(ss!=null)ns==="number"?(ss===0&&es.value===""||es.value!=ss)&&(es.value=""+ss):es.value!==""+ss&&(es.value=""+ss);else if(ns==="submit"||ns==="reset"){es.removeAttribute("value");return}ts.hasOwnProperty("value")?cb(es,ts.type,ss):ts.hasOwnProperty("defaultValue")&&cb(es,ts.type,Sa(ts.defaultValue)),ts.checked==null&&ts.defaultChecked!=null&&(es.defaultChecked=!!ts.defaultChecked)}function db$1(es,ts,ss){if(ts.hasOwnProperty("value")||ts.hasOwnProperty("defaultValue")){var ns=ts.type;if(!(ns!=="submit"&&ns!=="reset"||ts.value!==void 0&&ts.value!==null))return;ts=""+es._wrapperState.initialValue,ss||ts===es.value||(es.value=ts),es.defaultValue=ts}ss=es.name,ss!==""&&(es.name=""),es.defaultChecked=!!es._wrapperState.initialChecked,ss!==""&&(es.name=ss)}function cb(es,ts,ss){(ts!=="number"||Xa(es.ownerDocument)!==es)&&(ss==null?es.defaultValue=""+es._wrapperState.initialValue:es.defaultValue!==""+ss&&(es.defaultValue=""+ss))}var eb=Array.isArray;function fb(es,ts,ss,ns){if(es=es.options,ts){ts={};for(var rs=0;rs<ss.length;rs++)ts["$"+ss[rs]]=!0;for(ss=0;ss<es.length;ss++)rs=ts.hasOwnProperty("$"+es[ss].value),es[ss].selected!==rs&&(es[ss].selected=rs),rs&&ns&&(es[ss].defaultSelected=!0)}else{for(ss=""+Sa(ss),ts=null,rs=0;rs<es.length;rs++){if(es[rs].value===ss){es[rs].selected=!0,ns&&(es[rs].defaultSelected=!0);return}ts!==null||es[rs].disabled||(ts=es[rs])}ts!==null&&(ts.selected=!0)}}function gb(es,ts){if(ts.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},ts,{value:void 0,defaultValue:void 0,children:""+es._wrapperState.initialValue})}function hb(es,ts){var ss=ts.value;if(ss==null){if(ss=ts.children,ts=ts.defaultValue,ss!=null){if(ts!=null)throw Error(p$1(92));if(eb(ss)){if(1<ss.length)throw Error(p$1(93));ss=ss[0]}ts=ss}ts==null&&(ts=""),ss=ts}es._wrapperState={initialValue:Sa(ss)}}function ib(es,ts){var ss=Sa(ts.value),ns=Sa(ts.defaultValue);ss!=null&&(ss=""+ss,ss!==es.value&&(es.value=ss),ts.defaultValue==null&&es.defaultValue!==ss&&(es.defaultValue=ss)),ns!=null&&(es.defaultValue=""+ns)}function jb(es){var ts=es.textContent;ts===es._wrapperState.initialValue&&ts!==""&&ts!==null&&(es.value=ts)}function kb(es){switch(es){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(es,ts){return es==null||es==="http://www.w3.org/1999/xhtml"?kb(ts):es==="http://www.w3.org/2000/svg"&&ts==="foreignObject"?"http://www.w3.org/1999/xhtml":es}var mb,nb=function(es){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(ts,ss,ns,rs){MSApp.execUnsafeLocalFunction(function(){return es(ts,ss,ns,rs)})}:es}(function(es,ts){if(es.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in es)es.innerHTML=ts;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+ts.valueOf().toString()+"</svg>",ts=mb.firstChild;es.firstChild;)es.removeChild(es.firstChild);for(;ts.firstChild;)es.appendChild(ts.firstChild)}});function ob(es,ts){if(ts){var ss=es.firstChild;if(ss&&ss===es.lastChild&&ss.nodeType===3){ss.nodeValue=ts;return}}es.textContent=ts}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(es){qb.forEach(function(ts){ts=ts+es.charAt(0).toUpperCase()+es.substring(1),pb[ts]=pb[es]})});function rb(es,ts,ss){return ts==null||typeof ts=="boolean"||ts===""?"":ss||typeof ts!="number"||ts===0||pb.hasOwnProperty(es)&&pb[es]?(""+ts).trim():ts+"px"}function sb(es,ts){es=es.style;for(var ss in ts)if(ts.hasOwnProperty(ss)){var ns=ss.indexOf("--")===0,rs=rb(ss,ts[ss],ns);ss==="float"&&(ss="cssFloat"),ns?es.setProperty(ss,rs):es[ss]=rs}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(es,ts){if(ts){if(tb[es]&&(ts.children!=null||ts.dangerouslySetInnerHTML!=null))throw Error(p$1(137,es));if(ts.dangerouslySetInnerHTML!=null){if(ts.children!=null)throw Error(p$1(60));if(typeof ts.dangerouslySetInnerHTML!="object"||!("__html"in ts.dangerouslySetInnerHTML))throw Error(p$1(61))}if(ts.style!=null&&typeof ts.style!="object")throw Error(p$1(62))}}function vb(es,ts){if(es.indexOf("-")===-1)return typeof ts.is=="string";switch(es){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(es){return es=es.target||es.srcElement||window,es.correspondingUseElement&&(es=es.correspondingUseElement),es.nodeType===3?es.parentNode:es}var yb=null,zb=null,Ab=null;function Bb(es){if(es=Cb(es)){if(typeof yb!="function")throw Error(p$1(280));var ts=es.stateNode;ts&&(ts=Db(ts),yb(es.stateNode,es.type,ts))}}function Eb(es){zb?Ab?Ab.push(es):Ab=[es]:zb=es}function Fb(){if(zb){var es=zb,ts=Ab;if(Ab=zb=null,Bb(es),ts)for(es=0;es<ts.length;es++)Bb(ts[es])}}function Gb(es,ts){return es(ts)}function Hb(){}var Ib=!1;function Jb(es,ts,ss){if(Ib)return es(ts,ss);Ib=!0;try{return Gb(es,ts,ss)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(es,ts){var ss=es.stateNode;if(ss===null)return null;var ns=Db(ss);if(ns===null)return null;ss=ns[ts];e:switch(ts){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(ns=!ns.disabled)||(es=es.type,ns=!(es==="button"||es==="input"||es==="select"||es==="textarea")),es=!ns;break e;default:es=!1}if(es)return null;if(ss&&typeof ss!="function")throw Error(p$1(231,ts,typeof ss));return ss}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(es,ts,ss,ns,rs,os,as,cs,ls){var us=Array.prototype.slice.call(arguments,3);try{ts.apply(ss,us)}catch(ds){this.onError(ds)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(es){Ob=!0,Pb=es}};function Tb(es,ts,ss,ns,rs,os,as,cs,ls){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(es,ts,ss,ns,rs,os,as,cs,ls){if(Tb.apply(this,arguments),Ob){if(Ob){var us=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=us)}}function Vb(es){var ts=es,ss=es;if(es.alternate)for(;ts.return;)ts=ts.return;else{es=ts;do ts=es,ts.flags&4098&&(ss=ts.return),es=ts.return;while(es)}return ts.tag===3?ss:null}function Wb(es){if(es.tag===13){var ts=es.memoizedState;if(ts===null&&(es=es.alternate,es!==null&&(ts=es.memoizedState)),ts!==null)return ts.dehydrated}return null}function Xb(es){if(Vb(es)!==es)throw Error(p$1(188))}function Yb(es){var ts=es.alternate;if(!ts){if(ts=Vb(es),ts===null)throw Error(p$1(188));return ts!==es?null:es}for(var ss=es,ns=ts;;){var rs=ss.return;if(rs===null)break;var os=rs.alternate;if(os===null){if(ns=rs.return,ns!==null){ss=ns;continue}break}if(rs.child===os.child){for(os=rs.child;os;){if(os===ss)return Xb(rs),es;if(os===ns)return Xb(rs),ts;os=os.sibling}throw Error(p$1(188))}if(ss.return!==ns.return)ss=rs,ns=os;else{for(var as=!1,cs=rs.child;cs;){if(cs===ss){as=!0,ss=rs,ns=os;break}if(cs===ns){as=!0,ns=rs,ss=os;break}cs=cs.sibling}if(!as){for(cs=os.child;cs;){if(cs===ss){as=!0,ss=os,ns=rs;break}if(cs===ns){as=!0,ns=os,ss=rs;break}cs=cs.sibling}if(!as)throw Error(p$1(189))}}if(ss.alternate!==ns)throw Error(p$1(190))}if(ss.tag!==3)throw Error(p$1(188));return ss.stateNode.current===ss?es:ts}function Zb(es){return es=Yb(es),es!==null?$b(es):null}function $b(es){if(es.tag===5||es.tag===6)return es;for(es=es.child;es!==null;){var ts=$b(es);if(ts!==null)return ts;es=es.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$1=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(es){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,es,void 0,(es.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(es){return es>>>=0,es===0?32:31-(pc(es)/qc|0)|0}var rc=64,sc=4194304;function tc(es){switch(es&-es){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return es&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return es&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return es}}function uc(es,ts){var ss=es.pendingLanes;if(ss===0)return 0;var ns=0,rs=es.suspendedLanes,os=es.pingedLanes,as=ss&268435455;if(as!==0){var cs=as&~rs;cs!==0?ns=tc(cs):(os&=as,os!==0&&(ns=tc(os)))}else as=ss&~rs,as!==0?ns=tc(as):os!==0&&(ns=tc(os));if(ns===0)return 0;if(ts!==0&&ts!==ns&&!(ts&rs)&&(rs=ns&-ns,os=ts&-ts,rs>=os||rs===16&&(os&4194240)!==0))return ts;if(ns&4&&(ns|=ss&16),ts=es.entangledLanes,ts!==0)for(es=es.entanglements,ts&=ns;0<ts;)ss=31-oc(ts),rs=1<<ss,ns|=es[ss],ts&=~rs;return ns}function vc(es,ts){switch(es){case 1:case 2:case 4:return ts+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return ts+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(es,ts){for(var ss=es.suspendedLanes,ns=es.pingedLanes,rs=es.expirationTimes,os=es.pendingLanes;0<os;){var as=31-oc(os),cs=1<<as,ls=rs[as];ls===-1?(!(cs&ss)||cs&ns)&&(rs[as]=vc(cs,ts)):ls<=ts&&(es.expiredLanes|=cs),os&=~cs}}function xc(es){return es=es.pendingLanes&-1073741825,es!==0?es:es&1073741824?1073741824:0}function yc(){var es=rc;return rc<<=1,!(rc&4194240)&&(rc=64),es}function zc(es){for(var ts=[],ss=0;31>ss;ss++)ts.push(es);return ts}function Ac(es,ts,ss){es.pendingLanes|=ts,ts!==536870912&&(es.suspendedLanes=0,es.pingedLanes=0),es=es.eventTimes,ts=31-oc(ts),es[ts]=ss}function Bc(es,ts){var ss=es.pendingLanes&~ts;es.pendingLanes=ts,es.suspendedLanes=0,es.pingedLanes=0,es.expiredLanes&=ts,es.mutableReadLanes&=ts,es.entangledLanes&=ts,ts=es.entanglements;var ns=es.eventTimes;for(es=es.expirationTimes;0<ss;){var rs=31-oc(ss),os=1<<rs;ts[rs]=0,ns[rs]=-1,es[rs]=-1,ss&=~os}}function Cc(es,ts){var ss=es.entangledLanes|=ts;for(es=es.entanglements;ss;){var ns=31-oc(ss),rs=1<<ns;rs&ts|es[ns]&ts&&(es[ns]|=ts),ss&=~rs}}var C$1=0;function Dc(es){return es&=-es,1<es?4<es?es&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(es,ts){switch(es){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(ts.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(ts.pointerId)}}function Tc(es,ts,ss,ns,rs,os){return es===null||es.nativeEvent!==os?(es={blockedOn:ts,domEventName:ss,eventSystemFlags:ns,nativeEvent:os,targetContainers:[rs]},ts!==null&&(ts=Cb(ts),ts!==null&&Fc(ts)),es):(es.eventSystemFlags|=ns,ts=es.targetContainers,rs!==null&&ts.indexOf(rs)===-1&&ts.push(rs),es)}function Uc(es,ts,ss,ns,rs){switch(ts){case"focusin":return Lc=Tc(Lc,es,ts,ss,ns,rs),!0;case"dragenter":return Mc=Tc(Mc,es,ts,ss,ns,rs),!0;case"mouseover":return Nc=Tc(Nc,es,ts,ss,ns,rs),!0;case"pointerover":var os=rs.pointerId;return Oc.set(os,Tc(Oc.get(os)||null,es,ts,ss,ns,rs)),!0;case"gotpointercapture":return os=rs.pointerId,Pc.set(os,Tc(Pc.get(os)||null,es,ts,ss,ns,rs)),!0}return!1}function Vc(es){var ts=Wc(es.target);if(ts!==null){var ss=Vb(ts);if(ss!==null){if(ts=ss.tag,ts===13){if(ts=Wb(ss),ts!==null){es.blockedOn=ts,Ic(es.priority,function(){Gc(ss)});return}}else if(ts===3&&ss.stateNode.current.memoizedState.isDehydrated){es.blockedOn=ss.tag===3?ss.stateNode.containerInfo:null;return}}}es.blockedOn=null}function Xc(es){if(es.blockedOn!==null)return!1;for(var ts=es.targetContainers;0<ts.length;){var ss=Yc(es.domEventName,es.eventSystemFlags,ts[0],es.nativeEvent);if(ss===null){ss=es.nativeEvent;var ns=new ss.constructor(ss.type,ss);wb=ns,ss.target.dispatchEvent(ns),wb=null}else return ts=Cb(ss),ts!==null&&Fc(ts),es.blockedOn=ss,!1;ts.shift()}return!0}function Zc(es,ts,ss){Xc(es)&&ss.delete(ts)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(es,ts){es.blockedOn===ts&&(es.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(es){function ts(rs){return ad(rs,es)}if(0<Kc.length){ad(Kc[0],es);for(var ss=1;ss<Kc.length;ss++){var ns=Kc[ss];ns.blockedOn===es&&(ns.blockedOn=null)}}for(Lc!==null&&ad(Lc,es),Mc!==null&&ad(Mc,es),Nc!==null&&ad(Nc,es),Oc.forEach(ts),Pc.forEach(ts),ss=0;ss<Qc.length;ss++)ns=Qc[ss],ns.blockedOn===es&&(ns.blockedOn=null);for(;0<Qc.length&&(ss=Qc[0],ss.blockedOn===null);)Vc(ss),ss.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(es,ts,ss,ns){var rs=C$1,os=cd.transition;cd.transition=null;try{C$1=1,fd(es,ts,ss,ns)}finally{C$1=rs,cd.transition=os}}function gd(es,ts,ss,ns){var rs=C$1,os=cd.transition;cd.transition=null;try{C$1=4,fd(es,ts,ss,ns)}finally{C$1=rs,cd.transition=os}}function fd(es,ts,ss,ns){if(dd){var rs=Yc(es,ts,ss,ns);if(rs===null)hd(es,ts,ns,id,ss),Sc(es,ns);else if(Uc(rs,es,ts,ss,ns))ns.stopPropagation();else if(Sc(es,ns),ts&4&&-1<Rc.indexOf(es)){for(;rs!==null;){var os=Cb(rs);if(os!==null&&Ec(os),os=Yc(es,ts,ss,ns),os===null&&hd(es,ts,ns,id,ss),os===rs)break;rs=os}rs!==null&&ns.stopPropagation()}else hd(es,ts,ns,null,ss)}}var id=null;function Yc(es,ts,ss,ns){if(id=null,es=xb(ns),es=Wc(es),es!==null)if(ts=Vb(es),ts===null)es=null;else if(ss=ts.tag,ss===13){if(es=Wb(ts),es!==null)return es;es=null}else if(ss===3){if(ts.stateNode.current.memoizedState.isDehydrated)return ts.tag===3?ts.stateNode.containerInfo:null;es=null}else ts!==es&&(es=null);return id=es,null}function jd(es){switch(es){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var es,ts=ld,ss=ts.length,ns,rs="value"in kd?kd.value:kd.textContent,os=rs.length;for(es=0;es<ss&&ts[es]===rs[es];es++);var as=ss-es;for(ns=1;ns<=as&&ts[ss-ns]===rs[os-ns];ns++);return md=rs.slice(es,1<ns?1-ns:void 0)}function od(es){var ts=es.keyCode;return"charCode"in es?(es=es.charCode,es===0&&ts===13&&(es=13)):es=ts,es===10&&(es=13),32<=es||es===13?es:0}function pd(){return!0}function qd(){return!1}function rd(es){function ts(ss,ns,rs,os,as){this._reactName=ss,this._targetInst=rs,this.type=ns,this.nativeEvent=os,this.target=as,this.currentTarget=null;for(var cs in es)es.hasOwnProperty(cs)&&(ss=es[cs],this[cs]=ss?ss(os):os[cs]);return this.isDefaultPrevented=(os.defaultPrevented!=null?os.defaultPrevented:os.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(ts.prototype,{preventDefault:function(){this.defaultPrevented=!0;var ss=this.nativeEvent;ss&&(ss.preventDefault?ss.preventDefault():typeof ss.returnValue!="unknown"&&(ss.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var ss=this.nativeEvent;ss&&(ss.stopPropagation?ss.stopPropagation():typeof ss.cancelBubble!="unknown"&&(ss.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),ts}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(es){return es.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(es){return es.relatedTarget===void 0?es.fromElement===es.srcElement?es.toElement:es.fromElement:es.relatedTarget},movementX:function(es){return"movementX"in es?es.movementX:(es!==yd&&(yd&&es.type==="mousemove"?(wd=es.screenX-yd.screenX,xd=es.screenY-yd.screenY):xd=wd=0,yd=es),wd)},movementY:function(es){return"movementY"in es?es.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(es){return"clipboardData"in es?es.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(es){var ts=this.nativeEvent;return ts.getModifierState?ts.getModifierState(es):(es=Od[es])?!!ts[es]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(es){if(es.key){var ts=Md[es.key]||es.key;if(ts!=="Unidentified")return ts}return es.type==="keypress"?(es=od(es),es===13?"Enter":String.fromCharCode(es)):es.type==="keydown"||es.type==="keyup"?Nd[es.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(es){return es.type==="keypress"?od(es):0},keyCode:function(es){return es.type==="keydown"||es.type==="keyup"?es.keyCode:0},which:function(es){return es.type==="keypress"?od(es):es.type==="keydown"||es.type==="keyup"?es.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(es){return"deltaX"in es?es.deltaX:"wheelDeltaX"in es?-es.wheelDeltaX:0},deltaY:function(es){return"deltaY"in es?es.deltaY:"wheelDeltaY"in es?-es.wheelDeltaY:"wheelDelta"in es?-es.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$1=ia&&"CompositionEvent"in window,be$1=null;ia&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia&&"TextEvent"in window&&!be$1,de$1=ia&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee$1=" ",fe$1=!1;function ge$1(es,ts){switch(es){case"keyup":return $d.indexOf(ts.keyCode)!==-1;case"keydown":return ts.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(es){return es=es.detail,typeof es=="object"&&"data"in es?es.data:null}var ie$1=!1;function je$1(es,ts){switch(es){case"compositionend":return he$1(ts);case"keypress":return ts.which!==32?null:(fe$1=!0,ee$1);case"textInput":return es=ts.data,es===ee$1&&fe$1?null:es;default:return null}}function ke$1(es,ts){if(ie$1)return es==="compositionend"||!ae$1&&ge$1(es,ts)?(es=nd(),md=ld=kd=null,ie$1=!1,es):null;switch(es){case"paste":return null;case"keypress":if(!(ts.ctrlKey||ts.altKey||ts.metaKey)||ts.ctrlKey&&ts.altKey){if(ts.char&&1<ts.char.length)return ts.char;if(ts.which)return String.fromCharCode(ts.which)}return null;case"compositionend":return de$1&&ts.locale!=="ko"?null:ts.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(es){var ts=es&&es.nodeName&&es.nodeName.toLowerCase();return ts==="input"?!!le$1[es.type]:ts==="textarea"}function ne$1(es,ts,ss,ns){Eb(ns),ts=oe$1(ts,"onChange"),0<ts.length&&(ss=new td("onChange","change",null,ss,ns),es.push({event:ss,listeners:ts}))}var pe$1=null,qe$1=null;function re$1(es){se$1(es,0)}function te$1(es){var ts=ue$1(es);if(Wa(ts))return es}function ve$1(es,ts){if(es==="change")return ts}var we$1=!1;if(ia){var xe$1;if(ia){var ye$1="oninput"in document;if(!ye$1){var ze$1=document.createElement("div");ze$1.setAttribute("oninput","return;"),ye$1=typeof ze$1.oninput=="function"}xe$1=ye$1}else xe$1=!1;we$1=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae$1(){pe$1&&(pe$1.detachEvent("onpropertychange",Be$1),qe$1=pe$1=null)}function Be$1(es){if(es.propertyName==="value"&&te$1(qe$1)){var ts=[];ne$1(ts,qe$1,es,xb(es)),Jb(re$1,ts)}}function Ce$1(es,ts,ss){es==="focusin"?(Ae$1(),pe$1=ts,qe$1=ss,pe$1.attachEvent("onpropertychange",Be$1)):es==="focusout"&&Ae$1()}function De$1(es){if(es==="selectionchange"||es==="keyup"||es==="keydown")return te$1(qe$1)}function Ee$1(es,ts){if(es==="click")return te$1(ts)}function Fe$1(es,ts){if(es==="input"||es==="change")return te$1(ts)}function Ge$1(es,ts){return es===ts&&(es!==0||1/es===1/ts)||es!==es&&ts!==ts}var He$1=typeof Object.is=="function"?Object.is:Ge$1;function Ie$1(es,ts){if(He$1(es,ts))return!0;if(typeof es!="object"||es===null||typeof ts!="object"||ts===null)return!1;var ss=Object.keys(es),ns=Object.keys(ts);if(ss.length!==ns.length)return!1;for(ns=0;ns<ss.length;ns++){var rs=ss[ns];if(!ja.call(ts,rs)||!He$1(es[rs],ts[rs]))return!1}return!0}function Je$1(es){for(;es&&es.firstChild;)es=es.firstChild;return es}function Ke$1(es,ts){var ss=Je$1(es);es=0;for(var ns;ss;){if(ss.nodeType===3){if(ns=es+ss.textContent.length,es<=ts&&ns>=ts)return{node:ss,offset:ts-es};es=ns}e:{for(;ss;){if(ss.nextSibling){ss=ss.nextSibling;break e}ss=ss.parentNode}ss=void 0}ss=Je$1(ss)}}function Le$1(es,ts){return es&&ts?es===ts?!0:es&&es.nodeType===3?!1:ts&&ts.nodeType===3?Le$1(es,ts.parentNode):"contains"in es?es.contains(ts):es.compareDocumentPosition?!!(es.compareDocumentPosition(ts)&16):!1:!1}function Me$1(){for(var es=window,ts=Xa();ts instanceof es.HTMLIFrameElement;){try{var ss=typeof ts.contentWindow.location.href=="string"}catch{ss=!1}if(ss)es=ts.contentWindow;else break;ts=Xa(es.document)}return ts}function Ne$1(es){var ts=es&&es.nodeName&&es.nodeName.toLowerCase();return ts&&(ts==="input"&&(es.type==="text"||es.type==="search"||es.type==="tel"||es.type==="url"||es.type==="password")||ts==="textarea"||es.contentEditable==="true")}function Oe$1(es){var ts=Me$1(),ss=es.focusedElem,ns=es.selectionRange;if(ts!==ss&&ss&&ss.ownerDocument&&Le$1(ss.ownerDocument.documentElement,ss)){if(ns!==null&&Ne$1(ss)){if(ts=ns.start,es=ns.end,es===void 0&&(es=ts),"selectionStart"in ss)ss.selectionStart=ts,ss.selectionEnd=Math.min(es,ss.value.length);else if(es=(ts=ss.ownerDocument||document)&&ts.defaultView||window,es.getSelection){es=es.getSelection();var rs=ss.textContent.length,os=Math.min(ns.start,rs);ns=ns.end===void 0?os:Math.min(ns.end,rs),!es.extend&&os>ns&&(rs=ns,ns=os,os=rs),rs=Ke$1(ss,os);var as=Ke$1(ss,ns);rs&&as&&(es.rangeCount!==1||es.anchorNode!==rs.node||es.anchorOffset!==rs.offset||es.focusNode!==as.node||es.focusOffset!==as.offset)&&(ts=ts.createRange(),ts.setStart(rs.node,rs.offset),es.removeAllRanges(),os>ns?(es.addRange(ts),es.extend(as.node,as.offset)):(ts.setEnd(as.node,as.offset),es.addRange(ts)))}}for(ts=[],es=ss;es=es.parentNode;)es.nodeType===1&&ts.push({element:es,left:es.scrollLeft,top:es.scrollTop});for(typeof ss.focus=="function"&&ss.focus(),ss=0;ss<ts.length;ss++)es=ts[ss],es.element.scrollLeft=es.left,es.element.scrollTop=es.top}}var Pe$1=ia&&"documentMode"in document&&11>=document.documentMode,Qe$1=null,Re$1=null,Se$1=null,Te$1=!1;function Ue$1(es,ts,ss){var ns=ss.window===ss?ss.document:ss.nodeType===9?ss:ss.ownerDocument;Te$1||Qe$1==null||Qe$1!==Xa(ns)||(ns=Qe$1,"selectionStart"in ns&&Ne$1(ns)?ns={start:ns.selectionStart,end:ns.selectionEnd}:(ns=(ns.ownerDocument&&ns.ownerDocument.defaultView||window).getSelection(),ns={anchorNode:ns.anchorNode,anchorOffset:ns.anchorOffset,focusNode:ns.focusNode,focusOffset:ns.focusOffset}),Se$1&&Ie$1(Se$1,ns)||(Se$1=ns,ns=oe$1(Re$1,"onSelect"),0<ns.length&&(ts=new td("onSelect","select",null,ts,ss),es.push({event:ts,listeners:ns}),ts.target=Qe$1)))}function Ve$1(es,ts){var ss={};return ss[es.toLowerCase()]=ts.toLowerCase(),ss["Webkit"+es]="webkit"+ts,ss["Moz"+es]="moz"+ts,ss}var We$1={animationend:Ve$1("Animation","AnimationEnd"),animationiteration:Ve$1("Animation","AnimationIteration"),animationstart:Ve$1("Animation","AnimationStart"),transitionend:Ve$1("Transition","TransitionEnd")},Xe$1={},Ye$1={};ia&&(Ye$1=document.createElement("div").style,"AnimationEvent"in window||(delete We$1.animationend.animation,delete We$1.animationiteration.animation,delete We$1.animationstart.animation),"TransitionEvent"in window||delete We$1.transitionend.transition);function Ze$1(es){if(Xe$1[es])return Xe$1[es];if(!We$1[es])return es;var ts=We$1[es],ss;for(ss in ts)if(ts.hasOwnProperty(ss)&&ss in Ye$1)return Xe$1[es]=ts[ss];return es}var $e$1=Ze$1("animationend"),af=Ze$1("animationiteration"),bf=Ze$1("animationstart"),cf=Ze$1("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(es,ts){df.set(es,ts),fa(ts,[es])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e$1,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(es,ts,ss){var ns=es.type||"unknown-event";es.currentTarget=ss,Ub(ns,ts,void 0,es),es.currentTarget=null}function se$1(es,ts){ts=(ts&4)!==0;for(var ss=0;ss<es.length;ss++){var ns=es[ss],rs=ns.event;ns=ns.listeners;e:{var os=void 0;if(ts)for(var as=ns.length-1;0<=as;as--){var cs=ns[as],ls=cs.instance,us=cs.currentTarget;if(cs=cs.listener,ls!==os&&rs.isPropagationStopped())break e;nf(rs,cs,us),os=ls}else for(as=0;as<ns.length;as++){if(cs=ns[as],ls=cs.instance,us=cs.currentTarget,cs=cs.listener,ls!==os&&rs.isPropagationStopped())break e;nf(rs,cs,us),os=ls}}}if(Qb)throw es=Rb,Qb=!1,Rb=null,es}function D$1(es,ts){var ss=ts[of];ss===void 0&&(ss=ts[of]=new Set);var ns=es+"__bubble";ss.has(ns)||(pf(ts,es,2,!1),ss.add(ns))}function qf(es,ts,ss){var ns=0;ts&&(ns|=4),pf(ss,es,ns,ts)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(es){if(!es[rf]){es[rf]=!0,da.forEach(function(ss){ss!=="selectionchange"&&(mf.has(ss)||qf(ss,!1,es),qf(ss,!0,es))});var ts=es.nodeType===9?es:es.ownerDocument;ts===null||ts[rf]||(ts[rf]=!0,qf("selectionchange",!1,ts))}}function pf(es,ts,ss,ns){switch(jd(ts)){case 1:var rs=ed;break;case 4:rs=gd;break;default:rs=fd}ss=rs.bind(null,ts,ss,es),rs=void 0,!Lb||ts!=="touchstart"&&ts!=="touchmove"&&ts!=="wheel"||(rs=!0),ns?rs!==void 0?es.addEventListener(ts,ss,{capture:!0,passive:rs}):es.addEventListener(ts,ss,!0):rs!==void 0?es.addEventListener(ts,ss,{passive:rs}):es.addEventListener(ts,ss,!1)}function hd(es,ts,ss,ns,rs){var os=ns;if(!(ts&1)&&!(ts&2)&&ns!==null)e:for(;;){if(ns===null)return;var as=ns.tag;if(as===3||as===4){var cs=ns.stateNode.containerInfo;if(cs===rs||cs.nodeType===8&&cs.parentNode===rs)break;if(as===4)for(as=ns.return;as!==null;){var ls=as.tag;if((ls===3||ls===4)&&(ls=as.stateNode.containerInfo,ls===rs||ls.nodeType===8&&ls.parentNode===rs))return;as=as.return}for(;cs!==null;){if(as=Wc(cs),as===null)return;if(ls=as.tag,ls===5||ls===6){ns=os=as;continue e}cs=cs.parentNode}}ns=ns.return}Jb(function(){var us=os,ds=xb(ss),xs=[];e:{var fs=df.get(es);if(fs!==void 0){var gs=td,Es=es;switch(es){case"keypress":if(od(ss)===0)break e;case"keydown":case"keyup":gs=Rd;break;case"focusin":Es="focus",gs=Fd;break;case"focusout":Es="blur",gs=Fd;break;case"beforeblur":case"afterblur":gs=Fd;break;case"click":if(ss.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":gs=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":gs=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":gs=Vd;break;case $e$1:case af:case bf:gs=Hd;break;case cf:gs=Xd;break;case"scroll":gs=vd;break;case"wheel":gs=Zd;break;case"copy":case"cut":case"paste":gs=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":gs=Td}var js=(ts&4)!==0,ps=!js&&es==="scroll",ms=js?fs!==null?fs+"Capture":null:fs;js=[];for(var hs=us,vs;hs!==null;){vs=hs;var ws=vs.stateNode;if(vs.tag===5&&ws!==null&&(vs=ws,ms!==null&&(ws=Kb(hs,ms),ws!=null&&js.push(tf(hs,ws,vs)))),ps)break;hs=hs.return}0<js.length&&(fs=new gs(fs,Es,null,ss,ds),xs.push({event:fs,listeners:js}))}}if(!(ts&7)){e:{if(fs=es==="mouseover"||es==="pointerover",gs=es==="mouseout"||es==="pointerout",fs&&ss!==wb&&(Es=ss.relatedTarget||ss.fromElement)&&(Wc(Es)||Es[uf]))break e;if((gs||fs)&&(fs=ds.window===ds?ds:(fs=ds.ownerDocument)?fs.defaultView||fs.parentWindow:window,gs?(Es=ss.relatedTarget||ss.toElement,gs=us,Es=Es?Wc(Es):null,Es!==null&&(ps=Vb(Es),Es!==ps||Es.tag!==5&&Es.tag!==6)&&(Es=null)):(gs=null,Es=us),gs!==Es)){if(js=Bd,ws="onMouseLeave",ms="onMouseEnter",hs="mouse",(es==="pointerout"||es==="pointerover")&&(js=Td,ws="onPointerLeave",ms="onPointerEnter",hs="pointer"),ps=gs==null?fs:ue$1(gs),vs=Es==null?fs:ue$1(Es),fs=new js(ws,hs+"leave",gs,ss,ds),fs.target=ps,fs.relatedTarget=vs,ws=null,Wc(ds)===us&&(js=new js(ms,hs+"enter",Es,ss,ds),js.target=vs,js.relatedTarget=ps,ws=js),ps=ws,gs&&Es)t:{for(js=gs,ms=Es,hs=0,vs=js;vs;vs=vf(vs))hs++;for(vs=0,ws=ms;ws;ws=vf(ws))vs++;for(;0<hs-vs;)js=vf(js),hs--;for(;0<vs-hs;)ms=vf(ms),vs--;for(;hs--;){if(js===ms||ms!==null&&js===ms.alternate)break t;js=vf(js),ms=vf(ms)}js=null}else js=null;gs!==null&&wf(xs,fs,gs,js,!1),Es!==null&&ps!==null&&wf(xs,ps,Es,js,!0)}}e:{if(fs=us?ue$1(us):window,gs=fs.nodeName&&fs.nodeName.toLowerCase(),gs==="select"||gs==="input"&&fs.type==="file")var ys=ve$1;else if(me$1(fs))if(we$1)ys=Fe$1;else{ys=De$1;var Rs=Ce$1}else(gs=fs.nodeName)&&gs.toLowerCase()==="input"&&(fs.type==="checkbox"||fs.type==="radio")&&(ys=Ee$1);if(ys&&(ys=ys(es,us))){ne$1(xs,ys,ss,ds);break e}Rs&&Rs(es,fs,us),es==="focusout"&&(Rs=fs._wrapperState)&&Rs.controlled&&fs.type==="number"&&cb(fs,"number",fs.value)}switch(Rs=us?ue$1(us):window,es){case"focusin":(me$1(Rs)||Rs.contentEditable==="true")&&(Qe$1=Rs,Re$1=us,Se$1=null);break;case"focusout":Se$1=Re$1=Qe$1=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue$1(xs,ss,ds);break;case"selectionchange":if(Pe$1)break;case"keydown":case"keyup":Ue$1(xs,ss,ds)}var bs;if(ae$1)e:{switch(es){case"compositionstart":var Ns="onCompositionStart";break e;case"compositionend":Ns="onCompositionEnd";break e;case"compositionupdate":Ns="onCompositionUpdate";break e}Ns=void 0}else ie$1?ge$1(es,ss)&&(Ns="onCompositionEnd"):es==="keydown"&&ss.keyCode===229&&(Ns="onCompositionStart");Ns&&(de$1&&ss.locale!=="ko"&&(ie$1||Ns!=="onCompositionStart"?Ns==="onCompositionEnd"&&ie$1&&(bs=nd()):(kd=ds,ld="value"in kd?kd.value:kd.textContent,ie$1=!0)),Rs=oe$1(us,Ns),0<Rs.length&&(Ns=new Ld(Ns,es,null,ss,ds),xs.push({event:Ns,listeners:Rs}),bs?Ns.data=bs:(bs=he$1(ss),bs!==null&&(Ns.data=bs)))),(bs=ce$1?je$1(es,ss):ke$1(es,ss))&&(us=oe$1(us,"onBeforeInput"),0<us.length&&(ds=new Ld("onBeforeInput","beforeinput",null,ss,ds),xs.push({event:ds,listeners:us}),ds.data=bs))}se$1(xs,ts)})}function tf(es,ts,ss){return{instance:es,listener:ts,currentTarget:ss}}function oe$1(es,ts){for(var ss=ts+"Capture",ns=[];es!==null;){var rs=es,os=rs.stateNode;rs.tag===5&&os!==null&&(rs=os,os=Kb(es,ss),os!=null&&ns.unshift(tf(es,os,rs)),os=Kb(es,ts),os!=null&&ns.push(tf(es,os,rs))),es=es.return}return ns}function vf(es){if(es===null)return null;do es=es.return;while(es&&es.tag!==5);return es||null}function wf(es,ts,ss,ns,rs){for(var os=ts._reactName,as=[];ss!==null&&ss!==ns;){var cs=ss,ls=cs.alternate,us=cs.stateNode;if(ls!==null&&ls===ns)break;cs.tag===5&&us!==null&&(cs=us,rs?(ls=Kb(ss,os),ls!=null&&as.unshift(tf(ss,ls,cs))):rs||(ls=Kb(ss,os),ls!=null&&as.push(tf(ss,ls,cs)))),ss=ss.return}as.length!==0&&es.push({event:ts,listeners:as})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(es){return(typeof es=="string"?es:""+es).replace(xf,`
`).replace(yf,"")}function Af(es,ts,ss){if(ts=zf(ts),zf(es)!==ts&&ss)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(es,ts){return es==="textarea"||es==="noscript"||typeof ts.children=="string"||typeof ts.children=="number"||typeof ts.dangerouslySetInnerHTML=="object"&&ts.dangerouslySetInnerHTML!==null&&ts.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(es){return Hf.resolve(null).then(es).catch(If)}:Ff;function If(es){setTimeout(function(){throw es})}function Kf(es,ts){var ss=ts,ns=0;do{var rs=ss.nextSibling;if(es.removeChild(ss),rs&&rs.nodeType===8)if(ss=rs.data,ss==="/$"){if(ns===0){es.removeChild(rs),bd(ts);return}ns--}else ss!=="$"&&ss!=="$?"&&ss!=="$!"||ns++;ss=rs}while(ss);bd(ts)}function Lf(es){for(;es!=null;es=es.nextSibling){var ts=es.nodeType;if(ts===1||ts===3)break;if(ts===8){if(ts=es.data,ts==="$"||ts==="$!"||ts==="$?")break;if(ts==="/$")return null}}return es}function Mf(es){es=es.previousSibling;for(var ts=0;es;){if(es.nodeType===8){var ss=es.data;if(ss==="$"||ss==="$!"||ss==="$?"){if(ts===0)return es;ts--}else ss==="/$"&&ts++}es=es.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(es){var ts=es[Of];if(ts)return ts;for(var ss=es.parentNode;ss;){if(ts=ss[uf]||ss[Of]){if(ss=ts.alternate,ts.child!==null||ss!==null&&ss.child!==null)for(es=Mf(es);es!==null;){if(ss=es[Of])return ss;es=Mf(es)}return ts}es=ss,ss=es.parentNode}return null}function Cb(es){return es=es[Of]||es[uf],!es||es.tag!==5&&es.tag!==6&&es.tag!==13&&es.tag!==3?null:es}function ue$1(es){if(es.tag===5||es.tag===6)return es.stateNode;throw Error(p$1(33))}function Db(es){return es[Pf]||null}var Sf=[],Tf=-1;function Uf(es){return{current:es}}function E$1(es){0>Tf||(es.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(es,ts){Tf++,Sf[Tf]=es.current,es.current=ts}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(es,ts){var ss=es.type.contextTypes;if(!ss)return Vf;var ns=es.stateNode;if(ns&&ns.__reactInternalMemoizedUnmaskedChildContext===ts)return ns.__reactInternalMemoizedMaskedChildContext;var rs={},os;for(os in ss)rs[os]=ts[os];return ns&&(es=es.stateNode,es.__reactInternalMemoizedUnmaskedChildContext=ts,es.__reactInternalMemoizedMaskedChildContext=rs),rs}function Zf(es){return es=es.childContextTypes,es!=null}function $f(){E$1(Wf),E$1(H$1)}function ag(es,ts,ss){if(H$1.current!==Vf)throw Error(p$1(168));G$1(H$1,ts),G$1(Wf,ss)}function bg(es,ts,ss){var ns=es.stateNode;if(ts=ts.childContextTypes,typeof ns.getChildContext!="function")return ss;ns=ns.getChildContext();for(var rs in ns)if(!(rs in ts))throw Error(p$1(108,Ra(es)||"Unknown",rs));return A$1({},ss,ns)}function cg(es){return es=(es=es.stateNode)&&es.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G$1(H$1,es),G$1(Wf,Wf.current),!0}function dg(es,ts,ss){var ns=es.stateNode;if(!ns)throw Error(p$1(169));ss?(es=bg(es,ts,Xf),ns.__reactInternalMemoizedMergedChildContext=es,E$1(Wf),E$1(H$1),G$1(H$1,es)):E$1(Wf),G$1(Wf,ss)}var eg=null,fg=!1,gg=!1;function hg(es){eg===null?eg=[es]:eg.push(es)}function ig(es){fg=!0,hg(es)}function jg(){if(!gg&&eg!==null){gg=!0;var es=0,ts=C$1;try{var ss=eg;for(C$1=1;es<ss.length;es++){var ns=ss[es];do ns=ns(!0);while(ns!==null)}eg=null,fg=!1}catch(rs){throw eg!==null&&(eg=eg.slice(es+1)),ac(fc,jg),rs}finally{C$1=ts,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(es,ts){kg[lg++]=ng,kg[lg++]=mg,mg=es,ng=ts}function ug(es,ts,ss){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=es;var ns=rg;es=sg;var rs=32-oc(ns)-1;ns&=~(1<<rs),ss+=1;var os=32-oc(ts)+rs;if(30<os){var as=rs-rs%5;os=(ns&(1<<as)-1).toString(32),ns>>=as,rs-=as,rg=1<<32-oc(ts)+rs|ss<<rs|ns,sg=os+es}else rg=1<<os|ss<<rs|ns,sg=es}function vg(es){es.return!==null&&(tg(es,1),ug(es,1,0))}function wg(es){for(;es===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;es===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(es,ts){var ss=Bg(5,null,null,0);ss.elementType="DELETED",ss.stateNode=ts,ss.return=es,ts=es.deletions,ts===null?(es.deletions=[ss],es.flags|=16):ts.push(ss)}function Cg(es,ts){switch(es.tag){case 5:var ss=es.type;return ts=ts.nodeType!==1||ss.toLowerCase()!==ts.nodeName.toLowerCase()?null:ts,ts!==null?(es.stateNode=ts,xg=es,yg=Lf(ts.firstChild),!0):!1;case 6:return ts=es.pendingProps===""||ts.nodeType!==3?null:ts,ts!==null?(es.stateNode=ts,xg=es,yg=null,!0):!1;case 13:return ts=ts.nodeType!==8?null:ts,ts!==null?(ss=qg!==null?{id:rg,overflow:sg}:null,es.memoizedState={dehydrated:ts,treeContext:ss,retryLane:1073741824},ss=Bg(18,null,null,0),ss.stateNode=ts,ss.return=es,es.child=ss,xg=es,yg=null,!0):!1;default:return!1}}function Dg(es){return(es.mode&1)!==0&&(es.flags&128)===0}function Eg(es){if(I$1){var ts=yg;if(ts){var ss=ts;if(!Cg(es,ts)){if(Dg(es))throw Error(p$1(418));ts=Lf(ss.nextSibling);var ns=xg;ts&&Cg(es,ts)?Ag(ns,ss):(es.flags=es.flags&-4097|2,I$1=!1,xg=es)}}else{if(Dg(es))throw Error(p$1(418));es.flags=es.flags&-4097|2,I$1=!1,xg=es}}}function Fg(es){for(es=es.return;es!==null&&es.tag!==5&&es.tag!==3&&es.tag!==13;)es=es.return;xg=es}function Gg(es){if(es!==xg)return!1;if(!I$1)return Fg(es),I$1=!0,!1;var ts;if((ts=es.tag!==3)&&!(ts=es.tag!==5)&&(ts=es.type,ts=ts!=="head"&&ts!=="body"&&!Ef(es.type,es.memoizedProps)),ts&&(ts=yg)){if(Dg(es))throw Hg(),Error(p$1(418));for(;ts;)Ag(es,ts),ts=Lf(ts.nextSibling)}if(Fg(es),es.tag===13){if(es=es.memoizedState,es=es!==null?es.dehydrated:null,!es)throw Error(p$1(317));e:{for(es=es.nextSibling,ts=0;es;){if(es.nodeType===8){var ss=es.data;if(ss==="/$"){if(ts===0){yg=Lf(es.nextSibling);break e}ts--}else ss!=="$"&&ss!=="$!"&&ss!=="$?"||ts++}es=es.nextSibling}yg=null}}else yg=xg?Lf(es.stateNode.nextSibling):null;return!0}function Hg(){for(var es=yg;es;)es=Lf(es.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(es){zg===null?zg=[es]:zg.push(es)}var Kg=ua.ReactCurrentBatchConfig;function Lg(es,ts,ss){if(es=ss.ref,es!==null&&typeof es!="function"&&typeof es!="object"){if(ss._owner){if(ss=ss._owner,ss){if(ss.tag!==1)throw Error(p$1(309));var ns=ss.stateNode}if(!ns)throw Error(p$1(147,es));var rs=ns,os=""+es;return ts!==null&&ts.ref!==null&&typeof ts.ref=="function"&&ts.ref._stringRef===os?ts.ref:(ts=function(as){var cs=rs.refs;as===null?delete cs[os]:cs[os]=as},ts._stringRef=os,ts)}if(typeof es!="string")throw Error(p$1(284));if(!ss._owner)throw Error(p$1(290,es))}return es}function Mg(es,ts){throw es=Object.prototype.toString.call(ts),Error(p$1(31,es==="[object Object]"?"object with keys {"+Object.keys(ts).join(", ")+"}":es))}function Ng(es){var ts=es._init;return ts(es._payload)}function Og(es){function ts(ms,hs){if(es){var vs=ms.deletions;vs===null?(ms.deletions=[hs],ms.flags|=16):vs.push(hs)}}function ss(ms,hs){if(!es)return null;for(;hs!==null;)ts(ms,hs),hs=hs.sibling;return null}function ns(ms,hs){for(ms=new Map;hs!==null;)hs.key!==null?ms.set(hs.key,hs):ms.set(hs.index,hs),hs=hs.sibling;return ms}function rs(ms,hs){return ms=Pg(ms,hs),ms.index=0,ms.sibling=null,ms}function os(ms,hs,vs){return ms.index=vs,es?(vs=ms.alternate,vs!==null?(vs=vs.index,vs<hs?(ms.flags|=2,hs):vs):(ms.flags|=2,hs)):(ms.flags|=1048576,hs)}function as(ms){return es&&ms.alternate===null&&(ms.flags|=2),ms}function cs(ms,hs,vs,ws){return hs===null||hs.tag!==6?(hs=Qg(vs,ms.mode,ws),hs.return=ms,hs):(hs=rs(hs,vs),hs.return=ms,hs)}function ls(ms,hs,vs,ws){var ys=vs.type;return ys===ya?ds(ms,hs,vs.props.children,ws,vs.key):hs!==null&&(hs.elementType===ys||typeof ys=="object"&&ys!==null&&ys.$$typeof===Ha&&Ng(ys)===hs.type)?(ws=rs(hs,vs.props),ws.ref=Lg(ms,hs,vs),ws.return=ms,ws):(ws=Rg(vs.type,vs.key,vs.props,null,ms.mode,ws),ws.ref=Lg(ms,hs,vs),ws.return=ms,ws)}function us(ms,hs,vs,ws){return hs===null||hs.tag!==4||hs.stateNode.containerInfo!==vs.containerInfo||hs.stateNode.implementation!==vs.implementation?(hs=Sg(vs,ms.mode,ws),hs.return=ms,hs):(hs=rs(hs,vs.children||[]),hs.return=ms,hs)}function ds(ms,hs,vs,ws,ys){return hs===null||hs.tag!==7?(hs=Tg(vs,ms.mode,ws,ys),hs.return=ms,hs):(hs=rs(hs,vs),hs.return=ms,hs)}function xs(ms,hs,vs){if(typeof hs=="string"&&hs!==""||typeof hs=="number")return hs=Qg(""+hs,ms.mode,vs),hs.return=ms,hs;if(typeof hs=="object"&&hs!==null){switch(hs.$$typeof){case va:return vs=Rg(hs.type,hs.key,hs.props,null,ms.mode,vs),vs.ref=Lg(ms,null,hs),vs.return=ms,vs;case wa:return hs=Sg(hs,ms.mode,vs),hs.return=ms,hs;case Ha:var ws=hs._init;return xs(ms,ws(hs._payload),vs)}if(eb(hs)||Ka(hs))return hs=Tg(hs,ms.mode,vs,null),hs.return=ms,hs;Mg(ms,hs)}return null}function fs(ms,hs,vs,ws){var ys=hs!==null?hs.key:null;if(typeof vs=="string"&&vs!==""||typeof vs=="number")return ys!==null?null:cs(ms,hs,""+vs,ws);if(typeof vs=="object"&&vs!==null){switch(vs.$$typeof){case va:return vs.key===ys?ls(ms,hs,vs,ws):null;case wa:return vs.key===ys?us(ms,hs,vs,ws):null;case Ha:return ys=vs._init,fs(ms,hs,ys(vs._payload),ws)}if(eb(vs)||Ka(vs))return ys!==null?null:ds(ms,hs,vs,ws,null);Mg(ms,vs)}return null}function gs(ms,hs,vs,ws,ys){if(typeof ws=="string"&&ws!==""||typeof ws=="number")return ms=ms.get(vs)||null,cs(hs,ms,""+ws,ys);if(typeof ws=="object"&&ws!==null){switch(ws.$$typeof){case va:return ms=ms.get(ws.key===null?vs:ws.key)||null,ls(hs,ms,ws,ys);case wa:return ms=ms.get(ws.key===null?vs:ws.key)||null,us(hs,ms,ws,ys);case Ha:var Rs=ws._init;return gs(ms,hs,vs,Rs(ws._payload),ys)}if(eb(ws)||Ka(ws))return ms=ms.get(vs)||null,ds(hs,ms,ws,ys,null);Mg(hs,ws)}return null}function Es(ms,hs,vs,ws){for(var ys=null,Rs=null,bs=hs,Ns=hs=0,Ss=null;bs!==null&&Ns<vs.length;Ns++){bs.index>Ns?(Ss=bs,bs=null):Ss=bs.sibling;var Ts=fs(ms,bs,vs[Ns],ws);if(Ts===null){bs===null&&(bs=Ss);break}es&&bs&&Ts.alternate===null&&ts(ms,bs),hs=os(Ts,hs,Ns),Rs===null?ys=Ts:Rs.sibling=Ts,Rs=Ts,bs=Ss}if(Ns===vs.length)return ss(ms,bs),I$1&&tg(ms,Ns),ys;if(bs===null){for(;Ns<vs.length;Ns++)bs=xs(ms,vs[Ns],ws),bs!==null&&(hs=os(bs,hs,Ns),Rs===null?ys=bs:Rs.sibling=bs,Rs=bs);return I$1&&tg(ms,Ns),ys}for(bs=ns(ms,bs);Ns<vs.length;Ns++)Ss=gs(bs,ms,Ns,vs[Ns],ws),Ss!==null&&(es&&Ss.alternate!==null&&bs.delete(Ss.key===null?Ns:Ss.key),hs=os(Ss,hs,Ns),Rs===null?ys=Ss:Rs.sibling=Ss,Rs=Ss);return es&&bs.forEach(function(Cs){return ts(ms,Cs)}),I$1&&tg(ms,Ns),ys}function js(ms,hs,vs,ws){var ys=Ka(vs);if(typeof ys!="function")throw Error(p$1(150));if(vs=ys.call(vs),vs==null)throw Error(p$1(151));for(var Rs=ys=null,bs=hs,Ns=hs=0,Ss=null,Ts=vs.next();bs!==null&&!Ts.done;Ns++,Ts=vs.next()){bs.index>Ns?(Ss=bs,bs=null):Ss=bs.sibling;var Cs=fs(ms,bs,Ts.value,ws);if(Cs===null){bs===null&&(bs=Ss);break}es&&bs&&Cs.alternate===null&&ts(ms,bs),hs=os(Cs,hs,Ns),Rs===null?ys=Cs:Rs.sibling=Cs,Rs=Cs,bs=Ss}if(Ts.done)return ss(ms,bs),I$1&&tg(ms,Ns),ys;if(bs===null){for(;!Ts.done;Ns++,Ts=vs.next())Ts=xs(ms,Ts.value,ws),Ts!==null&&(hs=os(Ts,hs,Ns),Rs===null?ys=Ts:Rs.sibling=Ts,Rs=Ts);return I$1&&tg(ms,Ns),ys}for(bs=ns(ms,bs);!Ts.done;Ns++,Ts=vs.next())Ts=gs(bs,ms,Ns,Ts.value,ws),Ts!==null&&(es&&Ts.alternate!==null&&bs.delete(Ts.key===null?Ns:Ts.key),hs=os(Ts,hs,Ns),Rs===null?ys=Ts:Rs.sibling=Ts,Rs=Ts);return es&&bs.forEach(function(Ms){return ts(ms,Ms)}),I$1&&tg(ms,Ns),ys}function ps(ms,hs,vs,ws){if(typeof vs=="object"&&vs!==null&&vs.type===ya&&vs.key===null&&(vs=vs.props.children),typeof vs=="object"&&vs!==null){switch(vs.$$typeof){case va:e:{for(var ys=vs.key,Rs=hs;Rs!==null;){if(Rs.key===ys){if(ys=vs.type,ys===ya){if(Rs.tag===7){ss(ms,Rs.sibling),hs=rs(Rs,vs.props.children),hs.return=ms,ms=hs;break e}}else if(Rs.elementType===ys||typeof ys=="object"&&ys!==null&&ys.$$typeof===Ha&&Ng(ys)===Rs.type){ss(ms,Rs.sibling),hs=rs(Rs,vs.props),hs.ref=Lg(ms,Rs,vs),hs.return=ms,ms=hs;break e}ss(ms,Rs);break}else ts(ms,Rs);Rs=Rs.sibling}vs.type===ya?(hs=Tg(vs.props.children,ms.mode,ws,vs.key),hs.return=ms,ms=hs):(ws=Rg(vs.type,vs.key,vs.props,null,ms.mode,ws),ws.ref=Lg(ms,hs,vs),ws.return=ms,ms=ws)}return as(ms);case wa:e:{for(Rs=vs.key;hs!==null;){if(hs.key===Rs)if(hs.tag===4&&hs.stateNode.containerInfo===vs.containerInfo&&hs.stateNode.implementation===vs.implementation){ss(ms,hs.sibling),hs=rs(hs,vs.children||[]),hs.return=ms,ms=hs;break e}else{ss(ms,hs);break}else ts(ms,hs);hs=hs.sibling}hs=Sg(vs,ms.mode,ws),hs.return=ms,ms=hs}return as(ms);case Ha:return Rs=vs._init,ps(ms,hs,Rs(vs._payload),ws)}if(eb(vs))return Es(ms,hs,vs,ws);if(Ka(vs))return js(ms,hs,vs,ws);Mg(ms,vs)}return typeof vs=="string"&&vs!==""||typeof vs=="number"?(vs=""+vs,hs!==null&&hs.tag===6?(ss(ms,hs.sibling),hs=rs(hs,vs),hs.return=ms,ms=hs):(ss(ms,hs),hs=Qg(vs,ms.mode,ws),hs.return=ms,ms=hs),as(ms)):ss(ms,hs)}return ps}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(es){var ts=Wg.current;E$1(Wg),es._currentValue=ts}function bh(es,ts,ss){for(;es!==null;){var ns=es.alternate;if((es.childLanes&ts)!==ts?(es.childLanes|=ts,ns!==null&&(ns.childLanes|=ts)):ns!==null&&(ns.childLanes&ts)!==ts&&(ns.childLanes|=ts),es===ss)break;es=es.return}}function ch(es,ts){Xg=es,Zg=Yg=null,es=es.dependencies,es!==null&&es.firstContext!==null&&(es.lanes&ts&&(dh=!0),es.firstContext=null)}function eh(es){var ts=es._currentValue;if(Zg!==es)if(es={context:es,memoizedValue:ts,next:null},Yg===null){if(Xg===null)throw Error(p$1(308));Yg=es,Xg.dependencies={lanes:0,firstContext:es}}else Yg=Yg.next=es;return ts}var fh=null;function gh(es){fh===null?fh=[es]:fh.push(es)}function hh(es,ts,ss,ns){var rs=ts.interleaved;return rs===null?(ss.next=ss,gh(ts)):(ss.next=rs.next,rs.next=ss),ts.interleaved=ss,ih(es,ns)}function ih(es,ts){es.lanes|=ts;var ss=es.alternate;for(ss!==null&&(ss.lanes|=ts),ss=es,es=es.return;es!==null;)es.childLanes|=ts,ss=es.alternate,ss!==null&&(ss.childLanes|=ts),ss=es,es=es.return;return ss.tag===3?ss.stateNode:null}var jh=!1;function kh(es){es.updateQueue={baseState:es.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(es,ts){es=es.updateQueue,ts.updateQueue===es&&(ts.updateQueue={baseState:es.baseState,firstBaseUpdate:es.firstBaseUpdate,lastBaseUpdate:es.lastBaseUpdate,shared:es.shared,effects:es.effects})}function mh(es,ts){return{eventTime:es,lane:ts,tag:0,payload:null,callback:null,next:null}}function nh(es,ts,ss){var ns=es.updateQueue;if(ns===null)return null;if(ns=ns.shared,K$1&2){var rs=ns.pending;return rs===null?ts.next=ts:(ts.next=rs.next,rs.next=ts),ns.pending=ts,ih(es,ss)}return rs=ns.interleaved,rs===null?(ts.next=ts,gh(ns)):(ts.next=rs.next,rs.next=ts),ns.interleaved=ts,ih(es,ss)}function oh(es,ts,ss){if(ts=ts.updateQueue,ts!==null&&(ts=ts.shared,(ss&4194240)!==0)){var ns=ts.lanes;ns&=es.pendingLanes,ss|=ns,ts.lanes=ss,Cc(es,ss)}}function ph(es,ts){var ss=es.updateQueue,ns=es.alternate;if(ns!==null&&(ns=ns.updateQueue,ss===ns)){var rs=null,os=null;if(ss=ss.firstBaseUpdate,ss!==null){do{var as={eventTime:ss.eventTime,lane:ss.lane,tag:ss.tag,payload:ss.payload,callback:ss.callback,next:null};os===null?rs=os=as:os=os.next=as,ss=ss.next}while(ss!==null);os===null?rs=os=ts:os=os.next=ts}else rs=os=ts;ss={baseState:ns.baseState,firstBaseUpdate:rs,lastBaseUpdate:os,shared:ns.shared,effects:ns.effects},es.updateQueue=ss;return}es=ss.lastBaseUpdate,es===null?ss.firstBaseUpdate=ts:es.next=ts,ss.lastBaseUpdate=ts}function qh(es,ts,ss,ns){var rs=es.updateQueue;jh=!1;var os=rs.firstBaseUpdate,as=rs.lastBaseUpdate,cs=rs.shared.pending;if(cs!==null){rs.shared.pending=null;var ls=cs,us=ls.next;ls.next=null,as===null?os=us:as.next=us,as=ls;var ds=es.alternate;ds!==null&&(ds=ds.updateQueue,cs=ds.lastBaseUpdate,cs!==as&&(cs===null?ds.firstBaseUpdate=us:cs.next=us,ds.lastBaseUpdate=ls))}if(os!==null){var xs=rs.baseState;as=0,ds=us=ls=null,cs=os;do{var fs=cs.lane,gs=cs.eventTime;if((ns&fs)===fs){ds!==null&&(ds=ds.next={eventTime:gs,lane:0,tag:cs.tag,payload:cs.payload,callback:cs.callback,next:null});e:{var Es=es,js=cs;switch(fs=ts,gs=ss,js.tag){case 1:if(Es=js.payload,typeof Es=="function"){xs=Es.call(gs,xs,fs);break e}xs=Es;break e;case 3:Es.flags=Es.flags&-65537|128;case 0:if(Es=js.payload,fs=typeof Es=="function"?Es.call(gs,xs,fs):Es,fs==null)break e;xs=A$1({},xs,fs);break e;case 2:jh=!0}}cs.callback!==null&&cs.lane!==0&&(es.flags|=64,fs=rs.effects,fs===null?rs.effects=[cs]:fs.push(cs))}else gs={eventTime:gs,lane:fs,tag:cs.tag,payload:cs.payload,callback:cs.callback,next:null},ds===null?(us=ds=gs,ls=xs):ds=ds.next=gs,as|=fs;if(cs=cs.next,cs===null){if(cs=rs.shared.pending,cs===null)break;fs=cs,cs=fs.next,fs.next=null,rs.lastBaseUpdate=fs,rs.shared.pending=null}}while(!0);if(ds===null&&(ls=xs),rs.baseState=ls,rs.firstBaseUpdate=us,rs.lastBaseUpdate=ds,ts=rs.shared.interleaved,ts!==null){rs=ts;do as|=rs.lane,rs=rs.next;while(rs!==ts)}else os===null&&(rs.shared.lanes=0);rh|=as,es.lanes=as,es.memoizedState=xs}}function sh(es,ts,ss){if(es=ts.effects,ts.effects=null,es!==null)for(ts=0;ts<es.length;ts++){var ns=es[ts],rs=ns.callback;if(rs!==null){if(ns.callback=null,ns=ss,typeof rs!="function")throw Error(p$1(191,rs));rs.call(ns)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(es){if(es===th)throw Error(p$1(174));return es}function yh(es,ts){switch(G$1(wh,ts),G$1(vh,es),G$1(uh,th),es=ts.nodeType,es){case 9:case 11:ts=(ts=ts.documentElement)?ts.namespaceURI:lb(null,"");break;default:es=es===8?ts.parentNode:ts,ts=es.namespaceURI||null,es=es.tagName,ts=lb(ts,es)}E$1(uh),G$1(uh,ts)}function zh(){E$1(uh),E$1(vh),E$1(wh)}function Ah(es){xh(wh.current);var ts=xh(uh.current),ss=lb(ts,es.type);ts!==ss&&(G$1(vh,es),G$1(uh,ss))}function Bh(es){vh.current===es&&(E$1(uh),E$1(vh))}var L$1=Uf(0);function Ch(es){for(var ts=es;ts!==null;){if(ts.tag===13){var ss=ts.memoizedState;if(ss!==null&&(ss=ss.dehydrated,ss===null||ss.data==="$?"||ss.data==="$!"))return ts}else if(ts.tag===19&&ts.memoizedProps.revealOrder!==void 0){if(ts.flags&128)return ts}else if(ts.child!==null){ts.child.return=ts,ts=ts.child;continue}if(ts===es)break;for(;ts.sibling===null;){if(ts.return===null||ts.return===es)return null;ts=ts.return}ts.sibling.return=ts.return,ts=ts.sibling}return null}var Dh=[];function Eh(){for(var es=0;es<Dh.length;es++)Dh[es]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M$1=null,N$1=null,O$1=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p$1(321))}function Mh(es,ts){if(ts===null)return!1;for(var ss=0;ss<ts.length&&ss<es.length;ss++)if(!He$1(es[ss],ts[ss]))return!1;return!0}function Nh(es,ts,ss,ns,rs,os){if(Hh=os,M$1=ts,ts.memoizedState=null,ts.updateQueue=null,ts.lanes=0,Fh.current=es===null||es.memoizedState===null?Oh:Ph,es=ss(ns,rs),Jh){os=0;do{if(Jh=!1,Kh=0,25<=os)throw Error(p$1(301));os+=1,O$1=N$1=null,ts.updateQueue=null,Fh.current=Qh,es=ss(ns,rs)}while(Jh)}if(Fh.current=Rh,ts=N$1!==null&&N$1.next!==null,Hh=0,O$1=N$1=M$1=null,Ih=!1,ts)throw Error(p$1(300));return es}function Sh(){var es=Kh!==0;return Kh=0,es}function Th(){var es={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$1===null?M$1.memoizedState=O$1=es:O$1=O$1.next=es,O$1}function Uh(){if(N$1===null){var es=M$1.alternate;es=es!==null?es.memoizedState:null}else es=N$1.next;var ts=O$1===null?M$1.memoizedState:O$1.next;if(ts!==null)O$1=ts,N$1=es;else{if(es===null)throw Error(p$1(310));N$1=es,es={memoizedState:N$1.memoizedState,baseState:N$1.baseState,baseQueue:N$1.baseQueue,queue:N$1.queue,next:null},O$1===null?M$1.memoizedState=O$1=es:O$1=O$1.next=es}return O$1}function Vh(es,ts){return typeof ts=="function"?ts(es):ts}function Wh(es){var ts=Uh(),ss=ts.queue;if(ss===null)throw Error(p$1(311));ss.lastRenderedReducer=es;var ns=N$1,rs=ns.baseQueue,os=ss.pending;if(os!==null){if(rs!==null){var as=rs.next;rs.next=os.next,os.next=as}ns.baseQueue=rs=os,ss.pending=null}if(rs!==null){os=rs.next,ns=ns.baseState;var cs=as=null,ls=null,us=os;do{var ds=us.lane;if((Hh&ds)===ds)ls!==null&&(ls=ls.next={lane:0,action:us.action,hasEagerState:us.hasEagerState,eagerState:us.eagerState,next:null}),ns=us.hasEagerState?us.eagerState:es(ns,us.action);else{var xs={lane:ds,action:us.action,hasEagerState:us.hasEagerState,eagerState:us.eagerState,next:null};ls===null?(cs=ls=xs,as=ns):ls=ls.next=xs,M$1.lanes|=ds,rh|=ds}us=us.next}while(us!==null&&us!==os);ls===null?as=ns:ls.next=cs,He$1(ns,ts.memoizedState)||(dh=!0),ts.memoizedState=ns,ts.baseState=as,ts.baseQueue=ls,ss.lastRenderedState=ns}if(es=ss.interleaved,es!==null){rs=es;do os=rs.lane,M$1.lanes|=os,rh|=os,rs=rs.next;while(rs!==es)}else rs===null&&(ss.lanes=0);return[ts.memoizedState,ss.dispatch]}function Xh(es){var ts=Uh(),ss=ts.queue;if(ss===null)throw Error(p$1(311));ss.lastRenderedReducer=es;var ns=ss.dispatch,rs=ss.pending,os=ts.memoizedState;if(rs!==null){ss.pending=null;var as=rs=rs.next;do os=es(os,as.action),as=as.next;while(as!==rs);He$1(os,ts.memoizedState)||(dh=!0),ts.memoizedState=os,ts.baseQueue===null&&(ts.baseState=os),ss.lastRenderedState=os}return[os,ns]}function Yh(){}function Zh(es,ts){var ss=M$1,ns=Uh(),rs=ts(),os=!He$1(ns.memoizedState,rs);if(os&&(ns.memoizedState=rs,dh=!0),ns=ns.queue,$h(ai.bind(null,ss,ns,es),[es]),ns.getSnapshot!==ts||os||O$1!==null&&O$1.memoizedState.tag&1){if(ss.flags|=2048,bi(9,ci.bind(null,ss,ns,rs,ts),void 0,null),Q$1===null)throw Error(p$1(349));Hh&30||di(ss,ts,rs)}return rs}function di(es,ts,ss){es.flags|=16384,es={getSnapshot:ts,value:ss},ts=M$1.updateQueue,ts===null?(ts={lastEffect:null,stores:null},M$1.updateQueue=ts,ts.stores=[es]):(ss=ts.stores,ss===null?ts.stores=[es]:ss.push(es))}function ci(es,ts,ss,ns){ts.value=ss,ts.getSnapshot=ns,ei(ts)&&fi(es)}function ai(es,ts,ss){return ss(function(){ei(ts)&&fi(es)})}function ei(es){var ts=es.getSnapshot;es=es.value;try{var ss=ts();return!He$1(es,ss)}catch{return!0}}function fi(es){var ts=ih(es,1);ts!==null&&gi(ts,es,1,-1)}function hi(es){var ts=Th();return typeof es=="function"&&(es=es()),ts.memoizedState=ts.baseState=es,es={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:es},ts.queue=es,es=es.dispatch=ii.bind(null,M$1,es),[ts.memoizedState,es]}function bi(es,ts,ss,ns){return es={tag:es,create:ts,destroy:ss,deps:ns,next:null},ts=M$1.updateQueue,ts===null?(ts={lastEffect:null,stores:null},M$1.updateQueue=ts,ts.lastEffect=es.next=es):(ss=ts.lastEffect,ss===null?ts.lastEffect=es.next=es:(ns=ss.next,ss.next=es,es.next=ns,ts.lastEffect=es)),es}function ji(){return Uh().memoizedState}function ki(es,ts,ss,ns){var rs=Th();M$1.flags|=es,rs.memoizedState=bi(1|ts,ss,void 0,ns===void 0?null:ns)}function li(es,ts,ss,ns){var rs=Uh();ns=ns===void 0?null:ns;var os=void 0;if(N$1!==null){var as=N$1.memoizedState;if(os=as.destroy,ns!==null&&Mh(ns,as.deps)){rs.memoizedState=bi(ts,ss,os,ns);return}}M$1.flags|=es,rs.memoizedState=bi(1|ts,ss,os,ns)}function mi(es,ts){return ki(8390656,8,es,ts)}function $h(es,ts){return li(2048,8,es,ts)}function ni(es,ts){return li(4,2,es,ts)}function oi(es,ts){return li(4,4,es,ts)}function pi(es,ts){if(typeof ts=="function")return es=es(),ts(es),function(){ts(null)};if(ts!=null)return es=es(),ts.current=es,function(){ts.current=null}}function qi(es,ts,ss){return ss=ss!=null?ss.concat([es]):null,li(4,4,pi.bind(null,ts,es),ss)}function ri(){}function si(es,ts){var ss=Uh();ts=ts===void 0?null:ts;var ns=ss.memoizedState;return ns!==null&&ts!==null&&Mh(ts,ns[1])?ns[0]:(ss.memoizedState=[es,ts],es)}function ti(es,ts){var ss=Uh();ts=ts===void 0?null:ts;var ns=ss.memoizedState;return ns!==null&&ts!==null&&Mh(ts,ns[1])?ns[0]:(es=es(),ss.memoizedState=[es,ts],es)}function ui(es,ts,ss){return Hh&21?(He$1(ss,ts)||(ss=yc(),M$1.lanes|=ss,rh|=ss,es.baseState=!0),ts):(es.baseState&&(es.baseState=!1,dh=!0),es.memoizedState=ss)}function vi(es,ts){var ss=C$1;C$1=ss!==0&&4>ss?ss:4,es(!0);var ns=Gh.transition;Gh.transition={};try{es(!1),ts()}finally{C$1=ss,Gh.transition=ns}}function wi(){return Uh().memoizedState}function xi(es,ts,ss){var ns=yi(es);if(ss={lane:ns,action:ss,hasEagerState:!1,eagerState:null,next:null},zi(es))Ai(ts,ss);else if(ss=hh(es,ts,ss,ns),ss!==null){var rs=R$1();gi(ss,es,ns,rs),Bi(ss,ts,ns)}}function ii(es,ts,ss){var ns=yi(es),rs={lane:ns,action:ss,hasEagerState:!1,eagerState:null,next:null};if(zi(es))Ai(ts,rs);else{var os=es.alternate;if(es.lanes===0&&(os===null||os.lanes===0)&&(os=ts.lastRenderedReducer,os!==null))try{var as=ts.lastRenderedState,cs=os(as,ss);if(rs.hasEagerState=!0,rs.eagerState=cs,He$1(cs,as)){var ls=ts.interleaved;ls===null?(rs.next=rs,gh(ts)):(rs.next=ls.next,ls.next=rs),ts.interleaved=rs;return}}catch{}finally{}ss=hh(es,ts,rs,ns),ss!==null&&(rs=R$1(),gi(ss,es,ns,rs),Bi(ss,ts,ns))}}function zi(es){var ts=es.alternate;return es===M$1||ts!==null&&ts===M$1}function Ai(es,ts){Jh=Ih=!0;var ss=es.pending;ss===null?ts.next=ts:(ts.next=ss.next,ss.next=ts),es.pending=ts}function Bi(es,ts,ss){if(ss&4194240){var ns=ts.lanes;ns&=es.pendingLanes,ss|=ns,ts.lanes=ss,Cc(es,ss)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(es,ts){return Th().memoizedState=[es,ts===void 0?null:ts],es},useContext:eh,useEffect:mi,useImperativeHandle:function(es,ts,ss){return ss=ss!=null?ss.concat([es]):null,ki(4194308,4,pi.bind(null,ts,es),ss)},useLayoutEffect:function(es,ts){return ki(4194308,4,es,ts)},useInsertionEffect:function(es,ts){return ki(4,2,es,ts)},useMemo:function(es,ts){var ss=Th();return ts=ts===void 0?null:ts,es=es(),ss.memoizedState=[es,ts],es},useReducer:function(es,ts,ss){var ns=Th();return ts=ss!==void 0?ss(ts):ts,ns.memoizedState=ns.baseState=ts,es={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:ts},ns.queue=es,es=es.dispatch=xi.bind(null,M$1,es),[ns.memoizedState,es]},useRef:function(es){var ts=Th();return es={current:es},ts.memoizedState=es},useState:hi,useDebugValue:ri,useDeferredValue:function(es){return Th().memoizedState=es},useTransition:function(){var es=hi(!1),ts=es[0];return es=vi.bind(null,es[1]),Th().memoizedState=es,[ts,es]},useMutableSource:function(){},useSyncExternalStore:function(es,ts,ss){var ns=M$1,rs=Th();if(I$1){if(ss===void 0)throw Error(p$1(407));ss=ss()}else{if(ss=ts(),Q$1===null)throw Error(p$1(349));Hh&30||di(ns,ts,ss)}rs.memoizedState=ss;var os={value:ss,getSnapshot:ts};return rs.queue=os,mi(ai.bind(null,ns,os,es),[es]),ns.flags|=2048,bi(9,ci.bind(null,ns,os,ss,ts),void 0,null),ss},useId:function(){var es=Th(),ts=Q$1.identifierPrefix;if(I$1){var ss=sg,ns=rg;ss=(ns&~(1<<32-oc(ns)-1)).toString(32)+ss,ts=":"+ts+"R"+ss,ss=Kh++,0<ss&&(ts+="H"+ss.toString(32)),ts+=":"}else ss=Lh++,ts=":"+ts+"r"+ss.toString(32)+":";return es.memoizedState=ts},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(es){var ts=Uh();return ui(ts,N$1.memoizedState,es)},useTransition:function(){var es=Wh(Vh)[0],ts=Uh().memoizedState;return[es,ts]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(es){var ts=Uh();return N$1===null?ts.memoizedState=es:ui(ts,N$1.memoizedState,es)},useTransition:function(){var es=Xh(Vh)[0],ts=Uh().memoizedState;return[es,ts]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(es,ts){if(es&&es.defaultProps){ts=A$1({},ts),es=es.defaultProps;for(var ss in es)ts[ss]===void 0&&(ts[ss]=es[ss]);return ts}return ts}function Di(es,ts,ss,ns){ts=es.memoizedState,ss=ss(ns,ts),ss=ss==null?ts:A$1({},ts,ss),es.memoizedState=ss,es.lanes===0&&(es.updateQueue.baseState=ss)}var Ei={isMounted:function(es){return(es=es._reactInternals)?Vb(es)===es:!1},enqueueSetState:function(es,ts,ss){es=es._reactInternals;var ns=R$1(),rs=yi(es),os=mh(ns,rs);os.payload=ts,ss!=null&&(os.callback=ss),ts=nh(es,os,rs),ts!==null&&(gi(ts,es,rs,ns),oh(ts,es,rs))},enqueueReplaceState:function(es,ts,ss){es=es._reactInternals;var ns=R$1(),rs=yi(es),os=mh(ns,rs);os.tag=1,os.payload=ts,ss!=null&&(os.callback=ss),ts=nh(es,os,rs),ts!==null&&(gi(ts,es,rs,ns),oh(ts,es,rs))},enqueueForceUpdate:function(es,ts){es=es._reactInternals;var ss=R$1(),ns=yi(es),rs=mh(ss,ns);rs.tag=2,ts!=null&&(rs.callback=ts),ts=nh(es,rs,ns),ts!==null&&(gi(ts,es,ns,ss),oh(ts,es,ns))}};function Fi(es,ts,ss,ns,rs,os,as){return es=es.stateNode,typeof es.shouldComponentUpdate=="function"?es.shouldComponentUpdate(ns,os,as):ts.prototype&&ts.prototype.isPureReactComponent?!Ie$1(ss,ns)||!Ie$1(rs,os):!0}function Gi(es,ts,ss){var ns=!1,rs=Vf,os=ts.contextType;return typeof os=="object"&&os!==null?os=eh(os):(rs=Zf(ts)?Xf:H$1.current,ns=ts.contextTypes,os=(ns=ns!=null)?Yf(es,rs):Vf),ts=new ts(ss,os),es.memoizedState=ts.state!==null&&ts.state!==void 0?ts.state:null,ts.updater=Ei,es.stateNode=ts,ts._reactInternals=es,ns&&(es=es.stateNode,es.__reactInternalMemoizedUnmaskedChildContext=rs,es.__reactInternalMemoizedMaskedChildContext=os),ts}function Hi(es,ts,ss,ns){es=ts.state,typeof ts.componentWillReceiveProps=="function"&&ts.componentWillReceiveProps(ss,ns),typeof ts.UNSAFE_componentWillReceiveProps=="function"&&ts.UNSAFE_componentWillReceiveProps(ss,ns),ts.state!==es&&Ei.enqueueReplaceState(ts,ts.state,null)}function Ii(es,ts,ss,ns){var rs=es.stateNode;rs.props=ss,rs.state=es.memoizedState,rs.refs={},kh(es);var os=ts.contextType;typeof os=="object"&&os!==null?rs.context=eh(os):(os=Zf(ts)?Xf:H$1.current,rs.context=Yf(es,os)),rs.state=es.memoizedState,os=ts.getDerivedStateFromProps,typeof os=="function"&&(Di(es,ts,os,ss),rs.state=es.memoizedState),typeof ts.getDerivedStateFromProps=="function"||typeof rs.getSnapshotBeforeUpdate=="function"||typeof rs.UNSAFE_componentWillMount!="function"&&typeof rs.componentWillMount!="function"||(ts=rs.state,typeof rs.componentWillMount=="function"&&rs.componentWillMount(),typeof rs.UNSAFE_componentWillMount=="function"&&rs.UNSAFE_componentWillMount(),ts!==rs.state&&Ei.enqueueReplaceState(rs,rs.state,null),qh(es,ss,rs,ns),rs.state=es.memoizedState),typeof rs.componentDidMount=="function"&&(es.flags|=4194308)}function Ji(es,ts){try{var ss="",ns=ts;do ss+=Pa(ns),ns=ns.return;while(ns);var rs=ss}catch(os){rs=`
Error generating stack: `+os.message+`
`+os.stack}return{value:es,source:ts,stack:rs,digest:null}}function Ki(es,ts,ss){return{value:es,source:null,stack:ss??null,digest:ts??null}}function Li(es,ts){try{console.error(ts.value)}catch(ss){setTimeout(function(){throw ss})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(es,ts,ss){ss=mh(-1,ss),ss.tag=3,ss.payload={element:null};var ns=ts.value;return ss.callback=function(){Oi||(Oi=!0,Pi=ns),Li(es,ts)},ss}function Qi(es,ts,ss){ss=mh(-1,ss),ss.tag=3;var ns=es.type.getDerivedStateFromError;if(typeof ns=="function"){var rs=ts.value;ss.payload=function(){return ns(rs)},ss.callback=function(){Li(es,ts)}}var os=es.stateNode;return os!==null&&typeof os.componentDidCatch=="function"&&(ss.callback=function(){Li(es,ts),typeof ns!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var as=ts.stack;this.componentDidCatch(ts.value,{componentStack:as!==null?as:""})}),ss}function Si(es,ts,ss){var ns=es.pingCache;if(ns===null){ns=es.pingCache=new Mi;var rs=new Set;ns.set(ts,rs)}else rs=ns.get(ts),rs===void 0&&(rs=new Set,ns.set(ts,rs));rs.has(ss)||(rs.add(ss),es=Ti.bind(null,es,ts,ss),ts.then(es,es))}function Ui(es){do{var ts;if((ts=es.tag===13)&&(ts=es.memoizedState,ts=ts!==null?ts.dehydrated!==null:!0),ts)return es;es=es.return}while(es!==null);return null}function Vi(es,ts,ss,ns,rs){return es.mode&1?(es.flags|=65536,es.lanes=rs,es):(es===ts?es.flags|=65536:(es.flags|=128,ss.flags|=131072,ss.flags&=-52805,ss.tag===1&&(ss.alternate===null?ss.tag=17:(ts=mh(-1,1),ts.tag=2,nh(ss,ts,1))),ss.lanes|=1),es)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(es,ts,ss,ns){ts.child=es===null?Vg(ts,null,ss,ns):Ug(ts,es.child,ss,ns)}function Yi(es,ts,ss,ns,rs){ss=ss.render;var os=ts.ref;return ch(ts,rs),ns=Nh(es,ts,ss,ns,os,rs),ss=Sh(),es!==null&&!dh?(ts.updateQueue=es.updateQueue,ts.flags&=-2053,es.lanes&=~rs,Zi(es,ts,rs)):(I$1&&ss&&vg(ts),ts.flags|=1,Xi(es,ts,ns,rs),ts.child)}function $i(es,ts,ss,ns,rs){if(es===null){var os=ss.type;return typeof os=="function"&&!aj(os)&&os.defaultProps===void 0&&ss.compare===null&&ss.defaultProps===void 0?(ts.tag=15,ts.type=os,bj(es,ts,os,ns,rs)):(es=Rg(ss.type,null,ns,ts,ts.mode,rs),es.ref=ts.ref,es.return=ts,ts.child=es)}if(os=es.child,!(es.lanes&rs)){var as=os.memoizedProps;if(ss=ss.compare,ss=ss!==null?ss:Ie$1,ss(as,ns)&&es.ref===ts.ref)return Zi(es,ts,rs)}return ts.flags|=1,es=Pg(os,ns),es.ref=ts.ref,es.return=ts,ts.child=es}function bj(es,ts,ss,ns,rs){if(es!==null){var os=es.memoizedProps;if(Ie$1(os,ns)&&es.ref===ts.ref)if(dh=!1,ts.pendingProps=ns=os,(es.lanes&rs)!==0)es.flags&131072&&(dh=!0);else return ts.lanes=es.lanes,Zi(es,ts,rs)}return cj(es,ts,ss,ns,rs)}function dj(es,ts,ss){var ns=ts.pendingProps,rs=ns.children,os=es!==null?es.memoizedState:null;if(ns.mode==="hidden")if(!(ts.mode&1))ts.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(ej,fj),fj|=ss;else{if(!(ss&1073741824))return es=os!==null?os.baseLanes|ss:ss,ts.lanes=ts.childLanes=1073741824,ts.memoizedState={baseLanes:es,cachePool:null,transitions:null},ts.updateQueue=null,G$1(ej,fj),fj|=es,null;ts.memoizedState={baseLanes:0,cachePool:null,transitions:null},ns=os!==null?os.baseLanes:ss,G$1(ej,fj),fj|=ns}else os!==null?(ns=os.baseLanes|ss,ts.memoizedState=null):ns=ss,G$1(ej,fj),fj|=ns;return Xi(es,ts,rs,ss),ts.child}function gj(es,ts){var ss=ts.ref;(es===null&&ss!==null||es!==null&&es.ref!==ss)&&(ts.flags|=512,ts.flags|=2097152)}function cj(es,ts,ss,ns,rs){var os=Zf(ss)?Xf:H$1.current;return os=Yf(ts,os),ch(ts,rs),ss=Nh(es,ts,ss,ns,os,rs),ns=Sh(),es!==null&&!dh?(ts.updateQueue=es.updateQueue,ts.flags&=-2053,es.lanes&=~rs,Zi(es,ts,rs)):(I$1&&ns&&vg(ts),ts.flags|=1,Xi(es,ts,ss,rs),ts.child)}function hj(es,ts,ss,ns,rs){if(Zf(ss)){var os=!0;cg(ts)}else os=!1;if(ch(ts,rs),ts.stateNode===null)ij(es,ts),Gi(ts,ss,ns),Ii(ts,ss,ns,rs),ns=!0;else if(es===null){var as=ts.stateNode,cs=ts.memoizedProps;as.props=cs;var ls=as.context,us=ss.contextType;typeof us=="object"&&us!==null?us=eh(us):(us=Zf(ss)?Xf:H$1.current,us=Yf(ts,us));var ds=ss.getDerivedStateFromProps,xs=typeof ds=="function"||typeof as.getSnapshotBeforeUpdate=="function";xs||typeof as.UNSAFE_componentWillReceiveProps!="function"&&typeof as.componentWillReceiveProps!="function"||(cs!==ns||ls!==us)&&Hi(ts,as,ns,us),jh=!1;var fs=ts.memoizedState;as.state=fs,qh(ts,ns,as,rs),ls=ts.memoizedState,cs!==ns||fs!==ls||Wf.current||jh?(typeof ds=="function"&&(Di(ts,ss,ds,ns),ls=ts.memoizedState),(cs=jh||Fi(ts,ss,cs,ns,fs,ls,us))?(xs||typeof as.UNSAFE_componentWillMount!="function"&&typeof as.componentWillMount!="function"||(typeof as.componentWillMount=="function"&&as.componentWillMount(),typeof as.UNSAFE_componentWillMount=="function"&&as.UNSAFE_componentWillMount()),typeof as.componentDidMount=="function"&&(ts.flags|=4194308)):(typeof as.componentDidMount=="function"&&(ts.flags|=4194308),ts.memoizedProps=ns,ts.memoizedState=ls),as.props=ns,as.state=ls,as.context=us,ns=cs):(typeof as.componentDidMount=="function"&&(ts.flags|=4194308),ns=!1)}else{as=ts.stateNode,lh(es,ts),cs=ts.memoizedProps,us=ts.type===ts.elementType?cs:Ci(ts.type,cs),as.props=us,xs=ts.pendingProps,fs=as.context,ls=ss.contextType,typeof ls=="object"&&ls!==null?ls=eh(ls):(ls=Zf(ss)?Xf:H$1.current,ls=Yf(ts,ls));var gs=ss.getDerivedStateFromProps;(ds=typeof gs=="function"||typeof as.getSnapshotBeforeUpdate=="function")||typeof as.UNSAFE_componentWillReceiveProps!="function"&&typeof as.componentWillReceiveProps!="function"||(cs!==xs||fs!==ls)&&Hi(ts,as,ns,ls),jh=!1,fs=ts.memoizedState,as.state=fs,qh(ts,ns,as,rs);var Es=ts.memoizedState;cs!==xs||fs!==Es||Wf.current||jh?(typeof gs=="function"&&(Di(ts,ss,gs,ns),Es=ts.memoizedState),(us=jh||Fi(ts,ss,us,ns,fs,Es,ls)||!1)?(ds||typeof as.UNSAFE_componentWillUpdate!="function"&&typeof as.componentWillUpdate!="function"||(typeof as.componentWillUpdate=="function"&&as.componentWillUpdate(ns,Es,ls),typeof as.UNSAFE_componentWillUpdate=="function"&&as.UNSAFE_componentWillUpdate(ns,Es,ls)),typeof as.componentDidUpdate=="function"&&(ts.flags|=4),typeof as.getSnapshotBeforeUpdate=="function"&&(ts.flags|=1024)):(typeof as.componentDidUpdate!="function"||cs===es.memoizedProps&&fs===es.memoizedState||(ts.flags|=4),typeof as.getSnapshotBeforeUpdate!="function"||cs===es.memoizedProps&&fs===es.memoizedState||(ts.flags|=1024),ts.memoizedProps=ns,ts.memoizedState=Es),as.props=ns,as.state=Es,as.context=ls,ns=us):(typeof as.componentDidUpdate!="function"||cs===es.memoizedProps&&fs===es.memoizedState||(ts.flags|=4),typeof as.getSnapshotBeforeUpdate!="function"||cs===es.memoizedProps&&fs===es.memoizedState||(ts.flags|=1024),ns=!1)}return jj(es,ts,ss,ns,os,rs)}function jj(es,ts,ss,ns,rs,os){gj(es,ts);var as=(ts.flags&128)!==0;if(!ns&&!as)return rs&&dg(ts,ss,!1),Zi(es,ts,os);ns=ts.stateNode,Wi.current=ts;var cs=as&&typeof ss.getDerivedStateFromError!="function"?null:ns.render();return ts.flags|=1,es!==null&&as?(ts.child=Ug(ts,es.child,null,os),ts.child=Ug(ts,null,cs,os)):Xi(es,ts,cs,os),ts.memoizedState=ns.state,rs&&dg(ts,ss,!0),ts.child}function kj(es){var ts=es.stateNode;ts.pendingContext?ag(es,ts.pendingContext,ts.pendingContext!==ts.context):ts.context&&ag(es,ts.context,!1),yh(es,ts.containerInfo)}function lj(es,ts,ss,ns,rs){return Ig(),Jg(rs),ts.flags|=256,Xi(es,ts,ss,ns),ts.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(es){return{baseLanes:es,cachePool:null,transitions:null}}function oj(es,ts,ss){var ns=ts.pendingProps,rs=L$1.current,os=!1,as=(ts.flags&128)!==0,cs;if((cs=as)||(cs=es!==null&&es.memoizedState===null?!1:(rs&2)!==0),cs?(os=!0,ts.flags&=-129):(es===null||es.memoizedState!==null)&&(rs|=1),G$1(L$1,rs&1),es===null)return Eg(ts),es=ts.memoizedState,es!==null&&(es=es.dehydrated,es!==null)?(ts.mode&1?es.data==="$!"?ts.lanes=8:ts.lanes=1073741824:ts.lanes=1,null):(as=ns.children,es=ns.fallback,os?(ns=ts.mode,os=ts.child,as={mode:"hidden",children:as},!(ns&1)&&os!==null?(os.childLanes=0,os.pendingProps=as):os=pj(as,ns,0,null),es=Tg(es,ns,ss,null),os.return=ts,es.return=ts,os.sibling=es,ts.child=os,ts.child.memoizedState=nj(ss),ts.memoizedState=mj,es):qj(ts,as));if(rs=es.memoizedState,rs!==null&&(cs=rs.dehydrated,cs!==null))return rj(es,ts,as,ns,cs,rs,ss);if(os){os=ns.fallback,as=ts.mode,rs=es.child,cs=rs.sibling;var ls={mode:"hidden",children:ns.children};return!(as&1)&&ts.child!==rs?(ns=ts.child,ns.childLanes=0,ns.pendingProps=ls,ts.deletions=null):(ns=Pg(rs,ls),ns.subtreeFlags=rs.subtreeFlags&14680064),cs!==null?os=Pg(cs,os):(os=Tg(os,as,ss,null),os.flags|=2),os.return=ts,ns.return=ts,ns.sibling=os,ts.child=ns,ns=os,os=ts.child,as=es.child.memoizedState,as=as===null?nj(ss):{baseLanes:as.baseLanes|ss,cachePool:null,transitions:as.transitions},os.memoizedState=as,os.childLanes=es.childLanes&~ss,ts.memoizedState=mj,ns}return os=es.child,es=os.sibling,ns=Pg(os,{mode:"visible",children:ns.children}),!(ts.mode&1)&&(ns.lanes=ss),ns.return=ts,ns.sibling=null,es!==null&&(ss=ts.deletions,ss===null?(ts.deletions=[es],ts.flags|=16):ss.push(es)),ts.child=ns,ts.memoizedState=null,ns}function qj(es,ts){return ts=pj({mode:"visible",children:ts},es.mode,0,null),ts.return=es,es.child=ts}function sj(es,ts,ss,ns){return ns!==null&&Jg(ns),Ug(ts,es.child,null,ss),es=qj(ts,ts.pendingProps.children),es.flags|=2,ts.memoizedState=null,es}function rj(es,ts,ss,ns,rs,os,as){if(ss)return ts.flags&256?(ts.flags&=-257,ns=Ki(Error(p$1(422))),sj(es,ts,as,ns)):ts.memoizedState!==null?(ts.child=es.child,ts.flags|=128,null):(os=ns.fallback,rs=ts.mode,ns=pj({mode:"visible",children:ns.children},rs,0,null),os=Tg(os,rs,as,null),os.flags|=2,ns.return=ts,os.return=ts,ns.sibling=os,ts.child=ns,ts.mode&1&&Ug(ts,es.child,null,as),ts.child.memoizedState=nj(as),ts.memoizedState=mj,os);if(!(ts.mode&1))return sj(es,ts,as,null);if(rs.data==="$!"){if(ns=rs.nextSibling&&rs.nextSibling.dataset,ns)var cs=ns.dgst;return ns=cs,os=Error(p$1(419)),ns=Ki(os,ns,void 0),sj(es,ts,as,ns)}if(cs=(as&es.childLanes)!==0,dh||cs){if(ns=Q$1,ns!==null){switch(as&-as){case 4:rs=2;break;case 16:rs=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:rs=32;break;case 536870912:rs=268435456;break;default:rs=0}rs=rs&(ns.suspendedLanes|as)?0:rs,rs!==0&&rs!==os.retryLane&&(os.retryLane=rs,ih(es,rs),gi(ns,es,rs,-1))}return tj(),ns=Ki(Error(p$1(421))),sj(es,ts,as,ns)}return rs.data==="$?"?(ts.flags|=128,ts.child=es.child,ts=uj.bind(null,es),rs._reactRetry=ts,null):(es=os.treeContext,yg=Lf(rs.nextSibling),xg=ts,I$1=!0,zg=null,es!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=es.id,sg=es.overflow,qg=ts),ts=qj(ts,ns.children),ts.flags|=4096,ts)}function vj(es,ts,ss){es.lanes|=ts;var ns=es.alternate;ns!==null&&(ns.lanes|=ts),bh(es.return,ts,ss)}function wj(es,ts,ss,ns,rs){var os=es.memoizedState;os===null?es.memoizedState={isBackwards:ts,rendering:null,renderingStartTime:0,last:ns,tail:ss,tailMode:rs}:(os.isBackwards=ts,os.rendering=null,os.renderingStartTime=0,os.last=ns,os.tail=ss,os.tailMode=rs)}function xj(es,ts,ss){var ns=ts.pendingProps,rs=ns.revealOrder,os=ns.tail;if(Xi(es,ts,ns.children,ss),ns=L$1.current,ns&2)ns=ns&1|2,ts.flags|=128;else{if(es!==null&&es.flags&128)e:for(es=ts.child;es!==null;){if(es.tag===13)es.memoizedState!==null&&vj(es,ss,ts);else if(es.tag===19)vj(es,ss,ts);else if(es.child!==null){es.child.return=es,es=es.child;continue}if(es===ts)break e;for(;es.sibling===null;){if(es.return===null||es.return===ts)break e;es=es.return}es.sibling.return=es.return,es=es.sibling}ns&=1}if(G$1(L$1,ns),!(ts.mode&1))ts.memoizedState=null;else switch(rs){case"forwards":for(ss=ts.child,rs=null;ss!==null;)es=ss.alternate,es!==null&&Ch(es)===null&&(rs=ss),ss=ss.sibling;ss=rs,ss===null?(rs=ts.child,ts.child=null):(rs=ss.sibling,ss.sibling=null),wj(ts,!1,rs,ss,os);break;case"backwards":for(ss=null,rs=ts.child,ts.child=null;rs!==null;){if(es=rs.alternate,es!==null&&Ch(es)===null){ts.child=rs;break}es=rs.sibling,rs.sibling=ss,ss=rs,rs=es}wj(ts,!0,ss,null,os);break;case"together":wj(ts,!1,null,null,void 0);break;default:ts.memoizedState=null}return ts.child}function ij(es,ts){!(ts.mode&1)&&es!==null&&(es.alternate=null,ts.alternate=null,ts.flags|=2)}function Zi(es,ts,ss){if(es!==null&&(ts.dependencies=es.dependencies),rh|=ts.lanes,!(ss&ts.childLanes))return null;if(es!==null&&ts.child!==es.child)throw Error(p$1(153));if(ts.child!==null){for(es=ts.child,ss=Pg(es,es.pendingProps),ts.child=ss,ss.return=ts;es.sibling!==null;)es=es.sibling,ss=ss.sibling=Pg(es,es.pendingProps),ss.return=ts;ss.sibling=null}return ts.child}function yj(es,ts,ss){switch(ts.tag){case 3:kj(ts),Ig();break;case 5:Ah(ts);break;case 1:Zf(ts.type)&&cg(ts);break;case 4:yh(ts,ts.stateNode.containerInfo);break;case 10:var ns=ts.type._context,rs=ts.memoizedProps.value;G$1(Wg,ns._currentValue),ns._currentValue=rs;break;case 13:if(ns=ts.memoizedState,ns!==null)return ns.dehydrated!==null?(G$1(L$1,L$1.current&1),ts.flags|=128,null):ss&ts.child.childLanes?oj(es,ts,ss):(G$1(L$1,L$1.current&1),es=Zi(es,ts,ss),es!==null?es.sibling:null);G$1(L$1,L$1.current&1);break;case 19:if(ns=(ss&ts.childLanes)!==0,es.flags&128){if(ns)return xj(es,ts,ss);ts.flags|=128}if(rs=ts.memoizedState,rs!==null&&(rs.rendering=null,rs.tail=null,rs.lastEffect=null),G$1(L$1,L$1.current),ns)break;return null;case 22:case 23:return ts.lanes=0,dj(es,ts,ss)}return Zi(es,ts,ss)}var zj,Aj,Bj,Cj;zj=function(es,ts){for(var ss=ts.child;ss!==null;){if(ss.tag===5||ss.tag===6)es.appendChild(ss.stateNode);else if(ss.tag!==4&&ss.child!==null){ss.child.return=ss,ss=ss.child;continue}if(ss===ts)break;for(;ss.sibling===null;){if(ss.return===null||ss.return===ts)return;ss=ss.return}ss.sibling.return=ss.return,ss=ss.sibling}};Aj=function(){};Bj=function(es,ts,ss,ns){var rs=es.memoizedProps;if(rs!==ns){es=ts.stateNode,xh(uh.current);var os=null;switch(ss){case"input":rs=Ya(es,rs),ns=Ya(es,ns),os=[];break;case"select":rs=A$1({},rs,{value:void 0}),ns=A$1({},ns,{value:void 0}),os=[];break;case"textarea":rs=gb(es,rs),ns=gb(es,ns),os=[];break;default:typeof rs.onClick!="function"&&typeof ns.onClick=="function"&&(es.onclick=Bf)}ub(ss,ns);var as;ss=null;for(us in rs)if(!ns.hasOwnProperty(us)&&rs.hasOwnProperty(us)&&rs[us]!=null)if(us==="style"){var cs=rs[us];for(as in cs)cs.hasOwnProperty(as)&&(ss||(ss={}),ss[as]="")}else us!=="dangerouslySetInnerHTML"&&us!=="children"&&us!=="suppressContentEditableWarning"&&us!=="suppressHydrationWarning"&&us!=="autoFocus"&&(ea.hasOwnProperty(us)?os||(os=[]):(os=os||[]).push(us,null));for(us in ns){var ls=ns[us];if(cs=rs!=null?rs[us]:void 0,ns.hasOwnProperty(us)&&ls!==cs&&(ls!=null||cs!=null))if(us==="style")if(cs){for(as in cs)!cs.hasOwnProperty(as)||ls&&ls.hasOwnProperty(as)||(ss||(ss={}),ss[as]="");for(as in ls)ls.hasOwnProperty(as)&&cs[as]!==ls[as]&&(ss||(ss={}),ss[as]=ls[as])}else ss||(os||(os=[]),os.push(us,ss)),ss=ls;else us==="dangerouslySetInnerHTML"?(ls=ls?ls.__html:void 0,cs=cs?cs.__html:void 0,ls!=null&&cs!==ls&&(os=os||[]).push(us,ls)):us==="children"?typeof ls!="string"&&typeof ls!="number"||(os=os||[]).push(us,""+ls):us!=="suppressContentEditableWarning"&&us!=="suppressHydrationWarning"&&(ea.hasOwnProperty(us)?(ls!=null&&us==="onScroll"&&D$1("scroll",es),os||cs===ls||(os=[])):(os=os||[]).push(us,ls))}ss&&(os=os||[]).push("style",ss);var us=os;(ts.updateQueue=us)&&(ts.flags|=4)}};Cj=function(es,ts,ss,ns){ss!==ns&&(ts.flags|=4)};function Dj(es,ts){if(!I$1)switch(es.tailMode){case"hidden":ts=es.tail;for(var ss=null;ts!==null;)ts.alternate!==null&&(ss=ts),ts=ts.sibling;ss===null?es.tail=null:ss.sibling=null;break;case"collapsed":ss=es.tail;for(var ns=null;ss!==null;)ss.alternate!==null&&(ns=ss),ss=ss.sibling;ns===null?ts||es.tail===null?es.tail=null:es.tail.sibling=null:ns.sibling=null}}function S$1(es){var ts=es.alternate!==null&&es.alternate.child===es.child,ss=0,ns=0;if(ts)for(var rs=es.child;rs!==null;)ss|=rs.lanes|rs.childLanes,ns|=rs.subtreeFlags&14680064,ns|=rs.flags&14680064,rs.return=es,rs=rs.sibling;else for(rs=es.child;rs!==null;)ss|=rs.lanes|rs.childLanes,ns|=rs.subtreeFlags,ns|=rs.flags,rs.return=es,rs=rs.sibling;return es.subtreeFlags|=ns,es.childLanes=ss,ts}function Ej(es,ts,ss){var ns=ts.pendingProps;switch(wg(ts),ts.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(ts),null;case 1:return Zf(ts.type)&&$f(),S$1(ts),null;case 3:return ns=ts.stateNode,zh(),E$1(Wf),E$1(H$1),Eh(),ns.pendingContext&&(ns.context=ns.pendingContext,ns.pendingContext=null),(es===null||es.child===null)&&(Gg(ts)?ts.flags|=4:es===null||es.memoizedState.isDehydrated&&!(ts.flags&256)||(ts.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(es,ts),S$1(ts),null;case 5:Bh(ts);var rs=xh(wh.current);if(ss=ts.type,es!==null&&ts.stateNode!=null)Bj(es,ts,ss,ns,rs),es.ref!==ts.ref&&(ts.flags|=512,ts.flags|=2097152);else{if(!ns){if(ts.stateNode===null)throw Error(p$1(166));return S$1(ts),null}if(es=xh(uh.current),Gg(ts)){ns=ts.stateNode,ss=ts.type;var os=ts.memoizedProps;switch(ns[Of]=ts,ns[Pf]=os,es=(ts.mode&1)!==0,ss){case"dialog":D$1("cancel",ns),D$1("close",ns);break;case"iframe":case"object":case"embed":D$1("load",ns);break;case"video":case"audio":for(rs=0;rs<lf.length;rs++)D$1(lf[rs],ns);break;case"source":D$1("error",ns);break;case"img":case"image":case"link":D$1("error",ns),D$1("load",ns);break;case"details":D$1("toggle",ns);break;case"input":Za(ns,os),D$1("invalid",ns);break;case"select":ns._wrapperState={wasMultiple:!!os.multiple},D$1("invalid",ns);break;case"textarea":hb(ns,os),D$1("invalid",ns)}ub(ss,os),rs=null;for(var as in os)if(os.hasOwnProperty(as)){var cs=os[as];as==="children"?typeof cs=="string"?ns.textContent!==cs&&(os.suppressHydrationWarning!==!0&&Af(ns.textContent,cs,es),rs=["children",cs]):typeof cs=="number"&&ns.textContent!==""+cs&&(os.suppressHydrationWarning!==!0&&Af(ns.textContent,cs,es),rs=["children",""+cs]):ea.hasOwnProperty(as)&&cs!=null&&as==="onScroll"&&D$1("scroll",ns)}switch(ss){case"input":Va(ns),db$1(ns,os,!0);break;case"textarea":Va(ns),jb(ns);break;case"select":case"option":break;default:typeof os.onClick=="function"&&(ns.onclick=Bf)}ns=rs,ts.updateQueue=ns,ns!==null&&(ts.flags|=4)}else{as=rs.nodeType===9?rs:rs.ownerDocument,es==="http://www.w3.org/1999/xhtml"&&(es=kb(ss)),es==="http://www.w3.org/1999/xhtml"?ss==="script"?(es=as.createElement("div"),es.innerHTML="<script><\/script>",es=es.removeChild(es.firstChild)):typeof ns.is=="string"?es=as.createElement(ss,{is:ns.is}):(es=as.createElement(ss),ss==="select"&&(as=es,ns.multiple?as.multiple=!0:ns.size&&(as.size=ns.size))):es=as.createElementNS(es,ss),es[Of]=ts,es[Pf]=ns,zj(es,ts,!1,!1),ts.stateNode=es;e:{switch(as=vb(ss,ns),ss){case"dialog":D$1("cancel",es),D$1("close",es),rs=ns;break;case"iframe":case"object":case"embed":D$1("load",es),rs=ns;break;case"video":case"audio":for(rs=0;rs<lf.length;rs++)D$1(lf[rs],es);rs=ns;break;case"source":D$1("error",es),rs=ns;break;case"img":case"image":case"link":D$1("error",es),D$1("load",es),rs=ns;break;case"details":D$1("toggle",es),rs=ns;break;case"input":Za(es,ns),rs=Ya(es,ns),D$1("invalid",es);break;case"option":rs=ns;break;case"select":es._wrapperState={wasMultiple:!!ns.multiple},rs=A$1({},ns,{value:void 0}),D$1("invalid",es);break;case"textarea":hb(es,ns),rs=gb(es,ns),D$1("invalid",es);break;default:rs=ns}ub(ss,rs),cs=rs;for(os in cs)if(cs.hasOwnProperty(os)){var ls=cs[os];os==="style"?sb(es,ls):os==="dangerouslySetInnerHTML"?(ls=ls?ls.__html:void 0,ls!=null&&nb(es,ls)):os==="children"?typeof ls=="string"?(ss!=="textarea"||ls!=="")&&ob(es,ls):typeof ls=="number"&&ob(es,""+ls):os!=="suppressContentEditableWarning"&&os!=="suppressHydrationWarning"&&os!=="autoFocus"&&(ea.hasOwnProperty(os)?ls!=null&&os==="onScroll"&&D$1("scroll",es):ls!=null&&ta(es,os,ls,as))}switch(ss){case"input":Va(es),db$1(es,ns,!1);break;case"textarea":Va(es),jb(es);break;case"option":ns.value!=null&&es.setAttribute("value",""+Sa(ns.value));break;case"select":es.multiple=!!ns.multiple,os=ns.value,os!=null?fb(es,!!ns.multiple,os,!1):ns.defaultValue!=null&&fb(es,!!ns.multiple,ns.defaultValue,!0);break;default:typeof rs.onClick=="function"&&(es.onclick=Bf)}switch(ss){case"button":case"input":case"select":case"textarea":ns=!!ns.autoFocus;break e;case"img":ns=!0;break e;default:ns=!1}}ns&&(ts.flags|=4)}ts.ref!==null&&(ts.flags|=512,ts.flags|=2097152)}return S$1(ts),null;case 6:if(es&&ts.stateNode!=null)Cj(es,ts,es.memoizedProps,ns);else{if(typeof ns!="string"&&ts.stateNode===null)throw Error(p$1(166));if(ss=xh(wh.current),xh(uh.current),Gg(ts)){if(ns=ts.stateNode,ss=ts.memoizedProps,ns[Of]=ts,(os=ns.nodeValue!==ss)&&(es=xg,es!==null))switch(es.tag){case 3:Af(ns.nodeValue,ss,(es.mode&1)!==0);break;case 5:es.memoizedProps.suppressHydrationWarning!==!0&&Af(ns.nodeValue,ss,(es.mode&1)!==0)}os&&(ts.flags|=4)}else ns=(ss.nodeType===9?ss:ss.ownerDocument).createTextNode(ns),ns[Of]=ts,ts.stateNode=ns}return S$1(ts),null;case 13:if(E$1(L$1),ns=ts.memoizedState,es===null||es.memoizedState!==null&&es.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&ts.mode&1&&!(ts.flags&128))Hg(),Ig(),ts.flags|=98560,os=!1;else if(os=Gg(ts),ns!==null&&ns.dehydrated!==null){if(es===null){if(!os)throw Error(p$1(318));if(os=ts.memoizedState,os=os!==null?os.dehydrated:null,!os)throw Error(p$1(317));os[Of]=ts}else Ig(),!(ts.flags&128)&&(ts.memoizedState=null),ts.flags|=4;S$1(ts),os=!1}else zg!==null&&(Fj(zg),zg=null),os=!0;if(!os)return ts.flags&65536?ts:null}return ts.flags&128?(ts.lanes=ss,ts):(ns=ns!==null,ns!==(es!==null&&es.memoizedState!==null)&&ns&&(ts.child.flags|=8192,ts.mode&1&&(es===null||L$1.current&1?T$1===0&&(T$1=3):tj())),ts.updateQueue!==null&&(ts.flags|=4),S$1(ts),null);case 4:return zh(),Aj(es,ts),es===null&&sf(ts.stateNode.containerInfo),S$1(ts),null;case 10:return ah(ts.type._context),S$1(ts),null;case 17:return Zf(ts.type)&&$f(),S$1(ts),null;case 19:if(E$1(L$1),os=ts.memoizedState,os===null)return S$1(ts),null;if(ns=(ts.flags&128)!==0,as=os.rendering,as===null)if(ns)Dj(os,!1);else{if(T$1!==0||es!==null&&es.flags&128)for(es=ts.child;es!==null;){if(as=Ch(es),as!==null){for(ts.flags|=128,Dj(os,!1),ns=as.updateQueue,ns!==null&&(ts.updateQueue=ns,ts.flags|=4),ts.subtreeFlags=0,ns=ss,ss=ts.child;ss!==null;)os=ss,es=ns,os.flags&=14680066,as=os.alternate,as===null?(os.childLanes=0,os.lanes=es,os.child=null,os.subtreeFlags=0,os.memoizedProps=null,os.memoizedState=null,os.updateQueue=null,os.dependencies=null,os.stateNode=null):(os.childLanes=as.childLanes,os.lanes=as.lanes,os.child=as.child,os.subtreeFlags=0,os.deletions=null,os.memoizedProps=as.memoizedProps,os.memoizedState=as.memoizedState,os.updateQueue=as.updateQueue,os.type=as.type,es=as.dependencies,os.dependencies=es===null?null:{lanes:es.lanes,firstContext:es.firstContext}),ss=ss.sibling;return G$1(L$1,L$1.current&1|2),ts.child}es=es.sibling}os.tail!==null&&B$1()>Gj&&(ts.flags|=128,ns=!0,Dj(os,!1),ts.lanes=4194304)}else{if(!ns)if(es=Ch(as),es!==null){if(ts.flags|=128,ns=!0,ss=es.updateQueue,ss!==null&&(ts.updateQueue=ss,ts.flags|=4),Dj(os,!0),os.tail===null&&os.tailMode==="hidden"&&!as.alternate&&!I$1)return S$1(ts),null}else 2*B$1()-os.renderingStartTime>Gj&&ss!==1073741824&&(ts.flags|=128,ns=!0,Dj(os,!1),ts.lanes=4194304);os.isBackwards?(as.sibling=ts.child,ts.child=as):(ss=os.last,ss!==null?ss.sibling=as:ts.child=as,os.last=as)}return os.tail!==null?(ts=os.tail,os.rendering=ts,os.tail=ts.sibling,os.renderingStartTime=B$1(),ts.sibling=null,ss=L$1.current,G$1(L$1,ns?ss&1|2:ss&1),ts):(S$1(ts),null);case 22:case 23:return Hj(),ns=ts.memoizedState!==null,es!==null&&es.memoizedState!==null!==ns&&(ts.flags|=8192),ns&&ts.mode&1?fj&1073741824&&(S$1(ts),ts.subtreeFlags&6&&(ts.flags|=8192)):S$1(ts),null;case 24:return null;case 25:return null}throw Error(p$1(156,ts.tag))}function Ij(es,ts){switch(wg(ts),ts.tag){case 1:return Zf(ts.type)&&$f(),es=ts.flags,es&65536?(ts.flags=es&-65537|128,ts):null;case 3:return zh(),E$1(Wf),E$1(H$1),Eh(),es=ts.flags,es&65536&&!(es&128)?(ts.flags=es&-65537|128,ts):null;case 5:return Bh(ts),null;case 13:if(E$1(L$1),es=ts.memoizedState,es!==null&&es.dehydrated!==null){if(ts.alternate===null)throw Error(p$1(340));Ig()}return es=ts.flags,es&65536?(ts.flags=es&-65537|128,ts):null;case 19:return E$1(L$1),null;case 4:return zh(),null;case 10:return ah(ts.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$1=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Lj(es,ts){var ss=es.ref;if(ss!==null)if(typeof ss=="function")try{ss(null)}catch(ns){W$1(es,ts,ns)}else ss.current=null}function Mj(es,ts,ss){try{ss()}catch(ns){W$1(es,ts,ns)}}var Nj=!1;function Oj(es,ts){if(Cf=dd,es=Me$1(),Ne$1(es)){if("selectionStart"in es)var ss={start:es.selectionStart,end:es.selectionEnd};else e:{ss=(ss=es.ownerDocument)&&ss.defaultView||window;var ns=ss.getSelection&&ss.getSelection();if(ns&&ns.rangeCount!==0){ss=ns.anchorNode;var rs=ns.anchorOffset,os=ns.focusNode;ns=ns.focusOffset;try{ss.nodeType,os.nodeType}catch{ss=null;break e}var as=0,cs=-1,ls=-1,us=0,ds=0,xs=es,fs=null;t:for(;;){for(var gs;xs!==ss||rs!==0&&xs.nodeType!==3||(cs=as+rs),xs!==os||ns!==0&&xs.nodeType!==3||(ls=as+ns),xs.nodeType===3&&(as+=xs.nodeValue.length),(gs=xs.firstChild)!==null;)fs=xs,xs=gs;for(;;){if(xs===es)break t;if(fs===ss&&++us===rs&&(cs=as),fs===os&&++ds===ns&&(ls=as),(gs=xs.nextSibling)!==null)break;xs=fs,fs=xs.parentNode}xs=gs}ss=cs===-1||ls===-1?null:{start:cs,end:ls}}else ss=null}ss=ss||{start:0,end:0}}else ss=null;for(Df={focusedElem:es,selectionRange:ss},dd=!1,V$1=ts;V$1!==null;)if(ts=V$1,es=ts.child,(ts.subtreeFlags&1028)!==0&&es!==null)es.return=ts,V$1=es;else for(;V$1!==null;){ts=V$1;try{var Es=ts.alternate;if(ts.flags&1024)switch(ts.tag){case 0:case 11:case 15:break;case 1:if(Es!==null){var js=Es.memoizedProps,ps=Es.memoizedState,ms=ts.stateNode,hs=ms.getSnapshotBeforeUpdate(ts.elementType===ts.type?js:Ci(ts.type,js),ps);ms.__reactInternalSnapshotBeforeUpdate=hs}break;case 3:var vs=ts.stateNode.containerInfo;vs.nodeType===1?vs.textContent="":vs.nodeType===9&&vs.documentElement&&vs.removeChild(vs.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(ws){W$1(ts,ts.return,ws)}if(es=ts.sibling,es!==null){es.return=ts.return,V$1=es;break}V$1=ts.return}return Es=Nj,Nj=!1,Es}function Pj(es,ts,ss){var ns=ts.updateQueue;if(ns=ns!==null?ns.lastEffect:null,ns!==null){var rs=ns=ns.next;do{if((rs.tag&es)===es){var os=rs.destroy;rs.destroy=void 0,os!==void 0&&Mj(ts,ss,os)}rs=rs.next}while(rs!==ns)}}function Qj(es,ts){if(ts=ts.updateQueue,ts=ts!==null?ts.lastEffect:null,ts!==null){var ss=ts=ts.next;do{if((ss.tag&es)===es){var ns=ss.create;ss.destroy=ns()}ss=ss.next}while(ss!==ts)}}function Rj(es){var ts=es.ref;if(ts!==null){var ss=es.stateNode;switch(es.tag){case 5:es=ss;break;default:es=ss}typeof ts=="function"?ts(es):ts.current=es}}function Sj(es){var ts=es.alternate;ts!==null&&(es.alternate=null,Sj(ts)),es.child=null,es.deletions=null,es.sibling=null,es.tag===5&&(ts=es.stateNode,ts!==null&&(delete ts[Of],delete ts[Pf],delete ts[of],delete ts[Qf],delete ts[Rf])),es.stateNode=null,es.return=null,es.dependencies=null,es.memoizedProps=null,es.memoizedState=null,es.pendingProps=null,es.stateNode=null,es.updateQueue=null}function Tj(es){return es.tag===5||es.tag===3||es.tag===4}function Uj(es){e:for(;;){for(;es.sibling===null;){if(es.return===null||Tj(es.return))return null;es=es.return}for(es.sibling.return=es.return,es=es.sibling;es.tag!==5&&es.tag!==6&&es.tag!==18;){if(es.flags&2||es.child===null||es.tag===4)continue e;es.child.return=es,es=es.child}if(!(es.flags&2))return es.stateNode}}function Vj(es,ts,ss){var ns=es.tag;if(ns===5||ns===6)es=es.stateNode,ts?ss.nodeType===8?ss.parentNode.insertBefore(es,ts):ss.insertBefore(es,ts):(ss.nodeType===8?(ts=ss.parentNode,ts.insertBefore(es,ss)):(ts=ss,ts.appendChild(es)),ss=ss._reactRootContainer,ss!=null||ts.onclick!==null||(ts.onclick=Bf));else if(ns!==4&&(es=es.child,es!==null))for(Vj(es,ts,ss),es=es.sibling;es!==null;)Vj(es,ts,ss),es=es.sibling}function Wj(es,ts,ss){var ns=es.tag;if(ns===5||ns===6)es=es.stateNode,ts?ss.insertBefore(es,ts):ss.appendChild(es);else if(ns!==4&&(es=es.child,es!==null))for(Wj(es,ts,ss),es=es.sibling;es!==null;)Wj(es,ts,ss),es=es.sibling}var X$1=null,Xj=!1;function Yj(es,ts,ss){for(ss=ss.child;ss!==null;)Zj(es,ts,ss),ss=ss.sibling}function Zj(es,ts,ss){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,ss)}catch{}switch(ss.tag){case 5:U$1||Lj(ss,ts);case 6:var ns=X$1,rs=Xj;X$1=null,Yj(es,ts,ss),X$1=ns,Xj=rs,X$1!==null&&(Xj?(es=X$1,ss=ss.stateNode,es.nodeType===8?es.parentNode.removeChild(ss):es.removeChild(ss)):X$1.removeChild(ss.stateNode));break;case 18:X$1!==null&&(Xj?(es=X$1,ss=ss.stateNode,es.nodeType===8?Kf(es.parentNode,ss):es.nodeType===1&&Kf(es,ss),bd(es)):Kf(X$1,ss.stateNode));break;case 4:ns=X$1,rs=Xj,X$1=ss.stateNode.containerInfo,Xj=!0,Yj(es,ts,ss),X$1=ns,Xj=rs;break;case 0:case 11:case 14:case 15:if(!U$1&&(ns=ss.updateQueue,ns!==null&&(ns=ns.lastEffect,ns!==null))){rs=ns=ns.next;do{var os=rs,as=os.destroy;os=os.tag,as!==void 0&&(os&2||os&4)&&Mj(ss,ts,as),rs=rs.next}while(rs!==ns)}Yj(es,ts,ss);break;case 1:if(!U$1&&(Lj(ss,ts),ns=ss.stateNode,typeof ns.componentWillUnmount=="function"))try{ns.props=ss.memoizedProps,ns.state=ss.memoizedState,ns.componentWillUnmount()}catch(cs){W$1(ss,ts,cs)}Yj(es,ts,ss);break;case 21:Yj(es,ts,ss);break;case 22:ss.mode&1?(U$1=(ns=U$1)||ss.memoizedState!==null,Yj(es,ts,ss),U$1=ns):Yj(es,ts,ss);break;default:Yj(es,ts,ss)}}function ak(es){var ts=es.updateQueue;if(ts!==null){es.updateQueue=null;var ss=es.stateNode;ss===null&&(ss=es.stateNode=new Kj),ts.forEach(function(ns){var rs=bk.bind(null,es,ns);ss.has(ns)||(ss.add(ns),ns.then(rs,rs))})}}function ck(es,ts){var ss=ts.deletions;if(ss!==null)for(var ns=0;ns<ss.length;ns++){var rs=ss[ns];try{var os=es,as=ts,cs=as;e:for(;cs!==null;){switch(cs.tag){case 5:X$1=cs.stateNode,Xj=!1;break e;case 3:X$1=cs.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=cs.stateNode.containerInfo,Xj=!0;break e}cs=cs.return}if(X$1===null)throw Error(p$1(160));Zj(os,as,rs),X$1=null,Xj=!1;var ls=rs.alternate;ls!==null&&(ls.return=null),rs.return=null}catch(us){W$1(rs,ts,us)}}if(ts.subtreeFlags&12854)for(ts=ts.child;ts!==null;)dk(ts,es),ts=ts.sibling}function dk(es,ts){var ss=es.alternate,ns=es.flags;switch(es.tag){case 0:case 11:case 14:case 15:if(ck(ts,es),ek(es),ns&4){try{Pj(3,es,es.return),Qj(3,es)}catch(js){W$1(es,es.return,js)}try{Pj(5,es,es.return)}catch(js){W$1(es,es.return,js)}}break;case 1:ck(ts,es),ek(es),ns&512&&ss!==null&&Lj(ss,ss.return);break;case 5:if(ck(ts,es),ek(es),ns&512&&ss!==null&&Lj(ss,ss.return),es.flags&32){var rs=es.stateNode;try{ob(rs,"")}catch(js){W$1(es,es.return,js)}}if(ns&4&&(rs=es.stateNode,rs!=null)){var os=es.memoizedProps,as=ss!==null?ss.memoizedProps:os,cs=es.type,ls=es.updateQueue;if(es.updateQueue=null,ls!==null)try{cs==="input"&&os.type==="radio"&&os.name!=null&&ab(rs,os),vb(cs,as);var us=vb(cs,os);for(as=0;as<ls.length;as+=2){var ds=ls[as],xs=ls[as+1];ds==="style"?sb(rs,xs):ds==="dangerouslySetInnerHTML"?nb(rs,xs):ds==="children"?ob(rs,xs):ta(rs,ds,xs,us)}switch(cs){case"input":bb(rs,os);break;case"textarea":ib(rs,os);break;case"select":var fs=rs._wrapperState.wasMultiple;rs._wrapperState.wasMultiple=!!os.multiple;var gs=os.value;gs!=null?fb(rs,!!os.multiple,gs,!1):fs!==!!os.multiple&&(os.defaultValue!=null?fb(rs,!!os.multiple,os.defaultValue,!0):fb(rs,!!os.multiple,os.multiple?[]:"",!1))}rs[Pf]=os}catch(js){W$1(es,es.return,js)}}break;case 6:if(ck(ts,es),ek(es),ns&4){if(es.stateNode===null)throw Error(p$1(162));rs=es.stateNode,os=es.memoizedProps;try{rs.nodeValue=os}catch(js){W$1(es,es.return,js)}}break;case 3:if(ck(ts,es),ek(es),ns&4&&ss!==null&&ss.memoizedState.isDehydrated)try{bd(ts.containerInfo)}catch(js){W$1(es,es.return,js)}break;case 4:ck(ts,es),ek(es);break;case 13:ck(ts,es),ek(es),rs=es.child,rs.flags&8192&&(os=rs.memoizedState!==null,rs.stateNode.isHidden=os,!os||rs.alternate!==null&&rs.alternate.memoizedState!==null||(fk=B$1())),ns&4&&ak(es);break;case 22:if(ds=ss!==null&&ss.memoizedState!==null,es.mode&1?(U$1=(us=U$1)||ds,ck(ts,es),U$1=us):ck(ts,es),ek(es),ns&8192){if(us=es.memoizedState!==null,(es.stateNode.isHidden=us)&&!ds&&es.mode&1)for(V$1=es,ds=es.child;ds!==null;){for(xs=V$1=ds;V$1!==null;){switch(fs=V$1,gs=fs.child,fs.tag){case 0:case 11:case 14:case 15:Pj(4,fs,fs.return);break;case 1:Lj(fs,fs.return);var Es=fs.stateNode;if(typeof Es.componentWillUnmount=="function"){ns=fs,ss=fs.return;try{ts=ns,Es.props=ts.memoizedProps,Es.state=ts.memoizedState,Es.componentWillUnmount()}catch(js){W$1(ns,ss,js)}}break;case 5:Lj(fs,fs.return);break;case 22:if(fs.memoizedState!==null){gk(xs);continue}}gs!==null?(gs.return=fs,V$1=gs):gk(xs)}ds=ds.sibling}e:for(ds=null,xs=es;;){if(xs.tag===5){if(ds===null){ds=xs;try{rs=xs.stateNode,us?(os=rs.style,typeof os.setProperty=="function"?os.setProperty("display","none","important"):os.display="none"):(cs=xs.stateNode,ls=xs.memoizedProps.style,as=ls!=null&&ls.hasOwnProperty("display")?ls.display:null,cs.style.display=rb("display",as))}catch(js){W$1(es,es.return,js)}}}else if(xs.tag===6){if(ds===null)try{xs.stateNode.nodeValue=us?"":xs.memoizedProps}catch(js){W$1(es,es.return,js)}}else if((xs.tag!==22&&xs.tag!==23||xs.memoizedState===null||xs===es)&&xs.child!==null){xs.child.return=xs,xs=xs.child;continue}if(xs===es)break e;for(;xs.sibling===null;){if(xs.return===null||xs.return===es)break e;ds===xs&&(ds=null),xs=xs.return}ds===xs&&(ds=null),xs.sibling.return=xs.return,xs=xs.sibling}}break;case 19:ck(ts,es),ek(es),ns&4&&ak(es);break;case 21:break;default:ck(ts,es),ek(es)}}function ek(es){var ts=es.flags;if(ts&2){try{e:{for(var ss=es.return;ss!==null;){if(Tj(ss)){var ns=ss;break e}ss=ss.return}throw Error(p$1(160))}switch(ns.tag){case 5:var rs=ns.stateNode;ns.flags&32&&(ob(rs,""),ns.flags&=-33);var os=Uj(es);Wj(es,os,rs);break;case 3:case 4:var as=ns.stateNode.containerInfo,cs=Uj(es);Vj(es,cs,as);break;default:throw Error(p$1(161))}}catch(ls){W$1(es,es.return,ls)}es.flags&=-3}ts&4096&&(es.flags&=-4097)}function hk(es,ts,ss){V$1=es,ik(es)}function ik(es,ts,ss){for(var ns=(es.mode&1)!==0;V$1!==null;){var rs=V$1,os=rs.child;if(rs.tag===22&&ns){var as=rs.memoizedState!==null||Jj;if(!as){var cs=rs.alternate,ls=cs!==null&&cs.memoizedState!==null||U$1;cs=Jj;var us=U$1;if(Jj=as,(U$1=ls)&&!us)for(V$1=rs;V$1!==null;)as=V$1,ls=as.child,as.tag===22&&as.memoizedState!==null?jk(rs):ls!==null?(ls.return=as,V$1=ls):jk(rs);for(;os!==null;)V$1=os,ik(os),os=os.sibling;V$1=rs,Jj=cs,U$1=us}kk(es)}else rs.subtreeFlags&8772&&os!==null?(os.return=rs,V$1=os):kk(es)}}function kk(es){for(;V$1!==null;){var ts=V$1;if(ts.flags&8772){var ss=ts.alternate;try{if(ts.flags&8772)switch(ts.tag){case 0:case 11:case 15:U$1||Qj(5,ts);break;case 1:var ns=ts.stateNode;if(ts.flags&4&&!U$1)if(ss===null)ns.componentDidMount();else{var rs=ts.elementType===ts.type?ss.memoizedProps:Ci(ts.type,ss.memoizedProps);ns.componentDidUpdate(rs,ss.memoizedState,ns.__reactInternalSnapshotBeforeUpdate)}var os=ts.updateQueue;os!==null&&sh(ts,os,ns);break;case 3:var as=ts.updateQueue;if(as!==null){if(ss=null,ts.child!==null)switch(ts.child.tag){case 5:ss=ts.child.stateNode;break;case 1:ss=ts.child.stateNode}sh(ts,as,ss)}break;case 5:var cs=ts.stateNode;if(ss===null&&ts.flags&4){ss=cs;var ls=ts.memoizedProps;switch(ts.type){case"button":case"input":case"select":case"textarea":ls.autoFocus&&ss.focus();break;case"img":ls.src&&(ss.src=ls.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(ts.memoizedState===null){var us=ts.alternate;if(us!==null){var ds=us.memoizedState;if(ds!==null){var xs=ds.dehydrated;xs!==null&&bd(xs)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U$1||ts.flags&512&&Rj(ts)}catch(fs){W$1(ts,ts.return,fs)}}if(ts===es){V$1=null;break}if(ss=ts.sibling,ss!==null){ss.return=ts.return,V$1=ss;break}V$1=ts.return}}function gk(es){for(;V$1!==null;){var ts=V$1;if(ts===es){V$1=null;break}var ss=ts.sibling;if(ss!==null){ss.return=ts.return,V$1=ss;break}V$1=ts.return}}function jk(es){for(;V$1!==null;){var ts=V$1;try{switch(ts.tag){case 0:case 11:case 15:var ss=ts.return;try{Qj(4,ts)}catch(ls){W$1(ts,ss,ls)}break;case 1:var ns=ts.stateNode;if(typeof ns.componentDidMount=="function"){var rs=ts.return;try{ns.componentDidMount()}catch(ls){W$1(ts,rs,ls)}}var os=ts.return;try{Rj(ts)}catch(ls){W$1(ts,os,ls)}break;case 5:var as=ts.return;try{Rj(ts)}catch(ls){W$1(ts,as,ls)}}}catch(ls){W$1(ts,ts.return,ls)}if(ts===es){V$1=null;break}var cs=ts.sibling;if(cs!==null){cs.return=ts.return,V$1=cs;break}V$1=ts.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K$1=0,Q$1=null,Y$1=null,Z$1=0,fj=0,ej=Uf(0),T$1=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K$1&6?B$1():Ak!==-1?Ak:Ak=B$1()}function yi(es){return es.mode&1?K$1&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(es=C$1,es!==0||(es=window.event,es=es===void 0?16:jd(es.type)),es):1}function gi(es,ts,ss,ns){if(50<yk)throw yk=0,zk=null,Error(p$1(185));Ac(es,ss,ns),(!(K$1&2)||es!==Q$1)&&(es===Q$1&&(!(K$1&2)&&(qk|=ss),T$1===4&&Ck(es,Z$1)),Dk(es,ns),ss===1&&K$1===0&&!(ts.mode&1)&&(Gj=B$1()+500,fg&&jg()))}function Dk(es,ts){var ss=es.callbackNode;wc(es,ts);var ns=uc(es,es===Q$1?Z$1:0);if(ns===0)ss!==null&&bc(ss),es.callbackNode=null,es.callbackPriority=0;else if(ts=ns&-ns,es.callbackPriority!==ts){if(ss!=null&&bc(ss),ts===1)es.tag===0?ig(Ek.bind(null,es)):hg(Ek.bind(null,es)),Jf(function(){!(K$1&6)&&jg()}),ss=null;else{switch(Dc(ns)){case 1:ss=fc;break;case 4:ss=gc;break;case 16:ss=hc;break;case 536870912:ss=jc;break;default:ss=hc}ss=Fk(ss,Gk.bind(null,es))}es.callbackPriority=ts,es.callbackNode=ss}}function Gk(es,ts){if(Ak=-1,Bk=0,K$1&6)throw Error(p$1(327));var ss=es.callbackNode;if(Hk()&&es.callbackNode!==ss)return null;var ns=uc(es,es===Q$1?Z$1:0);if(ns===0)return null;if(ns&30||ns&es.expiredLanes||ts)ts=Ik(es,ns);else{ts=ns;var rs=K$1;K$1|=2;var os=Jk();(Q$1!==es||Z$1!==ts)&&(uk=null,Gj=B$1()+500,Kk(es,ts));do try{Lk();break}catch(cs){Mk(es,cs)}while(!0);$g(),mk.current=os,K$1=rs,Y$1!==null?ts=0:(Q$1=null,Z$1=0,ts=T$1)}if(ts!==0){if(ts===2&&(rs=xc(es),rs!==0&&(ns=rs,ts=Nk(es,rs))),ts===1)throw ss=pk,Kk(es,0),Ck(es,ns),Dk(es,B$1()),ss;if(ts===6)Ck(es,ns);else{if(rs=es.current.alternate,!(ns&30)&&!Ok(rs)&&(ts=Ik(es,ns),ts===2&&(os=xc(es),os!==0&&(ns=os,ts=Nk(es,os))),ts===1))throw ss=pk,Kk(es,0),Ck(es,ns),Dk(es,B$1()),ss;switch(es.finishedWork=rs,es.finishedLanes=ns,ts){case 0:case 1:throw Error(p$1(345));case 2:Pk(es,tk,uk);break;case 3:if(Ck(es,ns),(ns&130023424)===ns&&(ts=fk+500-B$1(),10<ts)){if(uc(es,0)!==0)break;if(rs=es.suspendedLanes,(rs&ns)!==ns){R$1(),es.pingedLanes|=es.suspendedLanes&rs;break}es.timeoutHandle=Ff(Pk.bind(null,es,tk,uk),ts);break}Pk(es,tk,uk);break;case 4:if(Ck(es,ns),(ns&4194240)===ns)break;for(ts=es.eventTimes,rs=-1;0<ns;){var as=31-oc(ns);os=1<<as,as=ts[as],as>rs&&(rs=as),ns&=~os}if(ns=rs,ns=B$1()-ns,ns=(120>ns?120:480>ns?480:1080>ns?1080:1920>ns?1920:3e3>ns?3e3:4320>ns?4320:1960*lk(ns/1960))-ns,10<ns){es.timeoutHandle=Ff(Pk.bind(null,es,tk,uk),ns);break}Pk(es,tk,uk);break;case 5:Pk(es,tk,uk);break;default:throw Error(p$1(329))}}}return Dk(es,B$1()),es.callbackNode===ss?Gk.bind(null,es):null}function Nk(es,ts){var ss=sk;return es.current.memoizedState.isDehydrated&&(Kk(es,ts).flags|=256),es=Ik(es,ts),es!==2&&(ts=tk,tk=ss,ts!==null&&Fj(ts)),es}function Fj(es){tk===null?tk=es:tk.push.apply(tk,es)}function Ok(es){for(var ts=es;;){if(ts.flags&16384){var ss=ts.updateQueue;if(ss!==null&&(ss=ss.stores,ss!==null))for(var ns=0;ns<ss.length;ns++){var rs=ss[ns],os=rs.getSnapshot;rs=rs.value;try{if(!He$1(os(),rs))return!1}catch{return!1}}}if(ss=ts.child,ts.subtreeFlags&16384&&ss!==null)ss.return=ts,ts=ss;else{if(ts===es)break;for(;ts.sibling===null;){if(ts.return===null||ts.return===es)return!0;ts=ts.return}ts.sibling.return=ts.return,ts=ts.sibling}}return!0}function Ck(es,ts){for(ts&=~rk,ts&=~qk,es.suspendedLanes|=ts,es.pingedLanes&=~ts,es=es.expirationTimes;0<ts;){var ss=31-oc(ts),ns=1<<ss;es[ss]=-1,ts&=~ns}}function Ek(es){if(K$1&6)throw Error(p$1(327));Hk();var ts=uc(es,0);if(!(ts&1))return Dk(es,B$1()),null;var ss=Ik(es,ts);if(es.tag!==0&&ss===2){var ns=xc(es);ns!==0&&(ts=ns,ss=Nk(es,ns))}if(ss===1)throw ss=pk,Kk(es,0),Ck(es,ts),Dk(es,B$1()),ss;if(ss===6)throw Error(p$1(345));return es.finishedWork=es.current.alternate,es.finishedLanes=ts,Pk(es,tk,uk),Dk(es,B$1()),null}function Qk(es,ts){var ss=K$1;K$1|=1;try{return es(ts)}finally{K$1=ss,K$1===0&&(Gj=B$1()+500,fg&&jg())}}function Rk(es){wk!==null&&wk.tag===0&&!(K$1&6)&&Hk();var ts=K$1;K$1|=1;var ss=ok.transition,ns=C$1;try{if(ok.transition=null,C$1=1,es)return es()}finally{C$1=ns,ok.transition=ss,K$1=ts,!(K$1&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(es,ts){es.finishedWork=null,es.finishedLanes=0;var ss=es.timeoutHandle;if(ss!==-1&&(es.timeoutHandle=-1,Gf(ss)),Y$1!==null)for(ss=Y$1.return;ss!==null;){var ns=ss;switch(wg(ns),ns.tag){case 1:ns=ns.type.childContextTypes,ns!=null&&$f();break;case 3:zh(),E$1(Wf),E$1(H$1),Eh();break;case 5:Bh(ns);break;case 4:zh();break;case 13:E$1(L$1);break;case 19:E$1(L$1);break;case 10:ah(ns.type._context);break;case 22:case 23:Hj()}ss=ss.return}if(Q$1=es,Y$1=es=Pg(es.current,null),Z$1=fj=ts,T$1=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(ts=0;ts<fh.length;ts++)if(ss=fh[ts],ns=ss.interleaved,ns!==null){ss.interleaved=null;var rs=ns.next,os=ss.pending;if(os!==null){var as=os.next;os.next=rs,ns.next=as}ss.pending=ns}fh=null}return es}function Mk(es,ts){do{var ss=Y$1;try{if($g(),Fh.current=Rh,Ih){for(var ns=M$1.memoizedState;ns!==null;){var rs=ns.queue;rs!==null&&(rs.pending=null),ns=ns.next}Ih=!1}if(Hh=0,O$1=N$1=M$1=null,Jh=!1,Kh=0,nk.current=null,ss===null||ss.return===null){T$1=1,pk=ts,Y$1=null;break}e:{var os=es,as=ss.return,cs=ss,ls=ts;if(ts=Z$1,cs.flags|=32768,ls!==null&&typeof ls=="object"&&typeof ls.then=="function"){var us=ls,ds=cs,xs=ds.tag;if(!(ds.mode&1)&&(xs===0||xs===11||xs===15)){var fs=ds.alternate;fs?(ds.updateQueue=fs.updateQueue,ds.memoizedState=fs.memoizedState,ds.lanes=fs.lanes):(ds.updateQueue=null,ds.memoizedState=null)}var gs=Ui(as);if(gs!==null){gs.flags&=-257,Vi(gs,as,cs,os,ts),gs.mode&1&&Si(os,us,ts),ts=gs,ls=us;var Es=ts.updateQueue;if(Es===null){var js=new Set;js.add(ls),ts.updateQueue=js}else Es.add(ls);break e}else{if(!(ts&1)){Si(os,us,ts),tj();break e}ls=Error(p$1(426))}}else if(I$1&&cs.mode&1){var ps=Ui(as);if(ps!==null){!(ps.flags&65536)&&(ps.flags|=256),Vi(ps,as,cs,os,ts),Jg(Ji(ls,cs));break e}}os=ls=Ji(ls,cs),T$1!==4&&(T$1=2),sk===null?sk=[os]:sk.push(os),os=as;do{switch(os.tag){case 3:os.flags|=65536,ts&=-ts,os.lanes|=ts;var ms=Ni(os,ls,ts);ph(os,ms);break e;case 1:cs=ls;var hs=os.type,vs=os.stateNode;if(!(os.flags&128)&&(typeof hs.getDerivedStateFromError=="function"||vs!==null&&typeof vs.componentDidCatch=="function"&&(Ri===null||!Ri.has(vs)))){os.flags|=65536,ts&=-ts,os.lanes|=ts;var ws=Qi(os,cs,ts);ph(os,ws);break e}}os=os.return}while(os!==null)}Sk(ss)}catch(ys){ts=ys,Y$1===ss&&ss!==null&&(Y$1=ss=ss.return);continue}break}while(!0)}function Jk(){var es=mk.current;return mk.current=Rh,es===null?Rh:es}function tj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),Q$1===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q$1,Z$1)}function Ik(es,ts){var ss=K$1;K$1|=2;var ns=Jk();(Q$1!==es||Z$1!==ts)&&(uk=null,Kk(es,ts));do try{Tk();break}catch(rs){Mk(es,rs)}while(!0);if($g(),K$1=ss,mk.current=ns,Y$1!==null)throw Error(p$1(261));return Q$1=null,Z$1=0,T$1}function Tk(){for(;Y$1!==null;)Uk(Y$1)}function Lk(){for(;Y$1!==null&&!cc();)Uk(Y$1)}function Uk(es){var ts=Vk(es.alternate,es,fj);es.memoizedProps=es.pendingProps,ts===null?Sk(es):Y$1=ts,nk.current=null}function Sk(es){var ts=es;do{var ss=ts.alternate;if(es=ts.return,ts.flags&32768){if(ss=Ij(ss,ts),ss!==null){ss.flags&=32767,Y$1=ss;return}if(es!==null)es.flags|=32768,es.subtreeFlags=0,es.deletions=null;else{T$1=6,Y$1=null;return}}else if(ss=Ej(ss,ts,fj),ss!==null){Y$1=ss;return}if(ts=ts.sibling,ts!==null){Y$1=ts;return}Y$1=ts=es}while(ts!==null);T$1===0&&(T$1=5)}function Pk(es,ts,ss){var ns=C$1,rs=ok.transition;try{ok.transition=null,C$1=1,Wk(es,ts,ss,ns)}finally{ok.transition=rs,C$1=ns}return null}function Wk(es,ts,ss,ns){do Hk();while(wk!==null);if(K$1&6)throw Error(p$1(327));ss=es.finishedWork;var rs=es.finishedLanes;if(ss===null)return null;if(es.finishedWork=null,es.finishedLanes=0,ss===es.current)throw Error(p$1(177));es.callbackNode=null,es.callbackPriority=0;var os=ss.lanes|ss.childLanes;if(Bc(es,os),es===Q$1&&(Y$1=Q$1=null,Z$1=0),!(ss.subtreeFlags&2064)&&!(ss.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),os=(ss.flags&15990)!==0,ss.subtreeFlags&15990||os){os=ok.transition,ok.transition=null;var as=C$1;C$1=1;var cs=K$1;K$1|=4,nk.current=null,Oj(es,ss),dk(ss,es),Oe$1(Df),dd=!!Cf,Df=Cf=null,es.current=ss,hk(ss),dc(),K$1=cs,C$1=as,ok.transition=os}else es.current=ss;if(vk&&(vk=!1,wk=es,xk=rs),os=es.pendingLanes,os===0&&(Ri=null),mc(ss.stateNode),Dk(es,B$1()),ts!==null)for(ns=es.onRecoverableError,ss=0;ss<ts.length;ss++)rs=ts[ss],ns(rs.value,{componentStack:rs.stack,digest:rs.digest});if(Oi)throw Oi=!1,es=Pi,Pi=null,es;return xk&1&&es.tag!==0&&Hk(),os=es.pendingLanes,os&1?es===zk?yk++:(yk=0,zk=es):yk=0,jg(),null}function Hk(){if(wk!==null){var es=Dc(xk),ts=ok.transition,ss=C$1;try{if(ok.transition=null,C$1=16>es?16:es,wk===null)var ns=!1;else{if(es=wk,wk=null,xk=0,K$1&6)throw Error(p$1(331));var rs=K$1;for(K$1|=4,V$1=es.current;V$1!==null;){var os=V$1,as=os.child;if(V$1.flags&16){var cs=os.deletions;if(cs!==null){for(var ls=0;ls<cs.length;ls++){var us=cs[ls];for(V$1=us;V$1!==null;){var ds=V$1;switch(ds.tag){case 0:case 11:case 15:Pj(8,ds,os)}var xs=ds.child;if(xs!==null)xs.return=ds,V$1=xs;else for(;V$1!==null;){ds=V$1;var fs=ds.sibling,gs=ds.return;if(Sj(ds),ds===us){V$1=null;break}if(fs!==null){fs.return=gs,V$1=fs;break}V$1=gs}}}var Es=os.alternate;if(Es!==null){var js=Es.child;if(js!==null){Es.child=null;do{var ps=js.sibling;js.sibling=null,js=ps}while(js!==null)}}V$1=os}}if(os.subtreeFlags&2064&&as!==null)as.return=os,V$1=as;else e:for(;V$1!==null;){if(os=V$1,os.flags&2048)switch(os.tag){case 0:case 11:case 15:Pj(9,os,os.return)}var ms=os.sibling;if(ms!==null){ms.return=os.return,V$1=ms;break e}V$1=os.return}}var hs=es.current;for(V$1=hs;V$1!==null;){as=V$1;var vs=as.child;if(as.subtreeFlags&2064&&vs!==null)vs.return=as,V$1=vs;else e:for(as=hs;V$1!==null;){if(cs=V$1,cs.flags&2048)try{switch(cs.tag){case 0:case 11:case 15:Qj(9,cs)}}catch(ys){W$1(cs,cs.return,ys)}if(cs===as){V$1=null;break e}var ws=cs.sibling;if(ws!==null){ws.return=cs.return,V$1=ws;break e}V$1=cs.return}}if(K$1=rs,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,es)}catch{}ns=!0}return ns}finally{C$1=ss,ok.transition=ts}}return!1}function Xk(es,ts,ss){ts=Ji(ss,ts),ts=Ni(es,ts,1),es=nh(es,ts,1),ts=R$1(),es!==null&&(Ac(es,1,ts),Dk(es,ts))}function W$1(es,ts,ss){if(es.tag===3)Xk(es,es,ss);else for(;ts!==null;){if(ts.tag===3){Xk(ts,es,ss);break}else if(ts.tag===1){var ns=ts.stateNode;if(typeof ts.type.getDerivedStateFromError=="function"||typeof ns.componentDidCatch=="function"&&(Ri===null||!Ri.has(ns))){es=Ji(ss,es),es=Qi(ts,es,1),ts=nh(ts,es,1),es=R$1(),ts!==null&&(Ac(ts,1,es),Dk(ts,es));break}}ts=ts.return}}function Ti(es,ts,ss){var ns=es.pingCache;ns!==null&&ns.delete(ts),ts=R$1(),es.pingedLanes|=es.suspendedLanes&ss,Q$1===es&&(Z$1&ss)===ss&&(T$1===4||T$1===3&&(Z$1&130023424)===Z$1&&500>B$1()-fk?Kk(es,0):rk|=ss),Dk(es,ts)}function Yk(es,ts){ts===0&&(es.mode&1?(ts=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):ts=1);var ss=R$1();es=ih(es,ts),es!==null&&(Ac(es,ts,ss),Dk(es,ss))}function uj(es){var ts=es.memoizedState,ss=0;ts!==null&&(ss=ts.retryLane),Yk(es,ss)}function bk(es,ts){var ss=0;switch(es.tag){case 13:var ns=es.stateNode,rs=es.memoizedState;rs!==null&&(ss=rs.retryLane);break;case 19:ns=es.stateNode;break;default:throw Error(p$1(314))}ns!==null&&ns.delete(ts),Yk(es,ss)}var Vk;Vk=function(es,ts,ss){if(es!==null)if(es.memoizedProps!==ts.pendingProps||Wf.current)dh=!0;else{if(!(es.lanes&ss)&&!(ts.flags&128))return dh=!1,yj(es,ts,ss);dh=!!(es.flags&131072)}else dh=!1,I$1&&ts.flags&1048576&&ug(ts,ng,ts.index);switch(ts.lanes=0,ts.tag){case 2:var ns=ts.type;ij(es,ts),es=ts.pendingProps;var rs=Yf(ts,H$1.current);ch(ts,ss),rs=Nh(null,ts,ns,es,rs,ss);var os=Sh();return ts.flags|=1,typeof rs=="object"&&rs!==null&&typeof rs.render=="function"&&rs.$$typeof===void 0?(ts.tag=1,ts.memoizedState=null,ts.updateQueue=null,Zf(ns)?(os=!0,cg(ts)):os=!1,ts.memoizedState=rs.state!==null&&rs.state!==void 0?rs.state:null,kh(ts),rs.updater=Ei,ts.stateNode=rs,rs._reactInternals=ts,Ii(ts,ns,es,ss),ts=jj(null,ts,ns,!0,os,ss)):(ts.tag=0,I$1&&os&&vg(ts),Xi(null,ts,rs,ss),ts=ts.child),ts;case 16:ns=ts.elementType;e:{switch(ij(es,ts),es=ts.pendingProps,rs=ns._init,ns=rs(ns._payload),ts.type=ns,rs=ts.tag=Zk(ns),es=Ci(ns,es),rs){case 0:ts=cj(null,ts,ns,es,ss);break e;case 1:ts=hj(null,ts,ns,es,ss);break e;case 11:ts=Yi(null,ts,ns,es,ss);break e;case 14:ts=$i(null,ts,ns,Ci(ns.type,es),ss);break e}throw Error(p$1(306,ns,""))}return ts;case 0:return ns=ts.type,rs=ts.pendingProps,rs=ts.elementType===ns?rs:Ci(ns,rs),cj(es,ts,ns,rs,ss);case 1:return ns=ts.type,rs=ts.pendingProps,rs=ts.elementType===ns?rs:Ci(ns,rs),hj(es,ts,ns,rs,ss);case 3:e:{if(kj(ts),es===null)throw Error(p$1(387));ns=ts.pendingProps,os=ts.memoizedState,rs=os.element,lh(es,ts),qh(ts,ns,null,ss);var as=ts.memoizedState;if(ns=as.element,os.isDehydrated)if(os={element:ns,isDehydrated:!1,cache:as.cache,pendingSuspenseBoundaries:as.pendingSuspenseBoundaries,transitions:as.transitions},ts.updateQueue.baseState=os,ts.memoizedState=os,ts.flags&256){rs=Ji(Error(p$1(423)),ts),ts=lj(es,ts,ns,ss,rs);break e}else if(ns!==rs){rs=Ji(Error(p$1(424)),ts),ts=lj(es,ts,ns,ss,rs);break e}else for(yg=Lf(ts.stateNode.containerInfo.firstChild),xg=ts,I$1=!0,zg=null,ss=Vg(ts,null,ns,ss),ts.child=ss;ss;)ss.flags=ss.flags&-3|4096,ss=ss.sibling;else{if(Ig(),ns===rs){ts=Zi(es,ts,ss);break e}Xi(es,ts,ns,ss)}ts=ts.child}return ts;case 5:return Ah(ts),es===null&&Eg(ts),ns=ts.type,rs=ts.pendingProps,os=es!==null?es.memoizedProps:null,as=rs.children,Ef(ns,rs)?as=null:os!==null&&Ef(ns,os)&&(ts.flags|=32),gj(es,ts),Xi(es,ts,as,ss),ts.child;case 6:return es===null&&Eg(ts),null;case 13:return oj(es,ts,ss);case 4:return yh(ts,ts.stateNode.containerInfo),ns=ts.pendingProps,es===null?ts.child=Ug(ts,null,ns,ss):Xi(es,ts,ns,ss),ts.child;case 11:return ns=ts.type,rs=ts.pendingProps,rs=ts.elementType===ns?rs:Ci(ns,rs),Yi(es,ts,ns,rs,ss);case 7:return Xi(es,ts,ts.pendingProps,ss),ts.child;case 8:return Xi(es,ts,ts.pendingProps.children,ss),ts.child;case 12:return Xi(es,ts,ts.pendingProps.children,ss),ts.child;case 10:e:{if(ns=ts.type._context,rs=ts.pendingProps,os=ts.memoizedProps,as=rs.value,G$1(Wg,ns._currentValue),ns._currentValue=as,os!==null)if(He$1(os.value,as)){if(os.children===rs.children&&!Wf.current){ts=Zi(es,ts,ss);break e}}else for(os=ts.child,os!==null&&(os.return=ts);os!==null;){var cs=os.dependencies;if(cs!==null){as=os.child;for(var ls=cs.firstContext;ls!==null;){if(ls.context===ns){if(os.tag===1){ls=mh(-1,ss&-ss),ls.tag=2;var us=os.updateQueue;if(us!==null){us=us.shared;var ds=us.pending;ds===null?ls.next=ls:(ls.next=ds.next,ds.next=ls),us.pending=ls}}os.lanes|=ss,ls=os.alternate,ls!==null&&(ls.lanes|=ss),bh(os.return,ss,ts),cs.lanes|=ss;break}ls=ls.next}}else if(os.tag===10)as=os.type===ts.type?null:os.child;else if(os.tag===18){if(as=os.return,as===null)throw Error(p$1(341));as.lanes|=ss,cs=as.alternate,cs!==null&&(cs.lanes|=ss),bh(as,ss,ts),as=os.sibling}else as=os.child;if(as!==null)as.return=os;else for(as=os;as!==null;){if(as===ts){as=null;break}if(os=as.sibling,os!==null){os.return=as.return,as=os;break}as=as.return}os=as}Xi(es,ts,rs.children,ss),ts=ts.child}return ts;case 9:return rs=ts.type,ns=ts.pendingProps.children,ch(ts,ss),rs=eh(rs),ns=ns(rs),ts.flags|=1,Xi(es,ts,ns,ss),ts.child;case 14:return ns=ts.type,rs=Ci(ns,ts.pendingProps),rs=Ci(ns.type,rs),$i(es,ts,ns,rs,ss);case 15:return bj(es,ts,ts.type,ts.pendingProps,ss);case 17:return ns=ts.type,rs=ts.pendingProps,rs=ts.elementType===ns?rs:Ci(ns,rs),ij(es,ts),ts.tag=1,Zf(ns)?(es=!0,cg(ts)):es=!1,ch(ts,ss),Gi(ts,ns,rs),Ii(ts,ns,rs,ss),jj(null,ts,ns,!0,es,ss);case 19:return xj(es,ts,ss);case 22:return dj(es,ts,ss)}throw Error(p$1(156,ts.tag))};function Fk(es,ts){return ac(es,ts)}function $k(es,ts,ss,ns){this.tag=es,this.key=ss,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=ts,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=ns,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(es,ts,ss,ns){return new $k(es,ts,ss,ns)}function aj(es){return es=es.prototype,!(!es||!es.isReactComponent)}function Zk(es){if(typeof es=="function")return aj(es)?1:0;if(es!=null){if(es=es.$$typeof,es===Da)return 11;if(es===Ga)return 14}return 2}function Pg(es,ts){var ss=es.alternate;return ss===null?(ss=Bg(es.tag,ts,es.key,es.mode),ss.elementType=es.elementType,ss.type=es.type,ss.stateNode=es.stateNode,ss.alternate=es,es.alternate=ss):(ss.pendingProps=ts,ss.type=es.type,ss.flags=0,ss.subtreeFlags=0,ss.deletions=null),ss.flags=es.flags&14680064,ss.childLanes=es.childLanes,ss.lanes=es.lanes,ss.child=es.child,ss.memoizedProps=es.memoizedProps,ss.memoizedState=es.memoizedState,ss.updateQueue=es.updateQueue,ts=es.dependencies,ss.dependencies=ts===null?null:{lanes:ts.lanes,firstContext:ts.firstContext},ss.sibling=es.sibling,ss.index=es.index,ss.ref=es.ref,ss}function Rg(es,ts,ss,ns,rs,os){var as=2;if(ns=es,typeof es=="function")aj(es)&&(as=1);else if(typeof es=="string")as=5;else e:switch(es){case ya:return Tg(ss.children,rs,os,ts);case za:as=8,rs|=8;break;case Aa:return es=Bg(12,ss,ts,rs|2),es.elementType=Aa,es.lanes=os,es;case Ea:return es=Bg(13,ss,ts,rs),es.elementType=Ea,es.lanes=os,es;case Fa:return es=Bg(19,ss,ts,rs),es.elementType=Fa,es.lanes=os,es;case Ia:return pj(ss,rs,os,ts);default:if(typeof es=="object"&&es!==null)switch(es.$$typeof){case Ba:as=10;break e;case Ca:as=9;break e;case Da:as=11;break e;case Ga:as=14;break e;case Ha:as=16,ns=null;break e}throw Error(p$1(130,es==null?es:typeof es,""))}return ts=Bg(as,ss,ts,rs),ts.elementType=es,ts.type=ns,ts.lanes=os,ts}function Tg(es,ts,ss,ns){return es=Bg(7,es,ns,ts),es.lanes=ss,es}function pj(es,ts,ss,ns){return es=Bg(22,es,ns,ts),es.elementType=Ia,es.lanes=ss,es.stateNode={isHidden:!1},es}function Qg(es,ts,ss){return es=Bg(6,es,null,ts),es.lanes=ss,es}function Sg(es,ts,ss){return ts=Bg(4,es.children!==null?es.children:[],es.key,ts),ts.lanes=ss,ts.stateNode={containerInfo:es.containerInfo,pendingChildren:null,implementation:es.implementation},ts}function al(es,ts,ss,ns,rs){this.tag=ts,this.containerInfo=es,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=ns,this.onRecoverableError=rs,this.mutableSourceEagerHydrationData=null}function bl(es,ts,ss,ns,rs,os,as,cs,ls){return es=new al(es,ts,ss,cs,ls),ts===1?(ts=1,os===!0&&(ts|=8)):ts=0,os=Bg(3,null,null,ts),es.current=os,os.stateNode=es,os.memoizedState={element:ns,isDehydrated:ss,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(os),es}function cl(es,ts,ss){var ns=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:ns==null?null:""+ns,children:es,containerInfo:ts,implementation:ss}}function dl(es){if(!es)return Vf;es=es._reactInternals;e:{if(Vb(es)!==es||es.tag!==1)throw Error(p$1(170));var ts=es;do{switch(ts.tag){case 3:ts=ts.stateNode.context;break e;case 1:if(Zf(ts.type)){ts=ts.stateNode.__reactInternalMemoizedMergedChildContext;break e}}ts=ts.return}while(ts!==null);throw Error(p$1(171))}if(es.tag===1){var ss=es.type;if(Zf(ss))return bg(es,ss,ts)}return ts}function el(es,ts,ss,ns,rs,os,as,cs,ls){return es=bl(ss,ns,!0,es,rs,os,as,cs,ls),es.context=dl(null),ss=es.current,ns=R$1(),rs=yi(ss),os=mh(ns,rs),os.callback=ts??null,nh(ss,os,rs),es.current.lanes=rs,Ac(es,rs,ns),Dk(es,ns),es}function fl(es,ts,ss,ns){var rs=ts.current,os=R$1(),as=yi(rs);return ss=dl(ss),ts.context===null?ts.context=ss:ts.pendingContext=ss,ts=mh(os,as),ts.payload={element:es},ns=ns===void 0?null:ns,ns!==null&&(ts.callback=ns),es=nh(rs,ts,as),es!==null&&(gi(es,rs,as,os),oh(es,rs,as)),as}function gl(es){if(es=es.current,!es.child)return null;switch(es.child.tag){case 5:return es.child.stateNode;default:return es.child.stateNode}}function hl(es,ts){if(es=es.memoizedState,es!==null&&es.dehydrated!==null){var ss=es.retryLane;es.retryLane=ss!==0&&ss<ts?ss:ts}}function il(es,ts){hl(es,ts),(es=es.alternate)&&hl(es,ts)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(es){console.error(es)};function ll(es){this._internalRoot=es}ml.prototype.render=ll.prototype.render=function(es){var ts=this._internalRoot;if(ts===null)throw Error(p$1(409));fl(es,ts,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var es=this._internalRoot;if(es!==null){this._internalRoot=null;var ts=es.containerInfo;Rk(function(){fl(null,es,null,null)}),ts[uf]=null}};function ml(es){this._internalRoot=es}ml.prototype.unstable_scheduleHydration=function(es){if(es){var ts=Hc();es={blockedOn:null,target:es,priority:ts};for(var ss=0;ss<Qc.length&&ts!==0&&ts<Qc[ss].priority;ss++);Qc.splice(ss,0,es),ss===0&&Vc(es)}};function nl(es){return!(!es||es.nodeType!==1&&es.nodeType!==9&&es.nodeType!==11)}function ol(es){return!(!es||es.nodeType!==1&&es.nodeType!==9&&es.nodeType!==11&&(es.nodeType!==8||es.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(es,ts,ss,ns,rs){if(rs){if(typeof ns=="function"){var os=ns;ns=function(){var us=gl(as);os.call(us)}}var as=el(ts,ns,es,0,null,!1,!1,"",pl);return es._reactRootContainer=as,es[uf]=as.current,sf(es.nodeType===8?es.parentNode:es),Rk(),as}for(;rs=es.lastChild;)es.removeChild(rs);if(typeof ns=="function"){var cs=ns;ns=function(){var us=gl(ls);cs.call(us)}}var ls=bl(es,0,!1,null,null,!1,!1,"",pl);return es._reactRootContainer=ls,es[uf]=ls.current,sf(es.nodeType===8?es.parentNode:es),Rk(function(){fl(ts,ls,ss,ns)}),ls}function rl(es,ts,ss,ns,rs){var os=ss._reactRootContainer;if(os){var as=os;if(typeof rs=="function"){var cs=rs;rs=function(){var ls=gl(as);cs.call(ls)}}fl(ts,as,es,rs)}else as=ql(ss,ts,es,rs,ns);return gl(as)}Ec=function(es){switch(es.tag){case 3:var ts=es.stateNode;if(ts.current.memoizedState.isDehydrated){var ss=tc(ts.pendingLanes);ss!==0&&(Cc(ts,ss|1),Dk(ts,B$1()),!(K$1&6)&&(Gj=B$1()+500,jg()))}break;case 13:Rk(function(){var ns=ih(es,1);if(ns!==null){var rs=R$1();gi(ns,es,1,rs)}}),il(es,1)}};Fc=function(es){if(es.tag===13){var ts=ih(es,134217728);if(ts!==null){var ss=R$1();gi(ts,es,134217728,ss)}il(es,134217728)}};Gc=function(es){if(es.tag===13){var ts=yi(es),ss=ih(es,ts);if(ss!==null){var ns=R$1();gi(ss,es,ts,ns)}il(es,ts)}};Hc=function(){return C$1};Ic=function(es,ts){var ss=C$1;try{return C$1=es,ts()}finally{C$1=ss}};yb=function(es,ts,ss){switch(ts){case"input":if(bb(es,ss),ts=ss.name,ss.type==="radio"&&ts!=null){for(ss=es;ss.parentNode;)ss=ss.parentNode;for(ss=ss.querySelectorAll("input[name="+JSON.stringify(""+ts)+'][type="radio"]'),ts=0;ts<ss.length;ts++){var ns=ss[ts];if(ns!==es&&ns.form===es.form){var rs=Db(ns);if(!rs)throw Error(p$1(90));Wa(ns),bb(ns,rs)}}}break;case"textarea":ib(es,ss);break;case"select":ts=ss.value,ts!=null&&fb(es,!!ss.multiple,ts,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue$1,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(es){return es=Zb(es),es===null?null:es.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(es,ts){var ss=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(ts))throw Error(p$1(200));return cl(es,ts,null,ss)};reactDom_production_min.createRoot=function(es,ts){if(!nl(es))throw Error(p$1(299));var ss=!1,ns="",rs=kl;return ts!=null&&(ts.unstable_strictMode===!0&&(ss=!0),ts.identifierPrefix!==void 0&&(ns=ts.identifierPrefix),ts.onRecoverableError!==void 0&&(rs=ts.onRecoverableError)),ts=bl(es,1,!1,null,null,ss,!1,ns,rs),es[uf]=ts.current,sf(es.nodeType===8?es.parentNode:es),new ll(ts)};reactDom_production_min.findDOMNode=function(es){if(es==null)return null;if(es.nodeType===1)return es;var ts=es._reactInternals;if(ts===void 0)throw typeof es.render=="function"?Error(p$1(188)):(es=Object.keys(es).join(","),Error(p$1(268,es)));return es=Zb(ts),es=es===null?null:es.stateNode,es};reactDom_production_min.flushSync=function(es){return Rk(es)};reactDom_production_min.hydrate=function(es,ts,ss){if(!ol(ts))throw Error(p$1(200));return rl(null,es,ts,!0,ss)};reactDom_production_min.hydrateRoot=function(es,ts,ss){if(!nl(es))throw Error(p$1(405));var ns=ss!=null&&ss.hydratedSources||null,rs=!1,os="",as=kl;if(ss!=null&&(ss.unstable_strictMode===!0&&(rs=!0),ss.identifierPrefix!==void 0&&(os=ss.identifierPrefix),ss.onRecoverableError!==void 0&&(as=ss.onRecoverableError)),ts=el(ts,null,es,1,ss??null,rs,!1,os,as),es[uf]=ts.current,sf(es),ns)for(es=0;es<ns.length;es++)ss=ns[es],rs=ss._getVersion,rs=rs(ss._source),ts.mutableSourceEagerHydrationData==null?ts.mutableSourceEagerHydrationData=[ss,rs]:ts.mutableSourceEagerHydrationData.push(ss,rs);return new ml(ts)};reactDom_production_min.render=function(es,ts,ss){if(!ol(ts))throw Error(p$1(200));return rl(null,es,ts,!1,ss)};reactDom_production_min.unmountComponentAtNode=function(es){if(!ol(es))throw Error(p$1(40));return es._reactRootContainer?(Rk(function(){rl(null,null,es,!1,function(){es._reactRootContainer=null,es[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(es,ts,ss,ns){if(!ol(ss))throw Error(p$1(200));if(es==null||es._reactInternals===void 0)throw Error(p$1(38));return rl(es,ts,ss,!1,ns)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(es){console.error(es)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;const __vite_import_meta_env__$2={},createStoreImpl=es=>{let ts;const ss=new Set,ns=(ds,xs)=>{const fs=typeof ds=="function"?ds(ts):ds;if(!Object.is(fs,ts)){const gs=ts;ts=xs??(typeof fs!="object"||fs===null)?fs:Object.assign({},ts,fs),ss.forEach(Es=>Es(ts,gs))}},rs=()=>ts,ls={setState:ns,getState:rs,getInitialState:()=>us,subscribe:ds=>(ss.add(ds),()=>ss.delete(ds)),destroy:()=>{(__vite_import_meta_env__$2?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),ss.clear()}},us=ts=es(ns,rs,ls);return ls},createStore=es=>es?createStoreImpl(es):createStoreImpl;var withSelector={exports:{}},withSelector_production={},shim$2={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React$1=reactExports;function is$1(es,ts){return es===ts&&(es!==0||1/es===1/ts)||es!==es&&ts!==ts}var objectIs$1=typeof Object.is=="function"?Object.is:is$1,useState=React$1.useState,useEffect$1=React$1.useEffect,useLayoutEffect=React$1.useLayoutEffect,useDebugValue$2=React$1.useDebugValue;function useSyncExternalStore$2(es,ts){var ss=ts(),ns=useState({inst:{value:ss,getSnapshot:ts}}),rs=ns[0].inst,os=ns[1];return useLayoutEffect(function(){rs.value=ss,rs.getSnapshot=ts,checkIfSnapshotChanged(rs)&&os({inst:rs})},[es,ss,ts]),useEffect$1(function(){return checkIfSnapshotChanged(rs)&&os({inst:rs}),es(function(){checkIfSnapshotChanged(rs)&&os({inst:rs})})},[es]),useDebugValue$2(ss),ss}function checkIfSnapshotChanged(es){var ts=es.getSnapshot;es=es.value;try{var ss=ts();return!objectIs$1(es,ss)}catch{return!0}}function useSyncExternalStore$1(es,ts){return ts()}var shim$1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?useSyncExternalStore$1:useSyncExternalStore$2;useSyncExternalStoreShim_production.useSyncExternalStore=React$1.useSyncExternalStore!==void 0?React$1.useSyncExternalStore:shim$1;shim$2.exports=useSyncExternalStoreShim_production;var shimExports=shim$2.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React=reactExports,shim=shimExports;function is(es,ts){return es===ts&&(es!==0||1/es===1/ts)||es!==es&&ts!==ts}var objectIs=typeof Object.is=="function"?Object.is:is,useSyncExternalStore=shim.useSyncExternalStore,useRef=React.useRef,useEffect=React.useEffect,useMemo=React.useMemo,useDebugValue$1=React.useDebugValue;withSelector_production.useSyncExternalStoreWithSelector=function(es,ts,ss,ns,rs){var os=useRef(null);if(os.current===null){var as={hasValue:!1,value:null};os.current=as}else as=os.current;os=useMemo(function(){function ls(gs){if(!us){if(us=!0,ds=gs,gs=ns(gs),rs!==void 0&&as.hasValue){var Es=as.value;if(rs(Es,gs))return xs=Es}return xs=gs}if(Es=xs,objectIs(ds,gs))return Es;var js=ns(gs);return rs!==void 0&&rs(Es,js)?(ds=gs,Es):(ds=gs,xs=js)}var us=!1,ds,xs,fs=ss===void 0?null:ss;return[function(){return ls(ts())},fs===null?void 0:function(){return ls(fs())}]},[ts,ss,ns,rs]);var cs=useSyncExternalStore(es,os[0],os[1]);return useEffect(function(){as.hasValue=!0,as.value=cs},[cs]),useDebugValue$1(cs),cs};withSelector.exports=withSelector_production;var withSelectorExports=withSelector.exports;const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__$1={},{useDebugValue}=React$2,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports;let didWarnAboutEqualityFn=!1;const identity=es=>es;function useStore(es,ts=identity,ss){(__vite_import_meta_env__$1?"production":void 0)!=="production"&&ss&&!didWarnAboutEqualityFn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),didWarnAboutEqualityFn=!0);const ns=useSyncExternalStoreWithSelector(es.subscribe,es.getState,es.getServerState||es.getInitialState,ts,ss);return useDebugValue(ns),ns}const createImpl=es=>{(__vite_import_meta_env__$1?"production":void 0)!=="production"&&typeof es!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const ts=typeof es=="function"?createStore(es):es,ss=(ns,rs)=>useStore(ts,ns,rs);return Object.assign(ss,ts),ss},create=es=>es?createImpl(es):createImpl,__vite_import_meta_env__={};function createJSONStorage(es,ts){let ss;try{ss=es()}catch{return}return{getItem:rs=>{var os;const as=ls=>ls===null?null:JSON.parse(ls,void 0),cs=(os=ss.getItem(rs))!=null?os:null;return cs instanceof Promise?cs.then(as):as(cs)},setItem:(rs,os)=>ss.setItem(rs,JSON.stringify(os,void 0)),removeItem:rs=>ss.removeItem(rs)}}const toThenable=es=>ts=>{try{const ss=es(ts);return ss instanceof Promise?ss:{then(ns){return toThenable(ns)(ss)},catch(ns){return this}}}catch(ss){return{then(ns){return this},catch(ns){return toThenable(ns)(ss)}}}},oldImpl=(es,ts)=>(ss,ns,rs)=>{let os={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:ps=>ps,version:0,merge:(ps,ms)=>({...ms,...ps}),...ts},as=!1;const cs=new Set,ls=new Set;let us;try{us=os.getStorage()}catch{}if(!us)return es((...ps)=>{console.warn(`[zustand persist middleware] Unable to update item '${os.name}', the given storage is currently unavailable.`),ss(...ps)},ns,rs);const ds=toThenable(os.serialize),xs=()=>{const ps=os.partialize({...ns()});let ms;const hs=ds({state:ps,version:os.version}).then(vs=>us.setItem(os.name,vs)).catch(vs=>{ms=vs});if(ms)throw ms;return hs},fs=rs.setState;rs.setState=(ps,ms)=>{fs(ps,ms),xs()};const gs=es((...ps)=>{ss(...ps),xs()},ns,rs);let Es;const js=()=>{var ps;if(!us)return;as=!1,cs.forEach(hs=>hs(ns()));const ms=((ps=os.onRehydrateStorage)==null?void 0:ps.call(os,ns()))||void 0;return toThenable(us.getItem.bind(us))(os.name).then(hs=>{if(hs)return os.deserialize(hs)}).then(hs=>{if(hs)if(typeof hs.version=="number"&&hs.version!==os.version){if(os.migrate)return os.migrate(hs.state,hs.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return hs.state}).then(hs=>{var vs;return Es=os.merge(hs,(vs=ns())!=null?vs:gs),ss(Es,!0),xs()}).then(()=>{ms==null||ms(Es,void 0),as=!0,ls.forEach(hs=>hs(Es))}).catch(hs=>{ms==null||ms(void 0,hs)})};return rs.persist={setOptions:ps=>{os={...os,...ps},ps.getStorage&&(us=ps.getStorage())},clearStorage:()=>{us==null||us.removeItem(os.name)},getOptions:()=>os,rehydrate:()=>js(),hasHydrated:()=>as,onHydrate:ps=>(cs.add(ps),()=>{cs.delete(ps)}),onFinishHydration:ps=>(ls.add(ps),()=>{ls.delete(ps)})},js(),Es||gs},newImpl=(es,ts)=>(ss,ns,rs)=>{let os={storage:createJSONStorage(()=>localStorage),partialize:js=>js,version:0,merge:(js,ps)=>({...ps,...js}),...ts},as=!1;const cs=new Set,ls=new Set;let us=os.storage;if(!us)return es((...js)=>{console.warn(`[zustand persist middleware] Unable to update item '${os.name}', the given storage is currently unavailable.`),ss(...js)},ns,rs);const ds=()=>{const js=os.partialize({...ns()});return us.setItem(os.name,{state:js,version:os.version})},xs=rs.setState;rs.setState=(js,ps)=>{xs(js,ps),ds()};const fs=es((...js)=>{ss(...js),ds()},ns,rs);rs.getInitialState=()=>fs;let gs;const Es=()=>{var js,ps;if(!us)return;as=!1,cs.forEach(hs=>{var vs;return hs((vs=ns())!=null?vs:fs)});const ms=((ps=os.onRehydrateStorage)==null?void 0:ps.call(os,(js=ns())!=null?js:fs))||void 0;return toThenable(us.getItem.bind(us))(os.name).then(hs=>{if(hs)if(typeof hs.version=="number"&&hs.version!==os.version){if(os.migrate)return[!0,os.migrate(hs.state,hs.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,hs.state];return[!1,void 0]}).then(hs=>{var vs;const[ws,ys]=hs;if(gs=os.merge(ys,(vs=ns())!=null?vs:fs),ss(gs,!0),ws)return ds()}).then(()=>{ms==null||ms(gs,void 0),gs=ns(),as=!0,ls.forEach(hs=>hs(gs))}).catch(hs=>{ms==null||ms(void 0,hs)})};return rs.persist={setOptions:js=>{os={...os,...js},js.storage&&(us=js.storage)},clearStorage:()=>{us==null||us.removeItem(os.name)},getOptions:()=>os,rehydrate:()=>Es(),hasHydrated:()=>as,onHydrate:js=>(cs.add(js),()=>{cs.delete(js)}),onFinishHydration:js=>(ls.add(js),()=>{ls.delete(js)})},os.skipHydration||Es(),gs||fs},persistImpl=(es,ts)=>"getStorage"in ts||"serialize"in ts||"deserialize"in ts?((__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),oldImpl(es,ts)):newImpl(es,ts),persist=persistImpl,e=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,t=Object.keys,n=Array.isArray;function r$1(es,ts){return typeof ts!="object"||t(ts).forEach(function(ss){es[ss]=ts[ss]}),es}typeof Promise>"u"||e.Promise||(e.Promise=Promise);const s=Object.getPrototypeOf,i={}.hasOwnProperty;function o(es,ts){return i.call(es,ts)}function a(es,ts){typeof ts=="function"&&(ts=ts(s(es))),(typeof Reflect>"u"?t:Reflect.ownKeys)(ts).forEach(ss=>{l(es,ss,ts[ss])})}const u=Object.defineProperty;function l(es,ts,ss,ns){u(es,ts,r$1(ss&&o(ss,"get")&&typeof ss.get=="function"?{get:ss.get,set:ss.set,configurable:!0}:{value:ss,configurable:!0,writable:!0},ns))}function c(es){return{from:function(ts){return es.prototype=Object.create(ts.prototype),l(es.prototype,"constructor",es),{extend:a.bind(null,es.prototype)}}}}const h=Object.getOwnPropertyDescriptor;function d(es,ts){let ss;return h(es,ts)||(ss=s(es))&&d(ss,ts)}const f=[].slice;function p(es,ts,ss){return f.call(es,ts,ss)}function y(es,ts){return ts(es)}function m(es){if(!es)throw new Error("Assertion Failed")}function v(es){e.setImmediate?setImmediate(es):setTimeout(es,0)}function g(es,ts){return es.reduce((ss,ns,rs)=>{var os=ts(ns,rs);return os&&(ss[os[0]]=os[1]),ss},{})}function b(es,ts){if(typeof ts=="string"&&o(es,ts))return es[ts];if(!ts)return es;if(typeof ts!="string"){for(var ss=[],ns=0,rs=ts.length;ns<rs;++ns){var os=b(es,ts[ns]);ss.push(os)}return ss}var as=ts.indexOf(".");if(as!==-1){var cs=es[ts.substr(0,as)];return cs==null?void 0:b(cs,ts.substr(as+1))}}function _(es,ts,ss){if(es&&ts!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(es)))if(typeof ts!="string"&&"length"in ts){m(typeof ss!="string"&&"length"in ss);for(var ns=0,rs=ts.length;ns<rs;++ns)_(es,ts[ns],ss[ns])}else{var os=ts.indexOf(".");if(os!==-1){var as=ts.substr(0,os),cs=ts.substr(os+1);if(cs==="")ss===void 0?n(es)&&!isNaN(parseInt(as))?es.splice(as,1):delete es[as]:es[as]=ss;else{var ls=es[as];ls&&o(es,as)||(ls=es[as]={}),_(ls,cs,ss)}}else ss===void 0?n(es)&&!isNaN(parseInt(ts))?es.splice(ts,1):delete es[ts]:es[ts]=ss}}function w(es){var ts={};for(var ss in es)o(es,ss)&&(ts[ss]=es[ss]);return ts}const x=[].concat;function k(es){return x.apply([],es)}const E="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(k([8,16,32,64].map(es=>["Int","Uint","Float"].map(ts=>ts+es+"Array")))).filter(es=>e[es]),P=E.map(es=>e[es]);g(E,es=>[es,!0]);let K=null;function O(es){K=typeof WeakMap<"u"&&new WeakMap;const ts=S(es);return K=null,ts}function S(es){if(!es||typeof es!="object")return es;let ts=K&&K.get(es);if(ts)return ts;if(n(es)){ts=[],K&&K.set(es,ts);for(var ss=0,ns=es.length;ss<ns;++ss)ts.push(S(es[ss]))}else if(P.indexOf(es.constructor)>=0)ts=es;else{const os=s(es);for(var rs in ts=os===Object.prototype?{}:Object.create(os),K&&K.set(es,ts),es)o(es,rs)&&(ts[rs]=S(es[rs]))}return ts}const{toString:A}={};function C(es){return A.call(es).slice(8,-1)}const j=typeof Symbol<"u"?Symbol.iterator:"@@iterator",D=typeof j=="symbol"?function(es){var ts;return es!=null&&(ts=es[j])&&ts.apply(es)}:function(){return null},I={};function B(es){var ts,ss,ns,rs;if(arguments.length===1){if(n(es))return es.slice();if(this===I&&typeof es=="string")return[es];if(rs=D(es)){for(ss=[];!(ns=rs.next()).done;)ss.push(ns.value);return ss}if(es==null)return[es];if(typeof(ts=es.length)=="number"){for(ss=new Array(ts);ts--;)ss[ts]=es[ts];return ss}return[es]}for(ts=arguments.length,ss=new Array(ts);ts--;)ss[ts]=arguments[ts];return ss}const T=typeof Symbol<"u"?es=>es[Symbol.toStringTag]==="AsyncFunction":()=>!1;var R=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function F(es,ts){R=es,M=ts}var M=()=>!0;const N=!new Error("").stack;function q(){if(N)try{throw q.arguments,new Error}catch(es){return es}return new Error}function $(es,ts){var ss=es.stack;return ss?(ts=ts||0,ss.indexOf(es.name)===0&&(ts+=(es.name+es.message).split(`
`).length),ss.split(`
`).slice(ts).filter(M).map(ns=>`
`+ns).join("")):""}var U=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],L=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(U),V={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function W(es,ts){this._e=q(),this.name=es,this.message=ts}function Y(es,ts){return es+". Errors: "+Object.keys(ts).map(ss=>ts[ss].toString()).filter((ss,ns,rs)=>rs.indexOf(ss)===ns).join(`
`)}function z(es,ts,ss,ns){this._e=q(),this.failures=ts,this.failedKeys=ns,this.successCount=ss,this.message=Y(es,ts)}function G(es,ts){this._e=q(),this.name="BulkError",this.failures=Object.keys(ts).map(ss=>ts[ss]),this.failuresByPos=ts,this.message=Y(es,ts)}c(W).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+$(this._e,2))}},toString:function(){return this.name+": "+this.message}}),c(z).from(W),c(G).from(W);var H=L.reduce((es,ts)=>(es[ts]=ts+"Error",es),{});const Q=W;var X=L.reduce((es,ts)=>{var ss=ts+"Error";function ns(rs,os){this._e=q(),this.name=ss,rs?typeof rs=="string"?(this.message=`${rs}${os?`
 `+os:""}`,this.inner=os||null):typeof rs=="object"&&(this.message=`${rs.name} ${rs.message}`,this.inner=rs):(this.message=V[ts]||ss,this.inner=null)}return c(ns).from(Q),es[ts]=ns,es},{});X.Syntax=SyntaxError,X.Type=TypeError,X.Range=RangeError;var J=U.reduce((es,ts)=>(es[ts+"Error"]=X[ts],es),{}),Z=L.reduce((es,ts)=>(["Syntax","Type","Range"].indexOf(ts)===-1&&(es[ts+"Error"]=X[ts]),es),{});function ee(){}function te(es){return es}function ne(es,ts){return es==null||es===te?ts:function(ss){return ts(es(ss))}}function re(es,ts){return function(){es.apply(this,arguments),ts.apply(this,arguments)}}function se(es,ts){return es===ee?ts:function(){var ss=es.apply(this,arguments);ss!==void 0&&(arguments[0]=ss);var ns=this.onsuccess,rs=this.onerror;this.onsuccess=null,this.onerror=null;var os=ts.apply(this,arguments);return ns&&(this.onsuccess=this.onsuccess?re(ns,this.onsuccess):ns),rs&&(this.onerror=this.onerror?re(rs,this.onerror):rs),os!==void 0?os:ss}}function ie(es,ts){return es===ee?ts:function(){es.apply(this,arguments);var ss=this.onsuccess,ns=this.onerror;this.onsuccess=this.onerror=null,ts.apply(this,arguments),ss&&(this.onsuccess=this.onsuccess?re(ss,this.onsuccess):ss),ns&&(this.onerror=this.onerror?re(ns,this.onerror):ns)}}function oe(es,ts){return es===ee?ts:function(ss){var ns=es.apply(this,arguments);r$1(ss,ns);var rs=this.onsuccess,os=this.onerror;this.onsuccess=null,this.onerror=null;var as=ts.apply(this,arguments);return rs&&(this.onsuccess=this.onsuccess?re(rs,this.onsuccess):rs),os&&(this.onerror=this.onerror?re(os,this.onerror):os),ns===void 0?as===void 0?void 0:as:r$1(ns,as)}}function ae(es,ts){return es===ee?ts:function(){return ts.apply(this,arguments)!==!1&&es.apply(this,arguments)}}function ue(es,ts){return es===ee?ts:function(){var ss=es.apply(this,arguments);if(ss&&typeof ss.then=="function"){for(var ns=this,rs=arguments.length,os=new Array(rs);rs--;)os[rs]=arguments[rs];return ss.then(function(){return ts.apply(ns,os)})}return ts.apply(this,arguments)}}Z.ModifyError=z,Z.DexieError=W,Z.BulkError=G;var le={};const ce=100,[he,de,fe]=typeof Promise>"u"?[]:(()=>{let es=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[es,s(es),es];const ts=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[ts,s(ts),es]})(),pe=de&&de.then,ye=he&&he.constructor,me=!!fe;var ve=!1,ge=fe?()=>{fe.then($e)}:e.setImmediate?setImmediate.bind(null,$e):e.MutationObserver?()=>{var es=document.createElement("div");new MutationObserver(()=>{$e(),es=null}).observe(es,{attributes:!0}),es.setAttribute("i","1")}:()=>{setTimeout($e,0)},be=function(es,ts){Se.push([es,ts]),we&&(ge(),we=!1)},_e=!0,we=!0,xe=[],ke=[],Ee=null,Pe=te,Ke={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:dt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(es=>{try{dt(es[0],es[1])}catch{}})}},Oe=Ke,Se=[],Ae=0,Ce=[];function je(es){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ee,this._lib=!1;var ts=this._PSD=Oe;if(R&&(this._stackHolder=q(),this._prev=null,this._numPrev=0),typeof es!="function"){if(es!==le)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Te(this,this._value))}this._state=null,this._value=null,++ts.ref,Be(this,es)}const De={get:function(){var es=Oe,ts=Xe;function ss(ns,rs){var os=!es.global&&(es!==Oe||ts!==Xe);const as=os&&!tt();var cs=new je((ls,us)=>{Fe(this,new Ie(lt(ns,es,os,as),lt(rs,es,os,as),ls,us,es))});return R&&qe(cs,this),cs}return ss.prototype=le,ss},set:function(es){l(this,"then",es&&es.prototype===le?De:{get:function(){return es},set:De.set})}};function Ie(es,ts,ss,ns,rs){this.onFulfilled=typeof es=="function"?es:null,this.onRejected=typeof ts=="function"?ts:null,this.resolve=ss,this.reject=ns,this.psd=rs}function Be(es,ts){try{ts(ss=>{if(es._state===null){if(ss===es)throw new TypeError("A promise cannot be resolved with itself.");var ns=es._lib&&Ue();ss&&typeof ss.then=="function"?Be(es,(rs,os)=>{ss instanceof je?ss._then(rs,os):ss.then(rs,os)}):(es._state=!0,es._value=ss,Re(es)),ns&&Le()}},Te.bind(null,es))}catch(ss){Te(es,ss)}}function Te(es,ts){if(ke.push(ts),es._state===null){var ss=es._lib&&Ue();ts=Pe(ts),es._state=!1,es._value=ts,R&&ts!==null&&typeof ts=="object"&&!ts._promise&&function(ns,rs,os){try{ns.apply(null,os)}catch{}}(()=>{var ns=d(ts,"stack");ts._promise=es,l(ts,"stack",{get:()=>ve?ns&&(ns.get?ns.get.apply(ts):ns.value):es.stack})}),function(ns){xe.some(rs=>rs._value===ns._value)||xe.push(ns)}(es),Re(es),ss&&Le()}}function Re(es){var ts=es._listeners;es._listeners=[];for(var ss=0,ns=ts.length;ss<ns;++ss)Fe(es,ts[ss]);var rs=es._PSD;--rs.ref||rs.finalize(),Ae===0&&(++Ae,be(()=>{--Ae==0&&Ve()},[]))}function Fe(es,ts){if(es._state!==null){var ss=es._state?ts.onFulfilled:ts.onRejected;if(ss===null)return(es._state?ts.resolve:ts.reject)(es._value);++ts.psd.ref,++Ae,be(Me,[ss,es,ts])}else es._listeners.push(ts)}function Me(es,ts,ss){try{Ee=ts;var ns,rs=ts._value;ts._state?ns=es(rs):(ke.length&&(ke=[]),ns=es(rs),ke.indexOf(rs)===-1&&function(os){for(var as=xe.length;as;)if(xe[--as]._value===os._value)return void xe.splice(as,1)}(ts)),ss.resolve(ns)}catch(os){ss.reject(os)}finally{Ee=null,--Ae==0&&Ve(),--ss.psd.ref||ss.psd.finalize()}}function Ne(es,ts,ss){if(ts.length===ss)return ts;var ns="";if(es._state===!1){var rs,os,as=es._value;as!=null?(rs=as.name||"Error",os=as.message||as,ns=$(as,0)):(rs=as,os=""),ts.push(rs+(os?": "+os:"")+ns)}return R&&((ns=$(es._stackHolder,2))&&ts.indexOf(ns)===-1&&ts.push(ns),es._prev&&Ne(es._prev,ts,ss)),ts}function qe(es,ts){var ss=ts?ts._numPrev+1:0;ss<100&&(es._prev=ts,es._numPrev=ss)}function $e(){Ue()&&Le()}function Ue(){var es=_e;return _e=!1,we=!1,es}function Le(){var es,ts,ss;do for(;Se.length>0;)for(es=Se,Se=[],ss=es.length,ts=0;ts<ss;++ts){var ns=es[ts];ns[0].apply(null,ns[1])}while(Se.length>0);_e=!0,we=!0}function Ve(){var es=xe;xe=[],es.forEach(ns=>{ns._PSD.onunhandled.call(null,ns._value,ns)});for(var ts=Ce.slice(0),ss=ts.length;ss;)ts[--ss]()}function We(es){return new je(le,!1,es)}function Ye(es,ts){var ss=Oe;return function(){var ns=Ue(),rs=Oe;try{return it(ss,!0),es.apply(this,arguments)}catch(os){ts&&ts(os)}finally{it(rs,!1),ns&&Le()}}}a(je.prototype,{then:De,_then:function(es,ts){Fe(this,new Ie(null,null,es,ts,Oe))},catch:function(es){if(arguments.length===1)return this.then(null,es);var ts=arguments[0],ss=arguments[1];return typeof ts=="function"?this.then(null,ns=>ns instanceof ts?ss(ns):We(ns)):this.then(null,ns=>ns&&ns.name===ts?ss(ns):We(ns))},finally:function(es){return this.then(ts=>(es(),ts),ts=>(es(),We(ts)))},stack:{get:function(){if(this._stack)return this._stack;try{ve=!0;var es=Ne(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=es),es}finally{ve=!1}}},timeout:function(es,ts){return es<1/0?new je((ss,ns)=>{var rs=setTimeout(()=>ns(new X.Timeout(ts)),es);this.then(ss,ns).finally(clearTimeout.bind(null,rs))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&l(je.prototype,Symbol.toStringTag,"Dexie.Promise"),Ke.env=ot(),a(je,{all:function(){var es=B.apply(null,arguments).map(nt);return new je(function(ts,ss){es.length===0&&ts([]);var ns=es.length;es.forEach((rs,os)=>je.resolve(rs).then(as=>{es[os]=as,--ns||ts(es)},ss))})},resolve:es=>{if(es instanceof je)return es;if(es&&typeof es.then=="function")return new je((ss,ns)=>{es.then(ss,ns)});var ts=new je(le,!0,es);return qe(ts,Ee),ts},reject:We,race:function(){var es=B.apply(null,arguments).map(nt);return new je((ts,ss)=>{es.map(ns=>je.resolve(ns).then(ts,ss))})},PSD:{get:()=>Oe,set:es=>Oe=es},totalEchoes:{get:()=>Xe},newPSD:Ze,usePSD:at,scheduler:{get:()=>be,set:es=>{be=es}},rejectionMapper:{get:()=>Pe,set:es=>{Pe=es}},follow:(es,ts)=>new je((ss,ns)=>Ze((rs,os)=>{var as=Oe;as.unhandleds=[],as.onunhandled=os,as.finalize=re(function(){(function(cs){function ls(){cs(),Ce.splice(Ce.indexOf(ls),1)}Ce.push(ls),++Ae,be(()=>{--Ae==0&&Ve()},[])})(()=>{this.unhandleds.length===0?rs():os(this.unhandleds[0])})},as.finalize),es()},ts,ss,ns))}),ye&&(ye.allSettled&&l(je,"allSettled",function(){const es=B.apply(null,arguments).map(nt);return new je(ts=>{es.length===0&&ts([]);let ss=es.length;const ns=new Array(ss);es.forEach((rs,os)=>je.resolve(rs).then(as=>ns[os]={status:"fulfilled",value:as},as=>ns[os]={status:"rejected",reason:as}).then(()=>--ss||ts(ns)))})}),ye.any&&typeof AggregateError<"u"&&l(je,"any",function(){const es=B.apply(null,arguments).map(nt);return new je((ts,ss)=>{es.length===0&&ss(new AggregateError([]));let ns=es.length;const rs=new Array(ns);es.forEach((os,as)=>je.resolve(os).then(cs=>ts(cs),cs=>{rs[as]=cs,--ns||ss(new AggregateError(rs))}))})}));const ze={awaits:0,echoes:0,id:0};var Ge=0,He=[],Qe=0,Xe=0,Je=0;function Ze(es,ts,ss,ns){var rs=Oe,os=Object.create(rs);os.parent=rs,os.ref=0,os.global=!1,os.id=++Je;var as=Ke.env;os.env=me?{Promise:je,PromiseProp:{value:je,configurable:!0,writable:!0},all:je.all,race:je.race,allSettled:je.allSettled,any:je.any,resolve:je.resolve,reject:je.reject,nthen:ct(as.nthen,os),gthen:ct(as.gthen,os)}:{},ts&&r$1(os,ts),++rs.ref,os.finalize=function(){--this.parent.ref||this.parent.finalize()};var cs=at(os,es,ss,ns);return os.ref===0&&os.finalize(),cs}function et(){return ze.id||(ze.id=++Ge),++ze.awaits,ze.echoes+=ce,ze.id}function tt(){return!!ze.awaits&&(--ze.awaits==0&&(ze.id=0),ze.echoes=ze.awaits*ce,!0)}function nt(es){return ze.echoes&&es&&es.constructor===ye?(et(),es.then(ts=>(tt(),ts),ts=>(tt(),ft(ts)))):es}function rt(es){++Xe,ze.echoes&&--ze.echoes!=0||(ze.echoes=ze.id=0),He.push(Oe),it(es,!0)}function st(){var es=He[He.length-1];He.pop(),it(es,!1)}function it(es,ts){var ss=Oe;if((ts?!ze.echoes||Qe++&&es===Oe:!Qe||--Qe&&es===Oe)||ut(ts?rt.bind(null,es):st),es!==Oe&&(Oe=es,ss===Ke&&(Ke.env=ot()),me)){var ns=Ke.env.Promise,rs=es.env;de.then=rs.nthen,ns.prototype.then=rs.gthen,(ss.global||es.global)&&(Object.defineProperty(e,"Promise",rs.PromiseProp),ns.all=rs.all,ns.race=rs.race,ns.resolve=rs.resolve,ns.reject=rs.reject,rs.allSettled&&(ns.allSettled=rs.allSettled),rs.any&&(ns.any=rs.any))}}function ot(){var es=e.Promise;return me?{Promise:es,PromiseProp:Object.getOwnPropertyDescriptor(e,"Promise"),all:es.all,race:es.race,allSettled:es.allSettled,any:es.any,resolve:es.resolve,reject:es.reject,nthen:de.then,gthen:es.prototype.then}:{}}function at(es,ts,ss,ns,rs){var os=Oe;try{return it(es,!0),ts(ss,ns,rs)}finally{it(os,!1)}}function ut(es){pe.call(he,es)}function lt(es,ts,ss,ns){return typeof es!="function"?es:function(){var rs=Oe;ss&&et(),it(ts,!0);try{return es.apply(this,arguments)}finally{it(rs,!1),ns&&ut(tt)}}}function ct(es,ts){return function(ss,ns){return es.call(this,lt(ss,ts),lt(ns,ts))}}(""+pe).indexOf("[native code]")===-1&&(et=tt=ee);const ht="unhandledrejection";function dt(es,ts){var ss;try{ss=ts.onuncatched(es)}catch{}if(ss!==!1)try{var ns,rs={promise:ts,reason:es};if(e.document&&document.createEvent?((ns=document.createEvent("Event")).initEvent(ht,!0,!0),r$1(ns,rs)):e.CustomEvent&&r$1(ns=new CustomEvent(ht,{detail:rs}),rs),ns&&e.dispatchEvent&&(dispatchEvent(ns),!e.PromiseRejectionEvent&&e.onunhandledrejection))try{e.onunhandledrejection(ns)}catch{}R&&ns&&!ns.defaultPrevented&&console.warn(`Unhandled rejection: ${es.stack||es}`)}catch{}}var ft=je.reject;function pt(es,ts,ss,ns){if(es.idbdb&&(es._state.openComplete||Oe.letThrough||es._vip)){var rs=es._createTransaction(ts,ss,es._dbSchema);try{rs.create(),es._state.PR1398_maxLoop=3}catch(os){return os.name===H.InvalidState&&es.isOpen()&&--es._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),es._close(),es.open().then(()=>pt(es,ts,ss,ns))):ft(os)}return rs._promise(ts,(os,as)=>Ze(()=>(Oe.trans=rs,ns(os,as,rs)))).then(os=>rs._completion.then(()=>os))}if(es._state.openComplete)return ft(new X.DatabaseClosed(es._state.dbOpenError));if(!es._state.isBeingOpened){if(!es._options.autoOpen)return ft(new X.DatabaseClosed);es.open().catch(ee)}return es._state.dbReadyPromise.then(()=>pt(es,ts,ss,ns))}const yt="3.2.7",mt="",vt=-1/0,gt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",bt="String expected.",_t=[],wt=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),xt=wt,kt=wt,Et=es=>!/(dexie\.js|dexie\.min\.js)/.test(es),Pt="__dbnames",Kt="readonly",Ot="readwrite";function St(es,ts){return es?ts?function(){return es.apply(this,arguments)&&ts.apply(this,arguments)}:es:ts}const At={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ct(es){return typeof es!="string"||/\./.test(es)?ts=>ts:ts=>(ts[es]===void 0&&es in ts&&delete(ts=O(ts))[es],ts)}class jt{_trans(ts,ss,ns){const rs=this._tx||Oe.trans,os=this.name;function as(ls,us,ds){if(!ds.schema[os])throw new X.NotFound("Table "+os+" not part of transaction");return ss(ds.idbtrans,ds)}const cs=Ue();try{return rs&&rs.db===this.db?rs===Oe.trans?rs._promise(ts,as,ns):Ze(()=>rs._promise(ts,as,ns),{trans:rs,transless:Oe.transless||Oe}):pt(this.db,ts,[this.name],as)}finally{cs&&Le()}}get(ts,ss){return ts&&ts.constructor===Object?this.where(ts).first(ss):this._trans("readonly",ns=>this.core.get({trans:ns,key:ts}).then(rs=>this.hook.reading.fire(rs))).then(ss)}where(ts){if(typeof ts=="string")return new this.db.WhereClause(this,ts);if(n(ts))return new this.db.WhereClause(this,`[${ts.join("+")}]`);const ss=t(ts);if(ss.length===1)return this.where(ss[0]).equals(ts[ss[0]]);const ns=this.schema.indexes.concat(this.schema.primKey).filter(us=>{if(us.compound&&ss.every(ds=>us.keyPath.indexOf(ds)>=0)){for(let ds=0;ds<ss.length;++ds)if(ss.indexOf(us.keyPath[ds])===-1)return!1;return!0}return!1}).sort((us,ds)=>us.keyPath.length-ds.keyPath.length)[0];if(ns&&this.db._maxKey!==mt){const us=ns.keyPath.slice(0,ss.length);return this.where(us).equals(us.map(ds=>ts[ds]))}!ns&&R&&console.warn(`The query ${JSON.stringify(ts)} on ${this.name} would benefit of a compound index [${ss.join("+")}]`);const{idxByName:rs}=this.schema,os=this.db._deps.indexedDB;function as(us,ds){try{return os.cmp(us,ds)===0}catch{return!1}}const[cs,ls]=ss.reduce(([us,ds],xs)=>{const fs=rs[xs],gs=ts[xs];return[us||fs,us||!fs?St(ds,fs&&fs.multi?Es=>{const js=b(Es,xs);return n(js)&&js.some(ps=>as(gs,ps))}:Es=>as(gs,b(Es,xs))):ds]},[null,null]);return cs?this.where(cs.name).equals(ts[cs.keyPath]).filter(ls):ns?this.filter(ls):this.where(ss).equals("")}filter(ts){return this.toCollection().and(ts)}count(ts){return this.toCollection().count(ts)}offset(ts){return this.toCollection().offset(ts)}limit(ts){return this.toCollection().limit(ts)}each(ts){return this.toCollection().each(ts)}toArray(ts){return this.toCollection().toArray(ts)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(ts){return new this.db.Collection(new this.db.WhereClause(this,n(ts)?`[${ts.join("+")}]`:ts))}reverse(){return this.toCollection().reverse()}mapToClass(ts){this.schema.mappedClass=ts;const ss=ns=>{if(!ns)return ns;const rs=Object.create(ts.prototype);for(var os in ns)if(o(ns,os))try{rs[os]=ns[os]}catch{}return rs};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=ss,this.hook("reading",ss),ts}defineClass(){return this.mapToClass(function(ts){r$1(this,ts)})}add(ts,ss){const{auto:ns,keyPath:rs}=this.schema.primKey;let os=ts;return rs&&ns&&(os=Ct(rs)(ts)),this._trans("readwrite",as=>this.core.mutate({trans:as,type:"add",keys:ss!=null?[ss]:null,values:[os]})).then(as=>as.numFailures?je.reject(as.failures[0]):as.lastResult).then(as=>{if(rs)try{_(ts,rs,as)}catch{}return as})}update(ts,ss){if(typeof ts!="object"||n(ts))return this.where(":id").equals(ts).modify(ss);{const ns=b(ts,this.schema.primKey.keyPath);if(ns===void 0)return ft(new X.InvalidArgument("Given object does not contain its primary key"));try{typeof ss!="function"?t(ss).forEach(rs=>{_(ts,rs,ss[rs])}):ss(ts,{value:ts,primKey:ns})}catch{}return this.where(":id").equals(ns).modify(ss)}}put(ts,ss){const{auto:ns,keyPath:rs}=this.schema.primKey;let os=ts;return rs&&ns&&(os=Ct(rs)(ts)),this._trans("readwrite",as=>this.core.mutate({trans:as,type:"put",values:[os],keys:ss!=null?[ss]:null})).then(as=>as.numFailures?je.reject(as.failures[0]):as.lastResult).then(as=>{if(rs)try{_(ts,rs,as)}catch{}return as})}delete(ts){return this._trans("readwrite",ss=>this.core.mutate({trans:ss,type:"delete",keys:[ts]})).then(ss=>ss.numFailures?je.reject(ss.failures[0]):void 0)}clear(){return this._trans("readwrite",ts=>this.core.mutate({trans:ts,type:"deleteRange",range:At})).then(ts=>ts.numFailures?je.reject(ts.failures[0]):void 0)}bulkGet(ts){return this._trans("readonly",ss=>this.core.getMany({keys:ts,trans:ss}).then(ns=>ns.map(rs=>this.hook.reading.fire(rs))))}bulkAdd(ts,ss,ns){const rs=Array.isArray(ss)?ss:void 0,os=(ns=ns||(rs?void 0:ss))?ns.allKeys:void 0;return this._trans("readwrite",as=>{const{auto:cs,keyPath:ls}=this.schema.primKey;if(ls&&rs)throw new X.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(rs&&rs.length!==ts.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");const us=ts.length;let ds=ls&&cs?ts.map(Ct(ls)):ts;return this.core.mutate({trans:as,type:"add",keys:rs,values:ds,wantResults:os}).then(({numFailures:xs,results:fs,lastResult:gs,failures:Es})=>{if(xs===0)return os?fs:gs;throw new G(`${this.name}.bulkAdd(): ${xs} of ${us} operations failed`,Es)})})}bulkPut(ts,ss,ns){const rs=Array.isArray(ss)?ss:void 0,os=(ns=ns||(rs?void 0:ss))?ns.allKeys:void 0;return this._trans("readwrite",as=>{const{auto:cs,keyPath:ls}=this.schema.primKey;if(ls&&rs)throw new X.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(rs&&rs.length!==ts.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");const us=ts.length;let ds=ls&&cs?ts.map(Ct(ls)):ts;return this.core.mutate({trans:as,type:"put",keys:rs,values:ds,wantResults:os}).then(({numFailures:xs,results:fs,lastResult:gs,failures:Es})=>{if(xs===0)return os?fs:gs;throw new G(`${this.name}.bulkPut(): ${xs} of ${us} operations failed`,Es)})})}bulkDelete(ts){const ss=ts.length;return this._trans("readwrite",ns=>this.core.mutate({trans:ns,type:"delete",keys:ts})).then(({numFailures:ns,lastResult:rs,failures:os})=>{if(ns===0)return rs;throw new G(`${this.name}.bulkDelete(): ${ns} of ${ss} operations failed`,os)})}}function Dt(es){var ts={},ss=function(as,cs){if(cs){for(var ls=arguments.length,us=new Array(ls-1);--ls;)us[ls-1]=arguments[ls];return ts[as].subscribe.apply(null,us),es}if(typeof as=="string")return ts[as]};ss.addEventType=os;for(var ns=1,rs=arguments.length;ns<rs;++ns)os(arguments[ns]);return ss;function os(as,cs,ls){if(typeof as!="object"){var us;cs||(cs=ae),ls||(ls=ee);var ds={subscribers:[],fire:ls,subscribe:function(xs){ds.subscribers.indexOf(xs)===-1&&(ds.subscribers.push(xs),ds.fire=cs(ds.fire,xs))},unsubscribe:function(xs){ds.subscribers=ds.subscribers.filter(function(fs){return fs!==xs}),ds.fire=ds.subscribers.reduce(cs,ls)}};return ts[as]=ss[as]=ds,ds}t(us=as).forEach(function(xs){var fs=us[xs];if(n(fs))os(xs,us[xs][0],us[xs][1]);else{if(fs!=="asap")throw new X.InvalidArgument("Invalid event config");var gs=os(xs,te,function(){for(var Es=arguments.length,js=new Array(Es);Es--;)js[Es]=arguments[Es];gs.subscribers.forEach(function(ps){v(function(){ps.apply(null,js)})})})}})}}function It(es,ts){return c(ts).from({prototype:es}),ts}function Bt(es,ts){return!(es.filter||es.algorithm||es.or)&&(ts?es.justLimit:!es.replayFilter)}function Tt(es,ts){es.filter=St(es.filter,ts)}function Rt(es,ts,ss){var ns=es.replayFilter;es.replayFilter=ns?()=>St(ns(),ts()):ts,es.justLimit=ss&&!ns}function Ft(es,ts){if(es.isPrimKey)return ts.primaryKey;const ss=ts.getIndexByKeyPath(es.index);if(!ss)throw new X.Schema("KeyPath "+es.index+" on object store "+ts.name+" is not indexed");return ss}function Mt(es,ts,ss){const ns=Ft(es,ts.schema);return ts.openCursor({trans:ss,values:!es.keysOnly,reverse:es.dir==="prev",unique:!!es.unique,query:{index:ns,range:es.range}})}function Nt(es,ts,ss,ns){const rs=es.replayFilter?St(es.filter,es.replayFilter()):es.filter;if(es.or){const os={},as=(cs,ls,us)=>{if(!rs||rs(ls,us,fs=>ls.stop(fs),fs=>ls.fail(fs))){var ds=ls.primaryKey,xs=""+ds;xs==="[object ArrayBuffer]"&&(xs=""+new Uint8Array(ds)),o(os,xs)||(os[xs]=!0,ts(cs,ls,us))}};return Promise.all([es.or._iterate(as,ss),qt(Mt(es,ns,ss),es.algorithm,as,!es.keysOnly&&es.valueMapper)])}return qt(Mt(es,ns,ss),St(es.algorithm,rs),ts,!es.keysOnly&&es.valueMapper)}function qt(es,ts,ss,ns){var rs=Ye(ns?(os,as,cs)=>ss(ns(os),as,cs):ss);return es.then(os=>{if(os)return os.start(()=>{var as=()=>os.continue();ts&&!ts(os,cs=>as=cs,cs=>{os.stop(cs),as=ee},cs=>{os.fail(cs),as=ee})||rs(os.value,os,cs=>as=cs),as()})})}function $t(es,ts){try{const ss=Ut(es),ns=Ut(ts);if(ss!==ns)return ss==="Array"?1:ns==="Array"?-1:ss==="binary"?1:ns==="binary"?-1:ss==="string"?1:ns==="string"?-1:ss==="Date"?1:ns!=="Date"?NaN:-1;switch(ss){case"number":case"Date":case"string":return es>ts?1:es<ts?-1:0;case"binary":return function(rs,os){const as=rs.length,cs=os.length,ls=as<cs?as:cs;for(let us=0;us<ls;++us)if(rs[us]!==os[us])return rs[us]<os[us]?-1:1;return as===cs?0:as<cs?-1:1}(Lt(es),Lt(ts));case"Array":return function(rs,os){const as=rs.length,cs=os.length,ls=as<cs?as:cs;for(let us=0;us<ls;++us){const ds=$t(rs[us],os[us]);if(ds!==0)return ds}return as===cs?0:as<cs?-1:1}(es,ts)}}catch{}return NaN}function Ut(es){const ts=typeof es;if(ts!=="object")return ts;if(ArrayBuffer.isView(es))return"binary";const ss=C(es);return ss==="ArrayBuffer"?"binary":ss}function Lt(es){return es instanceof Uint8Array?es:ArrayBuffer.isView(es)?new Uint8Array(es.buffer,es.byteOffset,es.byteLength):new Uint8Array(es)}class Vt{_read(ts,ss){var ns=this._ctx;return ns.error?ns.table._trans(null,ft.bind(null,ns.error)):ns.table._trans("readonly",ts).then(ss)}_write(ts){var ss=this._ctx;return ss.error?ss.table._trans(null,ft.bind(null,ss.error)):ss.table._trans("readwrite",ts,"locked")}_addAlgorithm(ts){var ss=this._ctx;ss.algorithm=St(ss.algorithm,ts)}_iterate(ts,ss){return Nt(this._ctx,ts,ss,this._ctx.table.core)}clone(ts){var ss=Object.create(this.constructor.prototype),ns=Object.create(this._ctx);return ts&&r$1(ns,ts),ss._ctx=ns,ss}raw(){return this._ctx.valueMapper=null,this}each(ts){var ss=this._ctx;return this._read(ns=>Nt(ss,ts,ns,ss.table.core))}count(ts){return this._read(ss=>{const ns=this._ctx,rs=ns.table.core;if(Bt(ns,!0))return rs.count({trans:ss,query:{index:Ft(ns,rs.schema),range:ns.range}}).then(as=>Math.min(as,ns.limit));var os=0;return Nt(ns,()=>(++os,!1),ss,rs).then(()=>os)}).then(ts)}sortBy(ts,ss){const ns=ts.split(".").reverse(),rs=ns[0],os=ns.length-1;function as(us,ds){return ds?as(us[ns[ds]],ds-1):us[rs]}var cs=this._ctx.dir==="next"?1:-1;function ls(us,ds){var xs=as(us,os),fs=as(ds,os);return xs<fs?-cs:xs>fs?cs:0}return this.toArray(function(us){return us.sort(ls)}).then(ss)}toArray(ts){return this._read(ss=>{var ns=this._ctx;if(ns.dir==="next"&&Bt(ns,!0)&&ns.limit>0){const{valueMapper:rs}=ns,os=Ft(ns,ns.table.core.schema);return ns.table.core.query({trans:ss,limit:ns.limit,values:!0,query:{index:os,range:ns.range}}).then(({result:as})=>rs?as.map(rs):as)}{const rs=[];return Nt(ns,os=>rs.push(os),ss,ns.table.core).then(()=>rs)}},ts)}offset(ts){var ss=this._ctx;return ts<=0||(ss.offset+=ts,Bt(ss)?Rt(ss,()=>{var ns=ts;return(rs,os)=>ns===0||(ns===1?(--ns,!1):(os(()=>{rs.advance(ns),ns=0}),!1))}):Rt(ss,()=>{var ns=ts;return()=>--ns<0})),this}limit(ts){return this._ctx.limit=Math.min(this._ctx.limit,ts),Rt(this._ctx,()=>{var ss=ts;return function(ns,rs,os){return--ss<=0&&rs(os),ss>=0}},!0),this}until(ts,ss){return Tt(this._ctx,function(ns,rs,os){return!ts(ns.value)||(rs(os),ss)}),this}first(ts){return this.limit(1).toArray(function(ss){return ss[0]}).then(ts)}last(ts){return this.reverse().first(ts)}filter(ts){var ss,ns;return Tt(this._ctx,function(rs){return ts(rs.value)}),ss=this._ctx,ns=ts,ss.isMatch=St(ss.isMatch,ns),this}and(ts){return this.filter(ts)}or(ts){return new this.db.WhereClause(this._ctx.table,ts,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(ts){var ss=this._ctx;return ss.keysOnly=!ss.isMatch,this.each(function(ns,rs){ts(rs.key,rs)})}eachUniqueKey(ts){return this._ctx.unique="unique",this.eachKey(ts)}eachPrimaryKey(ts){var ss=this._ctx;return ss.keysOnly=!ss.isMatch,this.each(function(ns,rs){ts(rs.primaryKey,rs)})}keys(ts){var ss=this._ctx;ss.keysOnly=!ss.isMatch;var ns=[];return this.each(function(rs,os){ns.push(os.key)}).then(function(){return ns}).then(ts)}primaryKeys(ts){var ss=this._ctx;if(ss.dir==="next"&&Bt(ss,!0)&&ss.limit>0)return this._read(rs=>{var os=Ft(ss,ss.table.core.schema);return ss.table.core.query({trans:rs,values:!1,limit:ss.limit,query:{index:os,range:ss.range}})}).then(({result:rs})=>rs).then(ts);ss.keysOnly=!ss.isMatch;var ns=[];return this.each(function(rs,os){ns.push(os.primaryKey)}).then(function(){return ns}).then(ts)}uniqueKeys(ts){return this._ctx.unique="unique",this.keys(ts)}firstKey(ts){return this.limit(1).keys(function(ss){return ss[0]}).then(ts)}lastKey(ts){return this.reverse().firstKey(ts)}distinct(){var ts=this._ctx,ss=ts.index&&ts.table.schema.idxByName[ts.index];if(!ss||!ss.multi)return this;var ns={};return Tt(this._ctx,function(rs){var os=rs.primaryKey.toString(),as=o(ns,os);return ns[os]=!0,!as}),this}modify(ts){var ss=this._ctx;return this._write(ns=>{var rs;if(typeof ts=="function")rs=ts;else{var os=t(ts),as=os.length;rs=function(js){for(var ps=!1,ms=0;ms<as;++ms){var hs=os[ms],vs=ts[hs];b(js,hs)!==vs&&(_(js,hs,vs),ps=!0)}return ps}}const cs=ss.table.core,{outbound:ls,extractKey:us}=cs.schema.primaryKey,ds=this.db._options.modifyChunkSize||200,xs=[];let fs=0;const gs=[],Es=(js,ps)=>{const{failures:ms,numFailures:hs}=ps;fs+=js-hs;for(let vs of t(ms))xs.push(ms[vs])};return this.clone().primaryKeys().then(js=>{const ps=ms=>{const hs=Math.min(ds,js.length-ms);return cs.getMany({trans:ns,keys:js.slice(ms,ms+hs),cache:"immutable"}).then(vs=>{const ws=[],ys=[],Rs=ls?[]:null,bs=[];for(let Ss=0;Ss<hs;++Ss){const Ts=vs[Ss],Cs={value:O(Ts),primKey:js[ms+Ss]};rs.call(Cs,Cs.value,Cs)!==!1&&(Cs.value==null?bs.push(js[ms+Ss]):ls||$t(us(Ts),us(Cs.value))===0?(ys.push(Cs.value),ls&&Rs.push(js[ms+Ss])):(bs.push(js[ms+Ss]),ws.push(Cs.value)))}const Ns=Bt(ss)&&ss.limit===1/0&&(typeof ts!="function"||ts===Wt)&&{index:ss.index,range:ss.range};return Promise.resolve(ws.length>0&&cs.mutate({trans:ns,type:"add",values:ws}).then(Ss=>{for(let Ts in Ss.failures)bs.splice(parseInt(Ts),1);Es(ws.length,Ss)})).then(()=>(ys.length>0||Ns&&typeof ts=="object")&&cs.mutate({trans:ns,type:"put",keys:Rs,values:ys,criteria:Ns,changeSpec:typeof ts!="function"&&ts}).then(Ss=>Es(ys.length,Ss))).then(()=>(bs.length>0||Ns&&ts===Wt)&&cs.mutate({trans:ns,type:"delete",keys:bs,criteria:Ns}).then(Ss=>Es(bs.length,Ss))).then(()=>js.length>ms+hs&&ps(ms+ds))})};return ps(0).then(()=>{if(xs.length>0)throw new z("Error modifying one or more objects",xs,fs,gs);return js.length})})})}delete(){var ts=this._ctx,ss=ts.range;return Bt(ts)&&(ts.isPrimKey&&!kt||ss.type===3)?this._write(ns=>{const{primaryKey:rs}=ts.table.core.schema,os=ss;return ts.table.core.count({trans:ns,query:{index:rs,range:os}}).then(as=>ts.table.core.mutate({trans:ns,type:"deleteRange",range:os}).then(({failures:cs,lastResult:ls,results:us,numFailures:ds})=>{if(ds)throw new z("Could not delete some values",Object.keys(cs).map(xs=>cs[xs]),as-ds);return as-ds}))}):this.modify(Wt)}}const Wt=(es,ts)=>ts.value=null;function Yt(es,ts){return es<ts?-1:es===ts?0:1}function zt(es,ts){return es>ts?-1:es===ts?0:1}function Gt(es,ts,ss){var ns=es instanceof en?new es.Collection(es):es;return ns._ctx.error=ss?new ss(ts):new TypeError(ts),ns}function Ht(es){return new es.Collection(es,()=>Zt("")).limit(0)}function Qt(es,ts,ss,ns,rs,os){for(var as=Math.min(es.length,ns.length),cs=-1,ls=0;ls<as;++ls){var us=ts[ls];if(us!==ns[ls])return rs(es[ls],ss[ls])<0?es.substr(0,ls)+ss[ls]+ss.substr(ls+1):rs(es[ls],ns[ls])<0?es.substr(0,ls)+ns[ls]+ss.substr(ls+1):cs>=0?es.substr(0,cs)+ts[cs]+ss.substr(cs+1):null;rs(es[ls],us)<0&&(cs=ls)}return as<ns.length&&os==="next"?es+ss.substr(es.length):as<es.length&&os==="prev"?es.substr(0,ss.length):cs<0?null:es.substr(0,cs)+ns[cs]+ss.substr(cs+1)}function Xt(es,ts,ss,ns){var rs,os,as,cs,ls,us,ds,xs=ss.length;if(!ss.every(js=>typeof js=="string"))return Gt(es,bt);function fs(js){rs=function(ms){return ms==="next"?hs=>hs.toUpperCase():hs=>hs.toLowerCase()}(js),os=function(ms){return ms==="next"?hs=>hs.toLowerCase():hs=>hs.toUpperCase()}(js),as=js==="next"?Yt:zt;var ps=ss.map(function(ms){return{lower:os(ms),upper:rs(ms)}}).sort(function(ms,hs){return as(ms.lower,hs.lower)});cs=ps.map(function(ms){return ms.upper}),ls=ps.map(function(ms){return ms.lower}),us=js,ds=js==="next"?"":ns}fs("next");var gs=new es.Collection(es,()=>Jt(cs[0],ls[xs-1]+ns));gs._ondirectionchange=function(js){fs(js)};var Es=0;return gs._addAlgorithm(function(js,ps,ms){var hs=js.key;if(typeof hs!="string")return!1;var vs=os(hs);if(ts(vs,ls,Es))return!0;for(var ws=null,ys=Es;ys<xs;++ys){var Rs=Qt(hs,vs,cs[ys],ls[ys],as,us);Rs===null&&ws===null?Es=ys+1:(ws===null||as(ws,Rs)>0)&&(ws=Rs)}return ps(ws!==null?function(){js.continue(ws+ds)}:ms),!1}),gs}function Jt(es,ts,ss,ns){return{type:2,lower:es,upper:ts,lowerOpen:ss,upperOpen:ns}}function Zt(es){return{type:1,lower:es,upper:es}}class en{get Collection(){return this._ctx.table.db.Collection}between(ts,ss,ns,rs){ns=ns!==!1,rs=rs===!0;try{return this._cmp(ts,ss)>0||this._cmp(ts,ss)===0&&(ns||rs)&&(!ns||!rs)?Ht(this):new this.Collection(this,()=>Jt(ts,ss,!ns,!rs))}catch{return Gt(this,gt)}}equals(ts){return ts==null?Gt(this,gt):new this.Collection(this,()=>Zt(ts))}above(ts){return ts==null?Gt(this,gt):new this.Collection(this,()=>Jt(ts,void 0,!0))}aboveOrEqual(ts){return ts==null?Gt(this,gt):new this.Collection(this,()=>Jt(ts,void 0,!1))}below(ts){return ts==null?Gt(this,gt):new this.Collection(this,()=>Jt(void 0,ts,!1,!0))}belowOrEqual(ts){return ts==null?Gt(this,gt):new this.Collection(this,()=>Jt(void 0,ts))}startsWith(ts){return typeof ts!="string"?Gt(this,bt):this.between(ts,ts+mt,!0,!0)}startsWithIgnoreCase(ts){return ts===""?this.startsWith(ts):Xt(this,(ss,ns)=>ss.indexOf(ns[0])===0,[ts],mt)}equalsIgnoreCase(ts){return Xt(this,(ss,ns)=>ss===ns[0],[ts],"")}anyOfIgnoreCase(){var ts=B.apply(I,arguments);return ts.length===0?Ht(this):Xt(this,(ss,ns)=>ns.indexOf(ss)!==-1,ts,"")}startsWithAnyOfIgnoreCase(){var ts=B.apply(I,arguments);return ts.length===0?Ht(this):Xt(this,(ss,ns)=>ns.some(rs=>ss.indexOf(rs)===0),ts,mt)}anyOf(){const ts=B.apply(I,arguments);let ss=this._cmp;try{ts.sort(ss)}catch{return Gt(this,gt)}if(ts.length===0)return Ht(this);const ns=new this.Collection(this,()=>Jt(ts[0],ts[ts.length-1]));ns._ondirectionchange=os=>{ss=os==="next"?this._ascending:this._descending,ts.sort(ss)};let rs=0;return ns._addAlgorithm((os,as,cs)=>{const ls=os.key;for(;ss(ls,ts[rs])>0;)if(++rs,rs===ts.length)return as(cs),!1;return ss(ls,ts[rs])===0||(as(()=>{os.continue(ts[rs])}),!1)}),ns}notEqual(ts){return this.inAnyRange([[vt,ts],[ts,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const ts=B.apply(I,arguments);if(ts.length===0)return new this.Collection(this);try{ts.sort(this._ascending)}catch{return Gt(this,gt)}const ss=ts.reduce((ns,rs)=>ns?ns.concat([[ns[ns.length-1][1],rs]]):[[vt,rs]],null);return ss.push([ts[ts.length-1],this.db._maxKey]),this.inAnyRange(ss,{includeLowers:!1,includeUppers:!1})}inAnyRange(ts,ss){const ns=this._cmp,rs=this._ascending,os=this._descending,as=this._min,cs=this._max;if(ts.length===0)return Ht(this);if(!ts.every(hs=>hs[0]!==void 0&&hs[1]!==void 0&&rs(hs[0],hs[1])<=0))return Gt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",X.InvalidArgument);const ls=!ss||ss.includeLowers!==!1,us=ss&&ss.includeUppers===!0;let ds,xs=rs;function fs(hs,vs){return xs(hs[0],vs[0])}try{ds=ts.reduce(function(hs,vs){let ws=0,ys=hs.length;for(;ws<ys;++ws){const Rs=hs[ws];if(ns(vs[0],Rs[1])<0&&ns(vs[1],Rs[0])>0){Rs[0]=as(Rs[0],vs[0]),Rs[1]=cs(Rs[1],vs[1]);break}}return ws===ys&&hs.push(vs),hs},[]),ds.sort(fs)}catch{return Gt(this,gt)}let gs=0;const Es=us?hs=>rs(hs,ds[gs][1])>0:hs=>rs(hs,ds[gs][1])>=0,js=ls?hs=>os(hs,ds[gs][0])>0:hs=>os(hs,ds[gs][0])>=0;let ps=Es;const ms=new this.Collection(this,()=>Jt(ds[0][0],ds[ds.length-1][1],!ls,!us));return ms._ondirectionchange=hs=>{hs==="next"?(ps=Es,xs=rs):(ps=js,xs=os),ds.sort(fs)},ms._addAlgorithm((hs,vs,ws)=>{for(var ys=hs.key;ps(ys);)if(++gs,gs===ds.length)return vs(ws),!1;return!!function(Rs){return!Es(Rs)&&!js(Rs)}(ys)||(this._cmp(ys,ds[gs][1])===0||this._cmp(ys,ds[gs][0])===0||vs(()=>{xs===rs?hs.continue(ds[gs][0]):hs.continue(ds[gs][1])}),!1)}),ms}startsWithAnyOf(){const ts=B.apply(I,arguments);return ts.every(ss=>typeof ss=="string")?ts.length===0?Ht(this):this.inAnyRange(ts.map(ss=>[ss,ss+mt])):Gt(this,"startsWithAnyOf() only works with strings")}}function tn(es){return Ye(function(ts){return nn(ts),es(ts.target.error),!1})}function nn(es){es.stopPropagation&&es.stopPropagation(),es.preventDefault&&es.preventDefault()}const rn="storagemutated",sn="x-storagemutated-1",on=Dt(null,rn);class an{_lock(){return m(!Oe.global),++this._reculock,this._reculock!==1||Oe.global||(Oe.lockOwnerFor=this),this}_unlock(){if(m(!Oe.global),--this._reculock==0)for(Oe.global||(Oe.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var ts=this._blockedFuncs.shift();try{at(ts[1],ts[0])}catch{}}return this}_locked(){return this._reculock&&Oe.lockOwnerFor!==this}create(ts){if(!this.mode)return this;const ss=this.db.idbdb,ns=this.db._state.dbOpenError;if(m(!this.idbtrans),!ts&&!ss)switch(ns&&ns.name){case"DatabaseClosedError":throw new X.DatabaseClosed(ns);case"MissingAPIError":throw new X.MissingAPI(ns.message,ns);default:throw new X.OpenFailed(ns)}if(!this.active)throw new X.TransactionInactive;return m(this._completion._state===null),(ts=this.idbtrans=ts||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):ss.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ye(rs=>{nn(rs),this._reject(ts.error)}),ts.onabort=Ye(rs=>{nn(rs),this.active&&this._reject(new X.Abort(ts.error)),this.active=!1,this.on("abort").fire(rs)}),ts.oncomplete=Ye(()=>{this.active=!1,this._resolve(),"mutatedParts"in ts&&on.storagemutated.fire(ts.mutatedParts)}),this}_promise(ts,ss,ns){if(ts==="readwrite"&&this.mode!=="readwrite")return ft(new X.ReadOnly("Transaction is readonly"));if(!this.active)return ft(new X.TransactionInactive);if(this._locked())return new je((os,as)=>{this._blockedFuncs.push([()=>{this._promise(ts,ss,ns).then(os,as)},Oe])});if(ns)return Ze(()=>{var os=new je((as,cs)=>{this._lock();const ls=ss(as,cs,this);ls&&ls.then&&ls.then(as,cs)});return os.finally(()=>this._unlock()),os._lib=!0,os});var rs=new je((os,as)=>{var cs=ss(os,as,this);cs&&cs.then&&cs.then(os,as)});return rs._lib=!0,rs}_root(){return this.parent?this.parent._root():this}waitFor(ts){var ss=this._root();const ns=je.resolve(ts);if(ss._waitingFor)ss._waitingFor=ss._waitingFor.then(()=>ns);else{ss._waitingFor=ns,ss._waitingQueue=[];var rs=ss.idbtrans.objectStore(ss.storeNames[0]);(function as(){for(++ss._spinCount;ss._waitingQueue.length;)ss._waitingQueue.shift()();ss._waitingFor&&(rs.get(-1/0).onsuccess=as)})()}var os=ss._waitingFor;return new je((as,cs)=>{ns.then(ls=>ss._waitingQueue.push(Ye(as.bind(null,ls))),ls=>ss._waitingQueue.push(Ye(cs.bind(null,ls)))).finally(()=>{ss._waitingFor===os&&(ss._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new X.Abort))}table(ts){const ss=this._memoizedTables||(this._memoizedTables={});if(o(ss,ts))return ss[ts];const ns=this.schema[ts];if(!ns)throw new X.NotFound("Table "+ts+" not part of transaction");const rs=new this.db.Table(ts,ns,this);return rs.core=this.db.core.table(ts),ss[ts]=rs,rs}}function un(es,ts,ss,ns,rs,os,as){return{name:es,keyPath:ts,unique:ss,multi:ns,auto:rs,compound:os,src:(ss&&!as?"&":"")+(ns?"*":"")+(rs?"++":"")+ln(ts)}}function ln(es){return typeof es=="string"?es:es?"["+[].join.call(es,"+")+"]":""}function cn(es,ts,ss){return{name:es,primKey:ts,indexes:ss,mappedClass:null,idxByName:g(ss,ns=>[ns.name,ns])}}let hn=es=>{try{return es.only([[]]),hn=()=>[[]],[[]]}catch{return hn=()=>mt,mt}};function dn(es){return es==null?()=>{}:typeof es=="string"?function(ts){return ts.split(".").length===1?ns=>ns[ts]:ns=>b(ns,ts)}(es):ts=>b(ts,es)}function fn(es){return[].slice.call(es)}let pn=0;function yn(es){return es==null?":id":typeof es=="string"?es:`[${es.join("+")}]`}function mn(es,ts,ss){function ns(ls){if(ls.type===3)return null;if(ls.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:us,upper:ds,lowerOpen:xs,upperOpen:fs}=ls;return us===void 0?ds===void 0?null:ts.upperBound(ds,!!fs):ds===void 0?ts.lowerBound(us,!!xs):ts.bound(us,ds,!!xs,!!fs)}const{schema:rs,hasGetAll:os}=function(ls,us){const ds=fn(ls.objectStoreNames);return{schema:{name:ls.name,tables:ds.map(xs=>us.objectStore(xs)).map(xs=>{const{keyPath:fs,autoIncrement:gs}=xs,Es=n(fs),js=fs==null,ps={},ms={name:xs.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:js,compound:Es,keyPath:fs,autoIncrement:gs,unique:!0,extractKey:dn(fs)},indexes:fn(xs.indexNames).map(hs=>xs.index(hs)).map(hs=>{const{name:vs,unique:ws,multiEntry:ys,keyPath:Rs}=hs,bs={name:vs,compound:n(Rs),keyPath:Rs,unique:ws,multiEntry:ys,extractKey:dn(Rs)};return ps[yn(Rs)]=bs,bs}),getIndexByKeyPath:hs=>ps[yn(hs)]};return ps[":id"]=ms.primaryKey,fs!=null&&(ps[yn(fs)]=ms.primaryKey),ms})},hasGetAll:ds.length>0&&"getAll"in us.objectStore(ds[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(es,ss),as=rs.tables.map(ls=>function(us){const ds=us.name;return{name:ds,schema:us,mutate:function({trans:xs,type:fs,keys:gs,values:Es,range:js}){return new Promise((ps,ms)=>{ps=Ye(ps);const hs=xs.objectStore(ds),vs=hs.keyPath==null,ws=fs==="put"||fs==="add";if(!ws&&fs!=="delete"&&fs!=="deleteRange")throw new Error("Invalid operation type: "+fs);const{length:ys}=gs||Es||{length:1};if(gs&&Es&&gs.length!==Es.length)throw new Error("Given keys array must have same length as given values array.");if(ys===0)return ps({numFailures:0,failures:{},results:[],lastResult:void 0});let Rs;const bs=[],Ns=[];let Ss=0;const Ts=Ms=>{++Ss,nn(Ms)};if(fs==="deleteRange"){if(js.type===4)return ps({numFailures:Ss,failures:Ns,results:[],lastResult:void 0});js.type===3?bs.push(Rs=hs.clear()):bs.push(Rs=hs.delete(ns(js)))}else{const[Ms,Is]=ws?vs?[Es,gs]:[Es,null]:[gs,null];if(ws)for(let Qs=0;Qs<ys;++Qs)bs.push(Rs=Is&&Is[Qs]!==void 0?hs[fs](Ms[Qs],Is[Qs]):hs[fs](Ms[Qs])),Rs.onerror=Ts;else for(let Qs=0;Qs<ys;++Qs)bs.push(Rs=hs[fs](Ms[Qs])),Rs.onerror=Ts}const Cs=Ms=>{const Is=Ms.target.result;bs.forEach((Qs,Ys)=>Qs.error!=null&&(Ns[Ys]=Qs.error)),ps({numFailures:Ss,failures:Ns,results:fs==="delete"?gs:bs.map(Qs=>Qs.result),lastResult:Is})};Rs.onerror=Ms=>{Ts(Ms),Cs(Ms)},Rs.onsuccess=Cs})},getMany:({trans:xs,keys:fs})=>new Promise((gs,Es)=>{gs=Ye(gs);const js=xs.objectStore(ds),ps=fs.length,ms=new Array(ps);let hs,vs=0,ws=0;const ys=bs=>{const Ns=bs.target;ms[Ns._pos]=Ns.result,++ws===vs&&gs(ms)},Rs=tn(Es);for(let bs=0;bs<ps;++bs)fs[bs]!=null&&(hs=js.get(fs[bs]),hs._pos=bs,hs.onsuccess=ys,hs.onerror=Rs,++vs);vs===0&&gs(ms)}),get:({trans:xs,key:fs})=>new Promise((gs,Es)=>{gs=Ye(gs);const js=xs.objectStore(ds).get(fs);js.onsuccess=ps=>gs(ps.target.result),js.onerror=tn(Es)}),query:function(xs){return fs=>new Promise((gs,Es)=>{gs=Ye(gs);const{trans:js,values:ps,limit:ms,query:hs}=fs,vs=ms===1/0?void 0:ms,{index:ws,range:ys}=hs,Rs=js.objectStore(ds),bs=ws.isPrimaryKey?Rs:Rs.index(ws.name),Ns=ns(ys);if(ms===0)return gs({result:[]});if(xs){const Ss=ps?bs.getAll(Ns,vs):bs.getAllKeys(Ns,vs);Ss.onsuccess=Ts=>gs({result:Ts.target.result}),Ss.onerror=tn(Es)}else{let Ss=0;const Ts=ps||!("openKeyCursor"in bs)?bs.openCursor(Ns):bs.openKeyCursor(Ns),Cs=[];Ts.onsuccess=Ms=>{const Is=Ts.result;return Is?(Cs.push(ps?Is.value:Is.primaryKey),++Ss===ms?gs({result:Cs}):void Is.continue()):gs({result:Cs})},Ts.onerror=tn(Es)}})}(os),openCursor:function({trans:xs,values:fs,query:gs,reverse:Es,unique:js}){return new Promise((ps,ms)=>{ps=Ye(ps);const{index:hs,range:vs}=gs,ws=xs.objectStore(ds),ys=hs.isPrimaryKey?ws:ws.index(hs.name),Rs=Es?js?"prevunique":"prev":js?"nextunique":"next",bs=fs||!("openKeyCursor"in ys)?ys.openCursor(ns(vs),Rs):ys.openKeyCursor(ns(vs),Rs);bs.onerror=tn(ms),bs.onsuccess=Ye(Ns=>{const Ss=bs.result;if(!Ss)return void ps(null);Ss.___id=++pn,Ss.done=!1;const Ts=Ss.continue.bind(Ss);let Cs=Ss.continuePrimaryKey;Cs&&(Cs=Cs.bind(Ss));const Ms=Ss.advance.bind(Ss),Is=()=>{throw new Error("Cursor not stopped")};Ss.trans=xs,Ss.stop=Ss.continue=Ss.continuePrimaryKey=Ss.advance=()=>{throw new Error("Cursor not started")},Ss.fail=Ye(ms),Ss.next=function(){let Qs=1;return this.start(()=>Qs--?this.continue():this.stop()).then(()=>this)},Ss.start=Qs=>{const Ys=new Promise((Vs,Ks)=>{Vs=Ye(Vs),bs.onerror=tn(Ks),Ss.fail=Ks,Ss.stop=Ds=>{Ss.stop=Ss.continue=Ss.continuePrimaryKey=Ss.advance=Is,Vs(Ds)}}),Zs=()=>{if(bs.result)try{Qs()}catch(Vs){Ss.fail(Vs)}else Ss.done=!0,Ss.start=()=>{throw new Error("Cursor behind last entry")},Ss.stop()};return bs.onsuccess=Ye(Vs=>{bs.onsuccess=Zs,Zs()}),Ss.continue=Ts,Ss.continuePrimaryKey=Cs,Ss.advance=Ms,Zs(),Ys},ps(Ss)},ms)})},count({query:xs,trans:fs}){const{index:gs,range:Es}=xs;return new Promise((js,ps)=>{const ms=fs.objectStore(ds),hs=gs.isPrimaryKey?ms:ms.index(gs.name),vs=ns(Es),ws=vs?hs.count(vs):hs.count();ws.onsuccess=Ye(ys=>js(ys.target.result)),ws.onerror=tn(ps)})}}}(ls)),cs={};return as.forEach(ls=>cs[ls.name]=ls),{stack:"dbcore",transaction:es.transaction.bind(es),table(ls){if(!cs[ls])throw new Error(`Table '${ls}' not found`);return cs[ls]},MIN_KEY:-1/0,MAX_KEY:hn(ts),schema:rs}}function vn({_novip:es},ts){const ss=ts.db,ns=function(rs,os,{IDBKeyRange:as,indexedDB:cs},ls){return{dbcore:function(ds,xs){return xs.reduce((fs,{create:gs})=>({...fs,...gs(fs)}),ds)}(mn(os,as,ls),rs.dbcore)}}(es._middlewares,ss,es._deps,ts);es.core=ns.dbcore,es.tables.forEach(rs=>{const os=rs.name;es.core.schema.tables.some(as=>as.name===os)&&(rs.core=es.core.table(os),es[os]instanceof es.Table&&(es[os].core=rs.core))})}function gn({_novip:es},ts,ss,ns){ss.forEach(rs=>{const os=ns[rs];ts.forEach(as=>{const cs=d(as,rs);(!cs||"value"in cs&&cs.value===void 0)&&(as===es.Transaction.prototype||as instanceof es.Transaction?l(as,rs,{get(){return this.table(rs)},set(ls){u(this,rs,{value:ls,writable:!0,configurable:!0,enumerable:!0})}}):as[rs]=new es.Table(rs,os))})})}function bn({_novip:es},ts){ts.forEach(ss=>{for(let ns in ss)ss[ns]instanceof es.Table&&delete ss[ns]})}function _n(es,ts){return es._cfg.version-ts._cfg.version}function wn(es,ts,ss,ns){const rs=es._dbSchema,os=es._createTransaction("readwrite",es._storeNames,rs);os.create(ss),os._completion.catch(ns);const as=os._reject.bind(os),cs=Oe.transless||Oe;Ze(()=>{Oe.trans=os,Oe.transless=cs,ts===0?(t(rs).forEach(ls=>{kn(ss,ls,rs[ls].primKey,rs[ls].indexes)}),vn(es,ss),je.follow(()=>es.on.populate.fire(os)).catch(as)):function({_novip:ls},us,ds,xs){const fs=[],gs=ls._versions;let Es=ls._dbSchema=Pn(ls,ls.idbdb,xs),js=!1;const ps=gs.filter(hs=>hs._cfg.version>=us);function ms(){return fs.length?je.resolve(fs.shift()(ds.idbtrans)).then(ms):je.resolve()}return ps.forEach(hs=>{fs.push(()=>{const vs=Es,ws=hs._cfg.dbschema;Kn(ls,vs,xs),Kn(ls,ws,xs),Es=ls._dbSchema=ws;const ys=xn(vs,ws);ys.add.forEach(bs=>{kn(xs,bs[0],bs[1].primKey,bs[1].indexes)}),ys.change.forEach(bs=>{if(bs.recreate)throw new X.Upgrade("Not yet support for changing primary key");{const Ns=xs.objectStore(bs.name);bs.add.forEach(Ss=>En(Ns,Ss)),bs.change.forEach(Ss=>{Ns.deleteIndex(Ss.name),En(Ns,Ss)}),bs.del.forEach(Ss=>Ns.deleteIndex(Ss))}});const Rs=hs._cfg.contentUpgrade;if(Rs&&hs._cfg.version>us){vn(ls,xs),ds._memoizedTables={},js=!0;let bs=w(ws);ys.del.forEach(Cs=>{bs[Cs]=vs[Cs]}),bn(ls,[ls.Transaction.prototype]),gn(ls,[ls.Transaction.prototype],t(bs),bs),ds.schema=bs;const Ns=T(Rs);let Ss;Ns&&et();const Ts=je.follow(()=>{if(Ss=Rs(ds),Ss&&Ns){var Cs=tt.bind(null,null);Ss.then(Cs,Cs)}});return Ss&&typeof Ss.then=="function"?je.resolve(Ss):Ts.then(()=>Ss)}}),fs.push(vs=>{(!js||!xt)&&function(ws,ys){[].slice.call(ys.db.objectStoreNames).forEach(Rs=>ws[Rs]==null&&ys.db.deleteObjectStore(Rs))}(hs._cfg.dbschema,vs),bn(ls,[ls.Transaction.prototype]),gn(ls,[ls.Transaction.prototype],ls._storeNames,ls._dbSchema),ds.schema=ls._dbSchema})}),ms().then(()=>{var hs,vs;vs=xs,t(hs=Es).forEach(ws=>{vs.db.objectStoreNames.contains(ws)||kn(vs,ws,hs[ws].primKey,hs[ws].indexes)})})}(es,ts,os,ss).catch(as)})}function xn(es,ts){const ss={del:[],add:[],change:[]};let ns;for(ns in es)ts[ns]||ss.del.push(ns);for(ns in ts){const rs=es[ns],os=ts[ns];if(rs){const as={name:ns,def:os,recreate:!1,del:[],add:[],change:[]};if(""+(rs.primKey.keyPath||"")!=""+(os.primKey.keyPath||"")||rs.primKey.auto!==os.primKey.auto&&!wt)as.recreate=!0,ss.change.push(as);else{const cs=rs.idxByName,ls=os.idxByName;let us;for(us in cs)ls[us]||as.del.push(us);for(us in ls){const ds=cs[us],xs=ls[us];ds?ds.src!==xs.src&&as.change.push(xs):as.add.push(xs)}(as.del.length>0||as.add.length>0||as.change.length>0)&&ss.change.push(as)}}else ss.add.push([ns,os])}return ss}function kn(es,ts,ss,ns){const rs=es.db.createObjectStore(ts,ss.keyPath?{keyPath:ss.keyPath,autoIncrement:ss.auto}:{autoIncrement:ss.auto});return ns.forEach(os=>En(rs,os)),rs}function En(es,ts){es.createIndex(ts.name,ts.keyPath,{unique:ts.unique,multiEntry:ts.multi})}function Pn(es,ts,ss){const ns={};return p(ts.objectStoreNames,0).forEach(rs=>{const os=ss.objectStore(rs);let as=os.keyPath;const cs=un(ln(as),as||"",!1,!1,!!os.autoIncrement,as&&typeof as!="string",!0),ls=[];for(let ds=0;ds<os.indexNames.length;++ds){const xs=os.index(os.indexNames[ds]);as=xs.keyPath;var us=un(xs.name,as,!!xs.unique,!!xs.multiEntry,!1,as&&typeof as!="string",!1);ls.push(us)}ns[rs]=cn(rs,cs,ls)}),ns}function Kn({_novip:es},ts,ss){const ns=ss.db.objectStoreNames;for(let rs=0;rs<ns.length;++rs){const os=ns[rs],as=ss.objectStore(os);es._hasGetAll="getAll"in as;for(let cs=0;cs<as.indexNames.length;++cs){const ls=as.indexNames[cs],us=as.index(ls).keyPath,ds=typeof us=="string"?us:"["+p(us).join("+")+"]";if(ts[os]){const xs=ts[os].idxByName[ds];xs&&(xs.name=ls,delete ts[os].idxByName[ds],ts[os].idxByName[ls]=xs)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&e.WorkerGlobalScope&&e instanceof e.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(es._hasGetAll=!1)}class On{_parseStoresSpec(ts,ss){t(ts).forEach(ns=>{if(ts[ns]!==null){var rs=ts[ns].split(",").map((as,cs)=>{const ls=(as=as.trim()).replace(/([&*]|\+\+)/g,""),us=/^\[/.test(ls)?ls.match(/^\[(.*)\]$/)[1].split("+"):ls;return un(ls,us||null,/\&/.test(as),/\*/.test(as),/\+\+/.test(as),n(us),cs===0)}),os=rs.shift();if(os.multi)throw new X.Schema("Primary key cannot be multi-valued");rs.forEach(as=>{if(as.auto)throw new X.Schema("Only primary key can be marked as autoIncrement (++)");if(!as.keyPath)throw new X.Schema("Index must have a name and cannot be an empty string")}),ss[ns]=cn(ns,os,rs)}})}stores(ts){const ss=this.db;this._cfg.storesSource=this._cfg.storesSource?r$1(this._cfg.storesSource,ts):ts;const ns=ss._versions,rs={};let os={};return ns.forEach(as=>{r$1(rs,as._cfg.storesSource),os=as._cfg.dbschema={},as._parseStoresSpec(rs,os)}),ss._dbSchema=os,bn(ss,[ss._allTables,ss,ss.Transaction.prototype]),gn(ss,[ss._allTables,ss,ss.Transaction.prototype,this._cfg.tables],t(os),os),ss._storeNames=t(os),this}upgrade(ts){return this._cfg.contentUpgrade=ue(this._cfg.contentUpgrade||ee,ts),this}}function Sn(es,ts){let ss=es._dbNamesDB;return ss||(ss=es._dbNamesDB=new Xn(Pt,{addons:[],indexedDB:es,IDBKeyRange:ts}),ss.version(1).stores({dbnames:"name"})),ss.table("dbnames")}function An(es){return es&&typeof es.databases=="function"}function Cn(es){return Ze(function(){return Oe.letThrough=!0,es()})}function jn(){var es;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(ts){var ss=function(){return indexedDB.databases().finally(ts)};es=setInterval(ss,100),ss()}).finally(function(){return clearInterval(es)}):Promise.resolve()}function Dn(es){const ts=es._state,{indexedDB:ss}=es._deps;if(ts.isBeingOpened||es.idbdb)return ts.dbReadyPromise.then(()=>ts.dbOpenError?ft(ts.dbOpenError):es);R&&(ts.openCanceller._stackHolder=q()),ts.isBeingOpened=!0,ts.dbOpenError=null,ts.openComplete=!1;const ns=ts.openCanceller;function rs(){if(ts.openCanceller!==ns)throw new X.DatabaseClosed("db.open() was cancelled")}let os=ts.dbReadyResolve,as=null,cs=!1;const ls=()=>new je((us,ds)=>{if(rs(),!ss)throw new X.MissingAPI;const xs=es.name,fs=ts.autoSchema?ss.open(xs):ss.open(xs,Math.round(10*es.verno));if(!fs)throw new X.MissingAPI;fs.onerror=tn(ds),fs.onblocked=Ye(es._fireOnBlocked),fs.onupgradeneeded=Ye(gs=>{if(as=fs.transaction,ts.autoSchema&&!es._options.allowEmptyDB){fs.onerror=nn,as.abort(),fs.result.close();const js=ss.deleteDatabase(xs);js.onsuccess=js.onerror=Ye(()=>{ds(new X.NoSuchDatabase(`Database ${xs} doesnt exist`))})}else{as.onerror=tn(ds);var Es=gs.oldVersion>Math.pow(2,62)?0:gs.oldVersion;cs=Es<1,es._novip.idbdb=fs.result,wn(es,Es/10,as,ds)}},ds),fs.onsuccess=Ye(()=>{as=null;const gs=es._novip.idbdb=fs.result,Es=p(gs.objectStoreNames);if(Es.length>0)try{const ps=gs.transaction((js=Es).length===1?js[0]:js,"readonly");ts.autoSchema?function({_novip:ms},hs,vs){ms.verno=hs.version/10;const ws=ms._dbSchema=Pn(0,hs,vs);ms._storeNames=p(hs.objectStoreNames,0),gn(ms,[ms._allTables],t(ws),ws)}(es,gs,ps):(Kn(es,es._dbSchema,ps),function(ms,hs){const vs=xn(Pn(0,ms.idbdb,hs),ms._dbSchema);return!(vs.add.length||vs.change.some(ws=>ws.add.length||ws.change.length))}(es,ps)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),vn(es,ps)}catch{}var js;_t.push(es),gs.onversionchange=Ye(ps=>{ts.vcFired=!0,es.on("versionchange").fire(ps)}),gs.onclose=Ye(ps=>{es.on("close").fire(ps)}),cs&&function({indexedDB:ps,IDBKeyRange:ms},hs){!An(ps)&&hs!==Pt&&Sn(ps,ms).put({name:hs}).catch(ee)}(es._deps,xs),us()},ds)}).catch(us=>us&&us.name==="UnknownError"&&ts.PR1398_maxLoop>0?(ts.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),ls()):je.reject(us));return je.race([ns,(typeof navigator>"u"?je.resolve():jn()).then(ls)]).then(()=>(rs(),ts.onReadyBeingFired=[],je.resolve(Cn(()=>es.on.ready.fire(es.vip))).then(function us(){if(ts.onReadyBeingFired.length>0){let ds=ts.onReadyBeingFired.reduce(ue,ee);return ts.onReadyBeingFired=[],je.resolve(Cn(()=>ds(es.vip))).then(us)}}))).finally(()=>{ts.onReadyBeingFired=null,ts.isBeingOpened=!1}).then(()=>es).catch(us=>{ts.dbOpenError=us;try{as&&as.abort()}catch{}return ns===ts.openCanceller&&es._close(),ft(us)}).finally(()=>{ts.openComplete=!0,os()})}function In(es){var ts=os=>es.next(os),ss=rs(ts),ns=rs(os=>es.throw(os));function rs(os){return as=>{var cs=os(as),ls=cs.value;return cs.done?ls:ls&&typeof ls.then=="function"?ls.then(ss,ns):n(ls)?Promise.all(ls).then(ss,ns):ss(ls)}}return rs(ts)()}function Bn(es,ts,ss){var ns=arguments.length;if(ns<2)throw new X.InvalidArgument("Too few arguments");for(var rs=new Array(ns-1);--ns;)rs[ns-1]=arguments[ns];return ss=rs.pop(),[es,k(rs),ss]}function Tn(es,ts,ss,ns,rs){return je.resolve().then(()=>{const os=Oe.transless||Oe,as=es._createTransaction(ts,ss,es._dbSchema,ns),cs={trans:as,transless:os};if(ns)as.idbtrans=ns.idbtrans;else try{as.create(),es._state.PR1398_maxLoop=3}catch(xs){return xs.name===H.InvalidState&&es.isOpen()&&--es._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),es._close(),es.open().then(()=>Tn(es,ts,ss,null,rs))):ft(xs)}const ls=T(rs);let us;ls&&et();const ds=je.follow(()=>{if(us=rs.call(as,as),us)if(ls){var xs=tt.bind(null,null);us.then(xs,xs)}else typeof us.next=="function"&&typeof us.throw=="function"&&(us=In(us))},cs);return(us&&typeof us.then=="function"?je.resolve(us).then(xs=>as.active?xs:ft(new X.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):ds.then(()=>us)).then(xs=>(ns&&as._resolve(),as._completion.then(()=>xs))).catch(xs=>(as._reject(xs),ft(xs)))})}function Rn(es,ts,ss){const ns=n(es)?es.slice():[es];for(let rs=0;rs<ss;++rs)ns.push(ts);return ns}const Fn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(es){return{...es,table(ts){const ss=es.table(ts),{schema:ns}=ss,rs={},os=[];function as(ds,xs,fs){const gs=yn(ds),Es=rs[gs]=rs[gs]||[],js=ds==null?0:typeof ds=="string"?1:ds.length,ps=xs>0,ms={...fs,isVirtual:ps,keyTail:xs,keyLength:js,extractKey:dn(ds),unique:!ps&&fs.unique};return Es.push(ms),ms.isPrimaryKey||os.push(ms),js>1&&as(js===2?ds[0]:ds.slice(0,js-1),xs+1,fs),Es.sort((hs,vs)=>hs.keyTail-vs.keyTail),ms}const cs=as(ns.primaryKey.keyPath,0,ns.primaryKey);rs[":id"]=[cs];for(const ds of ns.indexes)as(ds.keyPath,0,ds);function ls(ds){const xs=ds.query.index;return xs.isVirtual?{...ds,query:{index:xs,range:(fs=ds.query.range,gs=xs.keyTail,{type:fs.type===1?2:fs.type,lower:Rn(fs.lower,fs.lowerOpen?es.MAX_KEY:es.MIN_KEY,gs),lowerOpen:!0,upper:Rn(fs.upper,fs.upperOpen?es.MIN_KEY:es.MAX_KEY,gs),upperOpen:!0})}}:ds;var fs,gs}return{...ss,schema:{...ns,primaryKey:cs,indexes:os,getIndexByKeyPath:function(ds){const xs=rs[yn(ds)];return xs&&xs[0]}},count:ds=>ss.count(ls(ds)),query:ds=>ss.query(ls(ds)),openCursor(ds){const{keyTail:xs,isVirtual:fs,keyLength:gs}=ds.query.index;return fs?ss.openCursor(ls(ds)).then(Es=>Es&&function(js){return Object.create(js,{continue:{value:function(ms){ms!=null?js.continue(Rn(ms,ds.reverse?es.MAX_KEY:es.MIN_KEY,xs)):ds.unique?js.continue(js.key.slice(0,gs).concat(ds.reverse?es.MIN_KEY:es.MAX_KEY,xs)):js.continue()}},continuePrimaryKey:{value(ms,hs){js.continuePrimaryKey(Rn(ms,es.MAX_KEY,xs),hs)}},primaryKey:{get:()=>js.primaryKey},key:{get(){const ms=js.key;return gs===1?ms[0]:ms.slice(0,gs)}},value:{get:()=>js.value}})}(Es)):ss.openCursor(ds)}}}}}};function Mn(es,ts,ss,ns){return ss=ss||{},ns=ns||"",t(es).forEach(rs=>{if(o(ts,rs)){var os=es[rs],as=ts[rs];if(typeof os=="object"&&typeof as=="object"&&os&&as){const cs=C(os);cs!==C(as)?ss[ns+rs]=ts[rs]:cs==="Object"?Mn(os,as,ss,ns+rs+"."):os!==as&&(ss[ns+rs]=ts[rs])}else os!==as&&(ss[ns+rs]=ts[rs])}else ss[ns+rs]=void 0}),t(ts).forEach(rs=>{o(es,rs)||(ss[ns+rs]=ts[rs])}),ss}const Nn={stack:"dbcore",name:"HooksMiddleware",level:2,create:es=>({...es,table(ts){const ss=es.table(ts),{primaryKey:ns}=ss.schema;return{...ss,mutate(os){const as=Oe.trans,{deleting:cs,creating:ls,updating:us}=as.table(ts).hook;switch(os.type){case"add":if(ls.fire===ee)break;return as._promise("readwrite",()=>ds(os),!0);case"put":if(ls.fire===ee&&us.fire===ee)break;return as._promise("readwrite",()=>ds(os),!0);case"delete":if(cs.fire===ee)break;return as._promise("readwrite",()=>ds(os),!0);case"deleteRange":if(cs.fire===ee)break;return as._promise("readwrite",()=>function(fs){return xs(fs.trans,fs.range,1e4)}(os),!0)}return ss.mutate(os);function ds(fs){const gs=Oe.trans,Es=fs.keys||function(js,ps){return ps.type==="delete"?ps.keys:ps.keys||ps.values.map(js.extractKey)}(ns,fs);if(!Es)throw new Error("Keys missing");return(fs=fs.type==="add"||fs.type==="put"?{...fs,keys:Es}:{...fs}).type!=="delete"&&(fs.values=[...fs.values]),fs.keys&&(fs.keys=[...fs.keys]),function(js,ps,ms){return ps.type==="add"?Promise.resolve([]):js.getMany({trans:ps.trans,keys:ms,cache:"immutable"})}(ss,fs,Es).then(js=>{const ps=Es.map((ms,hs)=>{const vs=js[hs],ws={onerror:null,onsuccess:null};if(fs.type==="delete")cs.fire.call(ws,ms,vs,gs);else if(fs.type==="add"||vs===void 0){const ys=ls.fire.call(ws,ms,fs.values[hs],gs);ms==null&&ys!=null&&(ms=ys,fs.keys[hs]=ms,ns.outbound||_(fs.values[hs],ns.keyPath,ms))}else{const ys=Mn(vs,fs.values[hs]),Rs=us.fire.call(ws,ys,ms,vs,gs);if(Rs){const bs=fs.values[hs];Object.keys(Rs).forEach(Ns=>{o(bs,Ns)?bs[Ns]=Rs[Ns]:_(bs,Ns,Rs[Ns])})}}return ws});return ss.mutate(fs).then(({failures:ms,results:hs,numFailures:vs,lastResult:ws})=>{for(let ys=0;ys<Es.length;++ys){const Rs=hs?hs[ys]:Es[ys],bs=ps[ys];Rs==null?bs.onerror&&bs.onerror(ms[ys]):bs.onsuccess&&bs.onsuccess(fs.type==="put"&&js[ys]?fs.values[ys]:Rs)}return{failures:ms,results:hs,numFailures:vs,lastResult:ws}}).catch(ms=>(ps.forEach(hs=>hs.onerror&&hs.onerror(ms)),Promise.reject(ms)))})}function xs(fs,gs,Es){return ss.query({trans:fs,values:!1,query:{index:ns,range:gs},limit:Es}).then(({result:js})=>ds({type:"delete",keys:js,trans:fs}).then(ps=>ps.numFailures>0?Promise.reject(ps.failures[0]):js.length<Es?{failures:[],numFailures:0,lastResult:void 0}:xs(fs,{...gs,lower:js[js.length-1],lowerOpen:!0},Es)))}}}}})};function qn(es,ts,ss){try{if(!ts||ts.keys.length<es.length)return null;const ns=[];for(let rs=0,os=0;rs<ts.keys.length&&os<es.length;++rs)$t(ts.keys[rs],es[os])===0&&(ns.push(ss?O(ts.values[rs]):ts.values[rs]),++os);return ns.length===es.length?ns:null}catch{return null}}const $n={stack:"dbcore",level:-1,create:es=>({table:ts=>{const ss=es.table(ts);return{...ss,getMany:ns=>{if(!ns.cache)return ss.getMany(ns);const rs=qn(ns.keys,ns.trans._cache,ns.cache==="clone");return rs?je.resolve(rs):ss.getMany(ns).then(os=>(ns.trans._cache={keys:ns.keys,values:ns.cache==="clone"?O(os):os},os))},mutate:ns=>(ns.type!=="add"&&(ns.trans._cache=null),ss.mutate(ns))}}})};function Un(es){return!("from"in es)}const Ln=function(es,ts){if(!this){const ss=new Ln;return es&&"d"in es&&r$1(ss,es),ss}r$1(this,arguments.length?{d:1,from:es,to:arguments.length>1?ts:es}:{d:0})};function Vn(es,ts,ss){const ns=$t(ts,ss);if(isNaN(ns))return;if(ns>0)throw RangeError();if(Un(es))return r$1(es,{from:ts,to:ss,d:1});const rs=es.l,os=es.r;if($t(ss,es.from)<0)return rs?Vn(rs,ts,ss):es.l={from:ts,to:ss,d:1,l:null,r:null},Gn(es);if($t(ts,es.to)>0)return os?Vn(os,ts,ss):es.r={from:ts,to:ss,d:1,l:null,r:null},Gn(es);$t(ts,es.from)<0&&(es.from=ts,es.l=null,es.d=os?os.d+1:1),$t(ss,es.to)>0&&(es.to=ss,es.r=null,es.d=es.l?es.l.d+1:1);const as=!es.r;rs&&!es.l&&Wn(es,rs),os&&as&&Wn(es,os)}function Wn(es,ts){Un(ts)||function ss(ns,{from:rs,to:os,l:as,r:cs}){Vn(ns,rs,os),as&&ss(ns,as),cs&&ss(ns,cs)}(es,ts)}function Yn(es,ts){const ss=zn(ts);let ns=ss.next();if(ns.done)return!1;let rs=ns.value;const os=zn(es);let as=os.next(rs.from),cs=as.value;for(;!ns.done&&!as.done;){if($t(cs.from,rs.to)<=0&&$t(cs.to,rs.from)>=0)return!0;$t(rs.from,cs.from)<0?rs=(ns=ss.next(cs.from)).value:cs=(as=os.next(rs.from)).value}return!1}function zn(es){let ts=Un(es)?null:{s:0,n:es};return{next(ss){const ns=arguments.length>0;for(;ts;)switch(ts.s){case 0:if(ts.s=1,ns)for(;ts.n.l&&$t(ss,ts.n.from)<0;)ts={up:ts,n:ts.n.l,s:1};else for(;ts.n.l;)ts={up:ts,n:ts.n.l,s:1};case 1:if(ts.s=2,!ns||$t(ss,ts.n.to)<=0)return{value:ts.n,done:!1};case 2:if(ts.n.r){ts.s=3,ts={up:ts,n:ts.n.r,s:0};continue}case 3:ts=ts.up}return{done:!0}}}}function Gn(es){var ts,ss;const ns=(((ts=es.r)===null||ts===void 0?void 0:ts.d)||0)-(((ss=es.l)===null||ss===void 0?void 0:ss.d)||0),rs=ns>1?"r":ns<-1?"l":"";if(rs){const os=rs==="r"?"l":"r",as={...es},cs=es[rs];es.from=cs.from,es.to=cs.to,es[rs]=cs[rs],as[rs]=cs[os],es[os]=as,as.d=Hn(as)}es.d=Hn(es)}function Hn({r:es,l:ts}){return(es?ts?Math.max(es.d,ts.d):es.d:ts?ts.d:0)+1}a(Ln.prototype,{add(es){return Wn(this,es),this},addKey(es){return Vn(this,es,es),this},addKeys(es){return es.forEach(ts=>Vn(this,ts,ts)),this},[j](){return zn(this)}});const Qn={stack:"dbcore",level:0,create:es=>{const ts=es.schema.name,ss=new Ln(es.MIN_KEY,es.MAX_KEY);return{...es,table:ns=>{const rs=es.table(ns),{schema:os}=rs,{primaryKey:as}=os,{extractKey:cs,outbound:ls}=as,us={...rs,mutate:fs=>{const gs=fs.trans,Es=gs.mutatedParts||(gs.mutatedParts={}),js=Rs=>{const bs=`idb://${ts}/${ns}/${Rs}`;return Es[bs]||(Es[bs]=new Ln)},ps=js(""),ms=js(":dels"),{type:hs}=fs;let[vs,ws]=fs.type==="deleteRange"?[fs.range]:fs.type==="delete"?[fs.keys]:fs.values.length<50?[[],fs.values]:[];const ys=fs.trans._cache;return rs.mutate(fs).then(Rs=>{if(n(vs)){hs!=="delete"&&(vs=Rs.results),ps.addKeys(vs);const bs=qn(vs,ys);bs||hs==="add"||ms.addKeys(vs),(bs||ws)&&function(Ns,Ss,Ts,Cs){function Ms(Is){const Qs=Ns(Is.name||"");function Ys(Vs){return Vs!=null?Is.extractKey(Vs):null}const Zs=Vs=>Is.multiEntry&&n(Vs)?Vs.forEach(Ks=>Qs.addKey(Ks)):Qs.addKey(Vs);(Ts||Cs).forEach((Vs,Ks)=>{const Ds=Ts&&Ys(Ts[Ks]),$s=Cs&&Ys(Cs[Ks]);$t(Ds,$s)!==0&&(Ds!=null&&Zs(Ds),$s!=null&&Zs($s))})}Ss.indexes.forEach(Ms)}(js,os,bs,ws)}else if(vs){const bs={from:vs.lower,to:vs.upper};ms.add(bs),ps.add(bs)}else ps.add(ss),ms.add(ss),os.indexes.forEach(bs=>js(bs.name).add(ss));return Rs})}},ds=({query:{index:fs,range:gs}})=>{var Es,js;return[fs,new Ln((Es=gs.lower)!==null&&Es!==void 0?Es:es.MIN_KEY,(js=gs.upper)!==null&&js!==void 0?js:es.MAX_KEY)]},xs={get:fs=>[as,new Ln(fs.key)],getMany:fs=>[as,new Ln().addKeys(fs.keys)],count:ds,query:ds,openCursor:ds};return t(xs).forEach(fs=>{us[fs]=function(gs){const{subscr:Es}=Oe;if(Es){const js=ws=>{const ys=`idb://${ts}/${ns}/${ws}`;return Es[ys]||(Es[ys]=new Ln)},ps=js(""),ms=js(":dels"),[hs,vs]=xs[fs](gs);if(js(hs.name||"").add(vs),!hs.isPrimaryKey){if(fs!=="count"){const ws=fs==="query"&&ls&&gs.values&&rs.query({...gs,values:!1});return rs[fs].apply(this,arguments).then(ys=>{if(fs==="query"){if(ls&&gs.values)return ws.then(({result:bs})=>(ps.addKeys(bs),ys));const Rs=gs.values?ys.result.map(cs):ys.result;gs.values?ps.addKeys(Rs):ms.addKeys(Rs)}else if(fs==="openCursor"){const Rs=ys,bs=gs.values;return Rs&&Object.create(Rs,{key:{get:()=>(ms.addKey(Rs.primaryKey),Rs.key)},primaryKey:{get(){const Ns=Rs.primaryKey;return ms.addKey(Ns),Ns}},value:{get:()=>(bs&&ps.addKey(Rs.primaryKey),Rs.value)}})}return ys})}ms.add(ss)}}return rs[fs].apply(this,arguments)}}),us}}}};class Xn{constructor(ts,ss){this._middlewares={},this.verno=0;const ns=Xn.dependencies;this._options=ss={addons:Xn.addons,autoOpen:!0,indexedDB:ns.indexedDB,IDBKeyRange:ns.IDBKeyRange,...ss},this._deps={indexedDB:ss.indexedDB,IDBKeyRange:ss.IDBKeyRange};const{addons:rs}=ss;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const os={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ee,dbReadyPromise:null,cancelOpen:ee,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var as;os.dbReadyPromise=new je(cs=>{os.dbReadyResolve=cs}),os.openCanceller=new je((cs,ls)=>{os.cancelOpen=ls}),this._state=os,this.name=ts,this.on=Dt(this,"populate","blocked","versionchange","close",{ready:[ue,ee]}),this.on.ready.subscribe=y(this.on.ready.subscribe,cs=>(ls,us)=>{Xn.vip(()=>{const ds=this._state;if(ds.openComplete)ds.dbOpenError||je.resolve().then(ls),us&&cs(ls);else if(ds.onReadyBeingFired)ds.onReadyBeingFired.push(ls),us&&cs(ls);else{cs(ls);const xs=this;us||cs(function fs(){xs.on.ready.unsubscribe(ls),xs.on.ready.unsubscribe(fs)})}})}),this.Collection=(as=this,It(Vt.prototype,function(cs,ls){this.db=as;let us=At,ds=null;if(ls)try{us=ls()}catch(Es){ds=Es}const xs=cs._ctx,fs=xs.table,gs=fs.hook.reading.fire;this._ctx={table:fs,index:xs.index,isPrimKey:!xs.index||fs.schema.primKey.keyPath&&xs.index===fs.schema.primKey.name,range:us,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ds,or:xs.or,valueMapper:gs!==te?gs:null}})),this.Table=function(cs){return It(jt.prototype,function(ls,us,ds){this.db=cs,this._tx=ds,this.name=ls,this.schema=us,this.hook=cs._allTables[ls]?cs._allTables[ls].hook:Dt(null,{creating:[se,ee],reading:[ne,te],updating:[oe,ee],deleting:[ie,ee]})})}(this),this.Transaction=function(cs){return It(an.prototype,function(ls,us,ds,xs,fs){this.db=cs,this.mode=ls,this.storeNames=us,this.schema=ds,this.chromeTransactionDurability=xs,this.idbtrans=null,this.on=Dt(this,"complete","error","abort"),this.parent=fs||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new je((gs,Es)=>{this._resolve=gs,this._reject=Es}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},gs=>{var Es=this.active;return this.active=!1,this.on.error.fire(gs),this.parent?this.parent._reject(gs):Es&&this.idbtrans&&this.idbtrans.abort(),ft(gs)})})}(this),this.Version=function(cs){return It(On.prototype,function(ls){this.db=cs,this._cfg={version:ls,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(cs){return It(en.prototype,function(ls,us,ds){this.db=cs,this._ctx={table:ls,index:us===":id"?null:us,or:ds};const xs=cs._deps.indexedDB;if(!xs)throw new X.MissingAPI;this._cmp=this._ascending=xs.cmp.bind(xs),this._descending=(fs,gs)=>xs.cmp(gs,fs),this._max=(fs,gs)=>xs.cmp(fs,gs)>0?fs:gs,this._min=(fs,gs)=>xs.cmp(fs,gs)<0?fs:gs,this._IDBKeyRange=cs._deps.IDBKeyRange})}(this),this.on("versionchange",cs=>{cs.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",cs=>{!cs.newVersion||cs.newVersion<cs.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${cs.oldVersion/10}`)}),this._maxKey=hn(ss.IDBKeyRange),this._createTransaction=(cs,ls,us,ds)=>new this.Transaction(cs,ls,us,this._options.chromeTransactionDurability,ds),this._fireOnBlocked=cs=>{this.on("blocked").fire(cs),_t.filter(ls=>ls.name===this.name&&ls!==this&&!ls._state.vcFired).map(ls=>ls.on("versionchange").fire(cs))},this.use(Fn),this.use(Nn),this.use(Qn),this.use($n),this.vip=Object.create(this,{_vip:{value:!0}}),rs.forEach(cs=>cs(this))}version(ts){if(isNaN(ts)||ts<.1)throw new X.Type("Given version is not a positive number");if(ts=Math.round(10*ts)/10,this.idbdb||this._state.isBeingOpened)throw new X.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,ts);const ss=this._versions;var ns=ss.filter(rs=>rs._cfg.version===ts)[0];return ns||(ns=new this.Version(ts),ss.push(ns),ss.sort(_n),ns.stores({}),this._state.autoSchema=!1,ns)}_whenReady(ts){return this.idbdb&&(this._state.openComplete||Oe.letThrough||this._vip)?ts():new je((ss,ns)=>{if(this._state.openComplete)return ns(new X.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void ns(new X.DatabaseClosed);this.open().catch(ee)}this._state.dbReadyPromise.then(ss,ns)}).then(ts)}use({stack:ts,create:ss,level:ns,name:rs}){rs&&this.unuse({stack:ts,name:rs});const os=this._middlewares[ts]||(this._middlewares[ts]=[]);return os.push({stack:ts,create:ss,level:ns??10,name:rs}),os.sort((as,cs)=>as.level-cs.level),this}unuse({stack:ts,name:ss,create:ns}){return ts&&this._middlewares[ts]&&(this._middlewares[ts]=this._middlewares[ts].filter(rs=>ns?rs.create!==ns:!!ss&&rs.name!==ss)),this}open(){return Dn(this)}_close(){const ts=this._state,ss=_t.indexOf(this);if(ss>=0&&_t.splice(ss,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}ts.dbReadyPromise=new je(ns=>{ts.dbReadyResolve=ns}),ts.openCanceller=new je((ns,rs)=>{ts.cancelOpen=rs})}close(){this._close();const ts=this._state;this._options.autoOpen=!1,ts.dbOpenError=new X.DatabaseClosed,ts.isBeingOpened&&ts.cancelOpen(ts.dbOpenError)}delete(){const ts=arguments.length>0,ss=this._state;return new je((ns,rs)=>{const os=()=>{this.close();var as=this._deps.indexedDB.deleteDatabase(this.name);as.onsuccess=Ye(()=>{(function({indexedDB:cs,IDBKeyRange:ls},us){!An(cs)&&us!==Pt&&Sn(cs,ls).delete(us).catch(ee)})(this._deps,this.name),ns()}),as.onerror=tn(rs),as.onblocked=this._fireOnBlocked};if(ts)throw new X.InvalidArgument("Arguments not allowed in db.delete()");ss.isBeingOpened?ss.dbReadyPromise.then(os):os()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const ts=this._state.dbOpenError;return ts&&ts.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return t(this._allTables).map(ts=>this._allTables[ts])}transaction(){const ts=Bn.apply(this,arguments);return this._transaction.apply(this,ts)}_transaction(ts,ss,ns){let rs=Oe.trans;rs&&rs.db===this&&ts.indexOf("!")===-1||(rs=null);const os=ts.indexOf("?")!==-1;let as,cs;ts=ts.replace("!","").replace("?","");try{if(cs=ss.map(us=>{var ds=us instanceof this.Table?us.name:us;if(typeof ds!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return ds}),ts=="r"||ts===Kt)as=Kt;else{if(ts!="rw"&&ts!=Ot)throw new X.InvalidArgument("Invalid transaction mode: "+ts);as=Ot}if(rs){if(rs.mode===Kt&&as===Ot){if(!os)throw new X.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");rs=null}rs&&cs.forEach(us=>{if(rs&&rs.storeNames.indexOf(us)===-1){if(!os)throw new X.SubTransaction("Table "+us+" not included in parent transaction.");rs=null}}),os&&rs&&!rs.active&&(rs=null)}}catch(us){return rs?rs._promise(null,(ds,xs)=>{xs(us)}):ft(us)}const ls=Tn.bind(null,this,as,cs,rs,ns);return rs?rs._promise(as,ls,"lock"):Oe.trans?at(Oe.transless,()=>this._whenReady(ls)):this._whenReady(ls)}table(ts){if(!o(this._allTables,ts))throw new X.InvalidTable(`Table ${ts} does not exist`);return this._allTables[ts]}}const Jn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Zn{constructor(ts){this._subscribe=ts}subscribe(ts,ss,ns){return this._subscribe(ts&&typeof ts!="function"?ts:{next:ts,error:ss,complete:ns})}[Jn](){return this}}function er(es,ts){return t(ts).forEach(ss=>{Wn(es[ss]||(es[ss]=new Ln),ts[ss])}),es}function tr(es){let ts,ss=!1;const ns=new Zn(rs=>{const os=T(es);let as=!1,cs={},ls={};const us={get closed(){return as},unsubscribe:()=>{as=!0,on.storagemutated.unsubscribe(gs)}};rs.start&&rs.start(us);let ds=!1,xs=!1;function fs(){return t(ls).some(js=>cs[js]&&Yn(cs[js],ls[js]))}const gs=js=>{er(cs,js),fs()&&Es()},Es=()=>{if(ds||as)return;cs={};const js={},ps=function(ms){os&&et();const hs=()=>Ze(es,{subscr:ms,trans:null}),vs=Oe.trans?at(Oe.transless,hs):hs();return os&&vs.then(tt,tt),vs}(js);xs||(on(rn,gs),xs=!0),ds=!0,Promise.resolve(ps).then(ms=>{ss=!0,ts=ms,ds=!1,as||(fs()?Es():(cs={},ls=js,rs.next&&rs.next(ms)))},ms=>{ds=!1,ss=!1,rs.error&&rs.error(ms),us.unsubscribe()})};return Es(),us});return ns.hasValue=()=>ss,ns.getValue=()=>ts,ns}let nr;try{nr={indexedDB:e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,IDBKeyRange:e.IDBKeyRange||e.webkitIDBKeyRange}}catch{nr={indexedDB:null,IDBKeyRange:null}}const rr=Xn;function sr(es){let ts=ir;try{ir=!0,on.storagemutated.fire(es)}finally{ir=ts}}a(rr,{...Z,delete:es=>new rr(es,{addons:[]}).delete(),exists:es=>new rr(es,{addons:[]}).open().then(ts=>(ts.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(es){try{return function({indexedDB:ts,IDBKeyRange:ss}){return An(ts)?Promise.resolve(ts.databases()).then(ns=>ns.map(rs=>rs.name).filter(rs=>rs!==Pt)):Sn(ts,ss).toCollection().primaryKeys()}(rr.dependencies).then(es)}catch{return ft(new X.MissingAPI)}},defineClass:()=>function(es){r$1(this,es)},ignoreTransaction:es=>Oe.trans?at(Oe.transless,es):es(),vip:Cn,async:function(es){return function(){try{var ts=In(es.apply(this,arguments));return ts&&typeof ts.then=="function"?ts:je.resolve(ts)}catch(ss){return ft(ss)}}},spawn:function(es,ts,ss){try{var ns=In(es.apply(ss,ts||[]));return ns&&typeof ns.then=="function"?ns:je.resolve(ns)}catch(rs){return ft(rs)}},currentTransaction:{get:()=>Oe.trans||null},waitFor:function(es,ts){const ss=je.resolve(typeof es=="function"?rr.ignoreTransaction(es):es).timeout(ts||6e4);return Oe.trans?Oe.trans.waitFor(ss):ss},Promise:je,debug:{get:()=>R,set:es=>{F(es,es==="dexie"?()=>!0:Et)}},derive:c,extend:r$1,props:a,override:y,Events:Dt,on,liveQuery:tr,extendObservabilitySet:er,getByKeyPath:b,setByKeyPath:_,delByKeyPath:function(es,ts){typeof ts=="string"?_(es,ts,void 0):"length"in ts&&[].map.call(ts,function(ss){_(es,ss,void 0)})},shallowClone:w,deepClone:O,getObjectDiff:Mn,cmp:$t,asap:v,minKey:vt,addons:[],connections:_t,errnames:H,dependencies:nr,semVer:yt,version:yt.split(".").map(es=>parseInt(es)).reduce((es,ts,ss)=>es+ts/Math.pow(10,2*ss))}),rr.maxKey=hn(rr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(on(rn,es=>{if(!ir){let ts;wt?(ts=document.createEvent("CustomEvent"),ts.initCustomEvent(sn,!0,!0,es)):ts=new CustomEvent(sn,{detail:es}),ir=!0,dispatchEvent(ts),ir=!1}}),addEventListener(sn,({detail:es})=>{ir||sr(es)}));let ir=!1;if(typeof BroadcastChannel<"u"){const es=new BroadcastChannel(sn);typeof es.unref=="function"&&es.unref(),on(rn,ts=>{ir||es.postMessage(ts)}),es.onmessage=ts=>{ts.data&&sr(ts.data)}}else if(typeof self<"u"&&typeof navigator<"u"){on(rn,ts=>{try{ir||(typeof localStorage<"u"&&localStorage.setItem(sn,JSON.stringify({trig:Math.random(),changedParts:ts})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(ss=>ss.postMessage({type:sn,changedParts:ts})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",ts=>{if(ts.key===sn){const ss=JSON.parse(ts.newValue);ss&&sr(ss.changedParts)}});const es=self.document&&navigator.serviceWorker;es&&es.addEventListener("message",function({data:ts}){ts&&ts.type===sn&&sr(ts.changedParts)})}je.rejectionMapper=function(es,ts){if(!es||es instanceof W||es instanceof TypeError||es instanceof SyntaxError||!es.name||!J[es.name])return es;var ss=new J[es.name](ts||es.message,es);return"stack"in es&&l(ss,"stack",{get:function(){return this.inner.stack}}),ss},F(R,Et);class HairMakeupDB extends Xn{constructor(){super("HairMakeupProDB");eo(this,"projects");eo(this,"scenes");eo(this,"characters");eo(this,"looks");eo(this,"sceneCaptures");eo(this,"photoBlobs");eo(this,"storeBackups");this.version(1).stores({projects:"id, name, createdAt, updatedAt",scenes:"id, sceneNumber, slugline, isComplete",characters:"id, name",looks:"id, characterId, name",sceneCaptures:"id, sceneId, characterId, lookId, capturedAt",photos:"id, capturedAt, angle"}),this.version(2).stores({projects:"id, updatedAt",scenes:"id, sceneNumber, slugline, isComplete",characters:"id, name",looks:"id, characterId, name",sceneCaptures:"id, projectId, sceneId, characterId, updatedAt",photoBlobs:"id, capturedAt, angle",storeBackups:"id, updatedAt",photos:null}).upgrade(async()=>{console.log("Migrating database to version 2 with blob storage")})}}const db=new HairMakeupDB;async function saveStoreBackup(es,ts){await db.storeBackups.put({id:es,state:ts,updatedAt:new Date})}async function getStoreBackup(es){const ts=await db.storeBackups.get(es);return ts==null?void 0:ts.state}async function clearAllData(){await Promise.all([db.projects.clear(),db.scenes.clear(),db.characters.clear(),db.looks.clear(),db.sceneCaptures.clear(),db.photoBlobs.clear(),db.storeBackups.clear()])}const debounceTimers={},pendingWrites={},DEBOUNCE_DELAY=500,INDEXEDDB_STORES=new Set(["hair-makeup-pro-storage","hair-makeup-callsheets","hair-makeup-schedule","hair-makeup-timesheet-storage"]);function debouncedWrite(es,ts,ss){pendingWrites[es]=ts,debounceTimers[es]&&clearTimeout(debounceTimers[es]),debounceTimers[es]=setTimeout(async()=>{const ns=pendingWrites[es];delete pendingWrites[es],delete debounceTimers[es];try{await ss(es,ns)}catch(rs){console.error(`Failed to write store ${es}:`,rs)}},DEBOUNCE_DELAY)}async function flushPendingWrites(){const es=[];for(const[ts,ss]of Object.entries(pendingWrites))if(debounceTimers[ts]&&(clearTimeout(debounceTimers[ts]),delete debounceTimers[ts]),INDEXEDDB_STORES.has(ts))es.push(saveStoreBackup(ts,ss).catch(ns=>console.error(`Failed to flush store ${ts}:`,ns)));else try{localStorage.setItem(ts,JSON.stringify(ss))}catch(ns){console.error(`Failed to flush store ${ts} to localStorage:`,ns)}Object.keys(pendingWrites).forEach(ts=>delete pendingWrites[ts]),await Promise.all(es)}function createHybridStorage(es){const ts=INDEXEDDB_STORES.has(es);return{getItem:async ss=>{if(ts)try{return await db.open(),await getStoreBackup(ss)}catch(ns){console.error(`Failed to read store ${ss} from IndexedDB:`,ns);const rs=localStorage.getItem(ss);return rs?JSON.parse(rs):null}else{const ns=localStorage.getItem(ss);return ns?JSON.parse(ns):null}},setItem:(ss,ns)=>{ts?debouncedWrite(ss,ns,async(rs,os)=>{await saveStoreBackup(rs,os)}):debouncedWrite(ss,ns,async(rs,os)=>{localStorage.setItem(rs,JSON.stringify(os))})},removeItem:async ss=>{if(debounceTimers[ss]&&(clearTimeout(debounceTimers[ss]),delete debounceTimers[ss]),delete pendingWrites[ss],ts)try{await db.storeBackups.delete(ss)}catch(ns){console.error(`Failed to remove store ${ss} from IndexedDB:`,ns)}localStorage.removeItem(ss)}}}async function migrateToIndexedDB(){const es=[],ts=[];await db.open();for(const ss of INDEXEDDB_STORES)try{const ns=localStorage.getItem(ss);if(ns&&!await getStoreBackup(ss)){const os=JSON.parse(ns);await saveStoreBackup(ss,os),es.push(ss),localStorage.removeItem(ss)}}catch(ns){console.error(`Failed to migrate store ${ss}:`,ns),ts.push(ss)}return{migrated:es,errors:ts}}typeof window<"u"&&(window.addEventListener("beforeunload",()=>{for(const[es,ts]of Object.entries(pendingWrites))if(!INDEXEDDB_STORES.has(es))try{localStorage.setItem(es,JSON.stringify(ts))}catch{}}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&flushPendingWrites().catch(()=>{})}));const TIER_FEATURES={trainee:{maxProjects:3,maxArchivedProjects:1,maxPhotosPerProject:50,canCreateProjects:!1,offlineMode:!1,exportReports:!1,personalTemplates:!1,teamManagement:!1,characterProgressionTracking:!1,shootingScheduleView:!1,teamPhotoStorage:!1,desktopWebAccess:!1,preProductionBreakdown:!1,characterDesignDocs:!1,exportProductionBooks:!1,budgetSchedulingTools:!1},artist:{maxProjects:10,maxArchivedProjects:-1,maxPhotosPerProject:500,canCreateProjects:!1,offlineMode:!0,exportReports:!0,personalTemplates:!0,teamManagement:!1,characterProgressionTracking:!1,shootingScheduleView:!1,teamPhotoStorage:!1,desktopWebAccess:!1,preProductionBreakdown:!1,characterDesignDocs:!1,exportProductionBooks:!1,budgetSchedulingTools:!1},supervisor:{maxProjects:25,maxArchivedProjects:15,maxPhotosPerProject:1e3,canCreateProjects:!0,offlineMode:!0,exportReports:!0,personalTemplates:!0,teamManagement:!0,characterProgressionTracking:!0,shootingScheduleView:!0,teamPhotoStorage:!1,desktopWebAccess:!1,preProductionBreakdown:!1,characterDesignDocs:!1,exportProductionBooks:!1,budgetSchedulingTools:!1},designer:{maxProjects:-1,maxArchivedProjects:-1,maxPhotosPerProject:-1,canCreateProjects:!0,offlineMode:!0,exportReports:!0,personalTemplates:!0,teamManagement:!0,characterProgressionTracking:!0,shootingScheduleView:!0,teamPhotoStorage:!0,desktopWebAccess:!0,preProductionBreakdown:!0,characterDesignDocs:!0,exportProductionBooks:!0,budgetSchedulingTools:!0}},TIER_PRICING={trainee:{monthly:0,yearly:0,currency:"GBP",currencySymbol:""},artist:{monthly:4.99,yearly:47.9,currency:"GBP",currencySymbol:""},supervisor:{monthly:9.99,yearly:95.9,currency:"GBP",currencySymbol:""},designer:{monthly:29.99,yearly:287.9,perProject:49,currency:"GBP",currencySymbol:""}},SUBSCRIPTION_TIERS=[{id:"trainee",name:"TRAINEE",displayName:"Trainee",description:"Perfect for students and emerging artists",pricing:TIER_PRICING.trainee,features:TIER_FEATURES.trainee,featureList:["Multiple projects simultaneously","50 photos per project","View breakdowns & scenes","Add continuity notes","1 archived project"]},{id:"artist",name:"ARTIST",displayName:"Artist",description:"For working floor artists",pricing:TIER_PRICING.artist,features:TIER_FEATURES.artist,featureList:["Everything in Trainee","500 photos per project","Offline mode with full sync","Export continuity reports (PDF)","Personal templates between projects","Unlimited project archive"],isPopular:!0},{id:"supervisor",name:"SUPERVISOR",displayName:"Supervisor",description:"For supervisors and key artists",pricing:TIER_PRICING.supervisor,features:TIER_FEATURES.supervisor,featureList:["Everything in Artist","1000 photos per project","Create & manage projects","Generate team invite codes","Team management","Character progression tracking","Shooting schedule view"]},{id:"designer",name:"DESIGNER",displayName:"Designer",description:"The complete package for HODs and designers",pricing:TIER_PRICING.designer,features:TIER_FEATURES.designer,featureList:["Everything in Supervisor","Unlimited photo storage","Team photo storage included","Full desktop web access","Pre-production script breakdown","Character design documentation","Export full production books","Budget & scheduling tools"],isPremium:!0}],getTierById=es=>SUBSCRIPTION_TIERS.find(ts=>ts.id===es),formatPrice=(es,ts="")=>es===0?"Free":`${ts}${es.toFixed(2)}`,formatMonthlyEquivalent=(es,ts="")=>{const ss=es/12;return`${ts}${ss.toFixed(2)}`},isTierHigher=(es,ts)=>{const ss=["trainee","artist","supervisor","designer"];return ss.indexOf(es)>ss.indexOf(ts)},getDowngradeWarnings=(es,ts)=>{const ss=TIER_FEATURES[es],ns=TIER_FEATURES[ts],rs=[];if(ss.offlineMode&&!ns.offlineMode&&rs.push("Offline mode with full sync"),ss.exportReports&&!ns.exportReports&&rs.push("Export continuity reports"),ss.personalTemplates&&!ns.personalTemplates&&rs.push("Personal templates"),ss.teamManagement&&!ns.teamManagement&&rs.push("Team management"),ss.canCreateProjects&&!ns.canCreateProjects&&rs.push("Create & manage projects"),ss.characterProgressionTracking&&!ns.characterProgressionTracking&&rs.push("Character progression tracking"),ss.shootingScheduleView&&!ns.shootingScheduleView&&rs.push("Shooting schedule view"),ss.teamPhotoStorage&&!ns.teamPhotoStorage&&rs.push("Team photo storage"),ss.desktopWebAccess&&!ns.desktopWebAccess&&rs.push("Desktop web access"),ss.preProductionBreakdown&&!ns.preProductionBreakdown&&rs.push("Pre-production script breakdown"),ss.characterDesignDocs&&!ns.characterDesignDocs&&rs.push("Character design documentation"),ss.exportProductionBooks&&!ns.exportProductionBooks&&rs.push("Export production books"),ss.budgetSchedulingTools&&!ns.budgetSchedulingTools&&rs.push("Budget & scheduling tools"),ss.maxPhotosPerProject>ns.maxPhotosPerProject){const os=ss.maxPhotosPerProject===-1?"Unlimited":ss.maxPhotosPerProject,as=ns.maxPhotosPerProject===-1?"Unlimited":ns.maxPhotosPerProject;rs.push(`Photo limit reduced from ${os} to ${as} per project`)}return rs},createDefaultSubscription=()=>({tier:"trainee",status:null,billingPeriod:null}),HAIR_TYPES=["Natural","Wig","Hair Pieces","Extensions"],WIG_TYPES=["Lace Front","Full Lace","Hard Front","U-Part","Closure"],WIG_ATTACHMENTS=["Glue","Tape","Pins","Combs","Clips","Elastic"],HAIRLINE_STYLES=["Natural","Laid","Concealed","Bleached Knots"],SFX_TYPES=["Prosthetics","Wounds","Scars","Tattoos","Aging","Bald Cap","Contact Lenses","Teeth","Body Paint"],BLOOD_TYPES=["Fresh","Dried","Arterial","Mouth Blood","Bruising"],ALL_NAV_ITEMS=[{id:"today",label:"Today",iconName:"calendar"},{id:"breakdown",label:"Breakdown",iconName:"grid"},{id:"lookbook",label:"Lookbook",iconName:"book"},{id:"hours",label:"Hours",iconName:"clock"},{id:"budget",label:"Budget",iconName:"wallet"},{id:"script",label:"Script",iconName:"document"},{id:"schedule",label:"Schedule",iconName:"schedule"},{id:"callsheets",label:"Call Sheets",iconName:"clipboard"},{id:"settings",label:"Settings",iconName:"cog"}],DEFAULT_BOTTOM_NAV=["today","breakdown","hours"],SCENE_FILMING_STATUS_CONFIG={"not-filmed":{label:"Incomplete",shortLabel:"Incomplete",bgClass:"bg-red-100",textClass:"text-red-600",borderClass:"border-red-400",color:"#dc2626",glassOverlay:"rgba(239, 68, 68, 0.15)"},partial:{label:"Part Complete",shortLabel:"Part Complete",bgClass:"bg-amber-100",textClass:"text-amber-600",borderClass:"border-amber-400",color:"#d97706",glassOverlay:"rgba(245, 158, 11, 0.15)"},complete:{label:"Complete",shortLabel:"Complete",bgClass:"bg-green-100",textClass:"text-green-600",borderClass:"border-green-400",color:"#16a34a",glassOverlay:"rgba(34, 197, 94, 0.15)"}},createEmptyMakeupDetails=()=>({foundation:"",coverage:"",concealer:"",concealerPlacement:"",contour:"",contourPlacement:"",highlight:"",highlightPlacement:"",blush:"",blushPlacement:"",browProduct:"",browShape:"",eyePrimer:"",lidColour:"",creaseColour:"",outerV:"",liner:"",lashes:"",lipLiner:"",lipColour:"",setting:""}),createEmptyHairDetails=()=>({style:"",products:"",parting:"",piecesOut:"",pins:"",accessories:"",hairType:"Natural",wigNameId:"",wigType:"",wigCapMethod:"",wigAttachment:[],hairline:"",laceTint:"",edgesBabyHairs:""}),createEmptySFXDetails=()=>({sfxRequired:!1,sfxTypes:[],prostheticPieces:"",prostheticAdhesive:"",bloodTypes:[],bloodProducts:"",bloodPlacement:"",tattooCoverage:"",temporaryTattoos:"",contactLenses:"",teeth:"",agingCharacterNotes:"",sfxApplicationTime:null,sfxReferencePhotos:[]}),createEmptyContinuityFlags=()=>({sweat:!1,dishevelled:!1,blood:!1,dirt:!1,wetHair:!1,tears:!1}),STAGE_SUGGESTIONS=["Fresh","Day 1 Healing","Day 2 Healing","Day 3 Healing","Scabbed","Scarring","Healed","Faded"],CONTINUITY_EVENT_TYPES=["Wound","Bruise","Prosthetic","Scar","Tattoo","Other"],countFilledFields=es=>Object.entries(es).filter(([ts,ss])=>ts==="hairType"||ts==="sfxRequired"?!1:Array.isArray(ss)?ss.length>0:typeof ss=="number"?ss>0:ss===null||typeof ss=="boolean"?!1:typeof ss=="string"?ss.trim()!=="":!1).length,countHairFields=es=>{const ts=["style","products","parting","piecesOut","pins","accessories"],ss=["wigNameId","wigType","wigCapMethod","wigAttachment","hairline","laceTint","edgesBabyHairs"];let ns=0;return ts.forEach(rs=>{const os=es[rs];typeof os=="string"&&os.trim()!==""&&ns++}),es.hairType!=="Natural"&&ss.forEach(rs=>{const os=es[rs];(Array.isArray(os)&&os.length>0||typeof os=="string"&&os.trim()!=="")&&ns++}),ns},countSFXFields=es=>{if(!es.sfxRequired)return 0;let ts=0;return es.sfxTypes.length>0&&ts++,es.prostheticPieces.trim()!==""&&ts++,es.prostheticAdhesive.trim()!==""&&ts++,es.bloodTypes.length>0&&ts++,es.bloodProducts.trim()!==""&&ts++,es.bloodPlacement.trim()!==""&&ts++,es.tattooCoverage.trim()!==""&&ts++,es.temporaryTattoos.trim()!==""&&ts++,es.contactLenses.trim()!==""&&ts++,es.teeth.trim()!==""&&ts++,es.agingCharacterNotes.trim()!==""&&ts++,es.sfxApplicationTime!==null&&es.sfxApplicationTime>0&&ts++,es.sfxReferencePhotos.length>0&&ts++,ts},DAY_TYPE_LABELS={SWD:"Standard Working Day",CWD:"Continuous Working Day",SCWD:"Short Continuous Working Day"},getLunchDurationForDayType=es=>{switch(es){case"SWD":return 60;case"CWD":case"SCWD":return 30;default:return 60}},createDefaultRateCard=()=>({dailyRate:0,baseDayHours:11,baseContract:"11+1",dayType:"SWD",otMultiplier:1.5,lateNightMultiplier:2,preCallMultiplier:1.5,sixthDayMultiplier:1.5,seventhDayMultiplier:2,kitRental:0,lunchDuration:60}),createEmptyTimesheetEntry=es=>({id:`entry-${es}`,date:es,dayType:"SWD",preCall:"",unitCall:"",lunchStart:"",lunchEnd:"",outOfChair:"",wrapOut:"",lunchTaken:60,isSixthDay:!1,isSeventhDay:!1,notes:"",status:"draft"}),CURRENCIES=[{code:"GBP",symbol:"",name:"British Pound",locale:"en-GB"},{code:"USD",symbol:"$",name:"US Dollar",locale:"en-US"},{code:"EUR",symbol:"",name:"Euro",locale:"de-DE"},{code:"CAD",symbol:"C$",name:"Canadian Dollar",locale:"en-CA"},{code:"AUD",symbol:"A$",name:"Australian Dollar",locale:"en-AU"}],DEFAULT_CURRENCY="GBP",getCurrencyByCode=es=>CURRENCIES.find(ts=>ts.code===es)||CURRENCIES[0],formatCurrency=(es,ts=DEFAULT_CURRENCY)=>`${getCurrencyByCode(ts).symbol}${es.toFixed(2)}`,createEmptyBillingDetails=()=>({fullName:"",businessName:"",address:"",phone:"",email:"",bankDetails:{accountName:"",sortCode:"",accountNumber:""},paymentTerms:"Payment within 30 days",vatSettings:{isVATRegistered:!1,vatNumber:"",vatRate:20}}),EXPORT_DOCUMENTS=[{id:"continuity_bible",name:"Continuity Bible",description:"Complete reference document - all characters, all looks, all scenes with photos",format:"pdf",selected:!0},{id:"scene_breakdown",name:"Scene Breakdown",description:"Spreadsheet of all scenes with H&MU details per character",format:"csv",selected:!0},{id:"character_lookbooks",name:"Character Lookbooks",description:"Individual PDFs per character with all their looks",format:"pdf_zip",selected:!0},{id:"photo_archive",name:"Photo Archive",description:"All captured photos organized by character/scene",format:"zip",selected:!0},{id:"timesheets",name:"Timesheets",description:"All logged hours for the production",format:"pdf",selected:!0},{id:"invoice_summary",name:"Invoice Summary",description:"Total hours, rates, kit rental for invoicing",format:"pdf",selected:!1}],PROJECT_RETENTION_DAYS=90,REMINDER_INTERVAL_DAYS=7,INACTIVITY_TRIGGER_DAYS=30,createDefaultLifecycle=()=>({state:"active",lastActivityAt:new Date}),calculateDaysUntilDeletion=es=>{const ts=new Date,ss=new Date(es);ss.setDate(ss.getDate()+PROJECT_RETENTION_DAYS);const ns=ss.getTime()-ts.getTime();return Math.max(0,Math.ceil(ns/(1e3*60*60*24)))},PRODUCTION_TYPES=[{value:"film",label:"Film"},{value:"tv_series",label:"TV Series"},{value:"short_film",label:"Short Film"},{value:"commercial",label:"Commercial"},{value:"music_video",label:"Music Video"},{value:"other",label:"Other"}],PROJECT_CODE_CHARS="ABCDEFGHJKMNPQRSTUVWXYZ23456789",generateProjectCode=()=>{let es="";for(let ts=0;ts<3;ts++)es+=PROJECT_CODE_CHARS.charAt(Math.floor(Math.random()*23));es+="-";for(let ts=0;ts<4;ts++)es+=PROJECT_CODE_CHARS.charAt(Math.floor(Math.random()*PROJECT_CODE_CHARS.length));return es},isValidProjectCode=es=>/^[ABCDEFGHJKMNPQRSTUVWXYZ]{3}-[ABCDEFGHJKMNPQRSTUVWXYZ23456789]{4}$/.test(es.toUpperCase()),formatProjectCode=es=>{const ts=es.toUpperCase().replace(/[^ABCDEFGHJKMNPQRSTUVWXYZ23456789]/g,"");return ts.length<=3?ts:ts.slice(0,3)+"-"+ts.slice(3,7)},TIER_LIMITS={trainee:{maxProjects:3,maxArchivedProjects:1,canCreateProjects:!1},artist:{maxProjects:10,maxArchivedProjects:-1,canCreateProjects:!1},supervisor:{maxProjects:25,maxArchivedProjects:15,canCreateProjects:!0},designer:{maxProjects:-1,maxArchivedProjects:-1,canCreateProjects:!0}},shouldTriggerWrap=(es,ts)=>{if(ts.state!=="active")return{trigger:!1};if(es.scenes.length>0&&es.scenes.every(as=>as.isComplete))return{trigger:!0,reason:"all_scenes_complete"};const ns=new Date,rs=new Date(ts.lastActivityAt);return Math.floor((ns.getTime()-rs.getTime())/(1e3*60*60*24))>=INACTIVITY_TRIGGER_DAYS?{trigger:!0,reason:"inactivity"}:{trigger:!1}},TEAM_MEMBER_ROLES=[{value:"designer",label:"Designer (HoD)",level:8},{value:"supervisor",label:"Supervisor",level:7},{value:"key",label:"Key Artist",level:6},{value:"hair",label:"Hair Artist",level:5},{value:"makeup",label:"Makeup Artist",level:4},{value:"sfx",label:"Special Effects Artist",level:3},{value:"daily",label:"Daily",level:2},{value:"trainee",label:"Trainee",level:1}],getTeamMemberRoleLabel=es=>{var ts;return((ts=TEAM_MEMBER_ROLES.find(ss=>ss.value===es))==null?void 0:ts.label)||es},PERMISSION_LEVELS=[{value:"all",label:"All team members"},{value:"key_plus",label:"Key artists and above"},{value:"supervisor_plus",label:"Supervisors only"}],groupTeamMembersByRole=es=>{const ts=new Map;return TEAM_MEMBER_ROLES.forEach(ss=>{ts.set(ss.value,[])}),es.forEach(ss=>{const ns=ts.get(ss.role);ns&&ns.push(ss)}),ts.forEach(ss=>{ss.sort((ns,rs)=>ns.name.localeCompare(rs.name))}),TEAM_MEMBER_ROLES.filter(ss=>{var ns;return(((ns=ts.get(ss.value))==null?void 0:ns.length)||0)>0}).map(ss=>({role:ss.value,label:ss.label+"s",members:ts.get(ss.value)||[]}))},canManageProject=(es,ts)=>{if(!ts)return!1;if(ts.isOwner)return!0;const ss=["designer","supervisor"];return["supervisor","designer"].includes(es)&&ss.includes(ts.role)},createDefaultProjectPermissions=()=>({addPhotos:"all",editNotes:"all",markComplete:"key_plus"}),formatStorageSize=es=>{if(es===0)return"0 B";const ts=1024,ss=["B","KB","MB","GB","TB"],ns=Math.floor(Math.log(es)/Math.log(ts));return parseFloat((es/Math.pow(ts,ns)).toFixed(1))+" "+ss[ns]};let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let es=0;es<256;++es)byteToHex.push((es+256).toString(16).slice(1));function unsafeStringify(es,ts=0){return byteToHex[es[ts+0]]+byteToHex[es[ts+1]]+byteToHex[es[ts+2]]+byteToHex[es[ts+3]]+"-"+byteToHex[es[ts+4]]+byteToHex[es[ts+5]]+"-"+byteToHex[es[ts+6]]+byteToHex[es[ts+7]]+"-"+byteToHex[es[ts+8]]+byteToHex[es[ts+9]]+"-"+byteToHex[es[ts+10]]+byteToHex[es[ts+11]]+byteToHex[es[ts+12]]+byteToHex[es[ts+13]]+byteToHex[es[ts+14]]+byteToHex[es[ts+15]]}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(es,ts,ss){if(native.randomUUID&&!es)return native.randomUUID();es=es||{};const ns=es.random||(es.rng||rng)();return ns[6]=ns[6]&15|64,ns[8]=ns[8]&63|128,unsafeStringify(ns)}const useProjectStore=create()(persist((es,ts)=>({currentProject:null,currentSceneId:null,currentCharacterId:null,activeTab:"today",sceneFilter:"all",searchQuery:"",needsSetup:!1,sceneCaptures:{},lifecycle:createDefaultLifecycle(),showWrapPopup:!1,wrapTriggerReason:null,savedProjects:{},archivedProjects:[],setProject:ss=>es({currentProject:ss,needsSetup:!1,lifecycle:createDefaultLifecycle(),showWrapPopup:!1,wrapTriggerReason:null}),setProjectNeedsSetup:ss=>es({currentProject:ss,needsSetup:!0,lifecycle:createDefaultLifecycle(),showWrapPopup:!1,wrapTriggerReason:null}),clearNeedsSetup:()=>es({needsSetup:!1}),setScriptPdf:ss=>es(ns=>({currentProject:ns.currentProject?{...ns.currentProject,scriptPdfData:ss}:null})),clearProject:()=>es({currentProject:null,currentSceneId:null,currentCharacterId:null,needsSetup:!1,sceneCaptures:{},lifecycle:createDefaultLifecycle(),showWrapPopup:!1,wrapTriggerReason:null}),saveAndClearProject:()=>{const ss=ts();if(ss.currentProject){const ns=ss.currentProject.id,rs=ss.currentProject,os=ss.sceneCaptures,as=ss.lifecycle,cs=ss.needsSetup;es(ls=>({savedProjects:{...ls.savedProjects,[ns]:{project:rs,sceneCaptures:os,lifecycle:as,needsSetup:cs}},currentProject:null,currentSceneId:null,currentCharacterId:null,needsSetup:!1,sceneCaptures:{},lifecycle:createDefaultLifecycle(),showWrapPopup:!1,wrapTriggerReason:null}))}else es({currentProject:null,currentSceneId:null,currentCharacterId:null,needsSetup:!1,sceneCaptures:{},lifecycle:createDefaultLifecycle(),showWrapPopup:!1,wrapTriggerReason:null})},restoreSavedProject:ss=>{const ns=ts(),rs=ns.savedProjects[ss];if(!rs)return!1;const os={...ns.savedProjects};return delete os[ss],es({currentProject:rs.project,sceneCaptures:rs.sceneCaptures,lifecycle:rs.lifecycle,needsSetup:rs.needsSetup,savedProjects:os,currentSceneId:null,currentCharacterId:null,showWrapPopup:!1,wrapTriggerReason:null}),!0},hasSavedProject:ss=>!!ts().savedProjects[ss],setActiveTab:ss=>es({activeTab:ss}),setCurrentScene:ss=>es({currentSceneId:ss}),setCurrentCharacter:ss=>es({currentCharacterId:ss}),setSceneFilter:ss=>es({sceneFilter:ss}),setSearchQuery:ss=>es({searchQuery:ss}),getOrCreateSceneCapture:(ss,ns)=>{var ds,xs,fs;const rs=ts(),os=`${ss}-${ns}`,as=rs.sceneCaptures[os];if(as)return as;const cs=(xs=(ds=rs.currentProject)==null?void 0:ds.scenes.find(gs=>gs.id===ss))==null?void 0:xs.sceneNumber,ls=(fs=rs.currentProject)==null?void 0:fs.looks.find(gs=>gs.characterId===ns&&cs!==void 0&&gs.scenes.includes(cs)),us={id:os,sceneId:ss,characterId:ns,lookId:(ls==null?void 0:ls.id)??"",capturedAt:new Date,photos:{},additionalPhotos:[],continuityFlags:createEmptyContinuityFlags(),continuityEvents:[],sfxDetails:createEmptySFXDetails(),notes:""};return es(gs=>({sceneCaptures:{...gs.sceneCaptures,[os]:us}})),us},updateSceneCapture:(ss,ns)=>{es(rs=>({sceneCaptures:{...rs.sceneCaptures,[ss]:{...rs.sceneCaptures[ss],...ns}}}))},addPhotoToCapture:(ss,ns,rs)=>{es(os=>{const as=os.sceneCaptures[ss];return as?rs==="additional"?{sceneCaptures:{...os.sceneCaptures,[ss]:{...as,additionalPhotos:[...as.additionalPhotos,ns]}}}:{sceneCaptures:{...os.sceneCaptures,[ss]:{...as,photos:{...as.photos,[rs]:ns}}}}:os})},removePhotoFromCapture:(ss,ns,rs)=>{es(os=>{const as=os.sceneCaptures[ss];if(!as)return os;if(ns==="additional"&&rs)return{sceneCaptures:{...os.sceneCaptures,[ss]:{...as,additionalPhotos:as.additionalPhotos.filter(us=>us.id!==rs)}}};const cs=ns,ls={...as.photos};return delete ls[cs],{sceneCaptures:{...os.sceneCaptures,[ss]:{...as,photos:ls}}}})},toggleContinuityFlag:(ss,ns)=>{es(rs=>{const os=rs.sceneCaptures[ss];return os?{sceneCaptures:{...rs.sceneCaptures,[ss]:{...os,continuityFlags:{...os.continuityFlags,[ns]:!os.continuityFlags[ns]}}}}:rs})},addContinuityEvent:(ss,ns)=>{es(rs=>{const os=rs.sceneCaptures[ss];return os?{sceneCaptures:{...rs.sceneCaptures,[ss]:{...os,continuityEvents:[...os.continuityEvents,ns]}}}:rs})},updateContinuityEvent:(ss,ns,rs)=>{es(os=>{const as=os.sceneCaptures[ss];return as?{sceneCaptures:{...os.sceneCaptures,[ss]:{...as,continuityEvents:as.continuityEvents.map(cs=>cs.id===ns?{...cs,...rs}:cs)}}}:os})},removeContinuityEvent:(ss,ns)=>{es(rs=>{const os=rs.sceneCaptures[ss];return os?{sceneCaptures:{...rs.sceneCaptures,[ss]:{...os,continuityEvents:os.continuityEvents.filter(as=>as.id!==ns)}}}:rs})},updateSFXDetails:(ss,ns)=>{es(rs=>{const os=rs.sceneCaptures[ss];return os?{sceneCaptures:{...rs.sceneCaptures,[ss]:{...os,sfxDetails:ns}}}:rs})},addSFXPhoto:(ss,ns)=>{es(rs=>{const os=rs.sceneCaptures[ss];return os?{sceneCaptures:{...rs.sceneCaptures,[ss]:{...os,sfxDetails:{...os.sfxDetails,sfxReferencePhotos:[...os.sfxDetails.sfxReferencePhotos,ns]}}}}:rs})},removeSFXPhoto:(ss,ns)=>{es(rs=>{const os=rs.sceneCaptures[ss];return os?{sceneCaptures:{...rs.sceneCaptures,[ss]:{...os,sfxDetails:{...os.sfxDetails,sfxReferencePhotos:os.sfxDetails.sfxReferencePhotos.filter(as=>as.id!==ns)}}}}:rs})},markSceneComplete:ss=>{es(ns=>ns.currentProject?{currentProject:{...ns.currentProject,scenes:ns.currentProject.scenes.map(rs=>rs.id===ss?{...rs,isComplete:!0,completedAt:new Date}:rs)}}:ns)},markSceneIncomplete:ss=>{es(ns=>ns.currentProject?{currentProject:{...ns.currentProject,scenes:ns.currentProject.scenes.map(rs=>rs.id===ss?{...rs,isComplete:!1,completedAt:void 0}:rs)}}:ns)},copyToNextScene:(ss,ns)=>{const rs=ts();if(!rs.currentProject)return null;const os=rs.currentProject.scenes.find(ds=>ds.id===ss);if(!os)return null;const as=rs.currentProject.scenes.find(ds=>ds.sceneNumber>os.sceneNumber&&ds.characters.includes(ns));if(!as)return null;const cs=rs.sceneCaptures[`${ss}-${ns}`];if(!cs)return as.id;const ls=`${as.id}-${ns}`,us={id:ls,sceneId:as.id,characterId:ns,lookId:cs.lookId,capturedAt:new Date,photos:{},additionalPhotos:[],continuityFlags:{...cs.continuityFlags},continuityEvents:cs.continuityEvents.map(ds=>({...ds,id:v4()})),sfxDetails:{...cs.sfxDetails,sfxReferencePhotos:[]},notes:cs.notes,applicationTime:cs.applicationTime};return es(ds=>({sceneCaptures:{...ds.sceneCaptures,[ls]:us},currentSceneId:as.id})),as.id},updateSceneFilmingStatus:(ss,ns,rs)=>{es(os=>os.currentProject?{currentProject:{...os.currentProject,scenes:os.currentProject.scenes.map(as=>as.sceneNumber===ss?{...as,filmingStatus:ns,filmingNotes:rs}:as)}}:os)},updateSceneSynopsis:(ss,ns)=>{es(rs=>rs.currentProject?{currentProject:{...rs.currentProject,scenes:rs.currentProject.scenes.map(os=>os.id===ss?{...os,synopsis:ns}:os)}}:rs)},updateAllSceneSynopses:ss=>{es(ns=>{if(!ns.currentProject)return ns;const rs=new Map;return ss.forEach(os=>{os.synopsis&&rs.set(os.id,os.synopsis)}),{currentProject:{...ns.currentProject,scenes:ns.currentProject.scenes.map(os=>{const as=rs.get(os.id);return as?{...os,synopsis:as}:os})}}})},updateSceneShootingDays:(ss,ns)=>{es(rs=>{if(!rs.currentProject)return rs;const os=new Set(ns.map(as=>as.sceneNumber));return{currentProject:{...rs.currentProject,scenes:rs.currentProject.scenes.map(as=>({...as,shootingDay:ss[as.sceneNumber]??as.shootingDay,hasScheduleDiscrepancy:os.has(as.sceneNumber)}))}}})},updateLook:(ss,ns)=>{es(rs=>rs.currentProject?{currentProject:{...rs.currentProject,looks:rs.currentProject.looks.map(os=>os.id===ss?{...os,...ns}:os)}}:rs)},startCharacterDetection:()=>{es(ss=>ss.currentProject?{currentProject:{...ss.currentProject,characterDetectionStatus:"running",scenes:ss.currentProject.scenes.map(ns=>({...ns,characterConfirmationStatus:ns.characterConfirmationStatus==="confirmed"?"confirmed":"detecting"}))}}:ss)},setCharacterDetectionStatus:ss=>{es(ns=>ns.currentProject?{currentProject:{...ns.currentProject,characterDetectionStatus:ss}}:ns)},updateSceneSuggestedCharacters:(ss,ns)=>{es(rs=>rs.currentProject?{currentProject:{...rs.currentProject,scenes:rs.currentProject.scenes.map(os=>os.id===ss?{...os,suggestedCharacters:ns,characterConfirmationStatus:os.characterConfirmationStatus==="confirmed"?"confirmed":"ready"}:os)}}:rs)},updateSceneConfirmationStatus:(ss,ns)=>{es(rs=>rs.currentProject?{currentProject:{...rs.currentProject,scenes:rs.currentProject.scenes.map(os=>os.id===ss?{...os,characterConfirmationStatus:ns}:os)}}:rs)},confirmSceneCharacters:(ss,ns)=>{es(rs=>{if(!rs.currentProject)return rs;const os=rs.currentProject.scenes.map(us=>us.id===ss?{...us,characters:ns,characterConfirmationStatus:"confirmed",suggestedCharacters:void 0}:us),as=os.filter(us=>us.characterConfirmationStatus==="confirmed").length,cs=os.find(us=>us.id===ss),ls=rs.currentProject.looks.map(us=>cs&&ns.includes(us.characterId)&&!us.scenes.includes(cs.sceneNumber)?{...us,scenes:[...us.scenes,cs.sceneNumber].sort((ds,xs)=>ds.localeCompare(xs,void 0,{numeric:!0}))}:us);return{currentProject:{...rs.currentProject,scenes:os,looks:ls,scenesConfirmed:as}}})},addCharacterFromScene:(ss,ns)=>{const rs=ts();if(!rs.currentProject)throw new Error("No project loaded");const os=`char-${v4().slice(0,8)}`,as=ns.split(" ").map(xs=>xs[0]).join("").slice(0,2),cs=["#C9A961","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444","#3B82F6","#6366F1"],ls=cs[rs.currentProject.characters.length%cs.length],us={id:os,name:ns,initials:as,avatarColour:ls},ds=rs.currentProject.scenes.find(xs=>xs.id===ss);return es(xs=>{if(!xs.currentProject)return xs;const fs={id:`look-${us.id}`,characterId:us.id,name:"Look 1",scenes:ds?[ds.sceneNumber]:[],estimatedTime:30,makeup:createEmptyMakeupDetails(),hair:createEmptyHairDetails()};return{currentProject:{...xs.currentProject,characters:[...xs.currentProject.characters,us],looks:[...xs.currentProject.looks,fs]}}}),us},getUnconfirmedScenesCount:()=>{const ss=ts();return ss.currentProject?ss.currentProject.scenes.filter(ns=>ns.characterConfirmationStatus!=="confirmed").length:0},getConfirmedScenesCount:()=>{const ss=ts();return ss.currentProject?ss.currentProject.scenes.filter(ns=>ns.characterConfirmationStatus==="confirmed").length:0},getScene:ss=>{var ns;return(ns=ts().currentProject)==null?void 0:ns.scenes.find(rs=>rs.id===ss)},getCharacter:ss=>{var ns;return(ns=ts().currentProject)==null?void 0:ns.characters.find(rs=>rs.id===ss)},getLookForCharacterInScene:(ss,ns)=>{var rs;return(rs=ts().currentProject)==null?void 0:rs.looks.find(os=>os.characterId===ss&&os.scenes.includes(ns))},getSceneCapture:(ss,ns)=>ts().sceneCaptures[`${ss}-${ns}`],getFilteredScenes:()=>{const ss=ts();if(!ss.currentProject)return[];let ns=[...ss.currentProject.scenes];if(ss.sceneFilter==="complete"?ns=ns.filter(rs=>rs.isComplete):ss.sceneFilter==="incomplete"&&(ns=ns.filter(rs=>!rs.isComplete)),ss.searchQuery){const rs=ss.searchQuery.toLowerCase();ns=ns.filter(os=>os.sceneNumber.toString().includes(rs)||os.slugline.toLowerCase().includes(rs))}return ns.sort((rs,os)=>rs.sceneNumber.localeCompare(os.sceneNumber,void 0,{numeric:!0}))},getScenesForLook:ss=>{const ns=ts();if(!ns.currentProject)return[];const rs=ns.currentProject.looks.find(os=>os.id===ss);return rs?ns.currentProject.scenes.filter(os=>rs.scenes.includes(os.sceneNumber)).sort((os,as)=>os.sceneNumber.localeCompare(as.sceneNumber,void 0,{numeric:!0})):[]},updateActivity:()=>{es(ss=>({lifecycle:{...ss.lifecycle,lastActivityAt:new Date}}))},checkWrapTrigger:()=>{const ss=ts();if(!ss.currentProject)return;if(ss.lifecycle.nextReminderAt&&new Date>=new Date(ss.lifecycle.nextReminderAt)){es({showWrapPopup:!0,wrapTriggerReason:ss.lifecycle.wrapReason||"manual"});return}const ns=shouldTriggerWrap(ss.currentProject,ss.lifecycle);ns.trigger&&ns.reason&&es({showWrapPopup:!0,wrapTriggerReason:ns.reason})},wrapProject:ss=>{const ns=new Date,rs=new Date(ns);rs.setDate(rs.getDate()+PROJECT_RETENTION_DAYS),es(os=>({lifecycle:{...os.lifecycle,state:"wrapped",wrappedAt:ns,wrapReason:ss,deletionDate:rs},showWrapPopup:!1,wrapTriggerReason:null}))},dismissWrapPopup:ss=>{if(ss){const ns=new Date;ns.setDate(ns.getDate()+REMINDER_INTERVAL_DAYS),es(rs=>({showWrapPopup:!1,lifecycle:{...rs.lifecycle,reminderDismissedAt:new Date,nextReminderAt:ns}}))}else es({showWrapPopup:!1})},restoreProject:()=>{es(ss=>({lifecycle:{...ss.lifecycle,state:"active",wrappedAt:void 0,deletionDate:void 0,archiveDate:void 0,reminderDismissedAt:void 0,nextReminderAt:void 0,lastActivityAt:new Date}}))},archiveProject:()=>{const ss=ts();if(!ss.currentProject)return;const ns=new Date,rs={project:ss.currentProject,lifecycle:{...ss.lifecycle,state:"archived",archiveDate:ns},sceneCaptures:ss.sceneCaptures};es(os=>({archivedProjects:[...os.archivedProjects,rs],currentProject:null,sceneCaptures:{},lifecycle:createDefaultLifecycle()}))},permanentlyDeleteProject:()=>{es({currentProject:null,sceneCaptures:{},lifecycle:createDefaultLifecycle()})},getArchivedProjects:()=>ts().archivedProjects.map(ns=>{const rs=Object.values(ns.sceneCaptures).reduce((os,as)=>{let cs=0;return as.photos.front&&cs++,as.photos.left&&cs++,as.photos.right&&cs++,as.photos.back&&cs++,cs+=as.additionalPhotos.length,os+cs},0);return{id:ns.project.id,name:ns.project.name,state:ns.lifecycle.state,wrappedAt:ns.lifecycle.wrappedAt,daysUntilDeletion:ns.lifecycle.wrappedAt?calculateDaysUntilDeletion(new Date(ns.lifecycle.wrappedAt)):0,scenesCount:ns.project.scenes.length,charactersCount:ns.project.characters.length,photosCount:rs}}),loadArchivedProject:ss=>{const ns=ts(),rs=ns.archivedProjects.findIndex(cs=>cs.project.id===ss);if(rs===-1)return;const os=ns.archivedProjects[rs],as=[...ns.archivedProjects];as.splice(rs,1),es({currentProject:os.project,sceneCaptures:os.sceneCaptures,lifecycle:os.lifecycle,archivedProjects:as})},getDaysUntilDeletion:()=>{const ss=ts();return ss.lifecycle.state==="active"||!ss.lifecycle.wrappedAt?-1:calculateDaysUntilDeletion(new Date(ss.lifecycle.wrappedAt))},getLifecycleBanner:()=>{const ss=ts();if(ss.lifecycle.state==="active")return null;const ns=ss.lifecycle.wrappedAt?calculateDaysUntilDeletion(new Date(ss.lifecycle.wrappedAt)):0;return ss.lifecycle.state==="wrapped"?{show:!0,message:`Project wrapped. ${ns} days until archive.`,daysRemaining:ns}:ss.lifecycle.state==="archived"?{show:!0,message:"Archived. Export to restore.",daysRemaining:ns}:null}}),{name:"hair-makeup-pro-storage",storage:createHybridStorage("hair-makeup-pro-storage"),partialize:es=>({currentProject:es.currentProject,sceneCaptures:es.sceneCaptures,lifecycle:es.lifecycle,savedProjects:es.savedProjects,archivedProjects:es.archivedProjects})})),mockDelay$1=es=>new Promise(ts=>setTimeout(ts,es)),mockUsers=new Map,useAuthStore=create()(persist((es,ts)=>({isAuthenticated:!1,user:null,isLoading:!1,error:null,currentScreen:"welcome",screenHistory:[],hasCompletedOnboarding:!1,hasSelectedPlan:!1,subscription:createDefaultSubscription(),projectMemberships:[],guestProjectCode:null,setScreen:(ss,ns=!0)=>{const{currentScreen:rs,screenHistory:os}=ts();ss!==rs&&es(ns?{currentScreen:ss,screenHistory:[...os,rs],error:null}:{currentScreen:ss,error:null})},goBack:()=>{const{screenHistory:ss,isAuthenticated:ns}=ts();if(ss.length>0){const rs=[...ss],os=rs.pop();es({currentScreen:os,screenHistory:rs,error:null})}else es({currentScreen:ns?"hub":"welcome",error:null})},signIn:async(ss,ns)=>{es({isLoading:!0,error:null});try{await mockDelay$1(800);const rs=mockUsers.get(ss.toLowerCase());return rs?rs.password!==ns?(es({isLoading:!1,error:"Incorrect password"}),!1):(es({isAuthenticated:!0,user:rs.user,isLoading:!1,error:null,currentScreen:"hub",hasCompletedOnboarding:!0}),!0):(es({isLoading:!1,error:"No account found with this email"}),!1)}catch{return es({isLoading:!1,error:"An error occurred. Please try again."}),!1}},signUp:async(ss,ns,rs)=>{es({isLoading:!0,error:null});try{await mockDelay$1(800);const os=ns.toLowerCase();if(mockUsers.has(os))return es({isLoading:!1,error:"An account with this email already exists"}),!1;const as={id:crypto.randomUUID(),email:os,name:ss,tier:"trainee",createdAt:new Date};return mockUsers.set(os,{user:as,password:rs}),es({isAuthenticated:!0,user:as,isLoading:!1,error:null,currentScreen:"select-plan",hasCompletedOnboarding:!1,hasSelectedPlan:!1,subscription:createDefaultSubscription(),projectMemberships:[]}),!0}catch{return es({isLoading:!1,error:"An error occurred. Please try again."}),!1}},signOut:()=>{es({isAuthenticated:!1,user:null,currentScreen:"welcome",screenHistory:[],hasCompletedOnboarding:!1,hasSelectedPlan:!1,subscription:createDefaultSubscription(),projectMemberships:[],guestProjectCode:null})},joinProject:async ss=>{es({isLoading:!0,error:null});try{await mockDelay$1(600);const ns=ss.toUpperCase();if(!/^[A-Z]{3}-[A-Z0-9]{4}$/.test(ns))return es({isLoading:!1,error:"Invalid project code format"}),{success:!1,error:"Invalid project code format"};const os=`Production ${ns.slice(0,3)}`,{isAuthenticated:as,projectMemberships:cs}=ts();if(as){const ls={projectId:crypto.randomUUID(),projectName:os,productionType:"film",role:"artist",joinedAt:new Date,lastAccessedAt:new Date,teamMemberCount:Math.floor(Math.random()*10)+2,sceneCount:Math.floor(Math.random()*100)+20,projectCode:ns,status:"active"};es({isLoading:!1,projectMemberships:[...cs,ls],currentScreen:"hub"})}else es({isLoading:!1,guestProjectCode:ns});return{success:!0,projectName:os}}catch{return es({isLoading:!1,error:"Failed to join project. Please try again."}),{success:!1,error:"Failed to join project"}}},createProject:async(ss,ns)=>{const{user:rs,projectMemberships:os}=ts();if(!rs||!TIER_LIMITS[rs.tier].canCreateProjects)return es({error:"Your account tier does not allow creating projects"}),{success:!1,error:"Insufficient permissions"};es({isLoading:!0,error:null});try{await mockDelay$1(600);const as=generateProjectCode(),cs={projectId:crypto.randomUUID(),projectName:ss,productionType:ns,role:"owner",joinedAt:new Date,lastAccessedAt:new Date,teamMemberCount:1,sceneCount:0,projectCode:as,status:"active"};return es({isLoading:!1,projectMemberships:[...os,cs]}),{success:!0,code:as}}catch{return es({isLoading:!1,error:"Failed to create project. Please try again."}),{success:!1,error:"Failed to create project"}}},clearError:()=>{es({error:null})},setHasCompletedOnboarding:ss=>{es({hasCompletedOnboarding:ss})},canCreateProjects:()=>{const{user:ss}=ts();return ss?TIER_LIMITS[ss.tier].canCreateProjects:!1},updateLastAccessed:ss=>{const{projectMemberships:ns}=ts(),rs=ns.map(os=>os.projectId===ss?{...os,lastAccessedAt:new Date}:os);es({projectMemberships:rs})},selectTier:async(ss,ns)=>{const{user:rs}=ts();if(!rs)return!1;es({isLoading:!0,error:null});try{await mockDelay$1(600);const os={...rs,tier:ss},as={tier:ss,status:ss==="trainee"?null:"active",billingPeriod:ss==="trainee"?null:ns,subscriptionStartedAt:ss!=="trainee"?new Date:void 0,currentPeriodEndsAt:ss!=="trainee"?new Date(Date.now()+(ns==="yearly"?365:30)*24*60*60*1e3):void 0};es({user:os,subscription:as,hasSelectedPlan:!0,hasCompletedOnboarding:!0,currentScreen:"hub",isLoading:!1,error:null});const cs=mockUsers.get(rs.email);return cs&&mockUsers.set(rs.email,{...cs,user:os}),!0}catch{return es({isLoading:!1,error:"Failed to update subscription. Please try again."}),!1}},updateSubscription:ss=>{const{subscription:ns,user:rs}=ts(),os={...ns,...ss};if(ss.tier&&rs){const as={...rs,tier:ss.tier};es({subscription:os,user:as});const cs=mockUsers.get(rs.email);cs&&mockUsers.set(rs.email,{...cs,user:as})}else es({subscription:os})}}),{name:"checks-happy-auth-storage",storage:createJSONStorage(()=>localStorage),partialize:es=>({isAuthenticated:es.isAuthenticated,user:es.user,currentScreen:es.currentScreen,hasCompletedOnboarding:es.hasCompletedOnboarding,hasSelectedPlan:es.hasSelectedPlan,subscription:es.subscription,projectMemberships:es.projectMemberships,guestProjectCode:es.guestProjectCode})}));function r(es){var ts,ss,ns="";if(typeof es=="string"||typeof es=="number")ns+=es;else if(typeof es=="object")if(Array.isArray(es)){var rs=es.length;for(ts=0;ts<rs;ts++)es[ts]&&(ss=r(es[ts]))&&(ns&&(ns+=" "),ns+=ss)}else for(ss in es)es[ss]&&(ns&&(ns+=" "),ns+=ss);return ns}function clsx(){for(var es,ts,ss=0,ns="",rs=arguments.length;ss<rs;ss++)(es=arguments[ss])&&(ts=r(es))&&(ns&&(ns+=" "),ns+=ts);return ns}const MAX_BOTTOM_NAV_ITEMS=5,useNavigationStore=create()(persist((es,ts)=>({bottomNavItems:DEFAULT_BOTTOM_NAV,isEditMenuOpen:!1,setBottomNavItems:ss=>{const ns=ss.slice(0,MAX_BOTTOM_NAV_ITEMS);es({bottomNavItems:ns})},openEditMenu:()=>es({isEditMenuOpen:!0}),closeEditMenu:()=>es({isEditMenuOpen:!1}),moveToBottomNav:(ss,ns)=>{const rs=[...ts().bottomNavItems],os=rs.indexOf(ss);os!==-1?(rs.splice(os,1),rs.splice(ns,0,ss)):rs.length<MAX_BOTTOM_NAV_ITEMS?rs.splice(ns,0,ss):rs[ns]=ss,es({bottomNavItems:rs.slice(0,MAX_BOTTOM_NAV_ITEMS)})},moveToMoreMenu:ss=>{const ns=ts().bottomNavItems.filter(rs=>rs!==ss);ns.length!==0&&es({bottomNavItems:ns})},reorderBottomNav:(ss,ns)=>{const rs=[...ts().bottomNavItems],[os]=rs.splice(ss,1);rs.splice(ns,0,os),es({bottomNavItems:rs})},getMoreMenuItems:()=>{const ss=ts().bottomNavItems;return ALL_NAV_ITEMS.filter(ns=>!ss.includes(ns.id)).map(ns=>ns.id)},resetToDefaults:()=>{es({bottomNavItems:DEFAULT_BOTTOM_NAV})}}),{name:"hair-makeup-navigation",storage:createJSONStorage(()=>localStorage),partialize:es=>({bottomNavItems:es.bottomNavItems})}));function BottomNav({activeTab:es,onTabChange:ts}){const{bottomNavItems:ss}=useNavigationStore(),ns=[...ss.map(rs=>{const os=ALL_NAV_ITEMS.find(as=>as.id===rs);return os?{id:os.id,label:os.label,icon:jsxRuntimeExports.jsx(NavIcon,{name:os.iconName})}:null}).filter(Boolean),{id:"more",label:"More",icon:jsxRuntimeExports.jsx(NavIcon,{name:"ellipsis"})}];return jsxRuntimeExports.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-40 bg-card shadow-nav border-t border-border",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-around bottom-nav-safe",children:ns.map(rs=>{const os=es===rs.id;return jsxRuntimeExports.jsxs("button",{onClick:()=>ts(rs.id),className:clsx("flex flex-col items-center justify-center py-2 px-3 min-w-[56px] tap-target touch-manipulation transition-colors",{"text-gold":os,"text-text-light hover:text-text-muted":!os}),"aria-current":os?"page":void 0,children:[jsxRuntimeExports.jsx("span",{className:"w-6 h-6 mb-1",children:rs.icon}),jsxRuntimeExports.jsx("span",{className:clsx("text-[10px] font-medium",{"font-semibold":os}),children:rs.label})]},rs.id)})})})})}function NavIcon({name:es,className:ts="w-full h-full"}){switch(es){case"calendar":return jsxRuntimeExports.jsx("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})});case"grid":return jsxRuntimeExports.jsx("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 10h18M3 14h18M10 3v18M14 3v18M3 6a3 3 0 013-3h12a3 3 0 013 3v12a3 3 0 01-3 3H6a3 3 0 01-3-3V6z"})});case"book":return jsxRuntimeExports.jsx("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})});case"clock":return jsxRuntimeExports.jsx("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})});case"wallet":return jsxRuntimeExports.jsx("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})});case"document":return jsxRuntimeExports.jsx("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})});case"schedule":return jsxRuntimeExports.jsx("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5m-9-6h.008v.008H12v-.008zM12 15h.008v.008H12V15zm0 2.25h.008v.008H12v-.008zM9.75 15h.008v.008H9.75V15zm0 2.25h.008v.008H9.75v-.008zM7.5 15h.008v.008H7.5V15zm0 2.25h.008v.008H7.5v-.008zm6.75-4.5h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V15zm0 2.25h.008v.008h-.008v-.008zm2.25-4.5h.008v.008H16.5v-.008zm0 2.25h.008v.008H16.5V15z"})});case"clipboard":return jsxRuntimeExports.jsx("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z"})});case"cog":return jsxRuntimeExports.jsxs("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});case"ellipsis":return jsxRuntimeExports.jsx("svg",{className:ts,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})});default:return null}}const Button=reactExports.forwardRef(({className:es,variant:ts="primary",size:ss="md",fullWidth:ns=!1,children:rs,disabled:os,...as},cs)=>jsxRuntimeExports.jsx("button",{ref:cs,className:clsx("inline-flex items-center justify-center font-medium transition-all duration-200 touch-manipulation tap-target","focus:outline-none focus:ring-2 focus:ring-gold/50 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",{"gold-gradient text-white shadow-md hover:shadow-lg active:scale-[0.98]":ts==="primary","bg-gray-100 text-text-primary hover:bg-gray-200 active:bg-gray-300":ts==="secondary","border-2 border-gold text-gold hover:bg-gold-50 active:bg-gold-100":ts==="outline","text-gold hover:bg-gold-50 active:bg-gold-100":ts==="ghost","px-3 py-1.5 text-sm rounded-lg":ss==="sm","px-4 py-2.5 text-base rounded-button":ss==="md","px-6 py-3 text-lg rounded-button":ss==="lg","w-full":ns},es),disabled:os,...as,children:rs}));Button.displayName="Button";const Input=reactExports.forwardRef(({className:es,label:ts,error:ss,helperText:ns,id:rs,...os},as)=>{const cs=rs||(ts==null?void 0:ts.toLowerCase().replace(/\s+/g,"-"));return jsxRuntimeExports.jsxs("div",{className:"w-full",children:[ts&&jsxRuntimeExports.jsx("label",{htmlFor:cs,className:"field-label block mb-1.5",children:ts}),jsxRuntimeExports.jsx("input",{ref:as,id:cs,className:clsx("input-field w-full",{"border-error focus:border-error focus:ring-error/30":ss},es),...os}),ss&&jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-error",children:ss}),ns&&!ss&&jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-text-muted",children:ns})]})});Input.displayName="Input";const Textarea=reactExports.forwardRef(({className:es,label:ts,error:ss,helperText:ns,id:rs,rows:os=3,...as},cs)=>{const ls=rs||(ts==null?void 0:ts.toLowerCase().replace(/\s+/g,"-"));return jsxRuntimeExports.jsxs("div",{className:"w-full",children:[ts&&jsxRuntimeExports.jsx("label",{htmlFor:ls,className:"field-label block mb-1.5",children:ts}),jsxRuntimeExports.jsx("textarea",{ref:cs,id:ls,rows:os,className:clsx("input-field w-full resize-none",{"border-error focus:border-error focus:ring-error/30":ss},es),...as}),ss&&jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-error",children:ss}),ns&&!ss&&jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-text-muted",children:ns})]})});Textarea.displayName="Textarea";const Card=reactExports.forwardRef(({className:es,variant:ts="default",padding:ss="md",children:ns,...rs},os)=>jsxRuntimeExports.jsx("div",{ref:os,className:clsx("rounded-card",{"bg-card shadow-card":ts==="default","bg-card":ts==="flat","bg-card border border-border":ts==="bordered","p-0":ss==="none","p-3":ss==="sm","p-card-padding":ss==="md","p-6":ss==="lg"},es),...rs,children:ns}));Card.displayName="Card";const CardHeader=reactExports.forwardRef(({className:es,children:ts,...ss},ns)=>jsxRuntimeExports.jsx("div",{ref:ns,className:clsx("flex items-center justify-between mb-3",es),...ss,children:ts}));CardHeader.displayName="CardHeader";const CardTitle=reactExports.forwardRef(({className:es,children:ts,...ss},ns)=>jsxRuntimeExports.jsx("h3",{ref:ns,className:clsx("section-header",es),...ss,children:ts}));CardTitle.displayName="CardTitle";const CardContent=reactExports.forwardRef(({className:es,children:ts,...ss},ns)=>jsxRuntimeExports.jsx("div",{ref:ns,className:clsx(es),...ss,children:ts}));CardContent.displayName="CardContent";const Badge=reactExports.forwardRef(({className:es,variant:ts="default",size:ss="sm",children:ns,...rs},os)=>jsxRuntimeExports.jsx("span",{ref:os,className:clsx("inline-flex items-center justify-center font-semibold uppercase tracking-wide",{"bg-gray-100 text-text-muted":ts==="default","bg-gold text-white":ts==="gold","bg-blue-100 text-blue-700":ts==="int","bg-gold-100 text-gold-700":ts==="ext","bg-green-100 text-green-700":ts==="success","bg-orange-100 text-orange-700":ts==="warning","bg-red-100 text-red-700":ts==="error","bg-transparent border border-current":ts==="outline","px-1.5 py-0.5 text-[9px] rounded":ss==="sm","px-2.5 py-1 text-[10px] rounded-md":ss==="md"},es),...rs,children:ns}));Badge.displayName="Badge";const CountBadge=reactExports.forwardRef(({className:es,count:ts,label:ss="fields",...ns},rs)=>jsxRuntimeExports.jsxs("span",{ref:rs,className:clsx("inline-flex items-center justify-center px-2.5 py-0.5 text-[10px] font-semibold rounded-xl","bg-gold-100/60 text-gold",es),...ns,children:[ts," ",ss]}));CountBadge.displayName="CountBadge";const TogglePill=reactExports.forwardRef(({className:es,isActive:ts,label:ss,onClick:ns,...rs},os)=>jsxRuntimeExports.jsx("button",{ref:os,type:"button",role:"switch","aria-checked":ts,onClick:ns,className:clsx("px-3 py-1.5 text-xs font-medium rounded-pill border transition-all duration-200 touch-manipulation","focus:outline-none focus:ring-2 focus:ring-gold/50",{"bg-gold-50 text-gold border-gold":ts,"bg-gray-100 text-text-muted border-gray-200 hover:bg-gray-200":!ts},es),...rs,children:ss}));TogglePill.displayName="TogglePill";const Switch=reactExports.forwardRef(({className:es,isOn:ts,label:ss,onToggle:ns,...rs},os)=>jsxRuntimeExports.jsxs("button",{ref:os,type:"button",role:"switch","aria-checked":ts,onClick:ns,className:clsx("relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-gold focus:ring-offset-2",{"bg-gold":ts,"bg-gray-200":!ts},es),...rs,children:[ss&&jsxRuntimeExports.jsx("span",{className:"sr-only",children:ss}),jsxRuntimeExports.jsx("span",{"aria-hidden":"true",className:clsx("pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",{"translate-x-5":ts,"translate-x-0":!ts})})]}));Switch.displayName="Switch";function Accordion({title:es,count:ts,badge:ss,defaultOpen:ns=!1,children:rs,className:os}){const[as,cs]=reactExports.useState(ns);return jsxRuntimeExports.jsxs("div",{className:clsx("bg-card rounded-card shadow-card overflow-hidden",os),children:[jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>cs(!as),className:"w-full flex items-center justify-between px-[18px] py-4 text-left touch-manipulation","aria-expanded":as,children:[jsxRuntimeExports.jsx("span",{className:"section-header",children:es}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2.5",children:[ss&&jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:ss}),ts!==void 0&&ts>0&&jsxRuntimeExports.jsx(CountBadge,{count:ts}),jsxRuntimeExports.jsx(ChevronIcon,{isOpen:as})]})]}),jsxRuntimeExports.jsx("div",{className:clsx("overflow-hidden transition-all duration-300 ease-in-out",{"max-h-0 opacity-0":!as,"max-h-[2000px] opacity-100":as}),children:jsxRuntimeExports.jsx("div",{className:"px-[18px] pb-[18px]",children:rs})})]})}function ChevronIcon({isOpen:es}){return jsxRuntimeExports.jsx("svg",{className:clsx("w-5 h-5 text-text-muted transition-transform duration-200",{"rotate-180":es}),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}function Modal({isOpen:es,onClose:ts,title:ss,children:ns,className:rs,showCloseButton:os=!0}){const as=reactExports.useRef(null);reactExports.useEffect(()=>{const ls=us=>{us.key==="Escape"&&es&&ts()};return document.addEventListener("keydown",ls),()=>document.removeEventListener("keydown",ls)},[es,ts]),reactExports.useEffect(()=>(es?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[es]);const cs=ls=>{ls.target===as.current&&ts()};return es?jsxRuntimeExports.jsx("div",{ref:as,onClick:cs,className:"fixed inset-0 z-50 flex items-end justify-center bg-black/50 backdrop-blur-sm animate-fadeIn",children:jsxRuntimeExports.jsxs("div",{className:clsx("w-full max-w-[430px] bg-card rounded-t-2xl shadow-xl animate-slideUp","max-h-[90vh] overflow-hidden flex flex-col",rs),children:[(ss||os)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[ss&&jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:ss}),os&&jsxRuntimeExports.jsx("button",{onClick:ts,className:"p-2 -m-2 text-text-muted hover:text-text-primary transition-colors tap-target","aria-label":"Close modal",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:ns})]})}):null}function BottomSheet({isOpen:es,onClose:ts,title:ss,children:ns,className:rs,showCloseButton:os=!0,height:as="auto"}){return jsxRuntimeExports.jsx(Modal,{isOpen:es,onClose:ts,title:ss,showCloseButton:os,className:clsx({"max-h-[50vh]":as==="half","h-[90vh]":as==="full"},rs),children:ns})}function FormField({label:es,value:ts,onChange:ss,readOnly:ns=!1,placeholder:rs,multiline:os=!1,rows:as=2}){if(ns)return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:es}),jsxRuntimeExports.jsx("div",{className:"text-sm text-text-primary",children:ts||jsxRuntimeExports.jsx("span",{className:"text-text-placeholder",children:""})})]});const cs="w-full bg-[#f8f7f5] border border-[#e8e6e1] rounded-lg px-3 py-3 text-sm text-[#1a1a1a] placeholder:text-[#999] focus:outline-none focus:border-gold focus:ring-1 focus:ring-gold/30 transition-colors";return os?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:es}),jsxRuntimeExports.jsx("textarea",{value:ts,onChange:ls=>ss(ls.target.value),placeholder:rs,rows:as,className:`${cs} resize-none`})]}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:es}),jsxRuntimeExports.jsx("input",{type:"text",value:ts,onChange:ls=>ss(ls.target.value),placeholder:rs,className:cs})]})}function Header({title:es,showBack:ts=!1,onBack:ss,showSearch:ns=!1,onSearch:rs,showDemo:os=!1,rightContent:as,className:cs}){return jsxRuntimeExports.jsx("header",{className:clsx("sticky top-0 z-30 bg-card border-b border-border safe-top",cs),children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between h-14 px-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[ts&&jsxRuntimeExports.jsx("button",{onClick:ss,className:"flex items-center gap-1 text-gold tap-target touch-manipulation -ml-2","aria-label":"Go back",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary truncate",children:es}),os&&jsxRuntimeExports.jsx(Badge,{variant:"gold",size:"sm",children:"DEMO"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[as,ns&&jsxRuntimeExports.jsx("button",{onClick:rs,className:"p-2 text-text-muted hover:text-text-primary tap-target touch-manipulation","aria-label":"Search",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]})})})}function ConfirmationModal({isOpen:es,onClose:ts,onConfirm:ss,title:ns,message:rs,confirmText:os="Confirm",cancelText:as="Cancel",variant:cs="default",requiresTextConfirmation:ls,isLoading:us=!1}){const[ds,xs]=reactExports.useState(""),fs=ls!==void 0&&ds.toLowerCase()!==ls.toLowerCase(),gs=()=>{xs(""),ts()},Es=()=>{!fs&&!us&&(ss(),xs(""))};return jsxRuntimeExports.jsx(Modal,{isOpen:es,onClose:gs,title:ns,children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-text-muted",children:rs}),ls&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted",children:['Type "',jsxRuntimeExports.jsx("span",{className:"font-medium text-text-primary",children:ls}),'" to confirm:']}),jsxRuntimeExports.jsx(Input,{type:"text",value:ds,onChange:js=>xs(js.target.value),placeholder:ls,autoComplete:"off"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 pt-2",children:[jsxRuntimeExports.jsx(Button,{variant:"secondary",onClick:gs,fullWidth:!0,disabled:us,children:as}),jsxRuntimeExports.jsx(Button,{variant:cs==="danger"?"outline":"primary",onClick:Es,fullWidth:!0,disabled:fs||us,className:cs==="danger"?"border-red-500 text-red-500 hover:bg-red-50":"",children:us?"Loading...":os})]})]})})}function ProjectMenu({isOpen:es,onClose:ts,project:ss,userTier:ns,onViewTeam:rs,onShareInvite:os,onViewStats:as,onOpenSettings:cs,onSwitchProject:ls,onLeaveProject:us}){const[ds,xs]=reactExports.useState(!1);if(!ss)return null;const fs=ss.role==="owner",gs=canManageProject(ns,{isOwner:fs,role:ss.role==="owner"?"designer":ss.role==="supervisor"?"supervisor":"trainee"}),Es=()=>{xs(!0)},js=()=>{xs(!1),ts(),us()},ps=()=>{switch(ss.role){case"owner":return"Owner";case"supervisor":return"Supervisor";case"artist":return"Artist";case"viewer":return"Viewer";default:return ss.role}},ms=[{icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})}),label:"Team",sublabel:`${ss.teamMemberCount} members`,onClick:()=>{ts(),rs()}},{icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"})}),label:"Share Invite Code",onClick:()=>{ts(),os()}},{icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"})}),label:"Project Stats",onClick:()=>{ts(),as()}}];return gs&&ms.push({icon:jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),label:"Project Settings",sublabel:fs?"Owner":"Supervisor access",onClick:()=>{ts(),cs()}}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(BottomSheet,{isOpen:es,onClose:ts,showCloseButton:!1,children:jsxRuntimeExports.jsxs("div",{className:"pb-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center pb-4 border-b border-border mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-text-primary",children:ss.projectName}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-text-muted mt-1",children:[ss.productionType==="film"&&"Feature Film",ss.productionType==="tv_series"&&"TV Series",ss.productionType==="short_film"&&"Short Film",ss.productionType==="commercial"&&"Commercial",ss.productionType==="music_video"&&"Music Video",ss.productionType==="other"&&"Production"]}),jsxRuntimeExports.jsx("div",{className:"inline-flex items-center gap-1 mt-2 px-2 py-1 bg-gold-50 rounded-full",children:jsxRuntimeExports.jsx("span",{className:"text-xs font-medium text-gold",children:ps()})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-1",children:ms.map((hs,vs)=>jsxRuntimeExports.jsxs("button",{onClick:hs.onClick,className:"w-full flex items-center gap-4 px-4 py-3 rounded-xl hover:bg-gray-50 active:bg-gray-100 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-xl bg-gold-50 flex items-center justify-center text-gold",children:hs.icon}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:hs.label}),hs.sublabel&&jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:hs.sublabel})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]},vs))}),jsxRuntimeExports.jsx("div",{className:"border-t border-border my-4"}),jsxRuntimeExports.jsxs("button",{onClick:()=>{ts(),ls()},className:"w-full flex items-center gap-4 px-4 py-3 rounded-xl hover:bg-gray-50 active:bg-gray-100 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-text-muted",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"})})}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary",children:"Switch Project"})]}),!fs&&jsxRuntimeExports.jsxs("button",{onClick:Es,className:"w-full flex items-center gap-4 px-4 py-3 rounded-xl hover:bg-red-50 active:bg-red-100 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-50 flex items-center justify-center text-red-500",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})})}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-red-500",children:"Leave Project"})]})]})}),jsxRuntimeExports.jsx(ConfirmationModal,{isOpen:ds,onClose:()=>xs(!1),onConfirm:js,title:`Leave "${ss.projectName}"?`,message:jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("p",{children:"You will lose access to this project immediately."}),jsxRuntimeExports.jsx("p",{children:"To rejoin, you'll need a new invite code from the project owner."})]}),confirmText:"Leave Project",variant:"danger"})]})}function TeamMemberCard({member:es,canManage:ts,onChangeRole:ss,onRemove:ns}){const[rs,os]=reactExports.useState(!1),[as,cs]=reactExports.useState(!1),ls=reactExports.useRef(null),us=ps=>new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"short",year:"numeric"}).format(new Date(ps)),ds=ps=>ps.split(" ").map(ms=>ms[0]).join("").toUpperCase().slice(0,2),xs=ps=>{const ms=["bg-blue-500","bg-green-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-teal-500","bg-orange-500","bg-cyan-500"];let hs=0;for(let vs=0;vs<ps.length;vs++)hs=ps.charCodeAt(vs)+((hs<<5)-hs);return ms[Math.abs(hs)%ms.length]};reactExports.useEffect(()=>{const ps=ms=>{ls.current&&!ls.current.contains(ms.target)&&(os(!1),cs(!1))};if(rs)return document.addEventListener("mousedown",ps),()=>document.removeEventListener("mousedown",ps)},[rs]);const fs=()=>{ts&&!es.isOwner&&(os(!0),"vibrate"in navigator&&navigator.vibrate(50))},gs=reactExports.useRef(null),Es=()=>{gs.current=setTimeout(fs,500)},js=()=>{gs.current&&(clearTimeout(gs.current),gs.current=null)};return jsxRuntimeExports.jsxs("div",{className:"relative",ref:ls,children:[jsxRuntimeExports.jsxs("div",{className:"card flex items-center gap-3 mb-2",onTouchStart:Es,onTouchEnd:js,onTouchCancel:js,onContextMenu:ps=>{ts&&!es.isOwner&&(ps.preventDefault(),os(!0))},children:[es.avatarUrl?jsxRuntimeExports.jsx("img",{src:es.avatarUrl,alt:es.name,className:"w-12 h-12 rounded-full object-cover"}):jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold ${xs(es.name)}`,children:ds(es.name)}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-text-primary truncate",children:es.name}),es.isOwner&&jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 text-[10px] font-medium bg-gold-100 text-gold rounded-full",children:"Owner"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:getTeamMemberRoleLabel(es.role)}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-light",children:["Joined ",us(es.joinedAt)]})]}),ts&&!es.isOwner&&jsxRuntimeExports.jsx("button",{onClick:()=>os(!rs),className:"p-2 -m-2 text-text-muted hover:text-text-primary transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})]}),rs&&jsxRuntimeExports.jsxs("div",{className:"absolute right-4 top-full mt-1 z-10 bg-card rounded-xl shadow-lg border border-border overflow-hidden min-w-[160px]",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{os(!1),cs(!0)},className:"w-full px-4 py-3 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Change Role"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{os(!1),ns==null||ns(es.userId)},className:"w-full px-4 py-3 text-left text-sm text-red-500 hover:bg-red-50 flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove from Project"]})]}),as&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/50",children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-[430px] bg-card rounded-t-2xl shadow-xl animate-slideUp",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-border",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Change Role"}),jsxRuntimeExports.jsx("button",{onClick:()=>cs(!1),className:"p-2 -m-2 text-text-muted hover:text-text-primary",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-text-muted mt-1",children:["Select a new role for ",es.name]})]}),jsxRuntimeExports.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:jsxRuntimeExports.jsx("div",{className:"space-y-2",children:TEAM_MEMBER_ROLES.map(ps=>jsxRuntimeExports.jsxs("button",{onClick:()=>{ss==null||ss(es.userId,ps.value),cs(!1)},className:`w-full px-4 py-3 rounded-xl text-left flex items-center justify-between transition-colors ${es.role===ps.value?"bg-gold-50 border border-gold":"bg-gray-50 hover:bg-gray-100"}`,children:[jsxRuntimeExports.jsx("span",{className:`text-sm font-medium ${es.role===ps.value?"text-gold":"text-text-primary"}`,children:ps.label}),es.role===ps.value&&jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},ps.value))})})]})})]})}function TeamMemberList({members:es,canManage:ts,onChangeRole:ss,onRemoveMember:ns}){const[rs,os]=reactExports.useState(null),as=groupTeamMembersByRole(es),cs=ds=>{const xs=es.find(fs=>fs.userId===ds);xs&&os(xs)},ls=()=>{rs&&(ns==null||ns(rs.userId),os(null))},us=ds=>{const xs=ds.members.length;switch(ds.role){case"designer":return`DESIGNERS (HOD) (${xs})`;case"supervisor":return`SUPERVISORS (${xs})`;case"key":return`KEY ARTISTS (${xs})`;case"hair":return`HAIR ARTISTS (${xs})`;case"makeup":return`MAKEUP ARTISTS (${xs})`;case"sfx":return`SPECIAL EFFECTS ARTISTS (${xs})`;case"daily":return`DAILIES (${xs})`;case"trainee":return`TRAINEES (${xs})`;default:return`${ds.label.toUpperCase()} (${xs})`}};return es.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-text-muted",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"No team members yet"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-light mt-1",children:"Share the invite code to add team members"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"space-y-6",children:as.map(ds=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3 px-1",children:us(ds)}),jsxRuntimeExports.jsx("div",{children:ds.members.map(xs=>jsxRuntimeExports.jsx(TeamMemberCard,{member:xs,canManage:ts,onChangeRole:ss,onRemove:cs},xs.userId))})]},ds.role))}),jsxRuntimeExports.jsx(ConfirmationModal,{isOpen:!!rs,onClose:()=>os(null),onConfirm:ls,title:`Remove ${rs==null?void 0:rs.name}?`,message:jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("p",{children:"They will lose access to this project immediately."}),jsxRuntimeExports.jsx("p",{children:"Their contributions will remain."})]}),confirmText:"Remove",variant:"danger"})]})}function InviteCodeShare({inviteCode:es,isOwner:ts,onRegenerateCode:ss}){const[ns,rs]=reactExports.useState(null),[os,as]=reactExports.useState(!1),[cs,ls]=reactExports.useState(!1),[us,ds]=reactExports.useState(es),xs=`checkshappy.app/join/${us}`,fs=async(js,ps)=>{try{await navigator.clipboard.writeText(js),rs(ps),setTimeout(()=>rs(null),2e3)}catch{const ms=document.createElement("textarea");ms.value=js,document.body.appendChild(ms),ms.select(),document.execCommand("copy"),document.body.removeChild(ms),rs(ps),setTimeout(()=>rs(null),2e3)}},gs=async()=>{if(navigator.share)try{await navigator.share({title:"Join my project on Checks Happy",text:`Use code ${us} to join my production on Checks Happy!`,url:`https://${xs}`})}catch{}else fs(`https://${xs}`,"link")},Es=async()=>{if(ss){ls(!0);try{const js=await ss();ds(js),as(!1)}finally{ls(!1)}}};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-4",children:"Share this code with your team:"}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 rounded-2xl p-6 mb-4",children:jsxRuntimeExports.jsx("span",{className:"text-3xl font-bold tracking-widest text-text-primary",children:us})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:()=>fs(us,"code"),fullWidth:!0,children:ns==="code"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy"]})}),jsxRuntimeExports.jsxs(Button,{variant:"primary",onClick:gs,fullWidth:!0,children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share"]})]})]}),jsxRuntimeExports.jsx("div",{className:"border-t border-border"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-3",children:"Or share this link:"}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 rounded-xl p-3 mb-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-text-primary font-mono break-all",children:xs})}),jsxRuntimeExports.jsx(Button,{variant:"secondary",onClick:()=>fs(`https://${xs}`,"link"),fullWidth:!0,children:ns==="link"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Link Copied!"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Copy Link"]})})]}),jsxRuntimeExports.jsx("div",{className:"border-t border-border"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 p-4 bg-gold-50/50 rounded-xl",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-text-muted",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-text-primary",children:"Tip:"})," Add the code to your call sheet so the whole team can join easily."]})]}),ts&&ss&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"border-t border-border"}),jsxRuntimeExports.jsx("div",{className:"p-4 bg-amber-50 rounded-xl",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-amber-800 mb-1",children:"Regenerate Code"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-amber-700 mb-3",children:"Create a new code if the current one has been shared too widely. Existing team members won't be affected."}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>as(!0),className:"border-amber-600 text-amber-700 hover:bg-amber-100",children:"Regenerate Code"})]})]})})]})]}),jsxRuntimeExports.jsx(ConfirmationModal,{isOpen:os,onClose:()=>as(!1),onConfirm:Es,title:"Regenerate invite code?",message:jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("p",{children:["The current code (",jsxRuntimeExports.jsx("span",{className:"font-mono font-medium",children:us}),") will stop working immediately."]}),jsxRuntimeExports.jsx("p",{children:"Team members already joined won't be affected."})]}),confirmText:"Regenerate",isLoading:cs})]})}function ProjectStatsCard({stats:es}){const ts=ss=>{if(!ss)return"No activity";const rs=new Date().getTime()-new Date(ss).getTime(),os=Math.floor(rs/(1e3*60)),as=Math.floor(rs/(1e3*60*60)),cs=Math.floor(rs/(1e3*60*60*24));return os<1?"Just now":os<60?`${os} minutes ago`:as<24?`${as} hours ago`:cs===1?"Yesterday":cs<7?`${cs} days ago`:new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"short"}).format(new Date(ss))};return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"SCRIPT"}),jsxRuntimeExports.jsxs("div",{className:"card space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Scenes"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:es.sceneCount})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Story Days"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:es.storyDays})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Characters"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:es.characterCount})]})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"CONTINUITY"}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Progress"}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-semibold text-text-primary",children:[es.completionPercentage,"%"]})]}),jsxRuntimeExports.jsx("div",{className:"w-full h-3 bg-gray-100 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full gold-gradient rounded-full transition-all duration-500",style:{width:`${es.completionPercentage}%`}})}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted mt-2",children:[es.completedScenes," of ",es.sceneCount," scenes checked"]})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"PHOTOS"}),jsxRuntimeExports.jsxs("div",{className:"card space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Photos Uploaded"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:es.photoCount.toLocaleString()})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Storage Used"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:formatStorageSize(es.storageUsed)})]})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"TEAM ACTIVITY"}),jsxRuntimeExports.jsxs("div",{className:"card space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Team Members"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:es.teamMemberCount})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Last Activity"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:ts(es.lastActivity)})]}),es.mostActiveUser&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Most Active"}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-semibold text-text-primary",children:[es.mostActiveUser.name," (",es.mostActiveUser.editCount.toLocaleString()," edits)"]})]})]})]})]})}function PermissionPicker({label:es,value:ts,onChange:ss,disabled:ns=!1}){var cs;const[rs,os]=reactExports.useState(!1),as=((cs=PERMISSION_LEVELS.find(ls=>ls.value===ts))==null?void 0:cs.label)||ts;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("button",{onClick:()=>!ns&&os(!0),disabled:ns,className:`w-full card flex items-center justify-between ${ns?"opacity-50 cursor-not-allowed":"active:scale-[0.98] transition-transform"}`,children:[jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:es}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:as})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]}),jsxRuntimeExports.jsx(BottomSheet,{isOpen:rs,onClose:()=>os(!1),title:es,children:jsxRuntimeExports.jsx("div",{className:"space-y-2",children:PERMISSION_LEVELS.map(ls=>jsxRuntimeExports.jsxs("button",{onClick:()=>{ss(ls.value),os(!1)},className:`w-full px-4 py-3 rounded-xl text-left flex items-center justify-between transition-colors ${ts===ls.value?"bg-gold-50 border border-gold":"bg-gray-50 hover:bg-gray-100"}`,children:[jsxRuntimeExports.jsx("span",{className:`text-sm font-medium ${ts===ls.value?"text-gold":"text-text-primary"}`,children:ls.label}),ts===ls.value&&jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},ls.value))})})]})}const STATUS_OPTIONS=[{value:"prep",label:"Prep",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})},{value:"shooting",label:"Shooting",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})},{value:"wrapped",label:"Wrapped",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}];function StatusPicker({value:es,onChange:ts,disabled:ss=!1}){const[ns,rs]=reactExports.useState(!1),os=STATUS_OPTIONS.find(as=>as.value===es);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("button",{onClick:()=>!ss&&rs(!0),disabled:ss,className:`w-full card flex items-center justify-between ${ss?"opacity-50 cursor-not-allowed":"active:scale-[0.98] transition-transform"}`,children:[jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Project Status"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:os==null?void 0:os.label})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]}),jsxRuntimeExports.jsx(BottomSheet,{isOpen:ns,onClose:()=>rs(!1),title:"Project Status",children:jsxRuntimeExports.jsx("div",{className:"space-y-2",children:STATUS_OPTIONS.map(as=>jsxRuntimeExports.jsxs("button",{onClick:()=>{ts(as.value),rs(!1)},className:`w-full px-4 py-3 rounded-xl text-left flex items-center gap-3 transition-colors ${es===as.value?"bg-gold-50 border border-gold":"bg-gray-50 hover:bg-gray-100"}`,children:[jsxRuntimeExports.jsx("div",{className:`${es===as.value?"text-gold":"text-text-muted"}`,children:as.icon}),jsxRuntimeExports.jsx("span",{className:`flex-1 text-sm font-medium ${es===as.value?"text-gold":"text-text-primary"}`,children:as.label}),es===as.value&&jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},as.value))})})]})}const PRODUCTION_TYPE_OPTIONS=[{value:"film",label:"Feature Film"},{value:"tv_series",label:"TV Series"},{value:"short_film",label:"Short Film"},{value:"commercial",label:"Commercial"},{value:"music_video",label:"Music Video"},{value:"theatre",label:"Theatre"},{value:"other",label:"Other"}];function ProductionTypeSelector({value:es,onChange:ts,disabled:ss=!1}){var as;const[ns,rs]=reactExports.useState(!1),os=((as=PRODUCTION_TYPE_OPTIONS.find(cs=>cs.value===es))==null?void 0:as.label)||es;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("button",{onClick:()=>!ss&&rs(!0),disabled:ss,className:`w-full card flex items-center justify-between ${ss?"opacity-50 cursor-not-allowed":"active:scale-[0.98] transition-transform"}`,children:[jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Production Type"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:os})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]}),jsxRuntimeExports.jsx(BottomSheet,{isOpen:ns,onClose:()=>rs(!1),title:"Production Type",children:jsxRuntimeExports.jsx("div",{className:"space-y-2",children:PRODUCTION_TYPE_OPTIONS.map(cs=>jsxRuntimeExports.jsxs("button",{onClick:()=>{ts(cs.value),rs(!1)},className:`w-full px-4 py-3 rounded-xl text-left flex items-center justify-between transition-colors ${es===cs.value?"bg-gold-50 border border-gold":"bg-gray-50 hover:bg-gray-100"}`,children:[jsxRuntimeExports.jsx("span",{className:`text-sm font-medium ${es===cs.value?"text-gold":"text-text-primary"}`,children:cs.label}),es===cs.value&&jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},cs.value))})})]})}function ScheduleEditor({scenes:es,onSave:ts,initialDayNumber:ss=1,initialDate:ns=new Date,initialSceneIds:rs=[]}){const[os,as]=reactExports.useState(ss),[cs,ls]=reactExports.useState(js(ns)),[us,ds]=reactExports.useState(new Set(rs)),[xs,fs]=reactExports.useState(""),[gs,Es]=reactExports.useState(!1);function js(ys){return ys.toISOString().split("T")[0]}function ps(ys){const Rs=new Date(ys);return new Intl.DateTimeFormat("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}).format(Rs)}const ms=reactExports.useMemo(()=>{if(!xs.trim())return es;const ys=xs.toLowerCase();return es.filter(Rs=>Rs.sceneNumber.toLowerCase().includes(ys)||Rs.slugline.toLowerCase().includes(ys))},[es,xs]),hs=ys=>{const Rs=new Set(us);Rs.has(ys)?Rs.delete(ys):Rs.add(ys),ds(Rs)},vs=async()=>{Es(!0);try{const ys=new Date(cs);ts(os,ys,Array.from(us))}finally{Es(!1)}},ws=reactExports.useMemo(()=>es.filter(ys=>us.has(ys.id)),[es,us]);return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-medium text-text-muted mb-1.5",children:"Shooting Day"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("select",{value:os,onChange:ys=>as(Number(ys.target.value)),className:"input-field w-full appearance-none pr-10",children:Array.from({length:100},(ys,Rs)=>Rs+1).map(ys=>jsxRuntimeExports.jsxs("option",{value:ys,children:["Day ",ys]},ys))}),jsxRuntimeExports.jsx("svg",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-medium text-text-muted mb-1.5",children:"Date"}),jsxRuntimeExports.jsx("input",{type:"date",value:cs,onChange:ys=>ls(ys.target.value),className:"input-field w-full"})]})]}),jsxRuntimeExports.jsx("div",{className:"text-center py-2 px-4 bg-gold-50 rounded-xl",children:jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gold",children:ps(cs)})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-medium text-text-muted mb-1.5",children:"SELECT SCENES FOR TODAY:"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),jsxRuntimeExports.jsx(Input,{type:"text",value:xs,onChange:ys=>fs(ys.target.value),placeholder:"Search scenes...",className:"pl-10"})]})]}),jsxRuntimeExports.jsxs("div",{className:"max-h-[40vh] overflow-y-auto -mx-4 px-4",children:[jsxRuntimeExports.jsx("div",{className:"space-y-2",children:ms.map(ys=>{const Rs=us.has(ys.id);return jsxRuntimeExports.jsxs("button",{onClick:()=>hs(ys.id),className:`w-full px-4 py-3 rounded-xl text-left flex items-center gap-3 transition-colors ${Rs?"bg-gold-50 border border-gold":"bg-gray-50 hover:bg-gray-100"}`,children:[jsxRuntimeExports.jsx("div",{className:`w-5 h-5 rounded-md border-2 flex items-center justify-center transition-colors ${Rs?"bg-gold border-gold text-white":"border-gray-300"}`,children:Rs&&jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm font-semibold text-text-primary",children:["Scene ",ys.sceneNumber]}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:ys.intExt})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted truncate",children:ys.slugline})]}),ys.isComplete&&jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 text-[10px] font-medium bg-green-100 text-green-600 rounded-full",children:"Complete"})]},ys.id)})}),ms.length===0&&jsxRuntimeExports.jsx("div",{className:"text-center py-8",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"No scenes found"})})]}),jsxRuntimeExports.jsx("div",{className:"py-2 border-t border-border",children:jsxRuntimeExports.jsxs("p",{className:"text-sm text-text-muted text-center",children:[us.size," scene",us.size!==1?"s":""," selected"]})}),ws.length>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium text-text-muted mb-2",children:"Shot Order:"}),jsxRuntimeExports.jsx("div",{className:"space-y-1",children:ws.map((ys,Rs)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsxs("span",{className:"text-xs font-bold text-text-muted w-5",children:[Rs+1,"."]}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-primary",children:["Scene ",ys.sceneNumber]}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted truncate flex-1",children:ys.slugline})]},ys.id))}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-light mt-2 text-center",children:"Tip: Drag to reorder scenes for shot order"})]}),jsxRuntimeExports.jsx(Button,{variant:"primary",onClick:vs,fullWidth:!0,disabled:us.size===0||gs,children:gs?"Saving...":"Save Today's Schedule"})]})}function DangerZone({projectName:es,photoCount:ts,onArchive:ss,onDelete:ns}){const[rs,os]=reactExports.useState(!1),[as,cs]=reactExports.useState(!1),[ls,us]=reactExports.useState(!1),[ds,xs]=reactExports.useState(!1),fs=async()=>{us(!0);try{await ss(),os(!1)}finally{us(!1)}},gs=async()=>{xs(!0);try{await ns(),cs(!1)}finally{xs(!1)}};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-red-500 mb-3",children:"DANGER ZONE"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>os(!0),className:"w-full card flex items-center gap-4 active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-50 flex items-center justify-center text-amber-600",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Archive Project"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Mark as wrapped, make read-only"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>cs(!0),className:"w-full card flex items-center gap-4 border-red-200 active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-50 flex items-center justify-center text-red-500",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-red-500",children:"Delete Project"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Permanently delete all data"})]}),jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})]})]})]}),jsxRuntimeExports.jsx(ConfirmationModal,{isOpen:rs,onClose:()=>os(!1),onConfirm:fs,title:`Archive "${es}"?`,message:jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("p",{children:"The project will become read-only."}),jsxRuntimeExports.jsx("p",{children:"Team members can still view continuity data and photos, but can't make changes."}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:"You can restore it later from your Dashboard."})]}),confirmText:"Archive Project",isLoading:ls}),jsxRuntimeExports.jsx(ConfirmationModal,{isOpen:as,onClose:()=>cs(!1),onConfirm:gs,title:`Delete "${es}"?`,message:jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"This cannot be undone."})]}),jsxRuntimeExports.jsx("p",{children:"This will permanently delete:"}),jsxRuntimeExports.jsxs("ul",{className:"list-disc list-inside space-y-1 text-text-muted",children:[jsxRuntimeExports.jsx("li",{children:"All scenes and breakdowns"}),jsxRuntimeExports.jsx("li",{children:"All continuity notes"}),jsxRuntimeExports.jsxs("li",{children:["All ",ts.toLocaleString()," photos"]}),jsxRuntimeExports.jsx("li",{children:"Team member access"})]})]}),confirmText:"Delete Forever",variant:"danger",requiresTextConfirmation:es,isLoading:ds})]})}const mockDelay=es=>new Promise(ts=>setTimeout(ts,es)),generateMockTeamMembers=es=>[{name:"Sarah Chen",role:"designer",isOwner:!0},{name:"Mike Torres",role:"supervisor",isOwner:!1},{name:"Emma Wright",role:"key",isOwner:!1},{name:"David Park",role:"key",isOwner:!1},{name:"Lucy Hammond",role:"hair",isOwner:!1},{name:"Alex Rivera",role:"makeup",isOwner:!1},{name:"Jordan Lee",role:"sfx",isOwner:!1},{name:"James Cole",role:"daily",isOwner:!1}].map((ss,ns)=>({userId:`user-${ns+1}`,projectId:es,name:ss.name,email:`${ss.name.toLowerCase().replace(" ",".")}@example.com`,role:ss.role,isOwner:ss.isOwner,joinedAt:new Date(Date.now()-(30-ns)*24*60*60*1e3),lastActiveAt:new Date(Date.now()-ns*60*60*1e3),editCount:Math.floor(Math.random()*500)+50})),generateMockStats=()=>({sceneCount:142,storyDays:23,characterCount:14,completedScenes:94,completionPercentage:67,photoCount:1247,storageUsed:2.3*1024*1024*1024,teamMemberCount:8,lastActivity:new Date(Date.now()-2*60*60*1e3),mostActiveUser:{name:"Sarah Chen",editCount:342}}),useProjectSettingsStore=create((es,ts)=>({projectSettings:null,teamMembers:[],projectStats:null,shootingDays:[],isLoading:!1,error:null,loadProjectSettings:async ss=>{es({isLoading:!0,error:null});try{await mockDelay(400);const ns={id:ss,name:"The Punishing",type:"film",status:"shooting",inviteCode:"TMK-4827",ownerId:"user-1",permissions:createDefaultProjectPermissions(),createdAt:new Date(Date.now()-30*24*60*60*1e3),archivedAt:null},rs=generateMockStats();es({projectSettings:ns,projectStats:rs,isLoading:!1})}catch{es({isLoading:!1,error:"Failed to load project settings"})}},updateProjectName:async ss=>{const{projectSettings:ns}=ts();if(ns){es({isLoading:!0});try{await mockDelay(300),es({projectSettings:{...ns,name:ss},isLoading:!1})}catch{es({isLoading:!1,error:"Failed to update project name"})}}},updateProjectType:async ss=>{const{projectSettings:ns}=ts();if(ns){es({isLoading:!0});try{await mockDelay(300),es({projectSettings:{...ns,type:ss},isLoading:!1})}catch{es({isLoading:!1,error:"Failed to update project type"})}}},updateProjectStatus:async ss=>{const{projectSettings:ns}=ts();if(ns){es({isLoading:!0});try{await mockDelay(300),es({projectSettings:{...ns,status:ss},isLoading:!1})}catch{es({isLoading:!1,error:"Failed to update project status"})}}},updatePermission:async(ss,ns)=>{const{projectSettings:rs}=ts();if(rs){es({isLoading:!0});try{await mockDelay(300),es({projectSettings:{...rs,permissions:{...rs.permissions,[ss]:ns}},isLoading:!1})}catch{es({isLoading:!1,error:"Failed to update permission"})}}},regenerateInviteCode:async()=>{const{projectSettings:ss}=ts();if(!ss)throw new Error("No project loaded");es({isLoading:!0});try{await mockDelay(500);const ns=generateProjectCode();return es({projectSettings:{...ss,inviteCode:ns},isLoading:!1}),ns}catch{throw es({isLoading:!1,error:"Failed to regenerate invite code"}),new Error("Failed to regenerate invite code")}},archiveProject:async()=>{const{projectSettings:ss}=ts();if(ss){es({isLoading:!0});try{await mockDelay(500),es({projectSettings:{...ss,status:"archived",archivedAt:new Date},isLoading:!1})}catch{throw es({isLoading:!1,error:"Failed to archive project"}),new Error("Failed to archive project")}}},deleteProject:async()=>{es({isLoading:!0});try{await mockDelay(800),es({projectSettings:null,teamMembers:[],projectStats:null,shootingDays:[],isLoading:!1})}catch{throw es({isLoading:!1,error:"Failed to delete project"}),new Error("Failed to delete project")}},loadTeamMembers:async ss=>{es({isLoading:!0,error:null});try{await mockDelay(400);const ns=generateMockTeamMembers(ss);es({teamMembers:ns,isLoading:!1})}catch{es({isLoading:!1,error:"Failed to load team members"})}},changeTeamMemberRole:async(ss,ns)=>{const{teamMembers:rs}=ts();es({isLoading:!0});try{await mockDelay(300);const os=rs.map(as=>as.userId===ss?{...as,role:ns}:as);es({teamMembers:os,isLoading:!1})}catch{es({isLoading:!1,error:"Failed to change role"})}},removeTeamMember:async ss=>{const{teamMembers:ns,projectStats:rs}=ts();es({isLoading:!0});try{await mockDelay(400);const os=ns.filter(as=>as.userId!==ss);es({teamMembers:os,projectStats:rs?{...rs,teamMemberCount:os.length}:null,isLoading:!1})}catch{es({isLoading:!1,error:"Failed to remove team member"})}},saveShootingDay:async(ss,ns,rs)=>{const{shootingDays:os,projectSettings:as}=ts();if(as){es({isLoading:!0});try{await mockDelay(400);const cs={id:`day-${ss}`,projectId:as.id,dayNumber:ss,date:ns,sceneIds:rs,createdBy:"current-user",createdAt:new Date},ls=os.findIndex(ds=>ds.dayNumber===ss),us=ls>=0?os.map((ds,xs)=>xs===ls?cs:ds):[...os,cs];es({shootingDays:us,isLoading:!1})}catch{es({isLoading:!1,error:"Failed to save shooting day"})}}},clearState:()=>{es({projectSettings:null,teamMembers:[],projectStats:null,shootingDays:[],isLoading:!1,error:null})}}));function TeamScreen({projectId:es,canManage:ts,isOwner:ss,onBack:ns,onInvite:rs}){const{teamMembers:os,isLoading:as,loadTeamMembers:cs,changeTeamMemberRole:ls,removeTeamMember:us}=useProjectSettingsStore();reactExports.useEffect(()=>{cs(es)},[es,cs]);const ds=(fs,gs)=>{ls(fs,gs)},xs=fs=>{us(fs)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:ns,className:"p-2 -ml-2 text-text-muted hover:text-text-primary transition-colors tap-target",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Team"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted",children:[os.length," members"]})]})]}),ss&&jsxRuntimeExports.jsxs(Button,{variant:"primary",size:"sm",onClick:rs,children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Invite"]})]})})}),jsxRuntimeExports.jsx("div",{className:"mobile-container px-4 py-4",children:as&&os.length===0?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-12",children:jsxRuntimeExports.jsx("div",{className:"w-8 h-8 border-2 border-gold border-t-transparent rounded-full animate-spin"})}):jsxRuntimeExports.jsx(TeamMemberList,{members:os,canManage:ts,onChangeRole:ds,onRemoveMember:xs})})]})}function InviteScreen({inviteCode:es,isOwner:ts,onBack:ss}){const{regenerateInviteCode:ns}=useProjectSettingsStore();return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:ss,className:"p-2 -ml-2 text-text-muted hover:text-text-primary transition-colors tap-target",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Invite Team"})]})})}),jsxRuntimeExports.jsx("div",{className:"mobile-container px-4 py-6",children:jsxRuntimeExports.jsx(InviteCodeShare,{inviteCode:es,isOwner:ts,onRegenerateCode:ts?ns:void 0})})]})}function ProjectStatsScreen({projectId:es,onBack:ts}){const{projectStats:ss,isLoading:ns,loadProjectSettings:rs}=useProjectSettingsStore();return reactExports.useEffect(()=>{ss||rs(es)},[es,ss,rs]),jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:ts,className:"p-2 -ml-2 text-text-muted hover:text-text-primary transition-colors tap-target",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Project Stats"})]})})}),jsxRuntimeExports.jsx("div",{className:"mobile-container px-4 py-4",children:ns&&!ss?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-12",children:jsxRuntimeExports.jsx("div",{className:"w-8 h-8 border-2 border-gold border-t-transparent rounded-full animate-spin"})}):ss?jsxRuntimeExports.jsx(ProjectStatsCard,{stats:ss}):jsxRuntimeExports.jsx("div",{className:"text-center py-12",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"No stats available"})})})]})}function ScheduleScreen({onBack:es,onSaved:ts}){const{currentProject:ss}=useProjectStore(),{saveShootingDay:ns}=useProjectSettingsStore(),rs=(ss==null?void 0:ss.scenes)||[],os=async(as,cs,ls)=>{await ns(as,cs,ls),ts==null||ts()};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"p-2 -ml-2 text-text-muted hover:text-text-primary transition-colors tap-target",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Today's Scenes"})]})})}),jsxRuntimeExports.jsx("div",{className:"mobile-container px-4 py-4 pb-safe-bottom",children:rs.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-text-muted",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"})})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"No scenes available"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-light mt-1",children:"Import a script to add scenes"})]}):jsxRuntimeExports.jsx(ScheduleEditor,{scenes:rs,onSave:os})})]})}function ProjectSettingsScreen({projectId:es,onBack:ts,onNavigateToSchedule:ss,onNavigateToSceneManagement:ns,onProjectArchived:rs,onProjectDeleted:os}){const{projectSettings:as,projectStats:cs,isLoading:ls,loadProjectSettings:us,updateProjectName:ds,updateProjectType:xs,updateProjectStatus:fs,updatePermission:gs,archiveProject:Es,deleteProject:js}=useProjectSettingsStore(),[ps,ms]=reactExports.useState(!1),[hs,vs]=reactExports.useState("");reactExports.useEffect(()=>{us(es)},[es,us]),reactExports.useEffect(()=>{as&&vs(as.name)},[as]);const ws=async()=>{hs.trim()&&hs!==(as==null?void 0:as.name)&&await ds(hs.trim()),ms(!1)},ys=async()=>{await Es(),rs==null||rs()},Rs=async()=>{await js(),os==null||os()};return ls&&!as?jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:ts,className:"p-2 -ml-2 text-text-muted hover:text-text-primary transition-colors tap-target",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Project Settings"})]})})}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-12",children:jsxRuntimeExports.jsx("div",{className:"w-8 h-8 border-2 border-gold border-t-transparent rounded-full animate-spin"})})]}):as?jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:ts,className:"p-2 -ml-2 text-text-muted hover:text-text-primary transition-colors tap-target",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Project Settings"})]})})}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-4 space-y-6",children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"PROJECT DETAILS"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[ps?jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-medium text-text-muted mb-1.5",children:"Production Name"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx(Input,{value:hs,onChange:bs=>vs(bs.target.value),autoFocus:!0,className:"flex-1"}),jsxRuntimeExports.jsx("button",{onClick:ws,className:"px-3 py-2 text-sm font-medium text-gold hover:bg-gold-50 rounded-lg transition-colors",children:"Save"}),jsxRuntimeExports.jsx("button",{onClick:()=>{vs(as.name),ms(!1)},className:"px-3 py-2 text-sm text-text-muted hover:bg-gray-100 rounded-lg transition-colors",children:"Cancel"})]})]}):jsxRuntimeExports.jsxs("button",{onClick:()=>ms(!0),className:"w-full card flex items-center justify-between active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Production Name"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:as.name})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]}),jsxRuntimeExports.jsx(ProductionTypeSelector,{value:as.type,onChange:xs}),jsxRuntimeExports.jsx(StatusPicker,{value:as.status,onChange:fs})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"SHOOTING SCHEDULE"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{},className:"w-full card flex items-center justify-between active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Import Schedule"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Upload a shooting schedule"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]}),jsxRuntimeExports.jsxs("button",{onClick:ss,className:"w-full card flex items-center justify-between active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Manual Schedule Entry"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Set today's scenes manually"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"SCRIPT"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{},className:"w-full card flex items-center justify-between active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Re-import Script"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Upload updated script"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]}),jsxRuntimeExports.jsxs("button",{onClick:ns,className:"w-full card flex items-center justify-between active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Scene Management"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Add, edit, or remove scenes"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"TEAM PERMISSIONS"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx(PermissionPicker,{label:"Who can add photos",value:as.permissions.addPhotos,onChange:bs=>gs("addPhotos",bs)}),jsxRuntimeExports.jsx(PermissionPicker,{label:"Who can edit continuity notes",value:as.permissions.editNotes,onChange:bs=>gs("editNotes",bs)}),jsxRuntimeExports.jsx(PermissionPicker,{label:"Who can mark scenes complete",value:as.permissions.markComplete,onChange:bs=>gs("markComplete",bs)})]})]}),jsxRuntimeExports.jsx(DangerZone,{projectName:as.name,photoCount:(cs==null?void 0:cs.photoCount)||0,onArchive:ys,onDelete:Rs})]})]}):null}function ProjectHeader({onNavigateToSubView:es,onSwitchProject:ts}){const[ss,ns]=reactExports.useState(!1),{currentProject:rs}=useProjectStore(),{user:os,projectMemberships:as}=useAuthStore();if(!rs)return null;const cs=as.find(js=>js.projectId===rs.id)||as[0]||{projectId:rs.id,projectName:rs.name,productionType:"film",role:"owner",joinedAt:rs.createdAt,lastAccessedAt:rs.updatedAt,teamMemberCount:1,sceneCount:rs.scenes.length,projectCode:"",status:"active"},ls=()=>cs!=null&&cs.productionType&&{film:"Feature Film",tv_series:"TV Series",short_film:"Short Film",commercial:"Commercial",music_video:"Music Video",other:"Production"}[cs.productionType]||"",us=()=>{ns(!1),es==null||es("team")},ds=()=>{ns(!1),es==null||es("invite")},xs=()=>{ns(!1),es==null||es("projectStats")},fs=()=>{ns(!1),es==null||es("projectSettings")},gs=()=>{ns(!1),ts==null||ts()},Es=()=>{ns(!1),ts==null||ts()};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"bg-card border-b border-border",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("button",{onClick:()=>ns(!0),className:"w-full h-12 px-4 flex items-center justify-between active:bg-gray-50 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg gold-gradient flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"})})}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-text-primary truncate",children:rs.name}),ls()&&jsxRuntimeExports.jsx("p",{className:"text-[10px] text-text-muted truncate",children:ls()})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 text-text-muted",children:[jsxRuntimeExports.jsx("span",{className:"text-xs",children:"Menu"}),jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]})]})})}),jsxRuntimeExports.jsx(ProjectMenu,{isOpen:ss,onClose:()=>ns(!1),project:cs,userTier:(os==null?void 0:os.tier)||"trainee",onViewTeam:us,onShareInvite:ds,onViewStats:xs,onOpenSettings:fs,onSwitchProject:gs,onLeaveProject:Es})]})}function getCaptureStatus(es){return!es||!(es.photos.front||es.photos.left||es.photos.right||es.photos.back||es.additionalPhotos.length>0)?"not-started":es.photos.front?"complete":"in-progress"}function formatSceneRange(es){if(es.length===0)return"";if(es.length===1)return es[0];const ts=[...es].sort((cs,ls)=>cs.localeCompare(ls,void 0,{numeric:!0})),ss=[];let ns=ts[0],rs=ts[0],os=parseInt(ns,10),as=os;for(let cs=1;cs<ts.length;cs++){const ls=ts[cs],us=parseInt(ls,10);!isNaN(as)&&!isNaN(us)&&ls===String(us)&&rs===String(as)&&us===as+1?(rs=ls,as=us):(ss.push(ns===rs?ns:`${ns}-${rs}`),ns=ls,rs=ls,os=us,as=us)}return ss.push(ns===rs?ns:`${ns}-${rs}`),ss.join(", ")}function formatEstimatedTime(es){if(es<60)return`~${es} min`;const ts=Math.floor(es/60),ss=es%60;return ss===0?`~${ts}h`:`~${ts}h ${ss}m`}function formatShortDate(es){const ts=typeof es=="string"?new Date(es):es,ss=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ns=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return`${ss[ts.getDay()]} ${ts.getDate()} ${ns[ts.getMonth()]}`}function getBaseSceneNumber(es){const ts=es.trim(),ss=ts.match(/^(\d+)/);return ss?ss[1]:ts}function sceneExistsInSet(es,ts){if(es.has(ts))return!0;const ss=getBaseSceneNumber(ts);for(const ns of es)if(getBaseSceneNumber(ns)===ss)return!0;return!1}function findMatchingSceneData(es,ts){if(es.has(ts))return es.get(ts);const ss=getBaseSceneNumber(ts);for(const[ns,rs]of es)if(getBaseSceneNumber(ns)===ss)return rs}const MAX_IMAGE_DIMENSION=1920,IMAGE_QUALITY=.8,THUMBNAIL_SIZE=200,THUMBNAIL_QUALITY=.6;async function compressImage(es,ts=MAX_IMAGE_DIMENSION,ss=IMAGE_QUALITY){return new Promise((ns,rs)=>{const os=new Image,as=URL.createObjectURL(es);os.onload=()=>{URL.revokeObjectURL(as);let{width:cs,height:ls}=os;(cs>ts||ls>ts)&&(cs>ls?(ls=Math.round(ls*ts/cs),cs=ts):(cs=Math.round(cs*ts/ls),ls=ts));const us=document.createElement("canvas");us.width=cs,us.height=ls;const ds=us.getContext("2d");if(!ds){rs(new Error("Failed to get canvas context"));return}ds.drawImage(os,0,0,cs,ls),us.toBlob(xs=>{xs?ns(xs):rs(new Error("Failed to compress image"))},"image/jpeg",ss)},os.onerror=()=>{URL.revokeObjectURL(as),rs(new Error("Failed to load image"))},os.src=as})}async function generateThumbnail(es){const ts=await compressImage(es,THUMBNAIL_SIZE,THUMBNAIL_QUALITY);return blobToBase64(ts)}function blobToBase64(es){return new Promise((ts,ss)=>{const ns=new FileReader;ns.onloadend=()=>{const rs=ns.result;ts(rs)},ns.onerror=ss,ns.readAsDataURL(es)})}async function createPhotoFromBlob(es,ts){const ss=await compressImage(es),ns=await blobToBase64(ss),rs=await generateThumbnail(es);return{id:v4(),uri:ns,thumbnail:rs,capturedAt:new Date,angle:ts}}function CharacterAvatar({character:es,size:ts="md",className:ss}){const ns=es.avatarColour??"#C9A962";return jsxRuntimeExports.jsx("div",{className:clsx("rounded-full flex items-center justify-center font-bold text-white flex-shrink-0",{"w-5 h-5 text-[8px]":ts==="xs","w-8 h-8 text-xs":ts==="sm","w-10 h-10 text-sm":ts==="md","w-14 h-14 text-lg":ts==="lg","w-20 h-20 text-2xl":ts==="xl"},ss),style:{background:`linear-gradient(135deg, ${ns} 0%, ${adjustColor$1(ns,-20)} 100%)`},children:es.initials})}function adjustColor$1(es,ts){const ss=parseInt(es.replace("#",""),16),ns=Math.max(0,Math.min(255,(ss>>16)+ts)),rs=Math.max(0,Math.min(255,(ss>>8&255)+ts)),os=Math.max(0,Math.min(255,(ss&255)+ts));return`#${((1<<24)+(ns<<16)+(rs<<8)+os).toString(16).slice(1)}`}const angleLabels$1={front:"Front",left:"Left",right:"Right",back:"Back",additional:""};function PhotoSlot({photo:es,angle:ts,onCapture:ss,onView:ns,onRemove:rs,size:os="md",showLabel:as=!0,isPrimary:cs=!1}){const ls=!!es,us=angleLabels$1[ts],ds=()=>{ls&&ns?ns():ss()};return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:ds,className:clsx("relative rounded-[10px] overflow-hidden touch-manipulation transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-gold focus:ring-offset-2",{"w-full aspect-square":os==="sm","w-full aspect-[4/3]":os==="md","w-full aspect-[16/9]":os==="lg","w-full aspect-[3/4]":os==="portrait","border-2 border-dashed":!ls,"border-gold":!ls&&cs,"border-gray-300":!ls&&!cs,"border-2 border-solid border-gold":ls}),children:ls?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("img",{src:es.thumbnail||es.uri,alt:`${us} view`,className:"w-full h-full object-cover"}),as&&us&&jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent px-2 py-1.5",children:jsxRuntimeExports.jsx("span",{className:"text-[10px] font-medium text-white uppercase tracking-wide",children:us})})]}):jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-50",children:[jsxRuntimeExports.jsx(CameraIcon$1,{className:clsx("text-gray-400",{"w-5 h-5":os==="sm"||os==="portrait","w-6 h-6":os==="md","w-8 h-8":os==="lg"})}),as&&us&&jsxRuntimeExports.jsx("span",{className:clsx("font-bold uppercase tracking-widest text-gray-400 mt-2",{"text-[9px]":os==="sm"||os==="portrait","text-[10px]":os==="md","text-xs":os==="lg"}),children:us})]})}),ls&&rs&&jsxRuntimeExports.jsx("button",{type:"button",onClick:xs=>{xs.stopPropagation(),rs()},className:"absolute -top-1.5 -right-1.5 w-6 h-6 bg-error text-white rounded-full flex items-center justify-center shadow-md tap-target touch-manipulation","aria-label":"Remove photo",children:jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}function SceneThumbnailSlot({sceneNumber:es,hasCaptured:ts,isActive:ss,onClick:ns}){return jsxRuntimeExports.jsxs("button",{type:"button",onClick:ns,className:clsx("flex flex-col items-center gap-1.5 touch-manipulation","focus:outline-none"),children:[jsxRuntimeExports.jsx("div",{className:clsx("w-[70px] h-[70px] rounded-lg flex items-center justify-center transition-all",{"border-2 border-solid border-gold bg-gold-50":ts,"border-2 border-dashed border-gray-300 bg-gray-50":!ts,"ring-2 ring-gold ring-offset-2":ss}),children:ts?jsxRuntimeExports.jsx(CheckIcon$1,{className:"w-6 h-6 text-gold"}):jsxRuntimeExports.jsx(CameraIcon$1,{className:"w-5 h-5 text-gray-400"})}),jsxRuntimeExports.jsx("span",{className:clsx("text-xs font-medium",{"text-gold":ss,"text-text-secondary":!ss}),children:es})]})}function CameraIcon$1({className:es}){return jsxRuntimeExports.jsxs("svg",{className:es,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})}function CheckIcon$1({className:es}){return jsxRuntimeExports.jsx("svg",{className:es,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}function PhotoGrid({photos:es,onCapture:ts,onView:ss,onRemove:ns,className:rs}){const os=[{angle:"front",photo:es.front},{angle:"left",photo:es.left},{angle:"right",photo:es.right},{angle:"back",photo:es.back}];return jsxRuntimeExports.jsx("div",{className:clsx("grid grid-cols-4 gap-2.5",rs),children:os.map(({angle:as,photo:cs})=>jsxRuntimeExports.jsx(PhotoSlot,{photo:cs,angle:as,onCapture:()=>ts(as),onView:cs&&ss?()=>ss(cs,as):void 0,onRemove:cs&&ns?()=>ns(as):void 0,size:"portrait",showLabel:!0,isPrimary:as==="front"},as))})}function AdditionalPhotosGrid({photos:es,onCapture:ts,onView:ss,onRemove:ns,maxVisible:rs=8,className:os}){const as=es.slice(0,rs),cs=es.length-rs,ls=Math.max(0,4-(as.length%4||4)),us=as.length<rs;return jsxRuntimeExports.jsxs("div",{className:clsx("grid grid-cols-4 gap-2",os),children:[as.map((ds,xs)=>jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>ss==null?void 0:ss(ds,xs),className:"w-full aspect-square rounded-lg overflow-hidden border-2 border-gold touch-manipulation focus:outline-none focus:ring-2 focus:ring-gold",children:jsxRuntimeExports.jsx("img",{src:ds.thumbnail||ds.uri,alt:`Additional photo ${xs+1}`,className:"w-full h-full object-cover"})}),ns&&jsxRuntimeExports.jsx("button",{type:"button",onClick:fs=>{fs.stopPropagation(),ns(ds.id)},className:"absolute -top-1 -right-1 w-5 h-5 bg-error text-white rounded-full flex items-center justify-center shadow-sm touch-manipulation","aria-label":"Remove photo",children:jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),xs===rs-1&&cs>0&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/60 rounded-lg flex items-center justify-center",children:jsxRuntimeExports.jsxs("span",{className:"text-white font-semibold text-lg",children:["+",cs]})})]},ds.id)),us&&Array.from({length:Math.min(ls+1,rs-as.length)}).map((ds,xs)=>jsxRuntimeExports.jsx("button",{type:"button",onClick:ts,className:clsx("w-full aspect-square rounded-lg flex items-center justify-center touch-manipulation","focus:outline-none focus:ring-2 focus:ring-gold",{"border-2 border-dashed border-gold bg-gold-50/50":xs===0,"border-2 border-dashed border-gray-300 bg-gray-50":xs>0}),children:jsxRuntimeExports.jsx("svg",{className:clsx("w-5 h-5",{"text-gold":xs===0,"text-gray-400":xs>0}),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})},`empty-${xs}`))]})}function useCamera(es={}){const{facingMode:ts="environment",onCapture:ss,onError:ns}=es,rs=reactExports.useRef(null),os=reactExports.useRef(null),as=reactExports.useRef(null),[cs,ls]=reactExports.useState(!1),[us,ds]=reactExports.useState(!1),[xs,fs]=reactExports.useState(null),[gs,Es]=reactExports.useState(ts);reactExports.useEffect(()=>(as.current=document.createElement("canvas"),()=>{as.current=null}),[]);const js=reactExports.useCallback(()=>{os.current&&(os.current.getTracks().forEach(vs=>vs.stop()),os.current=null),rs.current&&(rs.current.srcObject=null),ls(!1)},[]);reactExports.useEffect(()=>()=>{os.current&&(os.current.getTracks().forEach(vs=>vs.stop()),os.current=null),rs.current&&(rs.current.srcObject=null)},[]);const ps=reactExports.useCallback(async()=>{try{if(fs(null),ls(!1),js(),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Camera not supported on this device");const vs={video:{facingMode:{ideal:gs},width:{ideal:1920},height:{ideal:1080}},audio:!1},ws=await navigator.mediaDevices.getUserMedia(vs);os.current=ws,rs.current&&(rs.current.srcObject=ws,await rs.current.play(),ls(!0))}catch(vs){const ws=vs instanceof Error?vs.message:"Failed to access camera";fs(ws),ns==null||ns(vs instanceof Error?vs:new Error(ws))}},[gs,js,ns]),ms=reactExports.useCallback(async()=>{const vs=gs==="user"?"environment":"user";if(Es(vs),os.current){js(),await new Promise(ws=>setTimeout(ws,100));try{const ws={video:{facingMode:{ideal:vs},width:{ideal:1920},height:{ideal:1080}},audio:!1},ys=await navigator.mediaDevices.getUserMedia(ws);os.current=ys,rs.current&&(rs.current.srcObject=ys,await rs.current.play(),ls(!0))}catch(ws){const ys=ws instanceof Error?ws.message:"Failed to switch camera";fs(ys),ns==null||ns(ws instanceof Error?ws:new Error(ys))}}},[gs,js,ns]),hs=reactExports.useCallback(async()=>{if(!rs.current||!as.current||!cs)return null;try{ds(!0);const vs=rs.current,ws=as.current;ws.width=vs.videoWidth,ws.height=vs.videoHeight;const ys=ws.getContext("2d");if(!ys)throw new Error("Failed to get canvas context");gs==="user"&&(ys.translate(ws.width,0),ys.scale(-1,1)),ys.drawImage(vs,0,0);const Rs=await new Promise((bs,Ns)=>{ws.toBlob(Ss=>{Ss?bs(Ss):Ns(new Error("Failed to capture photo"))},"image/jpeg",.9)});return ss==null||ss(Rs),Rs}catch(vs){const ws=vs instanceof Error?vs.message:"Failed to capture photo";return fs(ws),ns==null||ns(vs instanceof Error?vs:new Error(ws)),null}finally{ds(!1)}},[cs,gs,ss,ns]);return{videoRef:rs,isReady:cs,isCapturing:us,error:xs,facingMode:gs,startCamera:ps,stopCamera:js,capturePhoto:hs,switchCamera:ms}}const angleLabels={front:"Front View",left:"Left View",right:"Right View",back:"Back View",additional:"Additional"};function PhotoCapture({isOpen:es,onClose:ts,onCapture:ss,angle:ns="additional",characterName:rs,sceneNumber:os,lookName:as}){const[cs,ls]=reactExports.useState(null),[us,ds]=reactExports.useState(null),[xs,fs]=reactExports.useState("choose"),gs=reactExports.useRef(null),{videoRef:Es,isReady:js,isCapturing:ps,error:ms,facingMode:hs,startCamera:vs,stopCamera:ws,capturePhoto:ys,switchCamera:Rs}=useCamera({facingMode:"environment",onError:Is=>console.error("Camera error:",Is)});reactExports.useEffect(()=>{es?(fs("choose"),ls(null),ds(null)):(ws(),ls(null),ds(null))},[es,ws]),reactExports.useEffect(()=>{xs==="camera"?vs():ws()},[xs,vs,ws]),reactExports.useEffect(()=>()=>{us&&URL.revokeObjectURL(us)},[us]);const bs=async()=>{const Is=await ys();if(Is){const Qs=URL.createObjectURL(Is);ls(Is),ds(Qs),fs("preview")}},Ns=()=>{us&&URL.revokeObjectURL(us),ls(null),ds(null),fs("choose")},Ss=()=>{cs&&(ss(cs),ts())},Ts=Is=>{var Ys;const Qs=(Ys=Is.target.files)==null?void 0:Ys[0];if(Qs){const Zs=Qs,Vs=URL.createObjectURL(Zs);ls(Zs),ds(Vs),fs("preview")}gs.current&&(gs.current.value="")},Cs=()=>{var Is;(Is=gs.current)==null||Is.click()},Ms=()=>{fs("camera")};return es?xs==="choose"?jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 bg-background flex flex-col",children:[jsxRuntimeExports.jsx("input",{ref:gs,type:"file",accept:"image/*",capture:void 0,onChange:Ts,className:"hidden"}),jsxRuntimeExports.jsx("div",{className:"gold-gradient px-4 py-3 safe-top",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("button",{onClick:ts,className:"text-white tap-target touch-manipulation","aria-label":"Close",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[rs&&jsxRuntimeExports.jsx("div",{className:"text-white font-semibold text-sm",children:rs}),jsxRuntimeExports.jsxs("div",{className:"text-white/80 text-xs",children:[os&&`Scene ${os}`,as&&`  ${as}`]})]}),jsxRuntimeExports.jsx("div",{className:"w-6"})]})}),jsxRuntimeExports.jsx("div",{className:"bg-card border-b border-border px-4 py-3 text-center",children:jsxRuntimeExports.jsx("span",{className:"text-text-primary text-sm font-medium",children:angleLabels[ns]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-6 gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 rounded-full bg-gold/10 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsxs("svg",{className:"w-12 h-12 text-gold",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[jsxRuntimeExports.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),jsxRuntimeExports.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),jsxRuntimeExports.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Add Photo"}),jsxRuntimeExports.jsx("p",{className:"text-text-secondary text-center text-sm mb-8",children:"Take a new photo or choose one from your library"}),jsxRuntimeExports.jsxs(Button,{variant:"primary",size:"lg",fullWidth:!0,onClick:Ms,className:"max-w-xs",children:[jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("path",{d:"M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"}),jsxRuntimeExports.jsx("circle",{cx:"12",cy:"13",r:"4"})]}),"Take Photo"]}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"lg",fullWidth:!0,onClick:Cs,className:"max-w-xs",children:[jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),jsxRuntimeExports.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),jsxRuntimeExports.jsx("path",{d:"M21 15l-5-5L5 21"})]}),"Choose from Library"]})]})]}):xs==="preview"&&us?jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 bg-black flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"gold-gradient px-4 py-3 safe-top",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("button",{onClick:Ns,className:"text-white tap-target touch-manipulation","aria-label":"Back",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[rs&&jsxRuntimeExports.jsx("div",{className:"text-white font-semibold text-sm",children:rs}),jsxRuntimeExports.jsx("div",{className:"text-white/80 text-xs",children:angleLabels[ns]})]}),jsxRuntimeExports.jsx("div",{className:"w-6"})]})}),jsxRuntimeExports.jsx("div",{className:"flex-1 relative overflow-hidden bg-black",children:jsxRuntimeExports.jsx("img",{src:us,alt:"Captured preview",className:"w-full h-full object-contain"})}),jsxRuntimeExports.jsx("div",{className:"bg-black px-4 py-6 safe-bottom",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-6",children:[jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"lg",onClick:Ns,className:"flex-1 max-w-[140px]",children:"Change"}),jsxRuntimeExports.jsx(Button,{variant:"primary",size:"lg",onClick:Ss,className:"flex-1 max-w-[140px]",children:"Use Photo"})]})})]}):jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 bg-black flex flex-col",children:[jsxRuntimeExports.jsx("input",{ref:gs,type:"file",accept:"image/*",onChange:Ts,className:"hidden"}),jsxRuntimeExports.jsx("div",{className:"gold-gradient px-4 py-3 safe-top",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("button",{onClick:()=>fs("choose"),className:"text-white tap-target touch-manipulation","aria-label":"Back",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[rs&&jsxRuntimeExports.jsx("div",{className:"text-white font-semibold text-sm",children:rs}),jsxRuntimeExports.jsxs("div",{className:"text-white/80 text-xs",children:[os&&`Scene ${os}`,as&&`  ${as}`]})]}),jsxRuntimeExports.jsx("div",{className:"w-6"})]})}),jsxRuntimeExports.jsx("div",{className:"bg-black/50 px-4 py-2 text-center",children:jsxRuntimeExports.jsx("span",{className:"text-white/90 text-sm font-medium",children:angleLabels[ns]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[jsxRuntimeExports.jsx("video",{ref:Es,autoPlay:!0,playsInline:!0,muted:!0,className:clsx("w-full h-full object-cover",{"scale-x-[-1]":hs==="user"})}),!js&&!ms&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2"}),jsxRuntimeExports.jsx("div",{className:"text-sm",children:"Starting camera..."})]})}),ms&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black",children:jsxRuntimeExports.jsxs("div",{className:"text-white text-center px-8",children:[jsxRuntimeExports.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),jsxRuntimeExports.jsx("div",{className:"text-sm mb-4",children:ms.includes("permission")||ms.includes("Permission")?"Camera access denied. Please allow camera access in your browser settings.":ms}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsx(Button,{variant:"primary",size:"sm",onClick:vs,children:"Try Again"}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:Cs,children:"Choose from Library Instead"})]})]})})]}),jsxRuntimeExports.jsx("div",{className:"bg-black px-4 py-6 safe-bottom",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-8",children:[jsxRuntimeExports.jsx("button",{onClick:Cs,className:"w-12 h-12 rounded-full bg-white/20 flex items-center justify-center tap-target touch-manipulation","aria-label":"Choose from library",children:jsxRuntimeExports.jsxs("svg",{className:"w-6 h-6 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),jsxRuntimeExports.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),jsxRuntimeExports.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),jsxRuntimeExports.jsx("button",{onClick:bs,disabled:!js||ps,className:clsx("w-20 h-20 rounded-full border-4 border-white flex items-center justify-center tap-target touch-manipulation","transition-transform active:scale-95",{"opacity-50":!js||ps}),"aria-label":"Take photo",children:jsxRuntimeExports.jsx("div",{className:clsx("w-16 h-16 rounded-full bg-white",{"animate-pulse":ps})})}),jsxRuntimeExports.jsx("button",{onClick:Rs,disabled:!js,className:"w-12 h-12 rounded-full bg-white/20 flex items-center justify-center tap-target touch-manipulation disabled:opacity-50","aria-label":"Switch camera",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]}):null}function MasterReference({photo:es,onCapture:ts,onView:ss,onRemove:ns,className:rs}){const os=!!es,as=()=>{os&&ss?ss():ts()};return jsxRuntimeExports.jsxs("div",{className:clsx("relative",rs),children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:as,className:clsx("w-full aspect-[16/9] rounded-lg overflow-hidden touch-manipulation transition-all","focus:outline-none focus:ring-2 focus:ring-gold focus:ring-offset-2",{"border-2 border-dashed border-gray-300 bg-gray-50":!os,"border-2 border-solid border-gold":os}),children:os?jsxRuntimeExports.jsx("img",{src:es.uri,alt:"Master reference",className:"w-full h-full object-cover"}):jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx(CameraIcon,{className:"w-8 h-8 text-gray-400 mb-2"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-500",children:"Tap to set master reference"})]})}),os&&ns&&jsxRuntimeExports.jsx("button",{type:"button",onClick:cs=>{cs.stopPropagation(),ns()},className:"absolute top-2 right-2 w-8 h-8 bg-black/50 text-white rounded-full flex items-center justify-center tap-target touch-manipulation hover:bg-black/70","aria-label":"Remove master reference",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),os&&jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent px-3 py-2",children:jsxRuntimeExports.jsx("span",{className:"text-xs font-medium text-white uppercase tracking-wide",children:"Master Reference"})})]})}function CameraIcon({className:es}){return jsxRuntimeExports.jsxs("svg",{className:es,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})}const flagLabels=[{key:"sweat",label:"Sweat"},{key:"dishevelled",label:"Dishevelled"},{key:"blood",label:"Blood"},{key:"dirt",label:"Dirt"},{key:"wetHair",label:"Wet Hair"},{key:"tears",label:"Tears"}];function QuickFlags({flags:es,onToggle:ts}){return jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:flagLabels.map(({key:ss,label:ns})=>jsxRuntimeExports.jsx(TogglePill,{isActive:es[ss],label:ns,onClick:()=>ts(ss)},ss))})}function EventCard({event:es,onRemove:ts}){return jsxRuntimeExports.jsxs("div",{className:"bg-card border border-border rounded-[10px] p-3.5 relative",children:[ts&&jsxRuntimeExports.jsx("button",{onClick:ts,className:"absolute top-3 right-3 p-1 text-text-light hover:text-text-muted transition-colors touch-manipulation","aria-label":"Remove event",children:jsxRuntimeExports.jsx("svg",{className:"w-[18px] h-[18px]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 5v14M5 12h14"})})}),jsxRuntimeExports.jsx("span",{className:"inline-block text-[9px] font-bold tracking-widest uppercase text-gold bg-gold-100/50 px-2 py-0.5 rounded mb-2",children:es.type}),jsxRuntimeExports.jsx("h4",{className:"font-semibold text-text-primary text-[15px] mb-1",children:es.name}),es.description&&jsxRuntimeExports.jsx("p",{className:"text-[13px] text-text-secondary leading-snug mb-2.5",children:es.description}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-2",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:"Stage:"}),jsxRuntimeExports.jsx("span",{className:"text-text-primary font-medium ml-1.5",children:es.stage||""})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:"Scenes:"}),jsxRuntimeExports.jsx("span",{className:"text-text-primary font-medium ml-1.5",children:es.sceneRange||""})]})]}),es.products&&jsxRuntimeExports.jsxs("div",{className:"text-xs mt-2",children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:"Products:"}),jsxRuntimeExports.jsx("span",{className:"text-text-primary ml-1.5",children:es.products})]}),es.referencePhotos.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-3",children:[jsxRuntimeExports.jsx("div",{className:"field-label mb-2",children:"REFERENCE PHOTOS"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar",children:es.referencePhotos.map(ss=>jsxRuntimeExports.jsx("img",{src:ss.thumbnail||ss.uri,alt:"Reference",className:"w-16 h-16 rounded-lg object-cover flex-shrink-0"},ss.id))})]})]})}function ContinuityEvents({events:es,onAddEvent:ts,onRemoveEvent:ss}){return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3.5",children:[jsxRuntimeExports.jsx("h3",{className:"section-header",children:"CONTINUITY EVENTS"}),jsxRuntimeExports.jsxs("button",{onClick:ts,className:"flex items-center gap-1 px-3 py-1.5 rounded-md bg-gold-100/50 text-gold text-[11px] font-semibold hover:bg-gold-100 transition-colors",children:[jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"Add Event"]})]}),es.length===0?jsxRuntimeExports.jsx(EmptyState$4,{onAdd:ts}):jsxRuntimeExports.jsx("div",{className:"space-y-2.5",children:es.map(ns=>jsxRuntimeExports.jsx(EventCard,{event:ns,onRemove:()=>ss(ns.id)},ns.id))})]})}function EmptyState$4({onAdd:es}){return jsxRuntimeExports.jsxs("button",{onClick:es,className:"w-full flex flex-col items-center justify-center py-6 text-center touch-manipulation",children:[jsxRuntimeExports.jsxs("svg",{className:"w-8 h-8 text-gray-300 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),jsxRuntimeExports.jsx("polyline",{points:"14 2 14 8 20 8",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12",strokeLinecap:"round"}),jsxRuntimeExports.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15",strokeLinecap:"round"})]}),jsxRuntimeExports.jsx("span",{className:"text-[13px] text-text-light",children:"No continuity events"}),jsxRuntimeExports.jsx("span",{className:"text-[11px] text-text-placeholder mt-1",children:"Add wounds, bruises, prosthetics etc."})]})}function AddEventModal({isOpen:es,onClose:ts,onAdd:ss}){const[ns,rs]=reactExports.useState("Wound"),[os,as]=reactExports.useState(""),[cs,ls]=reactExports.useState(""),[us,ds]=reactExports.useState(""),[xs,fs]=reactExports.useState(""),[gs,Es]=reactExports.useState(""),[js,ps]=reactExports.useState(!1),[ms,hs]=reactExports.useState([]),[vs,ws]=reactExports.useState(!1),ys=reactExports.useRef(null),Rs=()=>{rs("Wound"),as(""),ls(""),ds(""),fs(""),Es(""),hs([])},bs=()=>{os.trim()&&(ss({type:ns,name:os.trim(),description:cs.trim(),stage:us.trim(),sceneRange:xs.trim(),products:gs.trim(),referencePhotos:ms}),Rs())},Ns=()=>{Rs(),ts()},Ss=async Ms=>{var Qs;const Is=(Qs=Ms.target.files)==null?void 0:Qs[0];if(Is){ws(!0);try{const Ys=await createPhotoFromBlob(Is,"additional");hs(Zs=>[...Zs,Ys])}catch(Ys){console.error("Failed to process photo:",Ys)}finally{ws(!1)}}ys.current&&(ys.current.value="")},Ts=()=>{var Ms;(Ms=ys.current)==null||Ms.click()},Cs=Ms=>{hs(Is=>Is.filter(Qs=>Qs.id!==Ms))};return jsxRuntimeExports.jsxs(BottomSheet,{isOpen:es,onClose:Ns,title:"Add Continuity Event",height:"auto",children:[jsxRuntimeExports.jsx("input",{ref:ys,type:"file",accept:"image/*",onChange:Ss,className:"hidden"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"TYPE"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:CONTINUITY_EVENT_TYPES.map(Ms=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>rs(Ms),className:clsx("px-3 py-1.5 text-xs font-medium rounded-full border transition-colors touch-manipulation",{"bg-gold text-white border-gold":ns===Ms,"bg-gray-100 text-text-secondary border-gray-200 hover:bg-gray-200":ns!==Ms}),children:Ms},Ms))})]}),jsxRuntimeExports.jsx(Input,{label:"NAME",value:os,onChange:Ms=>as(Ms.target.value),placeholder:"e.g., Forehead Cut"}),jsxRuntimeExports.jsx(Textarea,{label:"DESCRIPTION",value:cs,onChange:Ms=>ls(Ms.target.value),placeholder:"Describe the makeup effect...",rows:2}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Input,{label:"STAGE",value:us,onChange:Ms=>ds(Ms.target.value),onFocus:()=>ps(!0),onBlur:()=>setTimeout(()=>ps(!1),200),placeholder:"e.g., Fresh, Day 2 Healing"}),js&&jsxRuntimeExports.jsx("div",{className:"absolute z-10 top-full left-0 right-0 mt-1 bg-card rounded-lg shadow-lg border border-border overflow-hidden",children:STAGE_SUGGESTIONS.map(Ms=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{ds(Ms),ps(!1)},className:"w-full px-3 py-2 text-left text-sm text-text-secondary hover:bg-gray-50 touch-manipulation",children:Ms},Ms))})]}),jsxRuntimeExports.jsx(Input,{label:"SCENE RANGE",value:xs,onChange:Ms=>fs(Ms.target.value),placeholder:"e.g., 12-18"}),jsxRuntimeExports.jsx(Textarea,{label:"PRODUCTS",value:gs,onChange:Ms=>Es(Ms.target.value),placeholder:"List products used...",rows:2}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"REFERENCE PHOTOS"}),ms.length>0&&jsxRuntimeExports.jsx("div",{className:"grid grid-cols-4 gap-2 mb-3",children:ms.map(Ms=>jsxRuntimeExports.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[jsxRuntimeExports.jsx("img",{src:Ms.thumbnail||Ms.uri,alt:"Reference",className:"w-full h-full object-cover"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>Cs(Ms.id),className:"absolute top-1 right-1 w-5 h-5 bg-black/60 rounded-full flex items-center justify-center","aria-label":"Remove photo",children:jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Ms.id))}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",fullWidth:!0,onClick:Ts,disabled:vs,children:vs?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"w-4 h-4 mr-1.5 border-2 border-gold border-t-transparent rounded-full animate-spin"}),"Processing..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),ms.length>0?"Add Another Photo":"Add Reference Photo"]})})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 pt-2",children:[jsxRuntimeExports.jsx(Button,{variant:"secondary",size:"lg",fullWidth:!0,onClick:Ns,children:"Cancel"}),jsxRuntimeExports.jsx(Button,{variant:"primary",size:"lg",fullWidth:!0,onClick:bs,disabled:!os.trim(),children:"Add Event"})]})]})]})}function MakeupForm({makeup:es,onChange:ts,readOnly:ss=!1}){const ns=es||createEmptyMakeupDetails(),rs=(os,as)=>{ts&&!ss&&ts({...ns,[os]:as})};return!es&&ss?jsxRuntimeExports.jsx("div",{className:"text-center py-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"No makeup details available for this look."})}):jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h4",{className:"field-label text-gold mb-3",children:"BASE"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsx(FormField,{label:"Foundation",value:ns.foundation,onChange:os=>rs("foundation",os),readOnly:ss,placeholder:"e.g., MAC Studio Fix NC25"}),jsxRuntimeExports.jsx(FormField,{label:"Coverage",value:ns.coverage,onChange:os=>rs("coverage",os),readOnly:ss,placeholder:"e.g., Medium"})]}),jsxRuntimeExports.jsx(FormField,{label:"Concealer",value:ns.concealer,onChange:os=>rs("concealer",os),readOnly:ss,placeholder:"e.g., NARS Radiant Creamy"}),jsxRuntimeExports.jsx(FormField,{label:"Concealer Placement",value:ns.concealerPlacement,onChange:os=>rs("concealerPlacement",os),readOnly:ss,placeholder:"e.g., Under eyes, bridge of nose"}),jsxRuntimeExports.jsx(FormField,{label:"Contour",value:ns.contour,onChange:os=>rs("contour",os),readOnly:ss,placeholder:"e.g., Charlotte Tilbury Sculpt"}),jsxRuntimeExports.jsx(FormField,{label:"Contour Placement",value:ns.contourPlacement,onChange:os=>rs("contourPlacement",os),readOnly:ss,placeholder:"e.g., Hollows of cheeks, jawline"}),jsxRuntimeExports.jsx(FormField,{label:"Highlight",value:ns.highlight,onChange:os=>rs("highlight",os),readOnly:ss,placeholder:"e.g., Becca Champagne Pop"}),jsxRuntimeExports.jsx(FormField,{label:"Highlight Placement",value:ns.highlightPlacement,onChange:os=>rs("highlightPlacement",os),readOnly:ss,placeholder:"e.g., Cheekbones, brow bone"}),jsxRuntimeExports.jsx(FormField,{label:"Blush",value:ns.blush,onChange:os=>rs("blush",os),readOnly:ss,placeholder:"e.g., NARS Orgasm"}),jsxRuntimeExports.jsx(FormField,{label:"Blush Placement",value:ns.blushPlacement,onChange:os=>rs("blushPlacement",os),readOnly:ss,placeholder:"e.g., Apples of cheeks"})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h4",{className:"field-label text-gold mb-3",children:"EYES"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsx(FormField,{label:"Brow Product",value:ns.browProduct,onChange:os=>rs("browProduct",os),readOnly:ss,placeholder:"e.g., ABH Dipbrow Taupe"}),jsxRuntimeExports.jsx(FormField,{label:"Brow Shape",value:ns.browShape,onChange:os=>rs("browShape",os),readOnly:ss,placeholder:"e.g., Natural arch"})]}),jsxRuntimeExports.jsx(FormField,{label:"Eye Primer",value:ns.eyePrimer,onChange:os=>rs("eyePrimer",os),readOnly:ss,placeholder:"e.g., Urban Decay Primer Potion"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[jsxRuntimeExports.jsx(FormField,{label:"Lid Colour",value:ns.lidColour,onChange:os=>rs("lidColour",os),readOnly:ss,placeholder:"e.g., Champagne"}),jsxRuntimeExports.jsx(FormField,{label:"Crease",value:ns.creaseColour,onChange:os=>rs("creaseColour",os),readOnly:ss,placeholder:"e.g., Warm brown"}),jsxRuntimeExports.jsx(FormField,{label:"Outer V",value:ns.outerV,onChange:os=>rs("outerV",os),readOnly:ss,placeholder:"e.g., Deep brown"})]}),jsxRuntimeExports.jsx(FormField,{label:"Liner Style",value:ns.liner,onChange:os=>rs("liner",os),readOnly:ss,placeholder:"e.g., Thin black line, tight line"}),jsxRuntimeExports.jsx(FormField,{label:"Lashes",value:ns.lashes,onChange:os=>rs("lashes",os),readOnly:ss,placeholder:"e.g., Ardell Wispies, 2 coats mascara"})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h4",{className:"field-label text-gold mb-3",children:"LIPS"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsx(FormField,{label:"Lip Liner",value:ns.lipLiner,onChange:os=>rs("lipLiner",os),readOnly:ss,placeholder:"e.g., MAC Spice"}),jsxRuntimeExports.jsx(FormField,{label:"Lip Colour",value:ns.lipColour,onChange:os=>rs("lipColour",os),readOnly:ss,placeholder:"e.g., Charlotte Tilbury Pillow Talk"})]}),jsxRuntimeExports.jsx(FormField,{label:"Setting",value:ns.setting,onChange:os=>rs("setting",os),readOnly:ss,placeholder:"e.g., MAC Fix+, light powder"})]})]})]})}function HairForm({hair:es,onChange:ts,readOnly:ss=!1}){const ns=es||createEmptyHairDetails(),rs=ns.hairType!=="Natural",os=(cs,ls)=>{ts&&!ss&&ts({...ns,[cs]:ls})},as=cs=>{if(ss)return;const ls=ns.wigAttachment||[],us=ls.includes(cs)?ls.filter(ds=>ds!==cs):[...ls,cs];os("wigAttachment",us)};return!es&&ss?jsxRuntimeExports.jsx("div",{className:"text-center py-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"No hair details available for this look."})}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:"Hair Type"}),ss?jsxRuntimeExports.jsx("div",{className:"text-sm text-text-primary",children:ns.hairType}):jsxRuntimeExports.jsx("select",{value:ns.hairType,onChange:cs=>os("hairType",cs.target.value),className:"w-full bg-[#f8f7f5] border border-[#e8e6e1] rounded-lg px-3 py-3 text-sm text-[#1a1a1a] focus:outline-none focus:border-gold focus:ring-1 focus:ring-gold/30 transition-colors",children:HAIR_TYPES.map(cs=>jsxRuntimeExports.jsx("option",{value:cs,children:cs},cs))})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx(FormField,{label:"Style Description",value:ns.style,onChange:cs=>os("style",cs),readOnly:ss,placeholder:"e.g., Loose waves, half-up half-down",multiline:!0}),jsxRuntimeExports.jsx(FormField,{label:"Products Used",value:ns.products,onChange:cs=>os("products",cs),readOnly:ss,placeholder:"e.g., Oribe Dry Texturizing Spray, heat protectant",multiline:!0}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsx(FormField,{label:"Parting",value:ns.parting,onChange:cs=>os("parting",cs),readOnly:ss,placeholder:"e.g., Centre part"}),jsxRuntimeExports.jsx(FormField,{label:"Pieces Out",value:ns.piecesOut,onChange:cs=>os("piecesOut",cs),readOnly:ss,placeholder:"e.g., Face-framing layers"})]}),jsxRuntimeExports.jsx(FormField,{label:"Pins / Grips / Ties",value:ns.pins,onChange:cs=>os("pins",cs),readOnly:ss,placeholder:"e.g., 6 bobby pins at crown, clear elastic"}),jsxRuntimeExports.jsx(FormField,{label:"Accessories",value:ns.accessories,onChange:cs=>os("accessories",cs),readOnly:ss,placeholder:"e.g., Gold barrette, silk ribbon"})]}),rs&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"border-t border-border pt-4 mt-4",children:jsxRuntimeExports.jsx("h4",{className:"field-label text-gold mb-3",children:"WIG / HAIRPIECE DETAILS"})}),jsxRuntimeExports.jsx(FormField,{label:"Wig Name / ID",value:ns.wigNameId,onChange:cs=>os("wigNameId",cs),readOnly:ss,placeholder:"e.g., WIG-042 Auburn Bob"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:"Wig Type"}),ss?jsxRuntimeExports.jsx("div",{className:"text-sm text-text-primary",children:ns.wigType||jsxRuntimeExports.jsx("span",{className:"text-text-placeholder",children:""})}):jsxRuntimeExports.jsxs("select",{value:ns.wigType,onChange:cs=>os("wigType",cs.target.value),className:"w-full bg-[#f8f7f5] border border-[#e8e6e1] rounded-lg px-3 py-3 text-sm text-[#1a1a1a] focus:outline-none focus:border-gold focus:ring-1 focus:ring-gold/30 transition-colors",children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select type..."}),WIG_TYPES.map(cs=>jsxRuntimeExports.jsx("option",{value:cs,children:cs},cs))]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:"Hairline"}),ss?jsxRuntimeExports.jsx("div",{className:"text-sm text-text-primary",children:ns.hairline||jsxRuntimeExports.jsx("span",{className:"text-text-placeholder",children:""})}):jsxRuntimeExports.jsxs("select",{value:ns.hairline,onChange:cs=>os("hairline",cs.target.value),className:"w-full bg-[#f8f7f5] border border-[#e8e6e1] rounded-lg px-3 py-3 text-sm text-[#1a1a1a] focus:outline-none focus:border-gold focus:ring-1 focus:ring-gold/30 transition-colors",children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select style..."}),HAIRLINE_STYLES.map(cs=>jsxRuntimeExports.jsx("option",{value:cs,children:cs},cs))]})]})]}),jsxRuntimeExports.jsx(FormField,{label:"Wig Cap Method",value:ns.wigCapMethod,onChange:cs=>os("wigCapMethod",cs),readOnly:ss,placeholder:"e.g., Cornrows, bald cap, braided flat"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"Attachment Method"}),ss?jsxRuntimeExports.jsx("div",{className:"text-sm text-text-primary",children:ns.wigAttachment.length>0?ns.wigAttachment.join(", "):jsxRuntimeExports.jsx("span",{className:"text-text-placeholder",children:""})}):jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:WIG_ATTACHMENTS.map(cs=>{const ls=ns.wigAttachment.includes(cs);return jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>as(cs),className:`px-3 py-1.5 text-xs font-medium rounded-full border transition-all ${ls?"bg-gold text-white border-gold":"bg-white text-text-secondary border-border hover:border-gold/50"}`,children:cs},cs)})})]}),jsxRuntimeExports.jsx(FormField,{label:"Lace Tint",value:ns.laceTint,onChange:cs=>os("laceTint",cs),readOnly:ss,placeholder:"e.g., Ebin Lace Tint Medium Brown"}),jsxRuntimeExports.jsx(FormField,{label:"Edges / Baby Hairs",value:ns.edgesBabyHairs,onChange:cs=>os("edgesBabyHairs",cs),readOnly:ss,placeholder:"e.g., Laid with Got2b, swoop on left side"})]})]})}function SFXForm({sfx:es,onChange:ts,onCapturePhoto:ss,onRemovePhoto:ns,readOnly:rs=!1}){const os=es||createEmptySFXDetails(),as=(us,ds)=>{ts&&!rs&&ts({...os,[us]:ds})},cs=us=>{if(rs)return;const ds=os.sfxTypes||[],xs=ds.includes(us)?ds.filter(fs=>fs!==us):[...ds,us];as("sfxTypes",xs)},ls=us=>{if(rs)return;const ds=os.bloodTypes||[],xs=ds.includes(us)?ds.filter(fs=>fs!==us):[...ds,us];as("bloodTypes",xs)};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("label",{className:"field-label",children:"SFX Required"}),jsxRuntimeExports.jsx(Switch,{isOn:os.sfxRequired,onToggle:()=>!rs&&as("sfxRequired",!os.sfxRequired),disabled:rs})]}),os.sfxRequired&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"SFX Type"}),rs?jsxRuntimeExports.jsx("div",{className:"text-sm text-text-primary",children:os.sfxTypes.length>0?os.sfxTypes.join(", "):jsxRuntimeExports.jsx("span",{className:"text-text-placeholder",children:""})}):jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:SFX_TYPES.map(us=>{const ds=os.sfxTypes.includes(us);return jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>cs(us),className:`px-3 py-1.5 text-xs font-medium rounded-full border transition-all ${ds?"bg-gold text-white border-gold":"bg-white text-text-secondary border-border hover:border-gold/50"}`,children:us},us)})})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-border pt-4",children:[jsxRuntimeExports.jsx("h4",{className:"field-label text-gold mb-3",children:"PROSTHETICS"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx(FormField,{label:"Prosthetic Pieces",value:os.prostheticPieces,onChange:us=>as("prostheticPieces",us),readOnly:rs,placeholder:"e.g., Brow piece #3, nose tip, chin extension",multiline:!0}),jsxRuntimeExports.jsx(FormField,{label:"Prosthetic Adhesive",value:os.prostheticAdhesive,onChange:us=>as("prostheticAdhesive",us),readOnly:rs,placeholder:"e.g., Pros-Aide, Telesis 5"})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-border pt-4",children:[jsxRuntimeExports.jsx("h4",{className:"field-label text-gold mb-3",children:"BLOOD"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"Blood Type"}),rs?jsxRuntimeExports.jsx("div",{className:"text-sm text-text-primary",children:os.bloodTypes.length>0?os.bloodTypes.join(", "):jsxRuntimeExports.jsx("span",{className:"text-text-placeholder",children:""})}):jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:BLOOD_TYPES.map(us=>{const ds=os.bloodTypes.includes(us);return jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>ls(us),className:`px-3 py-1.5 text-xs font-medium rounded-full border transition-all ${ds?"bg-gold text-white border-gold":"bg-white text-text-secondary border-border hover:border-gold/50"}`,children:us},us)})})]}),jsxRuntimeExports.jsx(FormField,{label:"Blood Products",value:os.bloodProducts,onChange:us=>as("bloodProducts",us),readOnly:rs,placeholder:"e.g., Kryolan Dark Blood, Fleet Street Drying Blood"}),jsxRuntimeExports.jsx(FormField,{label:"Blood Placement",value:os.bloodPlacement,onChange:us=>as("bloodPlacement",us),readOnly:rs,placeholder:"e.g., Left temple wound, splatter on collar",multiline:!0})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-border pt-4",children:[jsxRuntimeExports.jsx("h4",{className:"field-label text-gold mb-3",children:"TATTOOS"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx(FormField,{label:"Tattoo Coverage",value:os.tattooCoverage,onChange:us=>as("tattooCoverage",us),readOnly:rs,placeholder:"e.g., Dermablend on right arm sleeve"}),jsxRuntimeExports.jsx(FormField,{label:"Temporary Tattoos",value:os.temporaryTattoos,onChange:us=>as("temporaryTattoos",us),readOnly:rs,placeholder:"e.g., Neck tattoo transfer, left forearm design"})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-border pt-4",children:[jsxRuntimeExports.jsx("h4",{className:"field-label text-gold mb-3",children:"EYES & TEETH"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx(FormField,{label:"Contact Lenses",value:os.contactLenses,onChange:us=>as("contactLenses",us),readOnly:rs,placeholder:"e.g., 9mm Mesmer Ghostly White, plano"}),jsxRuntimeExports.jsx(FormField,{label:"Teeth",value:os.teeth,onChange:us=>as("teeth",us),readOnly:rs,placeholder:"e.g., Custom vampire fangs, coffee staining"})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-border pt-4",children:[jsxRuntimeExports.jsx("h4",{className:"field-label text-gold mb-3",children:"AGING & CHARACTER"}),jsxRuntimeExports.jsx(FormField,{label:"Aging / Character Notes",value:os.agingCharacterNotes,onChange:us=>as("agingCharacterNotes",us),readOnly:rs,placeholder:"e.g., Stipple aging on hands and neck, sunken cheeks with highlight/shadow",multiline:!0,rows:3})]}),jsxRuntimeExports.jsx("div",{className:"border-t border-border pt-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("label",{className:"field-label whitespace-nowrap",children:"SFX APPLICATION TIME"}),rs?jsxRuntimeExports.jsxs("span",{className:"text-sm text-text-primary font-semibold",children:[os.sfxApplicationTime??""," min"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("input",{type:"number",value:os.sfxApplicationTime??"",onChange:us=>as("sfxApplicationTime",us.target.value?parseInt(us.target.value,10):null),className:"w-16 bg-[#f8f7f5] border border-[#e8e6e1] rounded-lg px-3 py-2 text-sm text-center font-semibold text-[#1a1a1a] focus:outline-none focus:border-gold focus:ring-1 focus:ring-gold/30 transition-colors",placeholder:"--",min:"0"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"minutes"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"border-t border-border pt-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("h4",{className:"field-label text-gold",children:"SFX REFERENCE PHOTOS"}),jsxRuntimeExports.jsxs("span",{className:"text-[11px] text-text-light",children:[os.sfxReferencePhotos.length," photos"]})]}),jsxRuntimeExports.jsx(SFXPhotoGrid,{photos:os.sfxReferencePhotos,onCapture:ss,onRemove:ns,readOnly:rs})]})]}),!os.sfxRequired&&jsxRuntimeExports.jsx("div",{className:"text-center py-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"Toggle SFX Required to add special effects details."})})]})}function SFXPhotoGrid({photos:es,onCapture:ts,onRemove:ss,readOnly:ns}){return jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[es.map(rs=>jsxRuntimeExports.jsxs("div",{className:"relative aspect-square",children:[jsxRuntimeExports.jsx("img",{src:rs.thumbnail||rs.uri,alt:"SFX reference",className:"w-full h-full object-cover rounded-lg"}),!ns&&ss&&jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>ss(rs.id),className:"absolute -top-1.5 -right-1.5 w-5 h-5 rounded-full bg-error text-white flex items-center justify-center shadow-sm",children:jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]},rs.id)),!ns&&ts&&jsxRuntimeExports.jsxs("button",{type:"button",onClick:ts,className:"aspect-square rounded-lg border-2 border-dashed border-border flex flex-col items-center justify-center gap-1 text-text-light hover:border-gold hover:text-gold transition-colors",children:[jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),jsxRuntimeExports.jsx("span",{className:"text-[10px] font-medium",children:"Add"})]}),es.length===0&&ns&&jsxRuntimeExports.jsx("div",{className:"col-span-4 text-center py-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"No SFX reference photos."})})]})}function NotesForm({notes:es,onChange:ts}){const[ss,ns]=reactExports.useState(es),rs=reactExports.useRef(null),os=reactExports.useRef(null),as=reactExports.useRef(ts);reactExports.useEffect(()=>{as.current=ts},[ts]),reactExports.useEffect(()=>{ns(es)},[es]);const cs=()=>{os.current&&(clearTimeout(os.current),os.current=null),rs.current!==null&&(as.current(rs.current),rs.current=null)};reactExports.useEffect(()=>()=>{cs()},[]);const ls=ds=>{ns(ds),rs.current=ds,os.current&&clearTimeout(os.current),os.current=setTimeout(()=>{rs.current!==null&&(as.current(rs.current),rs.current=null)},300)},us=()=>{cs()};return jsxRuntimeExports.jsx(Textarea,{value:ss,onChange:ds=>ls(ds.target.value),onBlur:us,placeholder:"Add continuity notes, anomalies, director requests...",rows:4,className:"resize-none"})}function CharacterProfile({sceneId:es,characterId:ts}){const{currentProject:ss,getCharacter:ns,getScene:rs,getLookForCharacterInScene:os,getOrCreateSceneCapture:as,getSceneCapture:cs,updateSceneCapture:ls,addPhotoToCapture:us,removePhotoFromCapture:ds,toggleContinuityFlag:xs,addContinuityEvent:fs,removeContinuityEvent:gs,updateSFXDetails:Es,addSFXPhoto:js,removeSFXPhoto:ps,markSceneComplete:ms,copyToNextScene:hs,setCurrentScene:vs,sceneCaptures:ws,updateLook:ys}=useProjectStore(),Rs=ns(ts),bs=rs(es),Ns=bs?os(ts,bs.sceneNumber):void 0,Ss=cs(es,ts)||as(es,ts),[Ts,Cs]=reactExports.useState(!1),[Ms,Is]=reactExports.useState("front"),[Qs,Ys]=reactExports.useState(!1),[Zs,Vs]=reactExports.useState(!1),[Ks,Ds]=reactExports.useState(!1);if(!Rs||!bs||!ss)return null;const $s=Ss.id,Xs=(Os,Ws=!1,Gs=!1)=>{Is(Os),Ys(Ws),Vs(Gs),Cs(!0)},Fs=async Os=>{const Ws=await createPhotoFromBlob(Os,Qs||Zs?void 0:Ms);Zs?js($s,Ws):Qs&&Ns?us($s,Ws,"additional"):us($s,Ws,Ms==="additional"?"additional":Ms)},As=Os=>{Es($s,Os)},_s=()=>{ms(es)},Ps=()=>{const Os=hs(es,ts);Os&&vs(Os)},Hs=Os=>{const Ws={...Os,id:`event-${Date.now()}`};fs($s,Ws),Ds(!1)},Ls=Ns?ss.scenes.filter(Os=>Ns.scenes.includes(Os.sceneNumber)):[];return jsxRuntimeExports.jsxs("div",{className:"mobile-container",children:[jsxRuntimeExports.jsxs("div",{className:"px-4 py-4 space-y-2.5 pb-32",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3.5",children:[jsxRuntimeExports.jsx(CharacterAvatar,{character:Rs,size:"xl"}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("h2",{className:"text-character-name text-gold font-bold truncate",children:Rs.name}),jsxRuntimeExports.jsxs("p",{className:"text-[13px] text-text-muted mt-0.5",children:["Scene ",bs.sceneNumber," | ",formatSluglineShort(bs.slugline)]})]})]}),Ns&&jsxRuntimeExports.jsxs("div",{className:"bg-input-bg rounded-[10px] px-4 py-3 flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-bold text-gold",children:Ns.name}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted ml-2.5",children:["Scenes ",formatSceneRange(Ns.scenes)]})]}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted font-medium",children:["~",formatEstimatedTime(Ns.estimatedTime)]})]}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h3",{className:"section-header mb-3",children:"SCENE PHOTOS"}),jsxRuntimeExports.jsx(PhotoGrid,{photos:Ss.photos,onCapture:Os=>Xs(Os),onRemove:Os=>ds($s,Os)})]}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h3",{className:"section-header mb-3",children:"MASTER REFERENCE"}),jsxRuntimeExports.jsx(MasterReference,{photo:Ns==null?void 0:Ns.masterReference,onCapture:()=>Xs("front",!0)})]}),Ls.length>1&&jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h3",{className:"section-header mb-3",children:"SCENES IN THIS LOOK"}),jsxRuntimeExports.jsx("div",{className:"flex gap-3 overflow-x-auto hide-scrollbar pb-1",children:Ls.map(Os=>{const Ws=ws[`${Os.id}-${ts}`],Gs=Ws?getCaptureStatus(Ws)!=="not-started":!1;return jsxRuntimeExports.jsx(SceneThumbnailSlot,{sceneNumber:Os.sceneNumber,hasCaptured:Gs,isActive:Os.id===es,onClick:()=>vs(Os.id)},Os.id)})})]}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("h3",{className:"section-header",children:"ADDITIONAL PHOTOS"}),jsxRuntimeExports.jsxs("span",{className:"text-[11px] text-text-light",children:[Ss.additionalPhotos.length," photos"]})]}),jsxRuntimeExports.jsx(AdditionalPhotosGrid,{photos:Ss.additionalPhotos,onCapture:()=>Xs("additional"),onRemove:Os=>ds($s,"additional",Os)})]}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h3",{className:"section-header mb-3",children:"QUICK FLAGS"}),jsxRuntimeExports.jsx(QuickFlags,{flags:Ss.continuityFlags,onToggle:Os=>xs($s,Os)})]}),jsxRuntimeExports.jsx("div",{className:"card",children:jsxRuntimeExports.jsx(ContinuityEvents,{events:Ss.continuityEvents,onAddEvent:()=>Ds(!0),onRemoveEvent:Os=>gs($s,Os)})}),jsxRuntimeExports.jsx(Accordion,{title:"MAKEUP",count:Ns?countFilledFields(Ns.makeup):0,children:jsxRuntimeExports.jsx(MakeupForm,{makeup:Ns==null?void 0:Ns.makeup,onChange:Ns?Os=>ys(Ns.id,{makeup:Os}):void 0})}),jsxRuntimeExports.jsx(Accordion,{title:"HAIR",count:Ns?countHairFields(Ns.hair):0,children:jsxRuntimeExports.jsx(HairForm,{hair:Ns==null?void 0:Ns.hair,onChange:Ns?Os=>ys(Ns.id,{hair:Os}):void 0})}),jsxRuntimeExports.jsx(Accordion,{title:"SPECIAL EFFECTS",count:countSFXFields(Ss.sfxDetails),badge:Ss.sfxDetails.sfxRequired?void 0:"None",children:jsxRuntimeExports.jsx(SFXForm,{sfx:Ss.sfxDetails,onChange:As,onCapturePhoto:()=>Xs("additional",!1,!0),onRemovePhoto:Os=>ps($s,Os)})}),jsxRuntimeExports.jsx(Accordion,{title:"SCENE NOTES",children:jsxRuntimeExports.jsx(NotesForm,{notes:Ss.notes,onChange:Os=>ls($s,{notes:Os})})}),jsxRuntimeExports.jsxs("div",{className:"card flex items-center gap-3.5",children:[jsxRuntimeExports.jsx("label",{className:"field-label whitespace-nowrap",children:"APPLICATION TIME"}),jsxRuntimeExports.jsx("input",{type:"number",value:Ss.applicationTime??(Ns==null?void 0:Ns.estimatedTime)??"",onChange:Os=>ls($s,{applicationTime:Os.target.value?parseInt(Os.target.value,10):void 0}),className:"input-field w-16 text-center font-semibold",placeholder:"--",min:"0"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"minutes"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2.5 pt-2",children:[jsxRuntimeExports.jsx(Button,{variant:"primary",size:"lg",fullWidth:!0,onClick:_s,disabled:bs.isComplete,children:bs.isComplete?"Scene Completed":"Mark Scene Complete"}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"lg",fullWidth:!0,onClick:Ps,children:"Copy to Next Scene"})]})]}),jsxRuntimeExports.jsx(PhotoCapture,{isOpen:Ts,onClose:()=>Cs(!1),onCapture:Fs,angle:Ms,characterName:Rs.name,sceneNumber:bs.sceneNumber,lookName:Ns==null?void 0:Ns.name}),jsxRuntimeExports.jsx(AddEventModal,{isOpen:Ks,onClose:()=>Ds(!1),onAdd:Hs})]})}function formatSluglineShort(es){return es.replace(/^(INT\.|EXT\.)\s*/i,"").replace(/\s*-\s*(DAY|NIGHT|MORNING|EVENING|CONTINUOUS)\s*$/i,"").split(" - ")[0]}function SceneView({sceneId:es,onBack:ts}){const{currentProject:ss,currentCharacterId:ns,setCurrentCharacter:rs,getScene:os,getCharacter:as}=useProjectStore(),cs=os(es),[ls,us]=reactExports.useState(!1);if(reactExports.useEffect(()=>{cs&&cs.characters.length>0&&!ns&&rs(cs.characters[0])},[cs,ns,rs]),!cs||!ss)return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-text-muted",children:"Scene not found"}),jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:ts,className:"mt-2",children:"Go Back"})]})});const ds=reactExports.useMemo(()=>cs.characters.map(xs=>as(xs)).filter(Boolean),[cs.characters,as]);return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx(Header,{title:`Scene ${cs.sceneNumber}`,showBack:!0,onBack:ts}),jsxRuntimeExports.jsx("div",{className:"bg-card border-b border-border px-4 py-3",children:jsxRuntimeExports.jsxs("div",{className:"mobile-container",children:[jsxRuntimeExports.jsx("h2",{className:"text-base font-semibold text-text-primary mb-2",children:cs.slugline}),cs.synopsis?jsxRuntimeExports.jsx("p",{className:"text-sm text-text-secondary mb-3",children:cs.synopsis}):jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted italic mb-3",children:"No synopsis available. Sync from desktop or tap to add."}),cs.scriptContent&&jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:()=>us(!0),children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"View Full Scene"]})]})}),ds.length>0&&jsxRuntimeExports.jsx("div",{className:"bg-card border-b border-border overflow-x-auto hide-scrollbar",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsx("div",{className:"flex gap-2 px-4 py-3",children:ds.map(xs=>jsxRuntimeExports.jsx("button",{onClick:()=>rs(xs.id),className:clsx("flex-shrink-0 px-4 py-2 rounded-pill text-sm font-medium transition-colors touch-manipulation",{"gold-gradient text-white":ns===xs.id,"bg-gray-100 text-text-secondary hover:bg-gray-200":ns!==xs.id}),children:xs.name},xs.id))})})}),ns&&jsxRuntimeExports.jsx(CharacterProfile,{sceneId:es,characterId:ns}),ls&&cs.scriptContent&&jsxRuntimeExports.jsx(FullScriptModal,{content:cs.scriptContent,sceneNumber:cs.sceneNumber,onClose:()=>us(!1)})]})}function FullScriptModal({content:es,sceneNumber:ts,onClose:ss}){return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-card animate-slideUp",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[jsxRuntimeExports.jsxs("h2",{className:"font-semibold text-text-primary",children:["Scene ",ts]}),jsxRuntimeExports.jsx("button",{onClick:ss,className:"p-2 -m-2 text-text-muted hover:text-text-primary tap-target touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:jsxRuntimeExports.jsx("pre",{className:"whitespace-pre-wrap font-mono text-sm text-text-primary leading-relaxed",children:es})})]})})}function SceneScriptModal({scene:es,onClose:ts}){return reactExports.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),reactExports.useEffect(()=>{const ss=ns=>{ns.key==="Escape"&&ts()};return document.addEventListener("keydown",ss),()=>document.removeEventListener("keydown",ss)},[ts]),jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",onClick:ts,children:jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-card animate-slideUp",onClick:ss=>ss.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border safe-top",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[jsxRuntimeExports.jsxs("h2",{className:"font-semibold text-text-primary",children:["Scene ",es.sceneNumber]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted truncate",children:es.slugline})]}),jsxRuntimeExports.jsx("button",{onClick:ts,className:"p-2 -m-2 text-text-muted hover:text-text-primary tap-target touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-b border-border/50 bg-gray-50",children:[jsxRuntimeExports.jsx("span",{className:clsx("px-2 py-0.5 text-xs font-bold rounded",es.intExt==="INT"?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"),children:es.intExt}),jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded bg-gray-200 text-text-secondary",children:es.timeOfDay}),es.filmingStatus&&jsxRuntimeExports.jsx("span",{className:clsx("px-2 py-0.5 text-xs font-medium rounded",es.filmingStatus==="complete"?"bg-green-100 text-green-700":es.filmingStatus==="partial"?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"),children:es.filmingStatus==="complete"?"Complete":es.filmingStatus==="partial"?"Partial":"Incomplete"})]}),es.synopsis&&jsxRuntimeExports.jsxs("div",{className:"px-4 py-3 border-b border-border/50 bg-gold-100/30",children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-1",children:"SYNOPSIS"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-secondary italic",children:es.synopsis})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto",children:es.scriptContent?jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"FULL SCENE"}),jsxRuntimeExports.jsx("pre",{className:"whitespace-pre-wrap font-mono text-sm text-text-primary leading-relaxed",children:es.scriptContent})]}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-text-primary mb-1",children:"No Script Content"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-text-muted text-center",children:["Script content is not available for this scene.",!es.synopsis&&" Upload a script to view full scene content."]})]})}),jsxRuntimeExports.jsx("div",{className:"border-t border-border p-4 safe-bottom bg-card",children:jsxRuntimeExports.jsx("button",{onClick:ts,className:"w-full py-3 rounded-button gold-gradient text-white font-medium active:scale-[0.98] transition-transform",children:"Close"})})]})})}function commonjsRequire(es){throw new Error('Could not dynamically require "'+es+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports$1){(function(ts,ss){module.exports=ts.pdfjsLib=ss()})(globalThis,()=>(()=>{var __webpack_modules__=[,(es,ts)=>{var to;Object.defineProperty(ts,"__esModule",{value:!0}),ts.VerbosityLevel=ts.Util=ts.UnknownErrorException=ts.UnexpectedResponseException=ts.TextRenderingMode=ts.RenderingIntentFlag=ts.PromiseCapability=ts.PermissionFlag=ts.PasswordResponses=ts.PasswordException=ts.PageActionEventType=ts.OPS=ts.MissingPDFException=ts.MAX_IMAGE_SIZE_TO_CACHE=ts.LINE_FACTOR=ts.LINE_DESCENT_FACTOR=ts.InvalidPDFException=ts.ImageKind=ts.IDENTITY_MATRIX=ts.FormatError=ts.FeatureTest=ts.FONT_IDENTITY_MATRIX=ts.DocumentActionEventType=ts.CMapCompressionType=ts.BaseException=ts.BASELINE_FACTOR=ts.AnnotationType=ts.AnnotationReplyType=ts.AnnotationPrefix=ts.AnnotationMode=ts.AnnotationFlag=ts.AnnotationFieldFlag=ts.AnnotationEditorType=ts.AnnotationEditorPrefix=ts.AnnotationEditorParamsType=ts.AnnotationBorderStyleType=ts.AnnotationActionEventType=ts.AbortException=void 0,ts.assert=Ds,ts.bytesToString=lr,ts.createValidAbsoluteUrl=Xs,ts.getModificationDate=Tr,ts.getUuid=zr,ts.getVerbosityLevel=Ys,ts.info=Zs,ts.isArrayBuffer=ur,ts.isArrayEqual=Pr,ts.isNodeJS=void 0,ts.normalizeUnicode=Or,ts.objectFromMap=wr,ts.objectSize=Nr,ts.setVerbosityLevel=Qs,ts.shadow=Fs,ts.string32=br,ts.stringToBytes=jr,ts.stringToPDFString=yr,ts.stringToUTF8String=Ar,ts.unreachable=Ks,ts.utf8StringToString=Cr,ts.warn=Vs;const ss=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");ts.isNodeJS=ss;const ns=[1,0,0,1,0,0];ts.IDENTITY_MATRIX=ns;const rs=[.001,0,0,.001,0,0];ts.FONT_IDENTITY_MATRIX=rs;const os=1e7;ts.MAX_IMAGE_SIZE_TO_CACHE=os;const as=1.35;ts.LINE_FACTOR=as;const cs=.35;ts.LINE_DESCENT_FACTOR=cs;const ls=cs/as;ts.BASELINE_FACTOR=ls;const us={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};ts.RenderingIntentFlag=us;const ds={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};ts.AnnotationMode=ds;const xs="pdfjs_internal_editor_";ts.AnnotationEditorPrefix=xs;const fs={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};ts.AnnotationEditorType=fs;const gs={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};ts.AnnotationEditorParamsType=gs;const Es={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};ts.PermissionFlag=Es;const js={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};ts.TextRenderingMode=js;const ps={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};ts.ImageKind=ps;const ms={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};ts.AnnotationType=ms;const hs={GROUP:"Group",REPLY:"R"};ts.AnnotationReplyType=hs;const vs={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};ts.AnnotationFlag=vs;const ws={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};ts.AnnotationFieldFlag=ws;const ys={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};ts.AnnotationBorderStyleType=ys;const Rs={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};ts.AnnotationActionEventType=Rs;const bs={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};ts.DocumentActionEventType=bs;const Ns={O:"PageOpen",C:"PageClose"};ts.PageActionEventType=Ns;const Ss={ERRORS:0,WARNINGS:1,INFOS:5};ts.VerbosityLevel=Ss;const Ts={NONE:0,BINARY:1};ts.CMapCompressionType=Ts;const Cs={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};ts.OPS=Cs;const Ms={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};ts.PasswordResponses=Ms;let Is=Ss.WARNINGS;function Qs(kr){Number.isInteger(kr)&&(Is=kr)}function Ys(){return Is}function Zs(kr){Is>=Ss.INFOS&&console.log(`Info: ${kr}`)}function Vs(kr){Is>=Ss.WARNINGS&&console.log(`Warning: ${kr}`)}function Ks(kr){throw new Error(kr)}function Ds(kr,pr){kr||Ks(pr)}function $s(kr){switch(kr==null?void 0:kr.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Xs(kr,pr=null,gr=null){if(!kr)return null;try{if(gr&&typeof kr=="string"){if(gr.addDefaultProtocol&&kr.startsWith("www.")){const Jr=kr.match(/\./g);(Jr==null?void 0:Jr.length)>=2&&(kr=`http://${kr}`)}if(gr.tryConvertEncoding)try{kr=Ar(kr)}catch{}}const Ir=pr?new URL(kr,pr):new URL(kr);if($s(Ir))return Ir}catch{}return null}function Fs(kr,pr,gr,Ir=!1){return Object.defineProperty(kr,pr,{value:gr,enumerable:!Ir,configurable:!0,writable:!1}),gr}const As=function(){function pr(gr,Ir){this.constructor===pr&&Ks("Cannot initialize BaseException."),this.message=gr,this.name=Ir}return pr.prototype=new Error,pr.constructor=pr,pr}();ts.BaseException=As;class _s extends As{constructor(pr,gr){super(pr,"PasswordException"),this.code=gr}}ts.PasswordException=_s;class Ps extends As{constructor(pr,gr){super(pr,"UnknownErrorException"),this.details=gr}}ts.UnknownErrorException=Ps;class Hs extends As{constructor(pr){super(pr,"InvalidPDFException")}}ts.InvalidPDFException=Hs;class Ls extends As{constructor(pr){super(pr,"MissingPDFException")}}ts.MissingPDFException=Ls;class Os extends As{constructor(pr,gr){super(pr,"UnexpectedResponseException"),this.status=gr}}ts.UnexpectedResponseException=Os;class Ws extends As{constructor(pr){super(pr,"FormatError")}}ts.FormatError=Ws;class Gs extends As{constructor(pr){super(pr,"AbortException")}}ts.AbortException=Gs;function lr(kr){(typeof kr!="object"||(kr==null?void 0:kr.length)===void 0)&&Ks("Invalid argument for bytesToString");const pr=kr.length,gr=8192;if(pr<gr)return String.fromCharCode.apply(null,kr);const Ir=[];for(let Jr=0;Jr<pr;Jr+=gr){const qr=Math.min(Jr+gr,pr),Js=kr.subarray(Jr,qr);Ir.push(String.fromCharCode.apply(null,Js))}return Ir.join("")}function jr(kr){typeof kr!="string"&&Ks("Invalid argument for stringToBytes");const pr=kr.length,gr=new Uint8Array(pr);for(let Ir=0;Ir<pr;++Ir)gr[Ir]=kr.charCodeAt(Ir)&255;return gr}function br(kr){return String.fromCharCode(kr>>24&255,kr>>16&255,kr>>8&255,kr&255)}function Nr(kr){return Object.keys(kr).length}function wr(kr){const pr=Object.create(null);for(const[gr,Ir]of kr)pr[gr]=Ir;return pr}function dr(){const kr=new Uint8Array(4);return kr[0]=1,new Uint32Array(kr.buffer,0,1)[0]===1}function hr(){try{return new Function(""),!0}catch{return!1}}class Bs{static get isLittleEndian(){return Fs(this,"isLittleEndian",dr())}static get isEvalSupported(){return Fs(this,"isEvalSupported",hr())}static get isOffscreenCanvasSupported(){return Fs(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Fs(this,"platform",{isWin:!1,isMac:!1}):Fs(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var pr,gr;return Fs(this,"isCSSRoundSupported",(gr=(pr=globalThis.CSS)==null?void 0:pr.supports)==null?void 0:gr.call(pr,"width: round(1.5px, 1px)"))}}ts.FeatureTest=Bs;const qs=[...Array(256).keys()].map(kr=>kr.toString(16).padStart(2,"0"));class cr{static makeHexColor(pr,gr,Ir){return`#${qs[pr]}${qs[gr]}${qs[Ir]}`}static scaleMinMax(pr,gr){let Ir;pr[0]?(pr[0]<0&&(Ir=gr[0],gr[0]=gr[1],gr[1]=Ir),gr[0]*=pr[0],gr[1]*=pr[0],pr[3]<0&&(Ir=gr[2],gr[2]=gr[3],gr[3]=Ir),gr[2]*=pr[3],gr[3]*=pr[3]):(Ir=gr[0],gr[0]=gr[2],gr[2]=Ir,Ir=gr[1],gr[1]=gr[3],gr[3]=Ir,pr[1]<0&&(Ir=gr[2],gr[2]=gr[3],gr[3]=Ir),gr[2]*=pr[1],gr[3]*=pr[1],pr[2]<0&&(Ir=gr[0],gr[0]=gr[1],gr[1]=Ir),gr[0]*=pr[2],gr[1]*=pr[2]),gr[0]+=pr[4],gr[1]+=pr[4],gr[2]+=pr[5],gr[3]+=pr[5]}static transform(pr,gr){return[pr[0]*gr[0]+pr[2]*gr[1],pr[1]*gr[0]+pr[3]*gr[1],pr[0]*gr[2]+pr[2]*gr[3],pr[1]*gr[2]+pr[3]*gr[3],pr[0]*gr[4]+pr[2]*gr[5]+pr[4],pr[1]*gr[4]+pr[3]*gr[5]+pr[5]]}static applyTransform(pr,gr){const Ir=pr[0]*gr[0]+pr[1]*gr[2]+gr[4],Jr=pr[0]*gr[1]+pr[1]*gr[3]+gr[5];return[Ir,Jr]}static applyInverseTransform(pr,gr){const Ir=gr[0]*gr[3]-gr[1]*gr[2],Jr=(pr[0]*gr[3]-pr[1]*gr[2]+gr[2]*gr[5]-gr[4]*gr[3])/Ir,qr=(-pr[0]*gr[1]+pr[1]*gr[0]+gr[4]*gr[1]-gr[5]*gr[0])/Ir;return[Jr,qr]}static getAxialAlignedBoundingBox(pr,gr){const Ir=this.applyTransform(pr,gr),Jr=this.applyTransform(pr.slice(2,4),gr),qr=this.applyTransform([pr[0],pr[3]],gr),Js=this.applyTransform([pr[2],pr[1]],gr);return[Math.min(Ir[0],Jr[0],qr[0],Js[0]),Math.min(Ir[1],Jr[1],qr[1],Js[1]),Math.max(Ir[0],Jr[0],qr[0],Js[0]),Math.max(Ir[1],Jr[1],qr[1],Js[1])]}static inverseTransform(pr){const gr=pr[0]*pr[3]-pr[1]*pr[2];return[pr[3]/gr,-pr[1]/gr,-pr[2]/gr,pr[0]/gr,(pr[2]*pr[5]-pr[4]*pr[3])/gr,(pr[4]*pr[1]-pr[5]*pr[0])/gr]}static singularValueDecompose2dScale(pr){const gr=[pr[0],pr[2],pr[1],pr[3]],Ir=pr[0]*gr[0]+pr[1]*gr[2],Jr=pr[0]*gr[1]+pr[1]*gr[3],qr=pr[2]*gr[0]+pr[3]*gr[2],Js=pr[2]*gr[1]+pr[3]*gr[3],Rr=(Ir+Js)/2,Mr=Math.sqrt((Ir+Js)**2-4*(Ir*Js-qr*Jr))/2,Br=Rr+Mr||1,Ur=Rr-Mr||1;return[Math.sqrt(Br),Math.sqrt(Ur)]}static normalizeRect(pr){const gr=pr.slice(0);return pr[0]>pr[2]&&(gr[0]=pr[2],gr[2]=pr[0]),pr[1]>pr[3]&&(gr[1]=pr[3],gr[3]=pr[1]),gr}static intersect(pr,gr){const Ir=Math.max(Math.min(pr[0],pr[2]),Math.min(gr[0],gr[2])),Jr=Math.min(Math.max(pr[0],pr[2]),Math.max(gr[0],gr[2]));if(Ir>Jr)return null;const qr=Math.max(Math.min(pr[1],pr[3]),Math.min(gr[1],gr[3])),Js=Math.min(Math.max(pr[1],pr[3]),Math.max(gr[1],gr[3]));return qr>Js?null:[Ir,qr,Jr,Js]}static bezierBoundingBox(pr,gr,Ir,Jr,qr,Js,Rr,Mr){const Br=[],Ur=[[],[]];let Dr,zs,Us,or,Er,vr,Sr,_r;for(let Yr=0;Yr<2;++Yr){if(Yr===0?(zs=6*pr-12*Ir+6*qr,Dr=-3*pr+9*Ir-9*qr+3*Rr,Us=3*Ir-3*pr):(zs=6*gr-12*Jr+6*Js,Dr=-3*gr+9*Jr-9*Js+3*Mr,Us=3*Jr-3*gr),Math.abs(Dr)<1e-12){if(Math.abs(zs)<1e-12)continue;or=-Us/zs,0<or&&or<1&&Br.push(or);continue}Sr=zs*zs-4*Us*Dr,_r=Math.sqrt(Sr),!(Sr<0)&&(Er=(-zs+_r)/(2*Dr),0<Er&&Er<1&&Br.push(Er),vr=(-zs-_r)/(2*Dr),0<vr&&vr<1&&Br.push(vr))}let Hr=Br.length,Fr;const Lr=Hr;for(;Hr--;)or=Br[Hr],Fr=1-or,Ur[0][Hr]=Fr*Fr*Fr*pr+3*Fr*Fr*or*Ir+3*Fr*or*or*qr+or*or*or*Rr,Ur[1][Hr]=Fr*Fr*Fr*gr+3*Fr*Fr*or*Jr+3*Fr*or*or*Js+or*or*or*Mr;return Ur[0][Lr]=pr,Ur[1][Lr]=gr,Ur[0][Lr+1]=Rr,Ur[1][Lr+1]=Mr,Ur[0].length=Ur[1].length=Lr+2,[Math.min(...Ur[0]),Math.min(...Ur[1]),Math.max(...Ur[0]),Math.max(...Ur[1])]}}ts.Util=cr;const xr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function yr(kr){if(kr[0]>=""){let gr;if(kr[0]===""&&kr[1]===""?gr="utf-16be":kr[0]===""&&kr[1]===""?gr="utf-16le":kr[0]===""&&kr[1]===""&&kr[2]===""&&(gr="utf-8"),gr)try{const Ir=new TextDecoder(gr,{fatal:!0}),Jr=jr(kr);return Ir.decode(Jr)}catch(Ir){Vs(`stringToPDFString: "${Ir}".`)}}const pr=[];for(let gr=0,Ir=kr.length;gr<Ir;gr++){const Jr=xr[kr.charCodeAt(gr)];pr.push(Jr?String.fromCharCode(Jr):kr.charAt(gr))}return pr.join("")}function Ar(kr){return decodeURIComponent(escape(kr))}function Cr(kr){return unescape(encodeURIComponent(kr))}function ur(kr){return typeof kr=="object"&&(kr==null?void 0:kr.byteLength)!==void 0}function Pr(kr,pr){if(kr.length!==pr.length)return!1;for(let gr=0,Ir=kr.length;gr<Ir;gr++)if(kr[gr]!==pr[gr])return!1;return!0}function Tr(kr=new Date){return[kr.getUTCFullYear().toString(),(kr.getUTCMonth()+1).toString().padStart(2,"0"),kr.getUTCDate().toString().padStart(2,"0"),kr.getUTCHours().toString().padStart(2,"0"),kr.getUTCMinutes().toString().padStart(2,"0"),kr.getUTCSeconds().toString().padStart(2,"0")].join("")}class Xr{constructor(){mr(this,to,!1);this.promise=new Promise((pr,gr)=>{this.resolve=Ir=>{fr(this,to,!0),pr(Ir)},this.reject=Ir=>{fr(this,to,!0),gr(Ir)}})}get settled(){return ks(this,to)}}to=new WeakMap,ts.PromiseCapability=Xr;let Vr=null,Qr=null;function Or(kr){return Vr||(Vr=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Qr=new Map([["","t"]])),kr.replaceAll(Vr,(pr,gr,Ir)=>gr?gr.normalize("NFKC"):Qr.get(Ir))}function zr(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const kr=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(kr);else for(let pr=0;pr<32;pr++)kr[pr]=Math.floor(Math.random()*255);return lr(kr)}const Zr="pdfjs_internal_id_";ts.AnnotationPrefix=Zr},(__unused_webpack_module,exports$1,__w_pdfjs_require__)=>{var es,ss,ns,rs,ho,No,cs,ls,us,ds,xs,fs,gs,Es,js,So,ms,hs,Bo,ws,ys;Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.RenderTask=exports$1.PDFWorkerUtil=exports$1.PDFWorker=exports$1.PDFPageProxy=exports$1.PDFDocumentProxy=exports$1.PDFDocumentLoadingTask=exports$1.PDFDataRangeTransport=exports$1.LoopbackPort=exports$1.DefaultStandardFontDataFactory=exports$1.DefaultFilterFactory=exports$1.DefaultCanvasFactory=exports$1.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports$1,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports$1.build=void 0,exports$1.getDocument=getDocument,exports$1.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports$1.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports$1.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports$1.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports$1.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(bs){if(typeof bs=="string"||bs instanceof URL?bs={url:bs}:(0,_util.isArrayBuffer)(bs)&&(bs={data:bs}),typeof bs!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!bs.url&&!bs.data&&!bs.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const Ns=new PDFDocumentLoadingTask,{docId:Ss}=Ns,Ts=bs.url?getUrlProp(bs.url):null,Cs=bs.data?getDataProp(bs.data):null,Ms=bs.httpHeaders||null,Is=bs.withCredentials===!0,Qs=bs.password??null,Ys=bs.range instanceof PDFDataRangeTransport?bs.range:null,Zs=Number.isInteger(bs.rangeChunkSize)&&bs.rangeChunkSize>0?bs.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Vs=bs.worker instanceof PDFWorker?bs.worker:null;const Ks=bs.verbosity,Ds=typeof bs.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(bs.docBaseUrl)?bs.docBaseUrl:null,$s=typeof bs.cMapUrl=="string"?bs.cMapUrl:null,Xs=bs.cMapPacked!==!1,Fs=bs.CMapReaderFactory||DefaultCMapReaderFactory,As=typeof bs.standardFontDataUrl=="string"?bs.standardFontDataUrl:null,_s=bs.StandardFontDataFactory||DefaultStandardFontDataFactory,Ps=bs.stopAtErrors!==!0,Hs=Number.isInteger(bs.maxImageSize)&&bs.maxImageSize>-1?bs.maxImageSize:-1,Ls=bs.isEvalSupported!==!1,Os=typeof bs.isOffscreenCanvasSupported=="boolean"?bs.isOffscreenCanvasSupported:!_util.isNodeJS,Ws=Number.isInteger(bs.canvasMaxAreaInBytes)?bs.canvasMaxAreaInBytes:-1,Gs=typeof bs.disableFontFace=="boolean"?bs.disableFontFace:_util.isNodeJS,lr=bs.fontExtraProperties===!0,jr=bs.enableXfa===!0,br=bs.ownerDocument||globalThis.document,Nr=bs.disableRange===!0,wr=bs.disableStream===!0,dr=bs.disableAutoFetch===!0,hr=bs.pdfBug===!0,Bs=Ys?Ys.length:bs.length??NaN,qs=typeof bs.useSystemFonts=="boolean"?bs.useSystemFonts:!_util.isNodeJS&&!Gs,cr=typeof bs.useWorkerFetch=="boolean"?bs.useWorkerFetch:Fs===_display_utils.DOMCMapReaderFactory&&_s===_display_utils.DOMStandardFontDataFactory&&$s&&As&&(0,_display_utils.isValidFetchUrl)($s,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(As,document.baseURI),xr=bs.canvasFactory||new DefaultCanvasFactory({ownerDocument:br}),yr=bs.filterFactory||new DefaultFilterFactory({docId:Ss,ownerDocument:br}),Ar=null;(0,_util.setVerbosityLevel)(Ks);const Cr={canvasFactory:xr,filterFactory:yr};if(cr||(Cr.cMapReaderFactory=new Fs({baseUrl:$s,isCompressed:Xs}),Cr.standardFontDataFactory=new _s({baseUrl:As})),!Vs){const Tr={verbosity:Ks,port:_worker_options.GlobalWorkerOptions.workerPort};Vs=Tr.port?PDFWorker.fromPort(Tr):new PDFWorker(Tr),Ns._worker=Vs}const ur={docId:Ss,apiVersion:"3.11.174",data:Cs,password:Qs,disableAutoFetch:dr,rangeChunkSize:Zs,length:Bs,docBaseUrl:Ds,enableXfa:jr,evaluatorOptions:{maxImageSize:Hs,disableFontFace:Gs,ignoreErrors:Ps,isEvalSupported:Ls,isOffscreenCanvasSupported:Os,canvasMaxAreaInBytes:Ws,fontExtraProperties:lr,useSystemFonts:qs,cMapUrl:cr?$s:null,standardFontDataUrl:cr?As:null}},Pr={ignoreErrors:Ps,isEvalSupported:Ls,disableFontFace:Gs,fontExtraProperties:lr,enableXfa:jr,ownerDocument:br,disableAutoFetch:dr,pdfBug:hr,styleElement:Ar};return Vs.promise.then(function(){if(Ns.destroyed)throw new Error("Loading aborted");const Tr=_fetchDocument(Vs,ur),Xr=new Promise(function(Vr){let Qr;Ys?Qr=new _transport_stream.PDFDataTransportStream({length:Bs,initialData:Ys.initialData,progressiveDone:Ys.progressiveDone,contentDispositionFilename:Ys.contentDispositionFilename,disableRange:Nr,disableStream:wr},Ys):Cs||(Qr=(zr=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(zr):(0,_display_utils.isValidFetchUrl)(zr.url)?new _displayFetch_stream.PDFFetchStream(zr):new _displayNetwork.PDFNetworkStream(zr))({url:Ts,length:Bs,httpHeaders:Ms,withCredentials:Is,rangeChunkSize:Zs,disableRange:Nr,disableStream:wr})),Vr(Qr)});return Promise.all([Tr,Xr]).then(function([Vr,Qr]){if(Ns.destroyed)throw new Error("Loading aborted");const Or=new _message_handler.MessageHandler(Ss,Vr,Vs.port),zr=new WorkerTransport(Or,Ns,Qr,Pr,Cr);Ns._transport=zr,Or.send("Ready",null)})}).catch(Ns._capability.reject),Ns}async function _fetchDocument(bs,Ns){if(bs.destroyed)throw new Error("Worker was destroyed");const Ss=await bs.messageHandler.sendWithPromise("GetDocRequest",Ns,Ns.data?[Ns.data.buffer]:null);if(bs.destroyed)throw new Error("Worker was destroyed");return Ss}function getUrlProp(bs){if(bs instanceof URL)return bs.href;try{return new URL(bs,window.location).href}catch{if(_util.isNodeJS&&typeof bs=="string")return bs}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(bs){if(_util.isNodeJS&&typeof Buffer<"u"&&bs instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(bs instanceof Uint8Array&&bs.byteLength===bs.buffer.byteLength)return bs;if(typeof bs=="string")return(0,_util.stringToBytes)(bs);if(typeof bs=="object"&&!isNaN(bs==null?void 0:bs.length)||(0,_util.isArrayBuffer)(bs))return new Uint8Array(bs);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const ts=class ts{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${go(ts,es)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var Ns,Ss,Ts;this.destroyed=!0;try{(Ns=this._worker)!=null&&Ns.port&&(this._worker._pendingDestroy=!0),await((Ss=this._transport)==null?void 0:Ss.destroy())}catch(Cs){throw(Ts=this._worker)!=null&&Ts.port&&delete this._worker._pendingDestroy,Cs}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};es=new WeakMap,mr(ts,es,0);let PDFDocumentLoadingTask=ts;exports$1.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(Ns,Ss,Ts=!1,Cs=null){this.length=Ns,this.initialData=Ss,this.progressiveDone=Ts,this.contentDispositionFilename=Cs,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(Ns){this._rangeListeners.push(Ns)}addProgressListener(Ns){this._progressListeners.push(Ns)}addProgressiveReadListener(Ns){this._progressiveReadListeners.push(Ns)}addProgressiveDoneListener(Ns){this._progressiveDoneListeners.push(Ns)}onDataRange(Ns,Ss){for(const Ts of this._rangeListeners)Ts(Ns,Ss)}onDataProgress(Ns,Ss){this._readyCapability.promise.then(()=>{for(const Ts of this._progressListeners)Ts(Ns,Ss)})}onDataProgressiveRead(Ns){this._readyCapability.promise.then(()=>{for(const Ss of this._progressiveReadListeners)Ss(Ns)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const Ns of this._progressiveDoneListeners)Ns()})}transportReady(){this._readyCapability.resolve()}requestDataRange(Ns,Ss){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports$1.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(Ns,Ss){this._pdfInfo=Ns,this._transport=Ss,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(Ts=>{if(!Ts)return Ts;const Cs=[];for(const Ms in Ts)Cs.push(...Ts[Ms]);return Cs}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(Ns){return this._transport.getPage(Ns)}getPageIndex(Ns){return this._transport.getPageIndex(Ns)}getDestinations(){return this._transport.getDestinations()}getDestination(Ns){return this._transport.getDestination(Ns)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(Ns=!1){return this._transport.startCleanup(Ns||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports$1.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(Ns,Ss,Ts,Cs=!1){mr(this,rs);mr(this,ss,null);mr(this,ns,!1);this._pageIndex=Ns,this._pageInfo=Ss,this._transport=Ts,this._stats=Cs?new _display_utils.StatTimer:null,this._pdfBug=Cs,this.commonObjs=Ts.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:Ns,rotation:Ss=this.rotate,offsetX:Ts=0,offsetY:Cs=0,dontFlip:Ms=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:Ns,rotation:Ss,offsetX:Ts,offsetY:Cs,dontFlip:Ms})}getAnnotations({intent:Ns="display"}={}){const Ss=this._transport.getRenderingIntent(Ns);return this._transport.getAnnotations(this._pageIndex,Ss.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var Ns;return((Ns=this._transport._htmlForXfa)==null?void 0:Ns.children[this._pageIndex])||null}render({canvasContext:Ns,viewport:Ss,intent:Ts="display",annotationMode:Cs=_util.AnnotationMode.ENABLE,transform:Ms=null,background:Is=null,optionalContentConfigPromise:Qs=null,annotationCanvasMap:Ys=null,pageColors:Zs=null,printAnnotationStorage:Vs=null}){var _s,Ps;(_s=this._stats)==null||_s.time("Overall");const Ks=this._transport.getRenderingIntent(Ts,Cs,Vs);fr(this,ns,!1),ar(this,rs,No).call(this),Qs||(Qs=this._transport.getOptionalContentConfig());let Ds=this._intentStates.get(Ks.cacheKey);Ds||(Ds=Object.create(null),this._intentStates.set(Ks.cacheKey,Ds)),Ds.streamReaderCancelTimeout&&(clearTimeout(Ds.streamReaderCancelTimeout),Ds.streamReaderCancelTimeout=null);const $s=!!(Ks.renderingIntent&_util.RenderingIntentFlag.PRINT);Ds.displayReadyCapability||(Ds.displayReadyCapability=new _util.PromiseCapability,Ds.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Ps=this._stats)==null||Ps.time("Page Request"),this._pumpOperatorList(Ks));const Xs=Hs=>{var Ls,Os;Ds.renderTasks.delete(Fs),(this._maybeCleanupAfterRender||$s)&&fr(this,ns,!0),ar(this,rs,ho).call(this,!$s),Hs?(Fs.capability.reject(Hs),this._abortOperatorList({intentState:Ds,reason:Hs instanceof Error?Hs:new Error(Hs)})):Fs.capability.resolve(),(Ls=this._stats)==null||Ls.timeEnd("Rendering"),(Os=this._stats)==null||Os.timeEnd("Overall")},Fs=new InternalRenderTask({callback:Xs,params:{canvasContext:Ns,viewport:Ss,transform:Ms,background:Is},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Ys,operatorList:Ds.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!$s,pdfBug:this._pdfBug,pageColors:Zs});(Ds.renderTasks||(Ds.renderTasks=new Set)).add(Fs);const As=Fs.task;return Promise.all([Ds.displayReadyCapability.promise,Qs]).then(([Hs,Ls])=>{var Os;if(this.destroyed){Xs();return}(Os=this._stats)==null||Os.time("Rendering"),Fs.initializeGraphics({transparency:Hs,optionalContentConfig:Ls}),Fs.operatorListChanged()}).catch(Xs),As}getOperatorList({intent:Ns="display",annotationMode:Ss=_util.AnnotationMode.ENABLE,printAnnotationStorage:Ts=null}={}){var Ys;function Cs(){Is.operatorList.lastChunk&&(Is.opListReadCapability.resolve(Is.operatorList),Is.renderTasks.delete(Qs))}const Ms=this._transport.getRenderingIntent(Ns,Ss,Ts,!0);let Is=this._intentStates.get(Ms.cacheKey);Is||(Is=Object.create(null),this._intentStates.set(Ms.cacheKey,Is));let Qs;return Is.opListReadCapability||(Qs=Object.create(null),Qs.operatorListChanged=Cs,Is.opListReadCapability=new _util.PromiseCapability,(Is.renderTasks||(Is.renderTasks=new Set)).add(Qs),Is.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Ys=this._stats)==null||Ys.time("Page Request"),this._pumpOperatorList(Ms)),Is.opListReadCapability.promise}streamTextContent({includeMarkedContent:Ns=!1,disableNormalization:Ss=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:Ns===!0,disableNormalization:Ss===!0},{highWaterMark:100,size(Cs){return Cs.items.length}})}getTextContent(Ns={}){if(this._transport._htmlForXfa)return this.getXfa().then(Ts=>_xfa_text.XfaText.textContent(Ts));const Ss=this.streamTextContent(Ns);return new Promise(function(Ts,Cs){function Ms(){Is.read().then(function({value:Ys,done:Zs}){if(Zs){Ts(Qs);return}Object.assign(Qs.styles,Ys.styles),Qs.items.push(...Ys.items),Ms()},Cs)}const Is=Ss.getReader(),Qs={items:[],styles:Object.create(null)};Ms()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const Ns=[];for(const Ss of this._intentStates.values())if(this._abortOperatorList({intentState:Ss,reason:new Error("Page was destroyed."),force:!0}),!Ss.opListReadCapability)for(const Ts of Ss.renderTasks)Ns.push(Ts.completed),Ts.cancel();return this.objs.clear(),fr(this,ns,!1),ar(this,rs,No).call(this),Promise.all(Ns)}cleanup(Ns=!1){fr(this,ns,!0);const Ss=ar(this,rs,ho).call(this,!1);return Ns&&Ss&&this._stats&&(this._stats=new _display_utils.StatTimer),Ss}_startRenderPage(Ns,Ss){var Cs,Ms;const Ts=this._intentStates.get(Ss);Ts&&((Cs=this._stats)==null||Cs.timeEnd("Page Request"),(Ms=Ts.displayReadyCapability)==null||Ms.resolve(Ns))}_renderPageChunk(Ns,Ss){for(let Ts=0,Cs=Ns.length;Ts<Cs;Ts++)Ss.operatorList.fnArray.push(Ns.fnArray[Ts]),Ss.operatorList.argsArray.push(Ns.argsArray[Ts]);Ss.operatorList.lastChunk=Ns.lastChunk,Ss.operatorList.separateAnnots=Ns.separateAnnots;for(const Ts of Ss.renderTasks)Ts.operatorListChanged();Ns.lastChunk&&ar(this,rs,ho).call(this,!0)}_pumpOperatorList({renderingIntent:Ns,cacheKey:Ss,annotationStorageSerializable:Ts}){const{map:Cs,transfers:Ms}=Ts,Qs=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:Ns,cacheKey:Ss,annotationStorage:Cs},Ms).getReader(),Ys=this._intentStates.get(Ss);Ys.streamReader=Qs;const Zs=()=>{Qs.read().then(({value:Vs,done:Ks})=>{if(Ks){Ys.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Vs,Ys),Zs())},Vs=>{if(Ys.streamReader=null,!this._transport.destroyed){if(Ys.operatorList){Ys.operatorList.lastChunk=!0;for(const Ks of Ys.renderTasks)Ks.operatorListChanged();ar(this,rs,ho).call(this,!0)}if(Ys.displayReadyCapability)Ys.displayReadyCapability.reject(Vs);else if(Ys.opListReadCapability)Ys.opListReadCapability.reject(Vs);else throw Vs}})};Zs()}_abortOperatorList({intentState:Ns,reason:Ss,force:Ts=!1}){if(Ns.streamReader){if(Ns.streamReaderCancelTimeout&&(clearTimeout(Ns.streamReaderCancelTimeout),Ns.streamReaderCancelTimeout=null),!Ts){if(Ns.renderTasks.size>0)return;if(Ss instanceof _display_utils.RenderingCancelledException){let Cs=RENDERING_CANCELLED_TIMEOUT;Ss.extraDelay>0&&Ss.extraDelay<1e3&&(Cs+=Ss.extraDelay),Ns.streamReaderCancelTimeout=setTimeout(()=>{Ns.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:Ns,reason:Ss,force:!0})},Cs);return}}if(Ns.streamReader.cancel(new _util.AbortException(Ss.message)).catch(()=>{}),Ns.streamReader=null,!this._transport.destroyed){for(const[Cs,Ms]of this._intentStates)if(Ms===Ns){this._intentStates.delete(Cs);break}this.cleanup()}}}get stats(){return this._stats}}ss=new WeakMap,ns=new WeakMap,rs=new WeakSet,ho=function(Ns=!1){if(ar(this,rs,No).call(this),!ks(this,ns)||this.destroyed)return!1;if(Ns)return fr(this,ss,setTimeout(()=>{fr(this,ss,null),ar(this,rs,ho).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:Ss,operatorList:Ts}of this._intentStates.values())if(Ss.size>0||!Ts.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),fr(this,ns,!1),!0},No=function(){ks(this,ss)&&(clearTimeout(ks(this,ss)),fr(this,ss,null))},exports$1.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){mr(this,cs,new Set);mr(this,ls,Promise.resolve())}postMessage(Ns,Ss){const Ts={data:structuredClone(Ns,Ss?{transfer:Ss}:null)};ks(this,ls).then(()=>{for(const Cs of ks(this,cs))Cs.call(this,Ts)})}addEventListener(Ns,Ss){ks(this,cs).add(Ss)}removeEventListener(Ns,Ss){ks(this,cs).delete(Ss)}terminate(){ks(this,cs).clear()}}cs=new WeakMap,ls=new WeakMap,exports$1.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports$1.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const bs=(us=document==null?void 0:document.currentScript)==null?void 0:us.src;bs&&(PDFWorkerUtil.fallbackWorkerSrc=bs.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(bs,Ns){let Ss;try{if(Ss=new URL(bs),!Ss.origin||Ss.origin==="null")return!1}catch{return!1}const Ts=new URL(Ns,Ss);return Ss.origin===Ts.origin},PDFWorkerUtil.createCDNWrapper=function(bs){const Ns=`importScripts("${bs}");`;return URL.createObjectURL(new Blob([Ns]))}}const _PDFWorker=class _PDFWorker{constructor({name:bs=null,port:Ns=null,verbosity:Ss=(0,_util.getVerbosityLevel)()}={}){var Ts;if(this.name=bs,this.destroyed=!1,this.verbosity=Ss,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,Ns){if((Ts=ks(_PDFWorker,ds))!=null&&Ts.has(Ns))throw new Error("Cannot use more than one PDFWorker per port.");(ks(_PDFWorker,ds)||fr(_PDFWorker,ds,new WeakMap)).set(Ns,this),this._initializeFromPort(Ns);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(bs){this._port=bs,this._messageHandler=new _message_handler.MessageHandler("main","worker",bs),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:bs}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,bs)||(bs=PDFWorkerUtil.createCDNWrapper(new URL(bs,window.location).href));const Ns=new Worker(bs),Ss=new _message_handler.MessageHandler("main","worker",Ns),Ts=()=>{Ns.removeEventListener("error",Cs),Ss.destroy(),Ns.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Cs=()=>{this._webWorker||Ts()};Ns.addEventListener("error",Cs),Ss.on("test",Is=>{if(Ns.removeEventListener("error",Cs),this.destroyed){Ts();return}Is?(this._messageHandler=Ss,this._port=Ns,this._webWorker=Ns,this._readyCapability.resolve(),Ss.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),Ss.destroy(),Ns.terminate())}),Ss.on("ready",Is=>{if(Ns.removeEventListener("error",Cs),this.destroyed){Ts();return}try{Ms()}catch{this._setupFakeWorker()}});const Ms=()=>{const Is=new Uint8Array;Ss.send("test",Is,[Is.buffer])};Ms();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(bs=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const Ns=new LoopbackPort;this._port=Ns;const Ss=`fake${PDFWorkerUtil.fakeWorkerId++}`,Ts=new _message_handler.MessageHandler(Ss+"_worker",Ss,Ns);bs.setup(Ts,Ns);const Cs=new _message_handler.MessageHandler(Ss,Ss+"_worker",Ns);this._messageHandler=Cs,this._readyCapability.resolve(),Cs.send("configure",{verbosity:this.verbosity})}).catch(bs=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${bs.message}".`))})}destroy(){var bs;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(bs=ks(_PDFWorker,ds))==null||bs.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(bs){var Ss;if(!(bs!=null&&bs.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const Ns=(Ss=ks(this,ds))==null?void 0:Ss.get(bs.port);if(Ns){if(Ns._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return Ns}return new _PDFWorker(bs)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var bs;try{return((bs=globalThis.pdfjsWorker)==null?void 0:bs.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};ds=new WeakMap,mr(_PDFWorker,ds);let PDFWorker=_PDFWorker;exports$1.PDFWorker=PDFWorker;class WorkerTransport{constructor(Ns,Ss,Ts,Cs,Ms){mr(this,js);mr(this,xs,new Map);mr(this,fs,new Map);mr(this,gs,new Map);mr(this,Es,null);this.messageHandler=Ns,this.loadingTask=Ss,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:Cs.ownerDocument,styleElement:Cs.styleElement}),this._params=Cs,this.canvasFactory=Ms.canvasFactory,this.filterFactory=Ms.filterFactory,this.cMapReaderFactory=Ms.cMapReaderFactory,this.standardFontDataFactory=Ms.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=Ts,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(Ns,Ss=_util.AnnotationMode.ENABLE,Ts=null,Cs=!1){let Ms=_util.RenderingIntentFlag.DISPLAY,Is=_annotation_storage.SerializableEmpty;switch(Ns){case"any":Ms=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Ms=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${Ns}`)}switch(Ss){case _util.AnnotationMode.DISABLE:Ms+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Ms+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Ms+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,Is=(Ms&_util.RenderingIntentFlag.PRINT&&Ts instanceof _annotation_storage.PrintAnnotationStorage?Ts:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${Ss}`)}return Cs&&(Ms+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Ms,cacheKey:`${Ms}_${Is.hash}`,annotationStorageSerializable:Is}}destroy(){var Ts;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(Ts=ks(this,Es))==null||Ts.reject(new Error("Worker was destroyed during onPassword callback"));const Ns=[];for(const Cs of ks(this,fs).values())Ns.push(Cs._destroy());ks(this,fs).clear(),ks(this,gs).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const Ss=this.messageHandler.sendWithPromise("Terminate",null);return Ns.push(Ss),Promise.all(Ns).then(()=>{var Cs;this.commonObjs.clear(),this.fontLoader.clear(),ks(this,xs).clear(),this.filterFactory.destroy(),(Cs=this._networkStream)==null||Cs.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:Ns,loadingTask:Ss}=this;Ns.on("GetReader",(Ts,Cs)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Ms=>{this._lastProgress={loaded:Ms.loaded,total:Ms.total}},Cs.onPull=()=>{this._fullReader.read().then(function({value:Ms,done:Is}){if(Is){Cs.close();return}(0,_util.assert)(Ms instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Cs.enqueue(new Uint8Array(Ms),1,[Ms])}).catch(Ms=>{Cs.error(Ms)})},Cs.onCancel=Ms=>{this._fullReader.cancel(Ms),Cs.ready.catch(Is=>{if(!this.destroyed)throw Is})}}),Ns.on("ReaderHeadersReady",Ts=>{const Cs=new _util.PromiseCapability,Ms=this._fullReader;return Ms.headersReady.then(()=>{var Is;(!Ms.isStreamingSupported||!Ms.isRangeSupported)&&(this._lastProgress&&((Is=Ss.onProgress)==null||Is.call(Ss,this._lastProgress)),Ms.onProgress=Qs=>{var Ys;(Ys=Ss.onProgress)==null||Ys.call(Ss,{loaded:Qs.loaded,total:Qs.total})}),Cs.resolve({isStreamingSupported:Ms.isStreamingSupported,isRangeSupported:Ms.isRangeSupported,contentLength:Ms.contentLength})},Cs.reject),Cs.promise}),Ns.on("GetRangeReader",(Ts,Cs)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Ms=this._networkStream.getRangeReader(Ts.begin,Ts.end);if(!Ms){Cs.close();return}Cs.onPull=()=>{Ms.read().then(function({value:Is,done:Qs}){if(Qs){Cs.close();return}(0,_util.assert)(Is instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Cs.enqueue(new Uint8Array(Is),1,[Is])}).catch(Is=>{Cs.error(Is)})},Cs.onCancel=Is=>{Ms.cancel(Is),Cs.ready.catch(Qs=>{if(!this.destroyed)throw Qs})}}),Ns.on("GetDoc",({pdfInfo:Ts})=>{this._numPages=Ts.numPages,this._htmlForXfa=Ts.htmlForXfa,delete Ts.htmlForXfa,Ss._capability.resolve(new PDFDocumentProxy(Ts,this))}),Ns.on("DocException",function(Ts){let Cs;switch(Ts.name){case"PasswordException":Cs=new _util.PasswordException(Ts.message,Ts.code);break;case"InvalidPDFException":Cs=new _util.InvalidPDFException(Ts.message);break;case"MissingPDFException":Cs=new _util.MissingPDFException(Ts.message);break;case"UnexpectedResponseException":Cs=new _util.UnexpectedResponseException(Ts.message,Ts.status);break;case"UnknownErrorException":Cs=new _util.UnknownErrorException(Ts.message,Ts.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}Ss._capability.reject(Cs)}),Ns.on("PasswordRequest",Ts=>{if(fr(this,Es,new _util.PromiseCapability),Ss.onPassword){const Cs=Ms=>{Ms instanceof Error?ks(this,Es).reject(Ms):ks(this,Es).resolve({password:Ms})};try{Ss.onPassword(Cs,Ts.code)}catch(Ms){ks(this,Es).reject(Ms)}}else ks(this,Es).reject(new _util.PasswordException(Ts.message,Ts.code));return ks(this,Es).promise}),Ns.on("DataLoaded",Ts=>{var Cs;(Cs=Ss.onProgress)==null||Cs.call(Ss,{loaded:Ts.length,total:Ts.length}),this.downloadInfoCapability.resolve(Ts)}),Ns.on("StartRenderPage",Ts=>{if(this.destroyed)return;ks(this,fs).get(Ts.pageIndex)._startRenderPage(Ts.transparency,Ts.cacheKey)}),Ns.on("commonobj",([Ts,Cs,Ms])=>{var Is;if(!this.destroyed&&!this.commonObjs.has(Ts))switch(Cs){case"Font":const Qs=this._params;if("error"in Ms){const Vs=Ms.error;(0,_util.warn)(`Error during font loading: ${Vs}`),this.commonObjs.resolve(Ts,Vs);break}const Ys=Qs.pdfBug&&((Is=globalThis.FontInspector)!=null&&Is.enabled)?(Vs,Ks)=>globalThis.FontInspector.fontAdded(Vs,Ks):null,Zs=new _font_loader.FontFaceObject(Ms,{isEvalSupported:Qs.isEvalSupported,disableFontFace:Qs.disableFontFace,ignoreErrors:Qs.ignoreErrors,inspectFont:Ys});this.fontLoader.bind(Zs).catch(Vs=>Ns.sendWithPromise("FontFallback",{id:Ts})).finally(()=>{!Qs.fontExtraProperties&&Zs.data&&(Zs.data=null),this.commonObjs.resolve(Ts,Zs)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(Ts,Ms);break;default:throw new Error(`Got unknown common object type ${Cs}`)}}),Ns.on("obj",([Ts,Cs,Ms,Is])=>{var Ys;if(this.destroyed)return;const Qs=ks(this,fs).get(Cs);if(!Qs.objs.has(Ts))switch(Ms){case"Image":if(Qs.objs.resolve(Ts,Is),Is){let Zs;if(Is.bitmap){const{width:Vs,height:Ks}=Is;Zs=Vs*Ks*4}else Zs=((Ys=Is.data)==null?void 0:Ys.length)||0;Zs>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Qs._maybeCleanupAfterRender=!0)}break;case"Pattern":Qs.objs.resolve(Ts,Is);break;default:throw new Error(`Got unknown object type ${Ms}`)}}),Ns.on("DocProgress",Ts=>{var Cs;this.destroyed||(Cs=Ss.onProgress)==null||Cs.call(Ss,{loaded:Ts.loaded,total:Ts.total})}),Ns.on("FetchBuiltInCMap",Ts=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(Ts):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),Ns.on("FetchStandardFontData",Ts=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(Ts):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var Ts;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:Ns,transfers:Ss}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:Ns,filename:((Ts=this._fullReader)==null?void 0:Ts.filename)??null},Ss).finally(()=>{this.annotationStorage.resetModified()})}getPage(Ns){if(!Number.isInteger(Ns)||Ns<=0||Ns>this._numPages)return Promise.reject(new Error("Invalid page request."));const Ss=Ns-1,Ts=ks(this,gs).get(Ss);if(Ts)return Ts;const Cs=this.messageHandler.sendWithPromise("GetPage",{pageIndex:Ss}).then(Ms=>{if(this.destroyed)throw new Error("Transport destroyed");const Is=new PDFPageProxy(Ss,Ms,this,this._params.pdfBug);return ks(this,fs).set(Ss,Is),Is});return ks(this,gs).set(Ss,Cs),Cs}getPageIndex(Ns){return typeof Ns!="object"||Ns===null||!Number.isInteger(Ns.num)||Ns.num<0||!Number.isInteger(Ns.gen)||Ns.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:Ns.num,gen:Ns.gen})}getAnnotations(Ns,Ss){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:Ns,intent:Ss})}getFieldObjects(){return ar(this,js,So).call(this,"GetFieldObjects")}hasJSActions(){return ar(this,js,So).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(Ns){return typeof Ns!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:Ns})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return ar(this,js,So).call(this,"GetDocJSActions")}getPageJSActions(Ns){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:Ns})}getStructTree(Ns){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:Ns})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(Ns=>new _optional_content_config.OptionalContentConfig(Ns))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const Ns="GetMetadata",Ss=ks(this,xs).get(Ns);if(Ss)return Ss;const Ts=this.messageHandler.sendWithPromise(Ns,null).then(Cs=>{var Ms,Is;return{info:Cs[0],metadata:Cs[1]?new _metadata.Metadata(Cs[1]):null,contentDispositionFilename:((Ms=this._fullReader)==null?void 0:Ms.filename)??null,contentLength:((Is=this._fullReader)==null?void 0:Is.contentLength)??null}});return ks(this,xs).set(Ns,Ts),Ts}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(Ns=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const Ss of ks(this,fs).values())if(!Ss.cleanup())throw new Error(`startCleanup: Page ${Ss.pageNumber} is currently rendering.`);this.commonObjs.clear(),Ns||this.fontLoader.clear(),ks(this,xs).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:Ns,enableXfa:Ss}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:Ns,enableXfa:Ss})}}xs=new WeakMap,fs=new WeakMap,gs=new WeakMap,Es=new WeakMap,js=new WeakSet,So=function(Ns,Ss=null){const Ts=ks(this,xs).get(Ns);if(Ts)return Ts;const Cs=this.messageHandler.sendWithPromise(Ns,Ss);return ks(this,xs).set(Ns,Cs),Cs};class PDFObjects{constructor(){mr(this,hs);mr(this,ms,Object.create(null))}get(Ns,Ss=null){if(Ss){const Cs=ar(this,hs,Bo).call(this,Ns);return Cs.capability.promise.then(()=>Ss(Cs.data)),null}const Ts=ks(this,ms)[Ns];if(!(Ts!=null&&Ts.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${Ns}.`);return Ts.data}has(Ns){const Ss=ks(this,ms)[Ns];return(Ss==null?void 0:Ss.capability.settled)||!1}resolve(Ns,Ss=null){const Ts=ar(this,hs,Bo).call(this,Ns);Ts.data=Ss,Ts.capability.resolve()}clear(){var Ns;for(const Ss in ks(this,ms)){const{data:Ts}=ks(this,ms)[Ss];(Ns=Ts==null?void 0:Ts.bitmap)==null||Ns.close()}fr(this,ms,Object.create(null))}}ms=new WeakMap,hs=new WeakSet,Bo=function(Ns){var Ss;return(Ss=ks(this,ms))[Ns]||(Ss[Ns]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(Ns){mr(this,ws,null);fr(this,ws,Ns),this.onContinue=null}get promise(){return ks(this,ws).capability.promise}cancel(Ns=0){ks(this,ws).cancel(null,Ns)}get separateAnnots(){const{separateAnnots:Ns}=ks(this,ws).operatorList;if(!Ns)return!1;const{annotationCanvasMap:Ss}=ks(this,ws);return Ns.form||Ns.canvas&&(Ss==null?void 0:Ss.size)>0}}ws=new WeakMap,exports$1.RenderTask=RenderTask;const Rs=class Rs{constructor({callback:Ns,params:Ss,objs:Ts,commonObjs:Cs,annotationCanvasMap:Ms,operatorList:Is,pageIndex:Qs,canvasFactory:Ys,filterFactory:Zs,useRequestAnimationFrame:Vs=!1,pdfBug:Ks=!1,pageColors:Ds=null}){this.callback=Ns,this.params=Ss,this.objs=Ts,this.commonObjs=Cs,this.annotationCanvasMap=Ms,this.operatorListIdx=null,this.operatorList=Is,this._pageIndex=Qs,this.canvasFactory=Ys,this.filterFactory=Zs,this._pdfBug=Ks,this.pageColors=Ds,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Vs===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=Ss.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:Ns=!1,optionalContentConfig:Ss}){var Qs,Ys;if(this.cancelled)return;if(this._canvas){if(ks(Rs,ys).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ks(Rs,ys).add(this._canvas)}this._pdfBug&&((Qs=globalThis.StepperManager)!=null&&Qs.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:Ts,viewport:Cs,transform:Ms,background:Is}=this.params;this.gfx=new _canvas.CanvasGraphics(Ts,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:Ss},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Ms,viewport:Cs,transparency:Ns,background:Is}),this.operatorListIdx=0,this.graphicsReady=!0,(Ys=this.graphicsReadyCallback)==null||Ys.call(this)}cancel(Ns=null,Ss=0){var Ts;this.running=!1,this.cancelled=!0,(Ts=this.gfx)==null||Ts.endDrawing(),ks(Rs,ys).delete(this._canvas),this.callback(Ns||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,Ss))}operatorListChanged(){var Ns;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(Ns=this.stepper)==null||Ns.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ks(Rs,ys).delete(this._canvas),this.callback())))}};ys=new WeakMap,mr(Rs,ys,new WeakSet);let InternalRenderTask=Rs;const version="3.11.174";exports$1.version=version;const build="ce8716743";exports$1.build=build},(es,ts,ss)=>{var us,ds,xs,Ol,gs;Object.defineProperty(ts,"__esModule",{value:!0}),ts.SerializableEmpty=ts.PrintAnnotationStorage=ts.AnnotationStorage=void 0;var ns=ss(1),rs=ss(4),os=ss(8);const as=Object.freeze({map:null,hash:"",transfers:void 0});ts.SerializableEmpty=as;class cs{constructor(){mr(this,xs);mr(this,us,!1);mr(this,ds,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(js,ps){const ms=ks(this,ds).get(js);return ms===void 0?ps:Object.assign(ps,ms)}getRawValue(js){return ks(this,ds).get(js)}remove(js){if(ks(this,ds).delete(js),ks(this,ds).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const ps of ks(this,ds).values())if(ps instanceof rs.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(js,ps){const ms=ks(this,ds).get(js);let hs=!1;if(ms!==void 0)for(const[vs,ws]of Object.entries(ps))ms[vs]!==ws&&(hs=!0,ms[vs]=ws);else hs=!0,ks(this,ds).set(js,ps);hs&&ar(this,xs,Ol).call(this),ps instanceof rs.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(ps.constructor._type)}has(js){return ks(this,ds).has(js)}getAll(){return ks(this,ds).size>0?(0,ns.objectFromMap)(ks(this,ds)):null}setAll(js){for(const[ps,ms]of Object.entries(js))this.setValue(ps,ms)}get size(){return ks(this,ds).size}resetModified(){ks(this,us)&&(fr(this,us,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ls(this)}get serializable(){if(ks(this,ds).size===0)return as;const js=new Map,ps=new os.MurmurHash3_64,ms=[],hs=Object.create(null);let vs=!1;for(const[ws,ys]of ks(this,ds)){const Rs=ys instanceof rs.AnnotationEditor?ys.serialize(!1,hs):ys;Rs&&(js.set(ws,Rs),ps.update(`${ws}:${JSON.stringify(Rs)}`),vs||(vs=!!Rs.bitmap))}if(vs)for(const ws of js.values())ws.bitmap&&ms.push(ws.bitmap);return js.size>0?{map:js,hash:ps.hexdigest(),transfers:ms}:as}}us=new WeakMap,ds=new WeakMap,xs=new WeakSet,Ol=function(){ks(this,us)||(fr(this,us,!0),typeof this.onSetModified=="function"&&this.onSetModified())},ts.AnnotationStorage=cs;class ls extends cs{constructor(ps){super();mr(this,gs);const{map:ms,hash:hs,transfers:vs}=ps.serializable,ws=structuredClone(ms,vs?{transfer:vs}:null);fr(this,gs,{map:ws,hash:hs,transfers:vs})}get print(){(0,ns.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return ks(this,gs)}}gs=new WeakMap,ts.PrintAnnotationStorage=ls},(es,ts,ss)=>{var ls,us,ds,xs,fs,gs,Es,js,ps,ms,hs,vs,ws,ys,Rs,Ho,Wo,Ss,Uo,zo,Fl,$l,Bl,Vo,Hl;Object.defineProperty(ts,"__esModule",{value:!0}),ts.AnnotationEditor=void 0;var ns=ss(5),rs=ss(1),os=ss(6);const Vs=class Vs{constructor(Ds){mr(this,Rs);mr(this,ls,"");mr(this,us,!1);mr(this,ds,null);mr(this,xs,null);mr(this,fs,null);mr(this,gs,!1);mr(this,Es,null);mr(this,js,this.focusin.bind(this));mr(this,ps,this.focusout.bind(this));mr(this,ms,!1);mr(this,hs,!1);mr(this,vs,!1);eo(this,"_initialOptions",Object.create(null));eo(this,"_uiManager",null);eo(this,"_focusEventsAllowed",!0);eo(this,"_l10nPromise",null);mr(this,ws,!1);mr(this,ys,Vs._zIndex++);this.constructor===Vs&&(0,rs.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Ds.parent,this.id=Ds.id,this.width=this.height=null,this.pageIndex=Ds.parent.pageIndex,this.name=Ds.name,this.div=null,this._uiManager=Ds.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=Ds.isCentered,this._structTreeParentId=null;const{rotation:$s,rawDims:{pageWidth:Xs,pageHeight:Fs,pageX:As,pageY:_s}}=this.parent.viewport;this.rotation=$s,this.pageRotation=(360+$s-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Xs,Fs],this.pageTranslation=[As,_s];const[Ps,Hs]=this.parentDimensions;this.x=Ds.x/Ps,this.y=Ds.y/Hs,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,rs.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(Ds){const $s=new cs({id:Ds.parent.getNextId(),parent:Ds.parent,uiManager:Ds._uiManager});$s.annotationElementId=Ds.annotationElementId,$s.deleted=!0,$s._uiManager.addToAnnotationStorage($s)}static initialize(Ds,$s=null){if(Vs._l10nPromise||(Vs._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(Fs=>[Fs,Ds.get(Fs)]))),$s!=null&&$s.strings)for(const Fs of $s.strings)Vs._l10nPromise.set(Fs,Ds.get(Fs));if(Vs._borderLineWidth!==-1)return;const Xs=getComputedStyle(document.documentElement);Vs._borderLineWidth=parseFloat(Xs.getPropertyValue("--outline-width"))||0}static updateDefaultParams(Ds,$s){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(Ds){return!1}static paste(Ds,$s){(0,rs.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return ks(this,ws)}set _isDraggable(Ds){var $s;fr(this,ws,Ds),($s=this.div)==null||$s.classList.toggle("draggable",Ds)}center(){const[Ds,$s]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*$s/(Ds*2),this.y+=this.width*Ds/($s*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*$s/(Ds*2),this.y-=this.width*Ds/($s*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(Ds){this._uiManager.addCommands(Ds)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=ks(this,ys)}setParent(Ds){Ds!==null&&(this.pageIndex=Ds.pageIndex,this.pageDimensions=Ds.pageDimensions),this.parent=Ds}focusin(Ds){this._focusEventsAllowed&&(ks(this,ms)?fr(this,ms,!1):this.parent.setSelected(this))}focusout(Ds){var Xs;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const $s=Ds.relatedTarget;$s!=null&&$s.closest(`#${this.id}`)||(Ds.preventDefault(),(Xs=this.parent)!=null&&Xs.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(Ds,$s,Xs,Fs){const[As,_s]=this.parentDimensions;[Xs,Fs]=this.screenToPageTranslation(Xs,Fs),this.x=(Ds+Xs)/As,this.y=($s+Fs)/_s,this.fixAndSetPosition()}translate(Ds,$s){ar(this,Rs,Ho).call(this,this.parentDimensions,Ds,$s)}translateInPage(Ds,$s){ar(this,Rs,Ho).call(this,this.pageDimensions,Ds,$s),this.div.scrollIntoView({block:"nearest"})}drag(Ds,$s){const[Xs,Fs]=this.parentDimensions;if(this.x+=Ds/Xs,this.y+=$s/Fs,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:Ls,y:Os}=this.div.getBoundingClientRect();this.parent.findNewParent(this,Ls,Os)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:As,y:_s}=this;const[Ps,Hs]=ar(this,Rs,Wo).call(this);As+=Ps,_s+=Hs,this.div.style.left=`${(100*As).toFixed(2)}%`,this.div.style.top=`${(100*_s).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[Ds,$s]=this.pageDimensions;let{x:Xs,y:Fs,width:As,height:_s}=this;switch(As*=Ds,_s*=$s,Xs*=Ds,Fs*=$s,this.rotation){case 0:Xs=Math.max(0,Math.min(Ds-As,Xs)),Fs=Math.max(0,Math.min($s-_s,Fs));break;case 90:Xs=Math.max(0,Math.min(Ds-_s,Xs)),Fs=Math.min($s,Math.max(As,Fs));break;case 180:Xs=Math.min(Ds,Math.max(As,Xs)),Fs=Math.min($s,Math.max(_s,Fs));break;case 270:Xs=Math.min(Ds,Math.max(_s,Xs)),Fs=Math.max(0,Math.min($s-As,Fs));break}this.x=Xs/=Ds,this.y=Fs/=$s;const[Ps,Hs]=ar(this,Rs,Wo).call(this);Xs+=Ps,Fs+=Hs;const{style:Ls}=this.div;Ls.left=`${(100*Xs).toFixed(2)}%`,Ls.top=`${(100*Fs).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(Ds,$s){var Xs;return ar(Xs=Vs,Ss,Uo).call(Xs,Ds,$s,this.parentRotation)}pageTranslationToScreen(Ds,$s){var Xs;return ar(Xs=Vs,Ss,Uo).call(Xs,Ds,$s,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:Ds,pageDimensions:[$s,Xs]}=this,Fs=$s*Ds,As=Xs*Ds;return rs.FeatureTest.isCSSRoundSupported?[Math.round(Fs),Math.round(As)]:[Fs,As]}setDims(Ds,$s){var As;const[Xs,Fs]=this.parentDimensions;this.div.style.width=`${(100*Ds/Xs).toFixed(2)}%`,ks(this,gs)||(this.div.style.height=`${(100*$s/Fs).toFixed(2)}%`),(As=ks(this,ds))==null||As.classList.toggle("small",Ds<Vs.SMALL_EDITOR_SIZE||$s<Vs.SMALL_EDITOR_SIZE)}fixDims(){const{style:Ds}=this.div,{height:$s,width:Xs}=Ds,Fs=Xs.endsWith("%"),As=!ks(this,gs)&&$s.endsWith("%");if(Fs&&As)return;const[_s,Ps]=this.parentDimensions;Fs||(Ds.width=`${(100*parseFloat(Xs)/_s).toFixed(2)}%`),!ks(this,gs)&&!As&&(Ds.height=`${(100*parseFloat($s)/Ps).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(ks(this,ds))return;const Ds=fr(this,ds,document.createElement("button"));Ds.className="altText";const $s=await Vs._l10nPromise.get("editor_alt_text_button_label");Ds.textContent=$s,Ds.setAttribute("aria-label",$s),Ds.tabIndex="0",Ds.addEventListener("contextmenu",os.noContextMenu),Ds.addEventListener("pointerdown",Xs=>Xs.stopPropagation()),Ds.addEventListener("click",Xs=>{Xs.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),Ds.addEventListener("keydown",Xs=>{Xs.target===Ds&&Xs.key==="Enter"&&(Xs.preventDefault(),this._uiManager.editAltText(this))}),ar(this,Rs,Vo).call(this),this.div.append(Ds),Vs.SMALL_EDITOR_SIZE||(Vs.SMALL_EDITOR_SIZE=Math.min(128,Math.round(Ds.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:ks(this,ls),decorative:ks(this,us)}}set altTextData({altText:Ds,decorative:$s}){ks(this,ls)===Ds&&ks(this,us)===$s||(fr(this,ls,Ds),fr(this,us,$s),ar(this,Rs,Vo).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",ks(this,js)),this.div.addEventListener("focusout",ks(this,ps));const[Ds,$s]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*$s/Ds).toFixed(2)}%`,this.div.style.maxHeight=`${(100*Ds/$s).toFixed(2)}%`);const[Xs,Fs]=this.getInitialTranslation();return this.translate(Xs,Fs),(0,ns.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(Ds){const{isMac:$s}=rs.FeatureTest.platform;if(Ds.button!==0||Ds.ctrlKey&&$s){Ds.preventDefault();return}fr(this,ms,!0),ar(this,Rs,Hl).call(this,Ds)}moveInDOM(){var Ds;(Ds=this.parent)==null||Ds.moveEditorInDOM(this)}_setParentAndPosition(Ds,$s,Xs){Ds.changeParent(this),this.x=$s,this.y=Xs,this.fixAndSetPosition()}getRect(Ds,$s){const Xs=this.parentScale,[Fs,As]=this.pageDimensions,[_s,Ps]=this.pageTranslation,Hs=Ds/Xs,Ls=$s/Xs,Os=this.x*Fs,Ws=this.y*As,Gs=this.width*Fs,lr=this.height*As;switch(this.rotation){case 0:return[Os+Hs+_s,As-Ws-Ls-lr+Ps,Os+Hs+Gs+_s,As-Ws-Ls+Ps];case 90:return[Os+Ls+_s,As-Ws+Hs+Ps,Os+Ls+lr+_s,As-Ws+Hs+Gs+Ps];case 180:return[Os-Hs-Gs+_s,As-Ws+Ls+Ps,Os-Hs+_s,As-Ws+Ls+lr+Ps];case 270:return[Os-Ls-lr+_s,As-Ws-Hs-Gs+Ps,Os-Ls+_s,As-Ws-Hs+Ps];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Ds,$s){const[Xs,Fs,As,_s]=Ds,Ps=As-Xs,Hs=_s-Fs;switch(this.rotation){case 0:return[Xs,$s-_s,Ps,Hs];case 90:return[Xs,$s-Fs,Hs,Ps];case 180:return[As,$s-Fs,Ps,Hs];case 270:return[As,$s-_s,Hs,Ps];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){fr(this,vs,!0)}disableEditMode(){fr(this,vs,!1)}isInEditMode(){return ks(this,vs)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var Ds,$s;(Ds=this.div)==null||Ds.addEventListener("focusin",ks(this,js)),($s=this.div)==null||$s.addEventListener("focusout",ks(this,ps))}serialize(Ds=!1,$s=null){(0,rs.unreachable)("An editor must be serializable")}static deserialize(Ds,$s,Xs){const Fs=new this.prototype.constructor({parent:$s,id:$s.getNextId(),uiManager:Xs});Fs.rotation=Ds.rotation;const[As,_s]=Fs.pageDimensions,[Ps,Hs,Ls,Os]=Fs.getRectInCurrentCoords(Ds.rect,_s);return Fs.x=Ps/As,Fs.y=Hs/_s,Fs.width=Ls/As,Fs.height=Os/_s,Fs}remove(){var Ds;this.div.removeEventListener("focusin",ks(this,js)),this.div.removeEventListener("focusout",ks(this,ps)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(Ds=ks(this,ds))==null||Ds.remove(),fr(this,ds,null),fr(this,xs,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(ar(this,Rs,Fl).call(this),ks(this,Es).classList.remove("hidden"))}select(){var Ds;this.makeResizable(),(Ds=this.div)==null||Ds.classList.add("selectedEditor")}unselect(){var Ds,$s,Xs;(Ds=ks(this,Es))==null||Ds.classList.add("hidden"),($s=this.div)==null||$s.classList.remove("selectedEditor"),(Xs=this.div)!=null&&Xs.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(Ds,$s){}disableEditing(){ks(this,ds)&&(ks(this,ds).hidden=!0)}enableEditing(){ks(this,ds)&&(ks(this,ds).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return ks(this,hs)}set isEditing(Ds){fr(this,hs,Ds),this.parent&&(Ds?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(Ds,$s){fr(this,gs,!0);const Xs=Ds/$s,{style:Fs}=this.div;Fs.aspectRatio=Xs,Fs.height="auto"}static get MIN_SIZE(){return 16}};ls=new WeakMap,us=new WeakMap,ds=new WeakMap,xs=new WeakMap,fs=new WeakMap,gs=new WeakMap,Es=new WeakMap,js=new WeakMap,ps=new WeakMap,ms=new WeakMap,hs=new WeakMap,vs=new WeakMap,ws=new WeakMap,ys=new WeakMap,Rs=new WeakSet,Ho=function([Ds,$s],Xs,Fs){[Xs,Fs]=this.screenToPageTranslation(Xs,Fs),this.x+=Xs/Ds,this.y+=Fs/$s,this.fixAndSetPosition()},Wo=function(){const[Ds,$s]=this.parentDimensions,{_borderLineWidth:Xs}=Vs,Fs=Xs/Ds,As=Xs/$s;switch(this.rotation){case 90:return[-Fs,As];case 180:return[Fs,As];case 270:return[Fs,-As];default:return[-Fs,-As]}},Ss=new WeakSet,Uo=function(Ds,$s,Xs){switch(Xs){case 90:return[$s,-Ds];case 180:return[-Ds,-$s];case 270:return[-$s,Ds];default:return[Ds,$s]}},zo=function(Ds){switch(Ds){case 90:{const[$s,Xs]=this.pageDimensions;return[0,-$s/Xs,Xs/$s,0]}case 180:return[-1,0,0,-1];case 270:{const[$s,Xs]=this.pageDimensions;return[0,$s/Xs,-Xs/$s,0]}default:return[1,0,0,1]}},Fl=function(){if(ks(this,Es))return;fr(this,Es,document.createElement("div")),ks(this,Es).classList.add("resizers");const Ds=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||Ds.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const $s of Ds){const Xs=document.createElement("div");ks(this,Es).append(Xs),Xs.classList.add("resizer",$s),Xs.addEventListener("pointerdown",ar(this,Rs,$l).bind(this,$s)),Xs.addEventListener("contextmenu",os.noContextMenu)}this.div.prepend(ks(this,Es))},$l=function(Ds,$s){$s.preventDefault();const{isMac:Xs}=rs.FeatureTest.platform;if($s.button!==0||$s.ctrlKey&&Xs)return;const Fs=ar(this,Rs,Bl).bind(this,Ds),As=this._isDraggable;this._isDraggable=!1;const _s={passive:!0,capture:!0};window.addEventListener("pointermove",Fs,_s);const Ps=this.x,Hs=this.y,Ls=this.width,Os=this.height,Ws=this.parent.div.style.cursor,Gs=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle($s.target).cursor;const lr=()=>{this._isDraggable=As,window.removeEventListener("pointerup",lr),window.removeEventListener("blur",lr),window.removeEventListener("pointermove",Fs,_s),this.parent.div.style.cursor=Ws,this.div.style.cursor=Gs;const jr=this.x,br=this.y,Nr=this.width,wr=this.height;jr===Ps&&br===Hs&&Nr===Ls&&wr===Os||this.addCommands({cmd:()=>{this.width=Nr,this.height=wr,this.x=jr,this.y=br;const[dr,hr]=this.parentDimensions;this.setDims(dr*Nr,hr*wr),this.fixAndSetPosition()},undo:()=>{this.width=Ls,this.height=Os,this.x=Ps,this.y=Hs;const[dr,hr]=this.parentDimensions;this.setDims(dr*Ls,hr*Os),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",lr),window.addEventListener("blur",lr)},Bl=function(Ds,$s){const[Xs,Fs]=this.parentDimensions,As=this.x,_s=this.y,Ps=this.width,Hs=this.height,Ls=Vs.MIN_SIZE/Xs,Os=Vs.MIN_SIZE/Fs,Ws=Or=>Math.round(Or*1e4)/1e4,Gs=ar(this,Rs,zo).call(this,this.rotation),lr=(Or,zr)=>[Gs[0]*Or+Gs[2]*zr,Gs[1]*Or+Gs[3]*zr],jr=ar(this,Rs,zo).call(this,360-this.rotation),br=(Or,zr)=>[jr[0]*Or+jr[2]*zr,jr[1]*Or+jr[3]*zr];let Nr,wr,dr=!1,hr=!1;switch(Ds){case"topLeft":dr=!0,Nr=(Or,zr)=>[0,0],wr=(Or,zr)=>[Or,zr];break;case"topMiddle":Nr=(Or,zr)=>[Or/2,0],wr=(Or,zr)=>[Or/2,zr];break;case"topRight":dr=!0,Nr=(Or,zr)=>[Or,0],wr=(Or,zr)=>[0,zr];break;case"middleRight":hr=!0,Nr=(Or,zr)=>[Or,zr/2],wr=(Or,zr)=>[0,zr/2];break;case"bottomRight":dr=!0,Nr=(Or,zr)=>[Or,zr],wr=(Or,zr)=>[0,0];break;case"bottomMiddle":Nr=(Or,zr)=>[Or/2,zr],wr=(Or,zr)=>[Or/2,0];break;case"bottomLeft":dr=!0,Nr=(Or,zr)=>[0,zr],wr=(Or,zr)=>[Or,0];break;case"middleLeft":hr=!0,Nr=(Or,zr)=>[0,zr/2],wr=(Or,zr)=>[Or,zr/2];break}const Bs=Nr(Ps,Hs),qs=wr(Ps,Hs);let cr=lr(...qs);const xr=Ws(As+cr[0]),yr=Ws(_s+cr[1]);let Ar=1,Cr=1,[ur,Pr]=this.screenToPageTranslation($s.movementX,$s.movementY);if([ur,Pr]=br(ur/Xs,Pr/Fs),dr){const Or=Math.hypot(Ps,Hs);Ar=Cr=Math.max(Math.min(Math.hypot(qs[0]-Bs[0]-ur,qs[1]-Bs[1]-Pr)/Or,1/Ps,1/Hs),Ls/Ps,Os/Hs)}else hr?Ar=Math.max(Ls,Math.min(1,Math.abs(qs[0]-Bs[0]-ur)))/Ps:Cr=Math.max(Os,Math.min(1,Math.abs(qs[1]-Bs[1]-Pr)))/Hs;const Tr=Ws(Ps*Ar),Xr=Ws(Hs*Cr);cr=lr(...wr(Tr,Xr));const Vr=xr-cr[0],Qr=yr-cr[1];this.width=Tr,this.height=Xr,this.x=Vr,this.y=Qr,this.setDims(Xs*Tr,Fs*Xr),this.fixAndSetPosition()},Vo=async function(){var Xs;const Ds=ks(this,ds);if(!Ds)return;if(!ks(this,ls)&&!ks(this,us)){Ds.classList.remove("done"),(Xs=ks(this,xs))==null||Xs.remove();return}Vs._l10nPromise.get("editor_alt_text_edit_button_label").then(Fs=>{Ds.setAttribute("aria-label",Fs)});let $s=ks(this,xs);if(!$s){fr(this,xs,$s=document.createElement("span")),$s.className="tooltip",$s.setAttribute("role","tooltip");const Fs=$s.id=`alt-text-tooltip-${this.id}`;Ds.setAttribute("aria-describedby",Fs);const As=100;Ds.addEventListener("mouseenter",()=>{fr(this,fs,setTimeout(()=>{fr(this,fs,null),ks(this,xs).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},As))}),Ds.addEventListener("mouseleave",()=>{var _s;clearTimeout(ks(this,fs)),fr(this,fs,null),(_s=ks(this,xs))==null||_s.classList.remove("show")})}Ds.classList.add("done"),$s.innerText=ks(this,us)?await Vs._l10nPromise.get("editor_alt_text_decorative_tooltip"):ks(this,ls),$s.parentNode||Ds.append($s)},Hl=function(Ds){if(!this._isDraggable)return;const $s=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Xs,Fs;$s&&(Xs={passive:!0,capture:!0},Fs=_s=>{const[Ps,Hs]=this.screenToPageTranslation(_s.movementX,_s.movementY);this._uiManager.dragSelectedEditors(Ps,Hs)},window.addEventListener("pointermove",Fs,Xs));const As=()=>{if(window.removeEventListener("pointerup",As),window.removeEventListener("blur",As),$s&&window.removeEventListener("pointermove",Fs,Xs),fr(this,ms,!1),!this._uiManager.endDragSession()){const{isMac:_s}=rs.FeatureTest.platform;Ds.ctrlKey&&!_s||Ds.shiftKey||Ds.metaKey&&_s?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",As),window.addEventListener("blur",As)},mr(Vs,Ss),eo(Vs,"_borderLineWidth",-1),eo(Vs,"_colorManager",new ns.ColorManager),eo(Vs,"_zIndex",1),eo(Vs,"SMALL_EDITOR_SIZE",0);let as=Vs;ts.AnnotationEditor=as;class cs extends as{constructor(Ds){super(Ds),this.annotationElementId=Ds.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(es,ts,ss)=>{var gs,Es,js,ps,ms,Go,ws,ys,Rs,bs,Ns,Wl,Cs,Ms,Is,Qs,Ys,Zs,Vs,Ks,Ds,$s,Xs,Fs,As,_s,Ps,Hs,Ls,Os,Ws,Gs,lr,jr,br,Nr,wr,dr,hr,Bs,qs,cr,xr,yr,Ar,Cr,ur,Ul,Xo,Yo,ko,Ko,qo,io,jo,zl,Vl,Jo,Eo,Qo;Object.defineProperty(ts,"__esModule",{value:!0}),ts.KeyboardManager=ts.CommandManager=ts.ColorManager=ts.AnnotationEditorUIManager=void 0,ts.bindEvents=os,ts.opacityToHex=as;var ns=ss(1),rs=ss(6);function os(qr,Js,Rr){for(const Mr of Rr)Js.addEventListener(Mr,qr[Mr].bind(qr))}function as(qr){return Math.round(Math.min(255,Math.max(1,255*qr))).toString(16).padStart(2,"0")}class cs{constructor(){mr(this,gs,0)}getId(){return`${ns.AnnotationEditorPrefix}${go(this,gs)._++}`}}gs=new WeakMap;const vs=class vs{constructor(){mr(this,ms);mr(this,Es,(0,ns.getUuid)());mr(this,js,0);mr(this,ps,null)}static get _isSVGFittingCanvas(){const Js='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Mr=new OffscreenCanvas(1,3).getContext("2d"),Br=new Image;Br.src=Js;const Ur=Br.decode().then(()=>(Mr.drawImage(Br,0,0,1,1,0,0,1,3),new Uint32Array(Mr.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,ns.shadow)(this,"_isSVGFittingCanvas",Ur)}async getFromFile(Js){const{lastModified:Rr,name:Mr,size:Br,type:Ur}=Js;return ar(this,ms,Go).call(this,`${Rr}_${Mr}_${Br}_${Ur}`,Js)}async getFromUrl(Js){return ar(this,ms,Go).call(this,Js,Js)}async getFromId(Js){ks(this,ps)||fr(this,ps,new Map);const Rr=ks(this,ps).get(Js);return Rr?Rr.bitmap?(Rr.refCounter+=1,Rr):Rr.file?this.getFromFile(Rr.file):this.getFromUrl(Rr.url):null}getSvgUrl(Js){const Rr=ks(this,ps).get(Js);return Rr!=null&&Rr.isSvg?Rr.svgUrl:null}deleteId(Js){ks(this,ps)||fr(this,ps,new Map);const Rr=ks(this,ps).get(Js);Rr&&(Rr.refCounter-=1,Rr.refCounter===0&&(Rr.bitmap=null))}isValidId(Js){return Js.startsWith(`image_${ks(this,Es)}_`)}};Es=new WeakMap,js=new WeakMap,ps=new WeakMap,ms=new WeakSet,Go=async function(Js,Rr){ks(this,ps)||fr(this,ps,new Map);let Mr=ks(this,ps).get(Js);if(Mr===null)return null;if(Mr!=null&&Mr.bitmap)return Mr.refCounter+=1,Mr;try{Mr||(Mr={bitmap:null,id:`image_${ks(this,Es)}_${go(this,js)._++}`,refCounter:0,isSvg:!1});let Br;if(typeof Rr=="string"){Mr.url=Rr;const Ur=await fetch(Rr);if(!Ur.ok)throw new Error(Ur.statusText);Br=await Ur.blob()}else Br=Mr.file=Rr;if(Br.type==="image/svg+xml"){const Ur=vs._isSVGFittingCanvas,Dr=new FileReader,zs=new Image,Us=new Promise((or,Er)=>{zs.onload=()=>{Mr.bitmap=zs,Mr.isSvg=!0,or()},Dr.onload=async()=>{const vr=Mr.svgUrl=Dr.result;zs.src=await Ur?`${vr}#svgView(preserveAspectRatio(none))`:vr},zs.onerror=Dr.onerror=Er});Dr.readAsDataURL(Br),await Us}else Mr.bitmap=await createImageBitmap(Br);Mr.refCounter=1}catch(Br){console.error(Br),Mr=null}return ks(this,ps).set(Js,Mr),Mr&&ks(this,ps).set(Mr.id,Mr),Mr};let ls=vs;class us{constructor(Js=128){mr(this,ws,[]);mr(this,ys,!1);mr(this,Rs);mr(this,bs,-1);fr(this,Rs,Js)}add({cmd:Js,undo:Rr,mustExec:Mr,type:Br=NaN,overwriteIfSameType:Ur=!1,keepUndo:Dr=!1}){if(Mr&&Js(),ks(this,ys))return;const zs={cmd:Js,undo:Rr,type:Br};if(ks(this,bs)===-1){ks(this,ws).length>0&&(ks(this,ws).length=0),fr(this,bs,0),ks(this,ws).push(zs);return}if(Ur&&ks(this,ws)[ks(this,bs)].type===Br){Dr&&(zs.undo=ks(this,ws)[ks(this,bs)].undo),ks(this,ws)[ks(this,bs)]=zs;return}const Us=ks(this,bs)+1;Us===ks(this,Rs)?ks(this,ws).splice(0,1):(fr(this,bs,Us),Us<ks(this,ws).length&&ks(this,ws).splice(Us)),ks(this,ws).push(zs)}undo(){ks(this,bs)!==-1&&(fr(this,ys,!0),ks(this,ws)[ks(this,bs)].undo(),fr(this,ys,!1),fr(this,bs,ks(this,bs)-1))}redo(){ks(this,bs)<ks(this,ws).length-1&&(fr(this,bs,ks(this,bs)+1),fr(this,ys,!0),ks(this,ws)[ks(this,bs)].cmd(),fr(this,ys,!1))}hasSomethingToUndo(){return ks(this,bs)!==-1}hasSomethingToRedo(){return ks(this,bs)<ks(this,ws).length-1}destroy(){fr(this,ws,null)}}ws=new WeakMap,ys=new WeakMap,Rs=new WeakMap,bs=new WeakMap,ts.CommandManager=us;class ds{constructor(Js){mr(this,Ns);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Rr}=ns.FeatureTest.platform;for(const[Mr,Br,Ur={}]of Js)for(const Dr of Mr){const zs=Dr.startsWith("mac+");Rr&&zs?(this.callbacks.set(Dr.slice(4),{callback:Br,options:Ur}),this.allKeys.add(Dr.split("+").at(-1))):!Rr&&!zs&&(this.callbacks.set(Dr,{callback:Br,options:Ur}),this.allKeys.add(Dr.split("+").at(-1)))}}exec(Js,Rr){if(!this.allKeys.has(Rr.key))return;const Mr=this.callbacks.get(ar(this,Ns,Wl).call(this,Rr));if(!Mr)return;const{callback:Br,options:{bubbles:Ur=!1,args:Dr=[],checker:zs=null}}=Mr;zs&&!zs(Js,Rr)||(Br.bind(Js,...Dr)(),Ur||(Rr.stopPropagation(),Rr.preventDefault()))}}Ns=new WeakSet,Wl=function(Js){Js.altKey&&this.buffer.push("alt"),Js.ctrlKey&&this.buffer.push("ctrl"),Js.metaKey&&this.buffer.push("meta"),Js.shiftKey&&this.buffer.push("shift"),this.buffer.push(Js.key);const Rr=this.buffer.join("+");return this.buffer.length=0,Rr},ts.KeyboardManager=ds;const Ts=class Ts{get _colors(){const Js=new Map([["CanvasText",null],["Canvas",null]]);return(0,rs.getColorValues)(Js),(0,ns.shadow)(this,"_colors",Js)}convert(Js){const Rr=(0,rs.getRGB)(Js);if(!window.matchMedia("(forced-colors: active)").matches)return Rr;for(const[Mr,Br]of this._colors)if(Br.every((Ur,Dr)=>Ur===Rr[Dr]))return Ts._colorsMapping.get(Mr);return Rr}getHexCode(Js){const Rr=this._colors.get(Js);return Rr?ns.Util.makeHexColor(...Rr):Js}};eo(Ts,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let xs=Ts;ts.ColorManager=xs;const Jr=class Jr{constructor(Js,Rr,Mr,Br,Ur,Dr){mr(this,ur);mr(this,Cs,null);mr(this,Ms,new Map);mr(this,Is,new Map);mr(this,Qs,null);mr(this,Ys,null);mr(this,Zs,new us);mr(this,Vs,0);mr(this,Ks,new Set);mr(this,Ds,null);mr(this,$s,null);mr(this,Xs,new Set);mr(this,Fs,null);mr(this,As,new cs);mr(this,_s,!1);mr(this,Ps,!1);mr(this,Hs,null);mr(this,Ls,ns.AnnotationEditorType.NONE);mr(this,Os,new Set);mr(this,Ws,null);mr(this,Gs,this.blur.bind(this));mr(this,lr,this.focus.bind(this));mr(this,jr,this.copy.bind(this));mr(this,br,this.cut.bind(this));mr(this,Nr,this.paste.bind(this));mr(this,wr,this.keydown.bind(this));mr(this,dr,this.onEditingAction.bind(this));mr(this,hr,this.onPageChanging.bind(this));mr(this,Bs,this.onScaleChanging.bind(this));mr(this,qs,this.onRotationChanging.bind(this));mr(this,cr,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});mr(this,xr,[0,0]);mr(this,yr,null);mr(this,Ar,null);mr(this,Cr,null);fr(this,Ar,Js),fr(this,Cr,Rr),fr(this,Qs,Mr),this._eventBus=Br,this._eventBus._on("editingaction",ks(this,dr)),this._eventBus._on("pagechanging",ks(this,hr)),this._eventBus._on("scalechanging",ks(this,Bs)),this._eventBus._on("rotationchanging",ks(this,qs)),fr(this,Ys,Ur.annotationStorage),fr(this,Fs,Ur.filterFactory),fr(this,Ws,Dr),this.viewParameters={realScale:rs.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const Js=Jr.prototype,Rr=Ur=>{const{activeElement:Dr}=document;return Dr&&ks(Ur,Ar).contains(Dr)&&Ur.hasSomethingToControl()},Mr=this.TRANSLATE_SMALL,Br=this.TRANSLATE_BIG;return(0,ns.shadow)(this,"_keyboardManager",new ds([[["ctrl+a","mac+meta+a"],Js.selectAll],[["ctrl+z","mac+meta+z"],Js.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],Js.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],Js.delete],[["Escape","mac+Escape"],Js.unselectAll],[["ArrowLeft","mac+ArrowLeft"],Js.translateSelectedEditors,{args:[-Mr,0],checker:Rr}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Js.translateSelectedEditors,{args:[-Br,0],checker:Rr}],[["ArrowRight","mac+ArrowRight"],Js.translateSelectedEditors,{args:[Mr,0],checker:Rr}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Js.translateSelectedEditors,{args:[Br,0],checker:Rr}],[["ArrowUp","mac+ArrowUp"],Js.translateSelectedEditors,{args:[0,-Mr],checker:Rr}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Js.translateSelectedEditors,{args:[0,-Br],checker:Rr}],[["ArrowDown","mac+ArrowDown"],Js.translateSelectedEditors,{args:[0,Mr],checker:Rr}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Js.translateSelectedEditors,{args:[0,Br],checker:Rr}]]))}destroy(){ar(this,ur,ko).call(this),ar(this,ur,Xo).call(this),this._eventBus._off("editingaction",ks(this,dr)),this._eventBus._off("pagechanging",ks(this,hr)),this._eventBus._off("scalechanging",ks(this,Bs)),this._eventBus._off("rotationchanging",ks(this,qs));for(const Js of ks(this,Is).values())Js.destroy();ks(this,Is).clear(),ks(this,Ms).clear(),ks(this,Xs).clear(),fr(this,Cs,null),ks(this,Os).clear(),ks(this,Zs).destroy(),ks(this,Qs).destroy()}get hcmFilter(){return(0,ns.shadow)(this,"hcmFilter",ks(this,Ws)?ks(this,Fs).addHCMFilter(ks(this,Ws).foreground,ks(this,Ws).background):"none")}get direction(){return(0,ns.shadow)(this,"direction",getComputedStyle(ks(this,Ar)).direction)}editAltText(Js){var Rr;(Rr=ks(this,Qs))==null||Rr.editAltText(this,Js)}onPageChanging({pageNumber:Js}){fr(this,Vs,Js-1)}focusMainContainer(){ks(this,Ar).focus()}findParent(Js,Rr){for(const Mr of ks(this,Is).values()){const{x:Br,y:Ur,width:Dr,height:zs}=Mr.div.getBoundingClientRect();if(Js>=Br&&Js<=Br+Dr&&Rr>=Ur&&Rr<=Ur+zs)return Mr}return null}disableUserSelect(Js=!1){ks(this,Cr).classList.toggle("noUserSelect",Js)}addShouldRescale(Js){ks(this,Xs).add(Js)}removeShouldRescale(Js){ks(this,Xs).delete(Js)}onScaleChanging({scale:Js}){this.commitOrRemove(),this.viewParameters.realScale=Js*rs.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Rr of ks(this,Xs))Rr.onScaleChanging()}onRotationChanging({pagesRotation:Js}){this.commitOrRemove(),this.viewParameters.rotation=Js}addToAnnotationStorage(Js){!Js.isEmpty()&&ks(this,Ys)&&!ks(this,Ys).has(Js.id)&&ks(this,Ys).setValue(Js.id,Js)}blur(){if(!this.hasSelection)return;const{activeElement:Js}=document;for(const Rr of ks(this,Os))if(Rr.div.contains(Js)){fr(this,Hs,[Rr,Js]),Rr._focusEventsAllowed=!1;break}}focus(){if(!ks(this,Hs))return;const[Js,Rr]=ks(this,Hs);fr(this,Hs,null),Rr.addEventListener("focusin",()=>{Js._focusEventsAllowed=!0},{once:!0}),Rr.focus()}addEditListeners(){ar(this,ur,Yo).call(this),ar(this,ur,Ko).call(this)}removeEditListeners(){ar(this,ur,ko).call(this),ar(this,ur,qo).call(this)}copy(Js){var Mr;if(Js.preventDefault(),(Mr=ks(this,Cs))==null||Mr.commitOrRemove(),!this.hasSelection)return;const Rr=[];for(const Br of ks(this,Os)){const Ur=Br.serialize(!0);Ur&&Rr.push(Ur)}Rr.length!==0&&Js.clipboardData.setData("application/pdfjs",JSON.stringify(Rr))}cut(Js){this.copy(Js),this.delete()}paste(Js){Js.preventDefault();const{clipboardData:Rr}=Js;for(const Ur of Rr.items)for(const Dr of ks(this,$s))if(Dr.isHandlingMimeForPasting(Ur.type)){Dr.paste(Ur,this.currentLayer);return}let Mr=Rr.getData("application/pdfjs");if(!Mr)return;try{Mr=JSON.parse(Mr)}catch(Ur){(0,ns.warn)(`paste: "${Ur.message}".`);return}if(!Array.isArray(Mr))return;this.unselectAll();const Br=this.currentLayer;try{const Ur=[];for(const Us of Mr){const or=Br.deserialize(Us);if(!or)return;Ur.push(or)}const Dr=()=>{for(const Us of Ur)ar(this,ur,Jo).call(this,Us);ar(this,ur,Qo).call(this,Ur)},zs=()=>{for(const Us of Ur)Us.remove()};this.addCommands({cmd:Dr,undo:zs,mustExec:!0})}catch(Ur){(0,ns.warn)(`paste: "${Ur.message}".`)}}keydown(Js){var Rr;(Rr=this.getActive())!=null&&Rr.shouldGetKeyboardEvents()||Jr._keyboardManager.exec(this,Js)}onEditingAction(Js){["undo","redo","delete","selectAll"].includes(Js.name)&&this[Js.name]()}setEditingState(Js){Js?(ar(this,ur,Ul).call(this),ar(this,ur,Yo).call(this),ar(this,ur,Ko).call(this),ar(this,ur,io).call(this,{isEditing:ks(this,Ls)!==ns.AnnotationEditorType.NONE,isEmpty:ar(this,ur,Eo).call(this),hasSomethingToUndo:ks(this,Zs).hasSomethingToUndo(),hasSomethingToRedo:ks(this,Zs).hasSomethingToRedo(),hasSelectedEditor:!1})):(ar(this,ur,Xo).call(this),ar(this,ur,ko).call(this),ar(this,ur,qo).call(this),ar(this,ur,io).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(Js){if(!ks(this,$s)){fr(this,$s,Js);for(const Rr of ks(this,$s))ar(this,ur,jo).call(this,Rr.defaultPropertiesToUpdate)}}getId(){return ks(this,As).getId()}get currentLayer(){return ks(this,Is).get(ks(this,Vs))}getLayer(Js){return ks(this,Is).get(Js)}get currentPageIndex(){return ks(this,Vs)}addLayer(Js){ks(this,Is).set(Js.pageIndex,Js),ks(this,_s)?Js.enable():Js.disable()}removeLayer(Js){ks(this,Is).delete(Js.pageIndex)}updateMode(Js,Rr=null){if(ks(this,Ls)!==Js){if(fr(this,Ls,Js),Js===ns.AnnotationEditorType.NONE){this.setEditingState(!1),ar(this,ur,Vl).call(this);return}this.setEditingState(!0),ar(this,ur,zl).call(this),this.unselectAll();for(const Mr of ks(this,Is).values())Mr.updateMode(Js);if(Rr){for(const Mr of ks(this,Ms).values())if(Mr.annotationElementId===Rr){this.setSelected(Mr),Mr.enterInEditMode();break}}}}updateToolbar(Js){Js!==ks(this,Ls)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:Js})}updateParams(Js,Rr){if(ks(this,$s)){if(Js===ns.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(Js);return}for(const Mr of ks(this,Os))Mr.updateParams(Js,Rr);for(const Mr of ks(this,$s))Mr.updateDefaultParams(Js,Rr)}}enableWaiting(Js=!1){if(ks(this,Ps)!==Js){fr(this,Ps,Js);for(const Rr of ks(this,Is).values())Js?Rr.disableClick():Rr.enableClick(),Rr.div.classList.toggle("waiting",Js)}}getEditors(Js){const Rr=[];for(const Mr of ks(this,Ms).values())Mr.pageIndex===Js&&Rr.push(Mr);return Rr}getEditor(Js){return ks(this,Ms).get(Js)}addEditor(Js){ks(this,Ms).set(Js.id,Js)}removeEditor(Js){var Rr;ks(this,Ms).delete(Js.id),this.unselect(Js),(!Js.annotationElementId||!ks(this,Ks).has(Js.annotationElementId))&&((Rr=ks(this,Ys))==null||Rr.remove(Js.id))}addDeletedAnnotationElement(Js){ks(this,Ks).add(Js.annotationElementId),Js.deleted=!0}isDeletedAnnotationElement(Js){return ks(this,Ks).has(Js)}removeDeletedAnnotationElement(Js){ks(this,Ks).delete(Js.annotationElementId),Js.deleted=!1}setActiveEditor(Js){ks(this,Cs)!==Js&&(fr(this,Cs,Js),Js&&ar(this,ur,jo).call(this,Js.propertiesToUpdate))}toggleSelected(Js){if(ks(this,Os).has(Js)){ks(this,Os).delete(Js),Js.unselect(),ar(this,ur,io).call(this,{hasSelectedEditor:this.hasSelection});return}ks(this,Os).add(Js),Js.select(),ar(this,ur,jo).call(this,Js.propertiesToUpdate),ar(this,ur,io).call(this,{hasSelectedEditor:!0})}setSelected(Js){for(const Rr of ks(this,Os))Rr!==Js&&Rr.unselect();ks(this,Os).clear(),ks(this,Os).add(Js),Js.select(),ar(this,ur,jo).call(this,Js.propertiesToUpdate),ar(this,ur,io).call(this,{hasSelectedEditor:!0})}isSelected(Js){return ks(this,Os).has(Js)}unselect(Js){Js.unselect(),ks(this,Os).delete(Js),ar(this,ur,io).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return ks(this,Os).size!==0}undo(){ks(this,Zs).undo(),ar(this,ur,io).call(this,{hasSomethingToUndo:ks(this,Zs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ar(this,ur,Eo).call(this)})}redo(){ks(this,Zs).redo(),ar(this,ur,io).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:ks(this,Zs).hasSomethingToRedo(),isEmpty:ar(this,ur,Eo).call(this)})}addCommands(Js){ks(this,Zs).add(Js),ar(this,ur,io).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ar(this,ur,Eo).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const Js=[...ks(this,Os)],Rr=()=>{for(const Br of Js)Br.remove()},Mr=()=>{for(const Br of Js)ar(this,ur,Jo).call(this,Br)};this.addCommands({cmd:Rr,undo:Mr,mustExec:!0})}commitOrRemove(){var Js;(Js=ks(this,Cs))==null||Js.commitOrRemove()}hasSomethingToControl(){return ks(this,Cs)||this.hasSelection}selectAll(){for(const Js of ks(this,Os))Js.commit();ar(this,ur,Qo).call(this,ks(this,Ms).values())}unselectAll(){if(ks(this,Cs)){ks(this,Cs).commitOrRemove();return}if(this.hasSelection){for(const Js of ks(this,Os))Js.unselect();ks(this,Os).clear(),ar(this,ur,io).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(Js,Rr,Mr=!1){if(Mr||this.commitOrRemove(),!this.hasSelection)return;ks(this,xr)[0]+=Js,ks(this,xr)[1]+=Rr;const[Br,Ur]=ks(this,xr),Dr=[...ks(this,Os)],zs=1e3;ks(this,yr)&&clearTimeout(ks(this,yr)),fr(this,yr,setTimeout(()=>{fr(this,yr,null),ks(this,xr)[0]=ks(this,xr)[1]=0,this.addCommands({cmd:()=>{for(const Us of Dr)ks(this,Ms).has(Us.id)&&Us.translateInPage(Br,Ur)},undo:()=>{for(const Us of Dr)ks(this,Ms).has(Us.id)&&Us.translateInPage(-Br,-Ur)},mustExec:!1})},zs));for(const Us of Dr)Us.translateInPage(Js,Rr)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),fr(this,Ds,new Map);for(const Js of ks(this,Os))ks(this,Ds).set(Js,{savedX:Js.x,savedY:Js.y,savedPageIndex:Js.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!ks(this,Ds))return!1;this.disableUserSelect(!1);const Js=ks(this,Ds);fr(this,Ds,null);let Rr=!1;for(const[{x:Br,y:Ur,pageIndex:Dr},zs]of Js)zs.newX=Br,zs.newY=Ur,zs.newPageIndex=Dr,Rr||(Rr=Br!==zs.savedX||Ur!==zs.savedY||Dr!==zs.savedPageIndex);if(!Rr)return!1;const Mr=(Br,Ur,Dr,zs)=>{if(ks(this,Ms).has(Br.id)){const Us=ks(this,Is).get(zs);Us?Br._setParentAndPosition(Us,Ur,Dr):(Br.pageIndex=zs,Br.x=Ur,Br.y=Dr)}};return this.addCommands({cmd:()=>{for(const[Br,{newX:Ur,newY:Dr,newPageIndex:zs}]of Js)Mr(Br,Ur,Dr,zs)},undo:()=>{for(const[Br,{savedX:Ur,savedY:Dr,savedPageIndex:zs}]of Js)Mr(Br,Ur,Dr,zs)},mustExec:!0}),!0}dragSelectedEditors(Js,Rr){if(ks(this,Ds))for(const Mr of ks(this,Ds).keys())Mr.drag(Js,Rr)}rebuild(Js){if(Js.parent===null){const Rr=this.getLayer(Js.pageIndex);Rr?(Rr.changeParent(Js),Rr.addOrRebuild(Js)):(this.addEditor(Js),this.addToAnnotationStorage(Js),Js.rebuild())}else Js.parent.addOrRebuild(Js)}isActive(Js){return ks(this,Cs)===Js}getActive(){return ks(this,Cs)}getMode(){return ks(this,Ls)}get imageManager(){return(0,ns.shadow)(this,"imageManager",new ls)}};Cs=new WeakMap,Ms=new WeakMap,Is=new WeakMap,Qs=new WeakMap,Ys=new WeakMap,Zs=new WeakMap,Vs=new WeakMap,Ks=new WeakMap,Ds=new WeakMap,$s=new WeakMap,Xs=new WeakMap,Fs=new WeakMap,As=new WeakMap,_s=new WeakMap,Ps=new WeakMap,Hs=new WeakMap,Ls=new WeakMap,Os=new WeakMap,Ws=new WeakMap,Gs=new WeakMap,lr=new WeakMap,jr=new WeakMap,br=new WeakMap,Nr=new WeakMap,wr=new WeakMap,dr=new WeakMap,hr=new WeakMap,Bs=new WeakMap,qs=new WeakMap,cr=new WeakMap,xr=new WeakMap,yr=new WeakMap,Ar=new WeakMap,Cr=new WeakMap,ur=new WeakSet,Ul=function(){window.addEventListener("focus",ks(this,lr)),window.addEventListener("blur",ks(this,Gs))},Xo=function(){window.removeEventListener("focus",ks(this,lr)),window.removeEventListener("blur",ks(this,Gs))},Yo=function(){window.addEventListener("keydown",ks(this,wr),{capture:!0})},ko=function(){window.removeEventListener("keydown",ks(this,wr),{capture:!0})},Ko=function(){document.addEventListener("copy",ks(this,jr)),document.addEventListener("cut",ks(this,br)),document.addEventListener("paste",ks(this,Nr))},qo=function(){document.removeEventListener("copy",ks(this,jr)),document.removeEventListener("cut",ks(this,br)),document.removeEventListener("paste",ks(this,Nr))},io=function(Js){Object.entries(Js).some(([Mr,Br])=>ks(this,cr)[Mr]!==Br)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(ks(this,cr),Js)})},jo=function(Js){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:Js})},zl=function(){if(!ks(this,_s)){fr(this,_s,!0);for(const Js of ks(this,Is).values())Js.enable()}},Vl=function(){if(this.unselectAll(),ks(this,_s)){fr(this,_s,!1);for(const Js of ks(this,Is).values())Js.disable()}},Jo=function(Js){const Rr=ks(this,Is).get(Js.pageIndex);Rr?Rr.addOrRebuild(Js):this.addEditor(Js)},Eo=function(){if(ks(this,Ms).size===0)return!0;if(ks(this,Ms).size===1)for(const Js of ks(this,Ms).values())return Js.isEmpty();return!1},Qo=function(Js){ks(this,Os).clear();for(const Rr of Js)Rr.isEmpty()||(ks(this,Os).add(Rr),Rr.select());ar(this,ur,io).call(this,{hasSelectedEditor:!0})},eo(Jr,"TRANSLATE_SMALL",1),eo(Jr,"TRANSLATE_BIG",10);let fs=Jr;ts.AnnotationEditorUIManager=fs},(es,ts,ss)=>{var Vs,Ks,Ds,$s,Xs,Fs,As,_s,Ps,Hs,Ls,Os,xo,mo,Zo,Co,Ao,vo,yo;Object.defineProperty(ts,"__esModule",{value:!0}),ts.StatTimer=ts.RenderingCancelledException=ts.PixelsPerInch=ts.PageViewport=ts.PDFDateString=ts.DOMStandardFontDataFactory=ts.DOMSVGFactory=ts.DOMFilterFactory=ts.DOMCanvasFactory=ts.DOMCMapReaderFactory=void 0,ts.deprecated=bs,ts.getColorValues=Ms,ts.getCurrentTransform=Is,ts.getCurrentTransformInverse=Qs,ts.getFilenameFromUrl=ms,ts.getPdfFilenameFromUrl=hs,ts.getRGB=Cs,ts.getXfaPageViewport=Ts,ts.isDataScheme=js,ts.isPdfFile=ps,ts.isValidFetchUrl=ws,ts.loadScript=Rs,ts.noContextMenu=ys,ts.setLayerDimensions=Ys;var ns=ss(7),rs=ss(1);const os="http://www.w3.org/2000/svg",Zs=class Zs{};eo(Zs,"CSS",96),eo(Zs,"PDF",72),eo(Zs,"PDF_TO_CSS_UNITS",Zs.CSS/Zs.PDF);let as=Zs;ts.PixelsPerInch=as;class cs extends ns.BaseFilterFactory{constructor({docId:Bs,ownerDocument:qs=globalThis.document}={}){super();mr(this,Os);mr(this,Vs);mr(this,Ks);mr(this,Ds);mr(this,$s);mr(this,Xs);mr(this,Fs);mr(this,As);mr(this,_s);mr(this,Ps);mr(this,Hs);mr(this,Ls,0);fr(this,Ds,Bs),fr(this,$s,qs)}addFilter(Bs){if(!Bs)return"none";let qs=ks(this,Os,xo).get(Bs);if(qs)return qs;let cr,xr,yr,Ar;if(Bs.length===1){const Tr=Bs[0],Xr=new Array(256);for(let Vr=0;Vr<256;Vr++)Xr[Vr]=Tr[Vr]/255;Ar=cr=xr=yr=Xr.join(",")}else{const[Tr,Xr,Vr]=Bs,Qr=new Array(256),Or=new Array(256),zr=new Array(256);for(let Zr=0;Zr<256;Zr++)Qr[Zr]=Tr[Zr]/255,Or[Zr]=Xr[Zr]/255,zr[Zr]=Vr[Zr]/255;cr=Qr.join(","),xr=Or.join(","),yr=zr.join(","),Ar=`${cr}${xr}${yr}`}if(qs=ks(this,Os,xo).get(Ar),qs)return ks(this,Os,xo).set(Bs,qs),qs;const Cr=`g_${ks(this,Ds)}_transfer_map_${go(this,Ls)._++}`,ur=`url(#${Cr})`;ks(this,Os,xo).set(Bs,ur),ks(this,Os,xo).set(Ar,ur);const Pr=ar(this,Os,Co).call(this,Cr);return ar(this,Os,vo).call(this,cr,xr,yr,Pr),ur}addHCMFilter(Bs,qs){var Xr;const cr=`${Bs}-${qs}`;if(ks(this,Fs)===cr)return ks(this,As);if(fr(this,Fs,cr),fr(this,As,"none"),(Xr=ks(this,Xs))==null||Xr.remove(),!Bs||!qs)return ks(this,As);const xr=ar(this,Os,yo).call(this,Bs);Bs=rs.Util.makeHexColor(...xr);const yr=ar(this,Os,yo).call(this,qs);if(qs=rs.Util.makeHexColor(...yr),ks(this,Os,mo).style.color="",Bs==="#000000"&&qs==="#ffffff"||Bs===qs)return ks(this,As);const Ar=new Array(256);for(let Vr=0;Vr<=255;Vr++){const Qr=Vr/255;Ar[Vr]=Qr<=.03928?Qr/12.92:((Qr+.055)/1.055)**2.4}const Cr=Ar.join(","),ur=`g_${ks(this,Ds)}_hcm_filter`,Pr=fr(this,_s,ar(this,Os,Co).call(this,ur));ar(this,Os,vo).call(this,Cr,Cr,Cr,Pr),ar(this,Os,Zo).call(this,Pr);const Tr=(Vr,Qr)=>{const Or=xr[Vr]/255,zr=yr[Vr]/255,Zr=new Array(Qr+1);for(let to=0;to<=Qr;to++)Zr[to]=Or+to/Qr*(zr-Or);return Zr.join(",")};return ar(this,Os,vo).call(this,Tr(0,5),Tr(1,5),Tr(2,5),Pr),fr(this,As,`url(#${ur})`),ks(this,As)}addHighlightHCMFilter(Bs,qs,cr,xr){var zr;const yr=`${Bs}-${qs}-${cr}-${xr}`;if(ks(this,Ps)===yr)return ks(this,Hs);if(fr(this,Ps,yr),fr(this,Hs,"none"),(zr=ks(this,_s))==null||zr.remove(),!Bs||!qs)return ks(this,Hs);const[Ar,Cr]=[Bs,qs].map(ar(this,Os,yo).bind(this));let ur=Math.round(.2126*Ar[0]+.7152*Ar[1]+.0722*Ar[2]),Pr=Math.round(.2126*Cr[0]+.7152*Cr[1]+.0722*Cr[2]),[Tr,Xr]=[cr,xr].map(ar(this,Os,yo).bind(this));Pr<ur&&([ur,Pr,Tr,Xr]=[Pr,ur,Xr,Tr]),ks(this,Os,mo).style.color="";const Vr=(Zr,to,kr)=>{const pr=new Array(256),gr=(Pr-ur)/kr,Ir=Zr/255,Jr=(to-Zr)/(255*kr);let qr=0;for(let Js=0;Js<=kr;Js++){const Rr=Math.round(ur+Js*gr),Mr=Ir+Js*Jr;for(let Br=qr;Br<=Rr;Br++)pr[Br]=Mr;qr=Rr+1}for(let Js=qr;Js<256;Js++)pr[Js]=pr[qr-1];return pr.join(",")},Qr=`g_${ks(this,Ds)}_hcm_highlight_filter`,Or=fr(this,_s,ar(this,Os,Co).call(this,Qr));return ar(this,Os,Zo).call(this,Or),ar(this,Os,vo).call(this,Vr(Tr[0],Xr[0],5),Vr(Tr[1],Xr[1],5),Vr(Tr[2],Xr[2],5),Or),fr(this,Hs,`url(#${Qr})`),ks(this,Hs)}destroy(Bs=!1){Bs&&(ks(this,As)||ks(this,Hs))||(ks(this,Ks)&&(ks(this,Ks).parentNode.parentNode.remove(),fr(this,Ks,null)),ks(this,Vs)&&(ks(this,Vs).clear(),fr(this,Vs,null)),fr(this,Ls,0))}}Vs=new WeakMap,Ks=new WeakMap,Ds=new WeakMap,$s=new WeakMap,Xs=new WeakMap,Fs=new WeakMap,As=new WeakMap,_s=new WeakMap,Ps=new WeakMap,Hs=new WeakMap,Ls=new WeakMap,Os=new WeakSet,xo=function(){return ks(this,Vs)||fr(this,Vs,new Map)},mo=function(){if(!ks(this,Ks)){const Bs=ks(this,$s).createElement("div"),{style:qs}=Bs;qs.visibility="hidden",qs.contain="strict",qs.width=qs.height=0,qs.position="absolute",qs.top=qs.left=0,qs.zIndex=-1;const cr=ks(this,$s).createElementNS(os,"svg");cr.setAttribute("width",0),cr.setAttribute("height",0),fr(this,Ks,ks(this,$s).createElementNS(os,"defs")),Bs.append(cr),cr.append(ks(this,Ks)),ks(this,$s).body.append(Bs)}return ks(this,Ks)},Zo=function(Bs){const qs=ks(this,$s).createElementNS(os,"feColorMatrix");qs.setAttribute("type","matrix"),qs.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Bs.append(qs)},Co=function(Bs){const qs=ks(this,$s).createElementNS(os,"filter");return qs.setAttribute("color-interpolation-filters","sRGB"),qs.setAttribute("id",Bs),ks(this,Os,mo).append(qs),qs},Ao=function(Bs,qs,cr){const xr=ks(this,$s).createElementNS(os,qs);xr.setAttribute("type","discrete"),xr.setAttribute("tableValues",cr),Bs.append(xr)},vo=function(Bs,qs,cr,xr){const yr=ks(this,$s).createElementNS(os,"feComponentTransfer");xr.append(yr),ar(this,Os,Ao).call(this,yr,"feFuncR",Bs),ar(this,Os,Ao).call(this,yr,"feFuncG",qs),ar(this,Os,Ao).call(this,yr,"feFuncB",cr)},yo=function(Bs){return ks(this,Os,mo).style.color=Bs,Cs(getComputedStyle(ks(this,Os,mo)).getPropertyValue("color"))},ts.DOMFilterFactory=cs;class ls extends ns.BaseCanvasFactory{constructor({ownerDocument:hr=globalThis.document}={}){super(),this._document=hr}_createCanvas(hr,Bs){const qs=this._document.createElement("canvas");return qs.width=hr,qs.height=Bs,qs}}ts.DOMCanvasFactory=ls;async function us(dr,hr=!1){if(ws(dr,document.baseURI)){const Bs=await fetch(dr);if(!Bs.ok)throw new Error(Bs.statusText);return hr?new Uint8Array(await Bs.arrayBuffer()):(0,rs.stringToBytes)(await Bs.text())}return new Promise((Bs,qs)=>{const cr=new XMLHttpRequest;cr.open("GET",dr,!0),hr&&(cr.responseType="arraybuffer"),cr.onreadystatechange=()=>{if(cr.readyState===XMLHttpRequest.DONE){if(cr.status===200||cr.status===0){let xr;if(hr&&cr.response?xr=new Uint8Array(cr.response):!hr&&cr.responseText&&(xr=(0,rs.stringToBytes)(cr.responseText)),xr){Bs(xr);return}}qs(new Error(cr.statusText))}},cr.send(null)})}class ds extends ns.BaseCMapReaderFactory{_fetchData(hr,Bs){return us(hr,this.isCompressed).then(qs=>({cMapData:qs,compressionType:Bs}))}}ts.DOMCMapReaderFactory=ds;class xs extends ns.BaseStandardFontDataFactory{_fetchData(hr){return us(hr,!0)}}ts.DOMStandardFontDataFactory=xs;class fs extends ns.BaseSVGFactory{_createSVG(hr){return document.createElementNS(os,hr)}}ts.DOMSVGFactory=fs;class gs{constructor({viewBox:hr,scale:Bs,rotation:qs,offsetX:cr=0,offsetY:xr=0,dontFlip:yr=!1}){this.viewBox=hr,this.scale=Bs,this.rotation=qs,this.offsetX=cr,this.offsetY=xr;const Ar=(hr[2]+hr[0])/2,Cr=(hr[3]+hr[1])/2;let ur,Pr,Tr,Xr;switch(qs%=360,qs<0&&(qs+=360),qs){case 180:ur=-1,Pr=0,Tr=0,Xr=1;break;case 90:ur=0,Pr=1,Tr=1,Xr=0;break;case 270:ur=0,Pr=-1,Tr=-1,Xr=0;break;case 0:ur=1,Pr=0,Tr=0,Xr=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}yr&&(Tr=-Tr,Xr=-Xr);let Vr,Qr,Or,zr;ur===0?(Vr=Math.abs(Cr-hr[1])*Bs+cr,Qr=Math.abs(Ar-hr[0])*Bs+xr,Or=(hr[3]-hr[1])*Bs,zr=(hr[2]-hr[0])*Bs):(Vr=Math.abs(Ar-hr[0])*Bs+cr,Qr=Math.abs(Cr-hr[1])*Bs+xr,Or=(hr[2]-hr[0])*Bs,zr=(hr[3]-hr[1])*Bs),this.transform=[ur*Bs,Pr*Bs,Tr*Bs,Xr*Bs,Vr-ur*Bs*Ar-Tr*Bs*Cr,Qr-Pr*Bs*Ar-Xr*Bs*Cr],this.width=Or,this.height=zr}get rawDims(){const{viewBox:hr}=this;return(0,rs.shadow)(this,"rawDims",{pageWidth:hr[2]-hr[0],pageHeight:hr[3]-hr[1],pageX:hr[0],pageY:hr[1]})}clone({scale:hr=this.scale,rotation:Bs=this.rotation,offsetX:qs=this.offsetX,offsetY:cr=this.offsetY,dontFlip:xr=!1}={}){return new gs({viewBox:this.viewBox.slice(),scale:hr,rotation:Bs,offsetX:qs,offsetY:cr,dontFlip:xr})}convertToViewportPoint(hr,Bs){return rs.Util.applyTransform([hr,Bs],this.transform)}convertToViewportRectangle(hr){const Bs=rs.Util.applyTransform([hr[0],hr[1]],this.transform),qs=rs.Util.applyTransform([hr[2],hr[3]],this.transform);return[Bs[0],Bs[1],qs[0],qs[1]]}convertToPdfPoint(hr,Bs){return rs.Util.applyInverseTransform([hr,Bs],this.transform)}}ts.PageViewport=gs;class Es extends rs.BaseException{constructor(hr,Bs=0){super(hr,"RenderingCancelledException"),this.extraDelay=Bs}}ts.RenderingCancelledException=Es;function js(dr){const hr=dr.length;let Bs=0;for(;Bs<hr&&dr[Bs].trim()==="";)Bs++;return dr.substring(Bs,Bs+5).toLowerCase()==="data:"}function ps(dr){return typeof dr=="string"&&/\.pdf$/i.test(dr)}function ms(dr,hr=!1){return hr||([dr]=dr.split(/[#?]/,1)),dr.substring(dr.lastIndexOf("/")+1)}function hs(dr,hr="document.pdf"){if(typeof dr!="string")return hr;if(js(dr))return(0,rs.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),hr;const Bs=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,qs=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,cr=Bs.exec(dr);let xr=qs.exec(cr[1])||qs.exec(cr[2])||qs.exec(cr[3]);if(xr&&(xr=xr[0],xr.includes("%")))try{xr=qs.exec(decodeURIComponent(xr))[0]}catch{}return xr||hr}class vs{constructor(){eo(this,"started",Object.create(null));eo(this,"times",[])}time(hr){hr in this.started&&(0,rs.warn)(`Timer is already running for ${hr}`),this.started[hr]=Date.now()}timeEnd(hr){hr in this.started||(0,rs.warn)(`Timer has not been started for ${hr}`),this.times.push({name:hr,start:this.started[hr],end:Date.now()}),delete this.started[hr]}toString(){const hr=[];let Bs=0;for(const{name:qs}of this.times)Bs=Math.max(qs.length,Bs);for(const{name:qs,start:cr,end:xr}of this.times)hr.push(`${qs.padEnd(Bs)} ${xr-cr}ms
`);return hr.join("")}}ts.StatTimer=vs;function ws(dr,hr){try{const{protocol:Bs}=hr?new URL(dr,hr):new URL(dr);return Bs==="http:"||Bs==="https:"}catch{return!1}}function ys(dr){dr.preventDefault()}function Rs(dr,hr=!1){return new Promise((Bs,qs)=>{const cr=document.createElement("script");cr.src=dr,cr.onload=function(xr){hr&&cr.remove(),Bs(xr)},cr.onerror=function(){qs(new Error(`Cannot load script at: ${cr.src}`))},(document.head||document.documentElement).append(cr)})}function bs(dr){console.log("Deprecated API usage: "+dr)}let Ns;class Ss{static toDateObject(hr){if(!hr||typeof hr!="string")return null;Ns||(Ns=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Bs=Ns.exec(hr);if(!Bs)return null;const qs=parseInt(Bs[1],10);let cr=parseInt(Bs[2],10);cr=cr>=1&&cr<=12?cr-1:0;let xr=parseInt(Bs[3],10);xr=xr>=1&&xr<=31?xr:1;let yr=parseInt(Bs[4],10);yr=yr>=0&&yr<=23?yr:0;let Ar=parseInt(Bs[5],10);Ar=Ar>=0&&Ar<=59?Ar:0;let Cr=parseInt(Bs[6],10);Cr=Cr>=0&&Cr<=59?Cr:0;const ur=Bs[7]||"Z";let Pr=parseInt(Bs[8],10);Pr=Pr>=0&&Pr<=23?Pr:0;let Tr=parseInt(Bs[9],10)||0;return Tr=Tr>=0&&Tr<=59?Tr:0,ur==="-"?(yr+=Pr,Ar+=Tr):ur==="+"&&(yr-=Pr,Ar-=Tr),new Date(Date.UTC(qs,cr,xr,yr,Ar,Cr))}}ts.PDFDateString=Ss;function Ts(dr,{scale:hr=1,rotation:Bs=0}){const{width:qs,height:cr}=dr.attributes.style,xr=[0,0,parseInt(qs),parseInt(cr)];return new gs({viewBox:xr,scale:hr,rotation:Bs})}function Cs(dr){if(dr.startsWith("#")){const hr=parseInt(dr.slice(1),16);return[(hr&16711680)>>16,(hr&65280)>>8,hr&255]}return dr.startsWith("rgb(")?dr.slice(4,-1).split(",").map(hr=>parseInt(hr)):dr.startsWith("rgba(")?dr.slice(5,-1).split(",").map(hr=>parseInt(hr)).slice(0,3):((0,rs.warn)(`Not a valid color format: "${dr}"`),[0,0,0])}function Ms(dr){const hr=document.createElement("span");hr.style.visibility="hidden",document.body.append(hr);for(const Bs of dr.keys()){hr.style.color=Bs;const qs=window.getComputedStyle(hr).color;dr.set(Bs,Cs(qs))}hr.remove()}function Is(dr){const{a:hr,b:Bs,c:qs,d:cr,e:xr,f:yr}=dr.getTransform();return[hr,Bs,qs,cr,xr,yr]}function Qs(dr){const{a:hr,b:Bs,c:qs,d:cr,e:xr,f:yr}=dr.getTransform().invertSelf();return[hr,Bs,qs,cr,xr,yr]}function Ys(dr,hr,Bs=!1,qs=!0){if(hr instanceof gs){const{pageWidth:cr,pageHeight:xr}=hr.rawDims,{style:yr}=dr,Ar=rs.FeatureTest.isCSSRoundSupported,Cr=`var(--scale-factor) * ${cr}px`,ur=`var(--scale-factor) * ${xr}px`,Pr=Ar?`round(${Cr}, 1px)`:`calc(${Cr})`,Tr=Ar?`round(${ur}, 1px)`:`calc(${ur})`;!Bs||hr.rotation%180===0?(yr.width=Pr,yr.height=Tr):(yr.width=Tr,yr.height=Pr)}qs&&dr.setAttribute("data-main-rotation",hr.rotation)}},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.BaseStandardFontDataFactory=ts.BaseSVGFactory=ts.BaseFilterFactory=ts.BaseCanvasFactory=ts.BaseCMapReaderFactory=void 0;var ns=ss(1);class rs{constructor(){this.constructor===rs&&(0,ns.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(ds){return"none"}addHCMFilter(ds,xs){return"none"}addHighlightHCMFilter(ds,xs,fs,gs){return"none"}destroy(ds=!1){}}ts.BaseFilterFactory=rs;class os{constructor(){this.constructor===os&&(0,ns.unreachable)("Cannot initialize BaseCanvasFactory.")}create(ds,xs){if(ds<=0||xs<=0)throw new Error("Invalid canvas size");const fs=this._createCanvas(ds,xs);return{canvas:fs,context:fs.getContext("2d")}}reset(ds,xs,fs){if(!ds.canvas)throw new Error("Canvas is not specified");if(xs<=0||fs<=0)throw new Error("Invalid canvas size");ds.canvas.width=xs,ds.canvas.height=fs}destroy(ds){if(!ds.canvas)throw new Error("Canvas is not specified");ds.canvas.width=0,ds.canvas.height=0,ds.canvas=null,ds.context=null}_createCanvas(ds,xs){(0,ns.unreachable)("Abstract method `_createCanvas` called.")}}ts.BaseCanvasFactory=os;class as{constructor({baseUrl:ds=null,isCompressed:xs=!0}){this.constructor===as&&(0,ns.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=ds,this.isCompressed=xs}async fetch({name:ds}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!ds)throw new Error("CMap name must be specified.");const xs=this.baseUrl+ds+(this.isCompressed?".bcmap":""),fs=this.isCompressed?ns.CMapCompressionType.BINARY:ns.CMapCompressionType.NONE;return this._fetchData(xs,fs).catch(gs=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${xs}`)})}_fetchData(ds,xs){(0,ns.unreachable)("Abstract method `_fetchData` called.")}}ts.BaseCMapReaderFactory=as;class cs{constructor({baseUrl:ds=null}){this.constructor===cs&&(0,ns.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=ds}async fetch({filename:ds}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!ds)throw new Error("Font filename must be specified.");const xs=`${this.baseUrl}${ds}`;return this._fetchData(xs).catch(fs=>{throw new Error(`Unable to load font data at: ${xs}`)})}_fetchData(ds){(0,ns.unreachable)("Abstract method `_fetchData` called.")}}ts.BaseStandardFontDataFactory=cs;class ls{constructor(){this.constructor===ls&&(0,ns.unreachable)("Cannot initialize BaseSVGFactory.")}create(ds,xs,fs=!1){if(ds<=0||xs<=0)throw new Error("Invalid SVG dimensions");const gs=this._createSVG("svg:svg");return gs.setAttribute("version","1.1"),fs||(gs.setAttribute("width",`${ds}px`),gs.setAttribute("height",`${xs}px`)),gs.setAttribute("preserveAspectRatio","none"),gs.setAttribute("viewBox",`0 0 ${ds} ${xs}`),gs}createElement(ds){if(typeof ds!="string")throw new Error("Invalid SVG element type");return this._createSVG(ds)}_createSVG(ds){(0,ns.unreachable)("Abstract method `_createSVG` called.")}}ts.BaseSVGFactory=ls},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.MurmurHash3_64=void 0;var ns=ss(1);const rs=3285377520,os=4294901760,as=65535;class cs{constructor(us){this.h1=us?us&4294967295:rs,this.h2=us?us&4294967295:rs}update(us){let ds,xs;if(typeof us=="string"){ds=new Uint8Array(us.length*2),xs=0;for(let bs=0,Ns=us.length;bs<Ns;bs++){const Ss=us.charCodeAt(bs);Ss<=255?ds[xs++]=Ss:(ds[xs++]=Ss>>>8,ds[xs++]=Ss&255)}}else if((0,ns.isArrayBuffer)(us))ds=us.slice(),xs=ds.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const fs=xs>>2,gs=xs-fs*4,Es=new Uint32Array(ds.buffer,0,fs);let js=0,ps=0,ms=this.h1,hs=this.h2;const vs=3432918353,ws=461845907,ys=vs&as,Rs=ws&as;for(let bs=0;bs<fs;bs++)bs&1?(js=Es[bs],js=js*vs&os|js*ys&as,js=js<<15|js>>>17,js=js*ws&os|js*Rs&as,ms^=js,ms=ms<<13|ms>>>19,ms=ms*5+3864292196):(ps=Es[bs],ps=ps*vs&os|ps*ys&as,ps=ps<<15|ps>>>17,ps=ps*ws&os|ps*Rs&as,hs^=ps,hs=hs<<13|hs>>>19,hs=hs*5+3864292196);switch(js=0,gs){case 3:js^=ds[fs*4+2]<<16;case 2:js^=ds[fs*4+1]<<8;case 1:js^=ds[fs*4],js=js*vs&os|js*ys&as,js=js<<15|js>>>17,js=js*ws&os|js*Rs&as,fs&1?ms^=js:hs^=js}this.h1=ms,this.h2=hs}hexdigest(){let us=this.h1,ds=this.h2;return us^=ds>>>1,us=us*3981806797&os|us*36045&as,ds=ds*4283543511&os|((ds<<16|us>>>16)*2950163797&os)>>>16,us^=ds>>>1,us=us*444984403&os|us*60499&as,ds=ds*3301882366&os|((ds<<16|us>>>16)*3120437893&os)>>>16,us^=ds>>>1,(us>>>0).toString(16).padStart(8,"0")+(ds>>>0).toString(16).padStart(8,"0")}}ts.MurmurHash3_64=cs},(es,ts,ss)=>{var as;Object.defineProperty(ts,"__esModule",{value:!0}),ts.FontLoader=ts.FontFaceObject=void 0;var ns=ss(1);class rs{constructor({ownerDocument:ls=globalThis.document,styleElement:us=null}){mr(this,as,new Set);this._document=ls,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(ls){this.nativeFontFaces.add(ls),this._document.fonts.add(ls)}removeNativeFontFace(ls){this.nativeFontFaces.delete(ls),this._document.fonts.delete(ls)}insertRule(ls){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const us=this.styleElement.sheet;us.insertRule(ls,us.cssRules.length)}clear(){for(const ls of this.nativeFontFaces)this._document.fonts.delete(ls);this.nativeFontFaces.clear(),ks(this,as).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(ls){if(!(!ls||ks(this,as).has(ls.loadedName))){if((0,ns.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:us,src:ds,style:xs}=ls,fs=new FontFace(us,ds,xs);this.addNativeFontFace(fs);try{await fs.load(),ks(this,as).add(us)}catch{(0,ns.warn)(`Cannot load system font: ${ls.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(fs)}return}(0,ns.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(ls){if(ls.attached||ls.missingFile&&!ls.systemFontInfo)return;if(ls.attached=!0,ls.systemFontInfo){await this.loadSystemFont(ls.systemFontInfo);return}if(this.isFontLoadingAPISupported){const ds=ls.createNativeFontFace();if(ds){this.addNativeFontFace(ds);try{await ds.loaded}catch(xs){throw(0,ns.warn)(`Failed to load font '${ds.family}': '${xs}'.`),ls.disableFontFace=!0,xs}}return}const us=ls.createFontFaceRule();if(us){if(this.insertRule(us),this.isSyncFontLoadingSupported)return;await new Promise(ds=>{const xs=this._queueLoadingCallback(ds);this._prepareFontLoadEvent(ls,xs)})}}get isFontLoadingAPISupported(){var us;const ls=!!((us=this._document)!=null&&us.fonts);return(0,ns.shadow)(this,"isFontLoadingAPISupported",ls)}get isSyncFontLoadingSupported(){let ls=!1;return(ns.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(ls=!0),(0,ns.shadow)(this,"isSyncFontLoadingSupported",ls)}_queueLoadingCallback(ls){function us(){for((0,ns.assert)(!xs.done,"completeRequest() cannot be called twice."),xs.done=!0;ds.length>0&&ds[0].done;){const fs=ds.shift();setTimeout(fs.callback,0)}}const{loadingRequests:ds}=this,xs={done:!1,complete:us,callback:ls};return ds.push(xs),xs}get _loadTestFont(){const ls=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,ns.shadow)(this,"_loadTestFont",ls)}_prepareFontLoadEvent(ls,us){function ds(Cs,Ms){return Cs.charCodeAt(Ms)<<24|Cs.charCodeAt(Ms+1)<<16|Cs.charCodeAt(Ms+2)<<8|Cs.charCodeAt(Ms+3)&255}function xs(Cs,Ms,Is,Qs){const Ys=Cs.substring(0,Ms),Zs=Cs.substring(Ms+Is);return Ys+Qs+Zs}let fs,gs;const Es=this._document.createElement("canvas");Es.width=1,Es.height=1;const js=Es.getContext("2d");let ps=0;function ms(Cs,Ms){if(++ps>30){(0,ns.warn)("Load test font never loaded."),Ms();return}if(js.font="30px "+Cs,js.fillText(".",0,20),js.getImageData(0,0,1,1).data[3]>0){Ms();return}setTimeout(ms.bind(null,Cs,Ms))}const hs=`lt${Date.now()}${this.loadTestFontId++}`;let vs=this._loadTestFont;vs=xs(vs,976,hs.length,hs);const ys=16,Rs=1482184792;let bs=ds(vs,ys);for(fs=0,gs=hs.length-3;fs<gs;fs+=4)bs=bs-Rs+ds(hs,fs)|0;fs<hs.length&&(bs=bs-Rs+ds(hs+"XXX",fs)|0),vs=xs(vs,ys,4,(0,ns.string32)(bs));const Ns=`url(data:font/opentype;base64,${btoa(vs)});`,Ss=`@font-face {font-family:"${hs}";src:${Ns}}`;this.insertRule(Ss);const Ts=this._document.createElement("div");Ts.style.visibility="hidden",Ts.style.width=Ts.style.height="10px",Ts.style.position="absolute",Ts.style.top=Ts.style.left="0px";for(const Cs of[ls.loadedName,hs]){const Ms=this._document.createElement("span");Ms.textContent="Hi",Ms.style.fontFamily=Cs,Ts.append(Ms)}this._document.body.append(Ts),ms(hs,()=>{Ts.remove(),us.complete()})}}as=new WeakMap,ts.FontLoader=rs;class os{constructor(ls,{isEvalSupported:us=!0,disableFontFace:ds=!1,ignoreErrors:xs=!1,inspectFont:fs=null}){this.compiledGlyphs=Object.create(null);for(const gs in ls)this[gs]=ls[gs];this.isEvalSupported=us!==!1,this.disableFontFace=ds===!0,this.ignoreErrors=xs===!0,this._inspectFont=fs}createNativeFontFace(){var us;if(!this.data||this.disableFontFace)return null;let ls;if(!this.cssFontInfo)ls=new FontFace(this.loadedName,this.data,{});else{const ds={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(ds.style=`oblique ${this.cssFontInfo.italicAngle}deg`),ls=new FontFace(this.cssFontInfo.fontFamily,this.data,ds)}return(us=this._inspectFont)==null||us.call(this,this),ls}createFontFaceRule(){var xs;if(!this.data||this.disableFontFace)return null;const ls=(0,ns.bytesToString)(this.data),us=`url(data:${this.mimetype};base64,${btoa(ls)});`;let ds;if(!this.cssFontInfo)ds=`@font-face {font-family:"${this.loadedName}";src:${us}}`;else{let fs=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(fs+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),ds=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${fs}src:${us}}`}return(xs=this._inspectFont)==null||xs.call(this,this,us),ds}getPathGenerator(ls,us){if(this.compiledGlyphs[us]!==void 0)return this.compiledGlyphs[us];let ds;try{ds=ls.get(this.loadedName+"_path_"+us)}catch(xs){if(!this.ignoreErrors)throw xs;return(0,ns.warn)(`getPathGenerator - ignoring character: "${xs}".`),this.compiledGlyphs[us]=function(fs,gs){}}if(this.isEvalSupported&&ns.FeatureTest.isEvalSupported){const xs=[];for(const fs of ds){const gs=fs.args!==void 0?fs.args.join(","):"";xs.push("c.",fs.cmd,"(",gs,`);
`)}return this.compiledGlyphs[us]=new Function("c","size",xs.join(""))}return this.compiledGlyphs[us]=function(xs,fs){for(const gs of ds)gs.cmd==="scale"&&(gs.args=[fs,-fs]),xs[gs.cmd].apply(xs,gs.args)}}}ts.FontFaceObject=os},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.NodeStandardFontDataFactory=ts.NodeFilterFactory=ts.NodeCanvasFactory=ts.NodeCMapReaderFactory=void 0;var ns=ss(7);ss(1);const rs=function(us){return new Promise((ds,xs)=>{require$$5.readFile(us,(gs,Es)=>{if(gs||!Es){xs(new Error(gs));return}ds(new Uint8Array(Es))})})};class os extends ns.BaseFilterFactory{}ts.NodeFilterFactory=os;class as extends ns.BaseCanvasFactory{_createCanvas(ds,xs){return require$$5.createCanvas(ds,xs)}}ts.NodeCanvasFactory=as;class cs extends ns.BaseCMapReaderFactory{_fetchData(ds,xs){return rs(ds).then(fs=>({cMapData:fs,compressionType:xs}))}}ts.NodeCMapReaderFactory=cs;class ls extends ns.BaseStandardFontDataFactory{_fetchData(ds){return rs(ds)}}ts.NodeStandardFontDataFactory=ls},(es,ts,ss)=>{var Ks,na,xa;Object.defineProperty(ts,"__esModule",{value:!0}),ts.CanvasGraphics=void 0;var ns=ss(1),rs=ss(6),os=ss(12),as=ss(13);const cs=16,ls=100,us=4096,ds=15,xs=10,fs=1e3,gs=16;function Es(Fs,As){if(Fs._removeMirroring)throw new Error("Context is already forwarding operations.");Fs.__originalSave=Fs.save,Fs.__originalRestore=Fs.restore,Fs.__originalRotate=Fs.rotate,Fs.__originalScale=Fs.scale,Fs.__originalTranslate=Fs.translate,Fs.__originalTransform=Fs.transform,Fs.__originalSetTransform=Fs.setTransform,Fs.__originalResetTransform=Fs.resetTransform,Fs.__originalClip=Fs.clip,Fs.__originalMoveTo=Fs.moveTo,Fs.__originalLineTo=Fs.lineTo,Fs.__originalBezierCurveTo=Fs.bezierCurveTo,Fs.__originalRect=Fs.rect,Fs.__originalClosePath=Fs.closePath,Fs.__originalBeginPath=Fs.beginPath,Fs._removeMirroring=()=>{Fs.save=Fs.__originalSave,Fs.restore=Fs.__originalRestore,Fs.rotate=Fs.__originalRotate,Fs.scale=Fs.__originalScale,Fs.translate=Fs.__originalTranslate,Fs.transform=Fs.__originalTransform,Fs.setTransform=Fs.__originalSetTransform,Fs.resetTransform=Fs.__originalResetTransform,Fs.clip=Fs.__originalClip,Fs.moveTo=Fs.__originalMoveTo,Fs.lineTo=Fs.__originalLineTo,Fs.bezierCurveTo=Fs.__originalBezierCurveTo,Fs.rect=Fs.__originalRect,Fs.closePath=Fs.__originalClosePath,Fs.beginPath=Fs.__originalBeginPath,delete Fs._removeMirroring},Fs.save=function(){As.save(),this.__originalSave()},Fs.restore=function(){As.restore(),this.__originalRestore()},Fs.translate=function(Ps,Hs){As.translate(Ps,Hs),this.__originalTranslate(Ps,Hs)},Fs.scale=function(Ps,Hs){As.scale(Ps,Hs),this.__originalScale(Ps,Hs)},Fs.transform=function(Ps,Hs,Ls,Os,Ws,Gs){As.transform(Ps,Hs,Ls,Os,Ws,Gs),this.__originalTransform(Ps,Hs,Ls,Os,Ws,Gs)},Fs.setTransform=function(Ps,Hs,Ls,Os,Ws,Gs){As.setTransform(Ps,Hs,Ls,Os,Ws,Gs),this.__originalSetTransform(Ps,Hs,Ls,Os,Ws,Gs)},Fs.resetTransform=function(){As.resetTransform(),this.__originalResetTransform()},Fs.rotate=function(Ps){As.rotate(Ps),this.__originalRotate(Ps)},Fs.clip=function(Ps){As.clip(Ps),this.__originalClip(Ps)},Fs.moveTo=function(_s,Ps){As.moveTo(_s,Ps),this.__originalMoveTo(_s,Ps)},Fs.lineTo=function(_s,Ps){As.lineTo(_s,Ps),this.__originalLineTo(_s,Ps)},Fs.bezierCurveTo=function(_s,Ps,Hs,Ls,Os,Ws){As.bezierCurveTo(_s,Ps,Hs,Ls,Os,Ws),this.__originalBezierCurveTo(_s,Ps,Hs,Ls,Os,Ws)},Fs.rect=function(_s,Ps,Hs,Ls){As.rect(_s,Ps,Hs,Ls),this.__originalRect(_s,Ps,Hs,Ls)},Fs.closePath=function(){As.closePath(),this.__originalClosePath()},Fs.beginPath=function(){As.beginPath(),this.__originalBeginPath()}}class js{constructor(As){this.canvasFactory=As,this.cache=Object.create(null)}getCanvas(As,_s,Ps){let Hs;return this.cache[As]!==void 0?(Hs=this.cache[As],this.canvasFactory.reset(Hs,_s,Ps)):(Hs=this.canvasFactory.create(_s,Ps),this.cache[As]=Hs),Hs}delete(As){delete this.cache[As]}clear(){for(const As in this.cache){const _s=this.cache[As];this.canvasFactory.destroy(_s),delete this.cache[As]}}}function ps(Fs,As,_s,Ps,Hs,Ls,Os,Ws,Gs,lr){const[jr,br,Nr,wr,dr,hr]=(0,rs.getCurrentTransform)(Fs);if(br===0&&Nr===0){const cr=Os*jr+dr,xr=Math.round(cr),yr=Ws*wr+hr,Ar=Math.round(yr),Cr=(Os+Gs)*jr+dr,ur=Math.abs(Math.round(Cr)-xr)||1,Pr=(Ws+lr)*wr+hr,Tr=Math.abs(Math.round(Pr)-Ar)||1;return Fs.setTransform(Math.sign(jr),0,0,Math.sign(wr),xr,Ar),Fs.drawImage(As,_s,Ps,Hs,Ls,0,0,ur,Tr),Fs.setTransform(jr,br,Nr,wr,dr,hr),[ur,Tr]}if(jr===0&&wr===0){const cr=Ws*Nr+dr,xr=Math.round(cr),yr=Os*br+hr,Ar=Math.round(yr),Cr=(Ws+lr)*Nr+dr,ur=Math.abs(Math.round(Cr)-xr)||1,Pr=(Os+Gs)*br+hr,Tr=Math.abs(Math.round(Pr)-Ar)||1;return Fs.setTransform(0,Math.sign(br),Math.sign(Nr),0,xr,Ar),Fs.drawImage(As,_s,Ps,Hs,Ls,0,0,Tr,ur),Fs.setTransform(jr,br,Nr,wr,dr,hr),[Tr,ur]}Fs.drawImage(As,_s,Ps,Hs,Ls,Os,Ws,Gs,lr);const Bs=Math.hypot(jr,br),qs=Math.hypot(Nr,wr);return[Bs*Gs,qs*lr]}function ms(Fs){const{width:As,height:_s}=Fs;if(As>fs||_s>fs)return null;const Ps=1e3,Hs=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Ls=As+1;let Os=new Uint8Array(Ls*(_s+1)),Ws,Gs,lr;const jr=As+7&-8;let br=new Uint8Array(jr*_s),Nr=0;for(const qs of Fs.data){let cr=128;for(;cr>0;)br[Nr++]=qs&cr?0:255,cr>>=1}let wr=0;for(Nr=0,br[Nr]!==0&&(Os[0]=1,++wr),Gs=1;Gs<As;Gs++)br[Nr]!==br[Nr+1]&&(Os[Gs]=br[Nr]?2:1,++wr),Nr++;for(br[Nr]!==0&&(Os[Gs]=2,++wr),Ws=1;Ws<_s;Ws++){Nr=Ws*jr,lr=Ws*Ls,br[Nr-jr]!==br[Nr]&&(Os[lr]=br[Nr]?1:8,++wr);let qs=(br[Nr]?4:0)+(br[Nr-jr]?8:0);for(Gs=1;Gs<As;Gs++)qs=(qs>>2)+(br[Nr+1]?4:0)+(br[Nr-jr+1]?8:0),Hs[qs]&&(Os[lr+Gs]=Hs[qs],++wr),Nr++;if(br[Nr-jr]!==br[Nr]&&(Os[lr+Gs]=br[Nr]?2:4,++wr),wr>Ps)return null}for(Nr=jr*(_s-1),lr=Ws*Ls,br[Nr]!==0&&(Os[lr]=8,++wr),Gs=1;Gs<As;Gs++)br[Nr]!==br[Nr+1]&&(Os[lr+Gs]=br[Nr]?4:8,++wr),Nr++;if(br[Nr]!==0&&(Os[lr+Gs]=4,++wr),wr>Ps)return null;const dr=new Int32Array([0,Ls,-1,0,-Ls,0,0,0,1]),hr=new Path2D;for(Ws=0;wr&&Ws<=_s;Ws++){let qs=Ws*Ls;const cr=qs+As;for(;qs<cr&&!Os[qs];)qs++;if(qs===cr)continue;hr.moveTo(qs%Ls,Ws);const xr=qs;let yr=Os[qs];do{const Ar=dr[yr];do qs+=Ar;while(!Os[qs]);const Cr=Os[qs];Cr!==5&&Cr!==10?(yr=Cr,Os[qs]=0):(yr=Cr&51*yr>>4,Os[qs]&=yr>>2|yr<<2),hr.lineTo(qs%Ls,qs/Ls|0),Os[qs]||--wr}while(xr!==qs);--Ws}return br=null,Os=null,function(qs){qs.save(),qs.scale(1/As,-1/_s),qs.translate(0,-_s),qs.fill(hr),qs.beginPath(),qs.restore()}}class hs{constructor(As,_s){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=ns.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=ns.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=ns.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,As,_s])}clone(){const As=Object.create(this);return As.clipBox=this.clipBox.slice(),As}setCurrentPoint(As,_s){this.x=As,this.y=_s}updatePathMinMax(As,_s,Ps){[_s,Ps]=ns.Util.applyTransform([_s,Ps],As),this.minX=Math.min(this.minX,_s),this.minY=Math.min(this.minY,Ps),this.maxX=Math.max(this.maxX,_s),this.maxY=Math.max(this.maxY,Ps)}updateRectMinMax(As,_s){const Ps=ns.Util.applyTransform(_s,As),Hs=ns.Util.applyTransform(_s.slice(2),As);this.minX=Math.min(this.minX,Ps[0],Hs[0]),this.minY=Math.min(this.minY,Ps[1],Hs[1]),this.maxX=Math.max(this.maxX,Ps[0],Hs[0]),this.maxY=Math.max(this.maxY,Ps[1],Hs[1])}updateScalingPathMinMax(As,_s){ns.Util.scaleMinMax(As,_s),this.minX=Math.min(this.minX,_s[0]),this.maxX=Math.max(this.maxX,_s[1]),this.minY=Math.min(this.minY,_s[2]),this.maxY=Math.max(this.maxY,_s[3])}updateCurvePathMinMax(As,_s,Ps,Hs,Ls,Os,Ws,Gs,lr,jr){const br=ns.Util.bezierBoundingBox(_s,Ps,Hs,Ls,Os,Ws,Gs,lr);if(jr){jr[0]=Math.min(jr[0],br[0],br[2]),jr[1]=Math.max(jr[1],br[0],br[2]),jr[2]=Math.min(jr[2],br[1],br[3]),jr[3]=Math.max(jr[3],br[1],br[3]);return}this.updateRectMinMax(As,br)}getPathBoundingBox(As=os.PathType.FILL,_s=null){const Ps=[this.minX,this.minY,this.maxX,this.maxY];if(As===os.PathType.STROKE){_s||(0,ns.unreachable)("Stroke bounding box must include transform.");const Hs=ns.Util.singularValueDecompose2dScale(_s),Ls=Hs[0]*this.lineWidth/2,Os=Hs[1]*this.lineWidth/2;Ps[0]-=Ls,Ps[1]-=Os,Ps[2]+=Ls,Ps[3]+=Os}return Ps}updateClipFromPath(){const As=ns.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(As||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(As){this.clipBox=As,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(As=os.PathType.FILL,_s=null){return ns.Util.intersect(this.clipBox,this.getPathBoundingBox(As,_s))}}function vs(Fs,As){if(typeof ImageData<"u"&&As instanceof ImageData){Fs.putImageData(As,0,0);return}const _s=As.height,Ps=As.width,Hs=_s%gs,Ls=(_s-Hs)/gs,Os=Hs===0?Ls:Ls+1,Ws=Fs.createImageData(Ps,gs);let Gs=0,lr;const jr=As.data,br=Ws.data;let Nr,wr,dr,hr;if(As.kind===ns.ImageKind.GRAYSCALE_1BPP){const Bs=jr.byteLength,qs=new Uint32Array(br.buffer,0,br.byteLength>>2),cr=qs.length,xr=Ps+7>>3,yr=4294967295,Ar=ns.FeatureTest.isLittleEndian?4278190080:255;for(Nr=0;Nr<Os;Nr++){for(dr=Nr<Ls?gs:Hs,lr=0,wr=0;wr<dr;wr++){const Cr=Bs-Gs;let ur=0;const Pr=Cr>xr?Ps:Cr*8-7,Tr=Pr&-8;let Xr=0,Vr=0;for(;ur<Tr;ur+=8)Vr=jr[Gs++],qs[lr++]=Vr&128?yr:Ar,qs[lr++]=Vr&64?yr:Ar,qs[lr++]=Vr&32?yr:Ar,qs[lr++]=Vr&16?yr:Ar,qs[lr++]=Vr&8?yr:Ar,qs[lr++]=Vr&4?yr:Ar,qs[lr++]=Vr&2?yr:Ar,qs[lr++]=Vr&1?yr:Ar;for(;ur<Pr;ur++)Xr===0&&(Vr=jr[Gs++],Xr=128),qs[lr++]=Vr&Xr?yr:Ar,Xr>>=1}for(;lr<cr;)qs[lr++]=0;Fs.putImageData(Ws,0,Nr*gs)}}else if(As.kind===ns.ImageKind.RGBA_32BPP){for(wr=0,hr=Ps*gs*4,Nr=0;Nr<Ls;Nr++)br.set(jr.subarray(Gs,Gs+hr)),Gs+=hr,Fs.putImageData(Ws,0,wr),wr+=gs;Nr<Os&&(hr=Ps*Hs*4,br.set(jr.subarray(Gs,Gs+hr)),Fs.putImageData(Ws,0,wr))}else if(As.kind===ns.ImageKind.RGB_24BPP)for(dr=gs,hr=Ps*dr,Nr=0;Nr<Os;Nr++){for(Nr>=Ls&&(dr=Hs,hr=Ps*dr),lr=0,wr=hr;wr--;)br[lr++]=jr[Gs++],br[lr++]=jr[Gs++],br[lr++]=jr[Gs++],br[lr++]=255;Fs.putImageData(Ws,0,Nr*gs)}else throw new Error(`bad image kind: ${As.kind}`)}function ws(Fs,As){if(As.bitmap){Fs.drawImage(As.bitmap,0,0);return}const _s=As.height,Ps=As.width,Hs=_s%gs,Ls=(_s-Hs)/gs,Os=Hs===0?Ls:Ls+1,Ws=Fs.createImageData(Ps,gs);let Gs=0;const lr=As.data,jr=Ws.data;for(let br=0;br<Os;br++){const Nr=br<Ls?gs:Hs;({srcPos:Gs}=(0,as.convertBlackAndWhiteToRGBA)({src:lr,srcPos:Gs,dest:jr,width:Ps,height:Nr,nonBlackColor:0})),Fs.putImageData(Ws,0,br*gs)}}function ys(Fs,As){const _s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const Ps of _s)Fs[Ps]!==void 0&&(As[Ps]=Fs[Ps]);Fs.setLineDash!==void 0&&(As.setLineDash(Fs.getLineDash()),As.lineDashOffset=Fs.lineDashOffset)}function Rs(Fs){if(Fs.strokeStyle=Fs.fillStyle="#000000",Fs.fillRule="nonzero",Fs.globalAlpha=1,Fs.lineWidth=1,Fs.lineCap="butt",Fs.lineJoin="miter",Fs.miterLimit=10,Fs.globalCompositeOperation="source-over",Fs.font="10px sans-serif",Fs.setLineDash!==void 0&&(Fs.setLineDash([]),Fs.lineDashOffset=0),!ns.isNodeJS){const{filter:As}=Fs;As!=="none"&&As!==""&&(Fs.filter="none")}}function bs(Fs,As,_s,Ps){const Hs=Fs.length;for(let Ls=3;Ls<Hs;Ls+=4){const Os=Fs[Ls];if(Os===0)Fs[Ls-3]=As,Fs[Ls-2]=_s,Fs[Ls-1]=Ps;else if(Os<255){const Ws=255-Os;Fs[Ls-3]=Fs[Ls-3]*Os+As*Ws>>8,Fs[Ls-2]=Fs[Ls-2]*Os+_s*Ws>>8,Fs[Ls-1]=Fs[Ls-1]*Os+Ps*Ws>>8}}}function Ns(Fs,As,_s){const Ps=Fs.length,Hs=1/255;for(let Ls=3;Ls<Ps;Ls+=4){const Os=_s?_s[Fs[Ls]]:Fs[Ls];As[Ls]=As[Ls]*Os*Hs|0}}function Ss(Fs,As,_s){const Ps=Fs.length;for(let Hs=3;Hs<Ps;Hs+=4){const Ls=Fs[Hs-3]*77+Fs[Hs-2]*152+Fs[Hs-1]*28;As[Hs]=_s?As[Hs]*_s[Ls>>8]>>8:As[Hs]*Ls>>16}}function Ts(Fs,As,_s,Ps,Hs,Ls,Os,Ws,Gs,lr,jr){const br=!!Ls,Nr=br?Ls[0]:0,wr=br?Ls[1]:0,dr=br?Ls[2]:0,hr=Hs==="Luminosity"?Ss:Ns,qs=Math.min(Ps,Math.ceil(1048576/_s));for(let cr=0;cr<Ps;cr+=qs){const xr=Math.min(qs,Ps-cr),yr=Fs.getImageData(Ws-lr,cr+(Gs-jr),_s,xr),Ar=As.getImageData(Ws,cr+Gs,_s,xr);br&&bs(yr.data,Nr,wr,dr),hr(yr.data,Ar.data,Os),As.putImageData(Ar,Ws,cr+Gs)}}function Cs(Fs,As,_s,Ps){const Hs=Ps[0],Ls=Ps[1],Os=Ps[2]-Hs,Ws=Ps[3]-Ls;Os===0||Ws===0||(Ts(As.context,_s,Os,Ws,As.subtype,As.backdrop,As.transferMap,Hs,Ls,As.offsetX,As.offsetY),Fs.save(),Fs.globalAlpha=1,Fs.globalCompositeOperation="source-over",Fs.setTransform(1,0,0,1,0,0),Fs.drawImage(_s.canvas,0,0),Fs.restore())}function Ms(Fs,As){const _s=ns.Util.singularValueDecompose2dScale(Fs);_s[0]=Math.fround(_s[0]),_s[1]=Math.fround(_s[1]);const Ps=Math.fround((globalThis.devicePixelRatio||1)*rs.PixelsPerInch.PDF_TO_CSS_UNITS);return As!==void 0?As:_s[0]<=Ps||_s[1]<=Ps}const Is=["butt","round","square"],Qs=["miter","round","bevel"],Ys={},Zs={},Xs=class Xs{constructor(As,_s,Ps,Hs,Ls,{optionalContentConfig:Os,markedContentStack:Ws=null},Gs,lr){mr(this,Ks);this.ctx=As,this.current=new hs(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=_s,this.objs=Ps,this.canvasFactory=Hs,this.filterFactory=Ls,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Ws||[],this.optionalContentConfig=Os,this.cachedCanvases=new js(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Gs,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=lr,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(As,_s=null){return typeof As=="string"?As.startsWith("g_")?this.commonObjs.get(As):this.objs.get(As):_s}beginDrawing({transform:As,viewport:_s,transparency:Ps=!1,background:Hs=null}){const Ls=this.ctx.canvas.width,Os=this.ctx.canvas.height,Ws=this.ctx.fillStyle;if(this.ctx.fillStyle=Hs||"#ffffff",this.ctx.fillRect(0,0,Ls,Os),this.ctx.fillStyle=Ws,Ps){const Gs=this.cachedCanvases.getCanvas("transparent",Ls,Os);this.compositeCtx=this.ctx,this.transparentCanvas=Gs.canvas,this.ctx=Gs.context,this.ctx.save(),this.ctx.transform(...(0,rs.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Rs(this.ctx),As&&(this.ctx.transform(...As),this.outputScaleX=As[0],this.outputScaleY=As[0]),this.ctx.transform(..._s.transform),this.viewportScale=_s.scale,this.baseTransform=(0,rs.getCurrentTransform)(this.ctx)}executeOperatorList(As,_s,Ps,Hs){const Ls=As.argsArray,Os=As.fnArray;let Ws=_s||0;const Gs=Ls.length;if(Gs===Ws)return Ws;const lr=Gs-Ws>xs&&typeof Ps=="function",jr=lr?Date.now()+ds:0;let br=0;const Nr=this.commonObjs,wr=this.objs;let dr;for(;;){if(Hs!==void 0&&Ws===Hs.nextBreakPoint)return Hs.breakIt(Ws,Ps),Ws;if(dr=Os[Ws],dr!==ns.OPS.dependency)this[dr].apply(this,Ls[Ws]);else for(const hr of Ls[Ws]){const Bs=hr.startsWith("g_")?Nr:wr;if(!Bs.has(hr))return Bs.get(hr,Ps),Ws}if(Ws++,Ws===Gs)return Ws;if(lr&&++br>xs){if(Date.now()>jr)return Ps(),Ws;br=0}}}endDrawing(){ar(this,Ks,na).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const As of this._cachedBitmapsMap.values()){for(const _s of As.values())typeof HTMLCanvasElement<"u"&&_s instanceof HTMLCanvasElement&&(_s.width=_s.height=0);As.clear()}this._cachedBitmapsMap.clear(),ar(this,Ks,xa).call(this)}_scaleImage(As,_s){const Ps=As.width,Hs=As.height;let Ls=Math.max(Math.hypot(_s[0],_s[1]),1),Os=Math.max(Math.hypot(_s[2],_s[3]),1),Ws=Ps,Gs=Hs,lr="prescale1",jr,br;for(;Ls>2&&Ws>1||Os>2&&Gs>1;){let Nr=Ws,wr=Gs;Ls>2&&Ws>1&&(Nr=Ws>=16384?Math.floor(Ws/2)-1||1:Math.ceil(Ws/2),Ls/=Ws/Nr),Os>2&&Gs>1&&(wr=Gs>=16384?Math.floor(Gs/2)-1||1:Math.ceil(Gs)/2,Os/=Gs/wr),jr=this.cachedCanvases.getCanvas(lr,Nr,wr),br=jr.context,br.clearRect(0,0,Nr,wr),br.drawImage(As,0,0,Ws,Gs,0,0,Nr,wr),As=jr.canvas,Ws=Nr,Gs=wr,lr=lr==="prescale1"?"prescale2":"prescale1"}return{img:As,paintWidth:Ws,paintHeight:Gs}}_createMaskCanvas(As){const _s=this.ctx,{width:Ps,height:Hs}=As,Ls=this.current.fillColor,Os=this.current.patternFill,Ws=(0,rs.getCurrentTransform)(_s);let Gs,lr,jr,br;if((As.bitmap||As.data)&&As.count>1){const ur=As.bitmap||As.data.buffer;lr=JSON.stringify(Os?Ws:[Ws.slice(0,4),Ls]),Gs=this._cachedBitmapsMap.get(ur),Gs||(Gs=new Map,this._cachedBitmapsMap.set(ur,Gs));const Pr=Gs.get(lr);if(Pr&&!Os){const Tr=Math.round(Math.min(Ws[0],Ws[2])+Ws[4]),Xr=Math.round(Math.min(Ws[1],Ws[3])+Ws[5]);return{canvas:Pr,offsetX:Tr,offsetY:Xr}}jr=Pr}jr||(br=this.cachedCanvases.getCanvas("maskCanvas",Ps,Hs),ws(br.context,As));let Nr=ns.Util.transform(Ws,[1/Ps,0,0,-1/Hs,0,0]);Nr=ns.Util.transform(Nr,[1,0,0,1,0,-Hs]);const wr=ns.Util.applyTransform([0,0],Nr),dr=ns.Util.applyTransform([Ps,Hs],Nr),hr=ns.Util.normalizeRect([wr[0],wr[1],dr[0],dr[1]]),Bs=Math.round(hr[2]-hr[0])||1,qs=Math.round(hr[3]-hr[1])||1,cr=this.cachedCanvases.getCanvas("fillCanvas",Bs,qs),xr=cr.context,yr=Math.min(wr[0],dr[0]),Ar=Math.min(wr[1],dr[1]);xr.translate(-yr,-Ar),xr.transform(...Nr),jr||(jr=this._scaleImage(br.canvas,(0,rs.getCurrentTransformInverse)(xr)),jr=jr.img,Gs&&Os&&Gs.set(lr,jr)),xr.imageSmoothingEnabled=Ms((0,rs.getCurrentTransform)(xr),As.interpolate),ps(xr,jr,0,0,jr.width,jr.height,0,0,Ps,Hs),xr.globalCompositeOperation="source-in";const Cr=ns.Util.transform((0,rs.getCurrentTransformInverse)(xr),[1,0,0,1,-yr,-Ar]);return xr.fillStyle=Os?Ls.getPattern(_s,this,Cr,os.PathType.FILL):Ls,xr.fillRect(0,0,Ps,Hs),Gs&&!Os&&(this.cachedCanvases.delete("fillCanvas"),Gs.set(lr,cr.canvas)),{canvas:cr.canvas,offsetX:Math.round(yr),offsetY:Math.round(Ar)}}setLineWidth(As){As!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=As,this.ctx.lineWidth=As}setLineCap(As){this.ctx.lineCap=Is[As]}setLineJoin(As){this.ctx.lineJoin=Qs[As]}setMiterLimit(As){this.ctx.miterLimit=As}setDash(As,_s){const Ps=this.ctx;Ps.setLineDash!==void 0&&(Ps.setLineDash(As),Ps.lineDashOffset=_s)}setRenderingIntent(As){}setFlatness(As){}setGState(As){for(const[_s,Ps]of As)switch(_s){case"LW":this.setLineWidth(Ps);break;case"LC":this.setLineCap(Ps);break;case"LJ":this.setLineJoin(Ps);break;case"ML":this.setMiterLimit(Ps);break;case"D":this.setDash(Ps[0],Ps[1]);break;case"RI":this.setRenderingIntent(Ps);break;case"FL":this.setFlatness(Ps);break;case"Font":this.setFont(Ps[0],Ps[1]);break;case"CA":this.current.strokeAlpha=Ps;break;case"ca":this.current.fillAlpha=Ps,this.ctx.globalAlpha=Ps;break;case"BM":this.ctx.globalCompositeOperation=Ps;break;case"SMask":this.current.activeSMask=Ps?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(Ps);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const As=this.inSMaskMode;this.current.activeSMask&&!As?this.beginSMaskMode():!this.current.activeSMask&&As&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const As=this.ctx.canvas.width,_s=this.ctx.canvas.height,Ps="smaskGroupAt"+this.groupLevel,Hs=this.cachedCanvases.getCanvas(Ps,As,_s);this.suspendedCtx=this.ctx,this.ctx=Hs.context;const Ls=this.ctx;Ls.setTransform(...(0,rs.getCurrentTransform)(this.suspendedCtx)),ys(this.suspendedCtx,Ls),Es(Ls,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ys(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(As){if(!this.current.activeSMask)return;As?(As[0]=Math.floor(As[0]),As[1]=Math.floor(As[1]),As[2]=Math.ceil(As[2]),As[3]=Math.ceil(As[3])):As=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const _s=this.current.activeSMask,Ps=this.suspendedCtx;Cs(Ps,_s,this.ctx,As),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(ys(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const As=this.current;this.stateStack.push(As),this.current=As.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),ys(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(As,_s,Ps,Hs,Ls,Os){this.ctx.transform(As,_s,Ps,Hs,Ls,Os),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(As,_s,Ps){const Hs=this.ctx,Ls=this.current;let Os=Ls.x,Ws=Ls.y,Gs,lr;const jr=(0,rs.getCurrentTransform)(Hs),br=jr[0]===0&&jr[3]===0||jr[1]===0&&jr[2]===0,Nr=br?Ps.slice(0):null;for(let wr=0,dr=0,hr=As.length;wr<hr;wr++)switch(As[wr]|0){case ns.OPS.rectangle:Os=_s[dr++],Ws=_s[dr++];const Bs=_s[dr++],qs=_s[dr++],cr=Os+Bs,xr=Ws+qs;Hs.moveTo(Os,Ws),Bs===0||qs===0?Hs.lineTo(cr,xr):(Hs.lineTo(cr,Ws),Hs.lineTo(cr,xr),Hs.lineTo(Os,xr)),br||Ls.updateRectMinMax(jr,[Os,Ws,cr,xr]),Hs.closePath();break;case ns.OPS.moveTo:Os=_s[dr++],Ws=_s[dr++],Hs.moveTo(Os,Ws),br||Ls.updatePathMinMax(jr,Os,Ws);break;case ns.OPS.lineTo:Os=_s[dr++],Ws=_s[dr++],Hs.lineTo(Os,Ws),br||Ls.updatePathMinMax(jr,Os,Ws);break;case ns.OPS.curveTo:Gs=Os,lr=Ws,Os=_s[dr+4],Ws=_s[dr+5],Hs.bezierCurveTo(_s[dr],_s[dr+1],_s[dr+2],_s[dr+3],Os,Ws),Ls.updateCurvePathMinMax(jr,Gs,lr,_s[dr],_s[dr+1],_s[dr+2],_s[dr+3],Os,Ws,Nr),dr+=6;break;case ns.OPS.curveTo2:Gs=Os,lr=Ws,Hs.bezierCurveTo(Os,Ws,_s[dr],_s[dr+1],_s[dr+2],_s[dr+3]),Ls.updateCurvePathMinMax(jr,Gs,lr,Os,Ws,_s[dr],_s[dr+1],_s[dr+2],_s[dr+3],Nr),Os=_s[dr+2],Ws=_s[dr+3],dr+=4;break;case ns.OPS.curveTo3:Gs=Os,lr=Ws,Os=_s[dr+2],Ws=_s[dr+3],Hs.bezierCurveTo(_s[dr],_s[dr+1],Os,Ws,Os,Ws),Ls.updateCurvePathMinMax(jr,Gs,lr,_s[dr],_s[dr+1],Os,Ws,Os,Ws,Nr),dr+=4;break;case ns.OPS.closePath:Hs.closePath();break}br&&Ls.updateScalingPathMinMax(jr,Nr),Ls.setCurrentPoint(Os,Ws)}closePath(){this.ctx.closePath()}stroke(As=!0){const _s=this.ctx,Ps=this.current.strokeColor;_s.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof Ps=="object"&&(Ps!=null&&Ps.getPattern)?(_s.save(),_s.strokeStyle=Ps.getPattern(_s,this,(0,rs.getCurrentTransformInverse)(_s),os.PathType.STROKE),this.rescaleAndStroke(!1),_s.restore()):this.rescaleAndStroke(!0)),As&&this.consumePath(this.current.getClippedPathBoundingBox()),_s.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(As=!0){const _s=this.ctx,Ps=this.current.fillColor,Hs=this.current.patternFill;let Ls=!1;Hs&&(_s.save(),_s.fillStyle=Ps.getPattern(_s,this,(0,rs.getCurrentTransformInverse)(_s),os.PathType.FILL),Ls=!0);const Os=this.current.getClippedPathBoundingBox();this.contentVisible&&Os!==null&&(this.pendingEOFill?(_s.fill("evenodd"),this.pendingEOFill=!1):_s.fill()),Ls&&_s.restore(),As&&this.consumePath(Os)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Ys}eoClip(){this.pendingClip=Zs}beginText(){this.current.textMatrix=ns.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const As=this.pendingTextPaths,_s=this.ctx;if(As===void 0){_s.beginPath();return}_s.save(),_s.beginPath();for(const Ps of As)_s.setTransform(...Ps.transform),_s.translate(Ps.x,Ps.y),Ps.addToPath(_s,Ps.fontSize);_s.restore(),_s.clip(),_s.beginPath(),delete this.pendingTextPaths}setCharSpacing(As){this.current.charSpacing=As}setWordSpacing(As){this.current.wordSpacing=As}setHScale(As){this.current.textHScale=As/100}setLeading(As){this.current.leading=-As}setFont(As,_s){var jr;const Ps=this.commonObjs.get(As),Hs=this.current;if(!Ps)throw new Error(`Can't find font for ${As}`);if(Hs.fontMatrix=Ps.fontMatrix||ns.FONT_IDENTITY_MATRIX,(Hs.fontMatrix[0]===0||Hs.fontMatrix[3]===0)&&(0,ns.warn)("Invalid font matrix for font "+As),_s<0?(_s=-_s,Hs.fontDirection=-1):Hs.fontDirection=1,this.current.font=Ps,this.current.fontSize=_s,Ps.isType3Font)return;const Ls=Ps.loadedName||"sans-serif",Os=((jr=Ps.systemFontInfo)==null?void 0:jr.css)||`"${Ls}", ${Ps.fallbackName}`;let Ws="normal";Ps.black?Ws="900":Ps.bold&&(Ws="bold");const Gs=Ps.italic?"italic":"normal";let lr=_s;_s<cs?lr=cs:_s>ls&&(lr=ls),this.current.fontSizeScale=_s/lr,this.ctx.font=`${Gs} ${Ws} ${lr}px ${Os}`}setTextRenderingMode(As){this.current.textRenderingMode=As}setTextRise(As){this.current.textRise=As}moveText(As,_s){this.current.x=this.current.lineX+=As,this.current.y=this.current.lineY+=_s}setLeadingMoveText(As,_s){this.setLeading(-_s),this.moveText(As,_s)}setTextMatrix(As,_s,Ps,Hs,Ls,Os){this.current.textMatrix=[As,_s,Ps,Hs,Ls,Os],this.current.textMatrixScale=Math.hypot(As,_s),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(As,_s,Ps,Hs){const Ls=this.ctx,Os=this.current,Ws=Os.font,Gs=Os.textRenderingMode,lr=Os.fontSize/Os.fontSizeScale,jr=Gs&ns.TextRenderingMode.FILL_STROKE_MASK,br=!!(Gs&ns.TextRenderingMode.ADD_TO_PATH_FLAG),Nr=Os.patternFill&&!Ws.missingFile;let wr;(Ws.disableFontFace||br||Nr)&&(wr=Ws.getPathGenerator(this.commonObjs,As)),Ws.disableFontFace||Nr?(Ls.save(),Ls.translate(_s,Ps),Ls.beginPath(),wr(Ls,lr),Hs&&Ls.setTransform(...Hs),(jr===ns.TextRenderingMode.FILL||jr===ns.TextRenderingMode.FILL_STROKE)&&Ls.fill(),(jr===ns.TextRenderingMode.STROKE||jr===ns.TextRenderingMode.FILL_STROKE)&&Ls.stroke(),Ls.restore()):((jr===ns.TextRenderingMode.FILL||jr===ns.TextRenderingMode.FILL_STROKE)&&Ls.fillText(As,_s,Ps),(jr===ns.TextRenderingMode.STROKE||jr===ns.TextRenderingMode.FILL_STROKE)&&Ls.strokeText(As,_s,Ps)),br&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,rs.getCurrentTransform)(Ls),x:_s,y:Ps,fontSize:lr,addToPath:wr})}get isFontSubpixelAAEnabled(){const{context:As}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);As.scale(1.5,1),As.fillText("I",0,10);const _s=As.getImageData(0,0,10,10).data;let Ps=!1;for(let Hs=3;Hs<_s.length;Hs+=4)if(_s[Hs]>0&&_s[Hs]<255){Ps=!0;break}return(0,ns.shadow)(this,"isFontSubpixelAAEnabled",Ps)}showText(As){const _s=this.current,Ps=_s.font;if(Ps.isType3Font)return this.showType3Text(As);const Hs=_s.fontSize;if(Hs===0)return;const Ls=this.ctx,Os=_s.fontSizeScale,Ws=_s.charSpacing,Gs=_s.wordSpacing,lr=_s.fontDirection,jr=_s.textHScale*lr,br=As.length,Nr=Ps.vertical,wr=Nr?1:-1,dr=Ps.defaultVMetrics,hr=Hs*_s.fontMatrix[0],Bs=_s.textRenderingMode===ns.TextRenderingMode.FILL&&!Ps.disableFontFace&&!_s.patternFill;Ls.save(),Ls.transform(..._s.textMatrix),Ls.translate(_s.x,_s.y+_s.textRise),lr>0?Ls.scale(jr,-1):Ls.scale(jr,1);let qs;if(_s.patternFill){Ls.save();const Cr=_s.fillColor.getPattern(Ls,this,(0,rs.getCurrentTransformInverse)(Ls),os.PathType.FILL);qs=(0,rs.getCurrentTransform)(Ls),Ls.restore(),Ls.fillStyle=Cr}let cr=_s.lineWidth;const xr=_s.textMatrixScale;if(xr===0||cr===0){const Cr=_s.textRenderingMode&ns.TextRenderingMode.FILL_STROKE_MASK;(Cr===ns.TextRenderingMode.STROKE||Cr===ns.TextRenderingMode.FILL_STROKE)&&(cr=this.getSinglePixelWidth())}else cr/=xr;if(Os!==1&&(Ls.scale(Os,Os),cr/=Os),Ls.lineWidth=cr,Ps.isInvalidPDFjsFont){const Cr=[];let ur=0;for(const Pr of As)Cr.push(Pr.unicode),ur+=Pr.width;Ls.fillText(Cr.join(""),0,0),_s.x+=ur*hr*jr,Ls.restore(),this.compose();return}let yr=0,Ar;for(Ar=0;Ar<br;++Ar){const Cr=As[Ar];if(typeof Cr=="number"){yr+=wr*Cr*Hs/1e3;continue}let ur=!1;const Pr=(Cr.isSpace?Gs:0)+Ws,Tr=Cr.fontChar,Xr=Cr.accent;let Vr,Qr,Or=Cr.width;if(Nr){const Zr=Cr.vmetric||dr,to=-(Cr.vmetric?Zr[1]:Or*.5)*hr,kr=Zr[2]*hr;Or=Zr?-Zr[0]:Or,Vr=to/Os,Qr=(yr+kr)/Os}else Vr=yr/Os,Qr=0;if(Ps.remeasure&&Or>0){const Zr=Ls.measureText(Tr).width*1e3/Hs*Os;if(Or<Zr&&this.isFontSubpixelAAEnabled){const to=Or/Zr;ur=!0,Ls.save(),Ls.scale(to,1),Vr/=to}else Or!==Zr&&(Vr+=(Or-Zr)/2e3*Hs/Os)}if(this.contentVisible&&(Cr.isInFont||Ps.missingFile)){if(Bs&&!Xr)Ls.fillText(Tr,Vr,Qr);else if(this.paintChar(Tr,Vr,Qr,qs),Xr){const Zr=Vr+Hs*Xr.offset.x/Os,to=Qr-Hs*Xr.offset.y/Os;this.paintChar(Xr.fontChar,Zr,to,qs)}}const zr=Nr?Or*hr-Pr*lr:Or*hr+Pr*lr;yr+=zr,ur&&Ls.restore()}Nr?_s.y-=yr:_s.x+=yr*jr,Ls.restore(),this.compose()}showType3Text(As){const _s=this.ctx,Ps=this.current,Hs=Ps.font,Ls=Ps.fontSize,Os=Ps.fontDirection,Ws=Hs.vertical?1:-1,Gs=Ps.charSpacing,lr=Ps.wordSpacing,jr=Ps.textHScale*Os,br=Ps.fontMatrix||ns.FONT_IDENTITY_MATRIX,Nr=As.length,wr=Ps.textRenderingMode===ns.TextRenderingMode.INVISIBLE;let dr,hr,Bs,qs;if(!(wr||Ls===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,_s.save(),_s.transform(...Ps.textMatrix),_s.translate(Ps.x,Ps.y),_s.scale(jr,Os),dr=0;dr<Nr;++dr){if(hr=As[dr],typeof hr=="number"){qs=Ws*hr*Ls/1e3,this.ctx.translate(qs,0),Ps.x+=qs*jr;continue}const cr=(hr.isSpace?lr:0)+Gs,xr=Hs.charProcOperatorList[hr.operatorListId];if(!xr){(0,ns.warn)(`Type3 character "${hr.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=hr,this.save(),_s.scale(Ls,Ls),_s.transform(...br),this.executeOperatorList(xr),this.restore()),Bs=ns.Util.applyTransform([hr.width,0],br)[0]*Ls+cr,_s.translate(Bs,0),Ps.x+=Bs*jr}_s.restore(),this.processingType3=null}}setCharWidth(As,_s){}setCharWidthAndBounds(As,_s,Ps,Hs,Ls,Os){this.ctx.rect(Ps,Hs,Ls-Ps,Os-Hs),this.ctx.clip(),this.endPath()}getColorN_Pattern(As){let _s;if(As[0]==="TilingPattern"){const Ps=As[1],Hs=this.baseTransform||(0,rs.getCurrentTransform)(this.ctx),Ls={createCanvasGraphics:Os=>new Xs(Os,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};_s=new os.TilingPattern(As,Ps,this.ctx,Ls,Hs)}else _s=this._getPattern(As[1],As[2]);return _s}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(As,_s,Ps){const Hs=ns.Util.makeHexColor(As,_s,Ps);this.ctx.strokeStyle=Hs,this.current.strokeColor=Hs}setFillRGBColor(As,_s,Ps){const Hs=ns.Util.makeHexColor(As,_s,Ps);this.ctx.fillStyle=Hs,this.current.fillColor=Hs,this.current.patternFill=!1}_getPattern(As,_s=null){let Ps;return this.cachedPatterns.has(As)?Ps=this.cachedPatterns.get(As):(Ps=(0,os.getShadingPattern)(this.getObject(As)),this.cachedPatterns.set(As,Ps)),_s&&(Ps.matrix=_s),Ps}shadingFill(As){if(!this.contentVisible)return;const _s=this.ctx;this.save();const Ps=this._getPattern(As);_s.fillStyle=Ps.getPattern(_s,this,(0,rs.getCurrentTransformInverse)(_s),os.PathType.SHADING);const Hs=(0,rs.getCurrentTransformInverse)(_s);if(Hs){const{width:Ls,height:Os}=_s.canvas,[Ws,Gs,lr,jr]=ns.Util.getAxialAlignedBoundingBox([0,0,Ls,Os],Hs);this.ctx.fillRect(Ws,Gs,lr-Ws,jr-Gs)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,ns.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,ns.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(As,_s){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(As)&&As.length===6&&this.transform(...As),this.baseTransform=(0,rs.getCurrentTransform)(this.ctx),_s)){const Ps=_s[2]-_s[0],Hs=_s[3]-_s[1];this.ctx.rect(_s[0],_s[1],Ps,Hs),this.current.updateRectMinMax((0,rs.getCurrentTransform)(this.ctx),_s),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(As){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const _s=this.ctx;As.isolated||(0,ns.info)("TODO: Support non-isolated groups."),As.knockout&&(0,ns.warn)("Knockout groups not supported.");const Ps=(0,rs.getCurrentTransform)(_s);if(As.matrix&&_s.transform(...As.matrix),!As.bbox)throw new Error("Bounding box is required.");let Hs=ns.Util.getAxialAlignedBoundingBox(As.bbox,(0,rs.getCurrentTransform)(_s));const Ls=[0,0,_s.canvas.width,_s.canvas.height];Hs=ns.Util.intersect(Hs,Ls)||[0,0,0,0];const Os=Math.floor(Hs[0]),Ws=Math.floor(Hs[1]);let Gs=Math.max(Math.ceil(Hs[2])-Os,1),lr=Math.max(Math.ceil(Hs[3])-Ws,1),jr=1,br=1;Gs>us&&(jr=Gs/us,Gs=us),lr>us&&(br=lr/us,lr=us),this.current.startNewPathAndClipBox([0,0,Gs,lr]);let Nr="groupAt"+this.groupLevel;As.smask&&(Nr+="_smask_"+this.smaskCounter++%2);const wr=this.cachedCanvases.getCanvas(Nr,Gs,lr),dr=wr.context;dr.scale(1/jr,1/br),dr.translate(-Os,-Ws),dr.transform(...Ps),As.smask?this.smaskStack.push({canvas:wr.canvas,context:dr,offsetX:Os,offsetY:Ws,scaleX:jr,scaleY:br,subtype:As.smask.subtype,backdrop:As.smask.backdrop,transferMap:As.smask.transferMap||null,startTransformInverse:null}):(_s.setTransform(1,0,0,1,0,0),_s.translate(Os,Ws),_s.scale(jr,br),_s.save()),ys(_s,dr),this.ctx=dr,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(_s),this.groupLevel++}endGroup(As){if(!this.contentVisible)return;this.groupLevel--;const _s=this.ctx,Ps=this.groupStack.pop();if(this.ctx=Ps,this.ctx.imageSmoothingEnabled=!1,As.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Hs=(0,rs.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Hs);const Ls=ns.Util.getAxialAlignedBoundingBox([0,0,_s.canvas.width,_s.canvas.height],Hs);this.ctx.drawImage(_s.canvas,0,0),this.ctx.restore(),this.compose(Ls)}}beginAnnotation(As,_s,Ps,Hs,Ls){if(ar(this,Ks,na).call(this),Rs(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(_s)&&_s.length===4){const Os=_s[2]-_s[0],Ws=_s[3]-_s[1];if(Ls&&this.annotationCanvasMap){Ps=Ps.slice(),Ps[4]-=_s[0],Ps[5]-=_s[1],_s=_s.slice(),_s[0]=_s[1]=0,_s[2]=Os,_s[3]=Ws;const[Gs,lr]=ns.Util.singularValueDecompose2dScale((0,rs.getCurrentTransform)(this.ctx)),{viewportScale:jr}=this,br=Math.ceil(Os*this.outputScaleX*jr),Nr=Math.ceil(Ws*this.outputScaleY*jr);this.annotationCanvas=this.canvasFactory.create(br,Nr);const{canvas:wr,context:dr}=this.annotationCanvas;this.annotationCanvasMap.set(As,wr),this.annotationCanvas.savedCtx=this.ctx,this.ctx=dr,this.ctx.save(),this.ctx.setTransform(Gs,0,0,-lr,0,Ws*lr),Rs(this.ctx)}else Rs(this.ctx),this.ctx.rect(_s[0],_s[1],Os,Ws),this.ctx.clip(),this.endPath()}this.current=new hs(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...Ps),this.transform(...Hs)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),ar(this,Ks,xa).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(As){if(!this.contentVisible)return;const _s=As.count;As=this.getObject(As.data,As),As.count=_s;const Ps=this.ctx,Hs=this.processingType3;if(Hs&&(Hs.compiled===void 0&&(Hs.compiled=ms(As)),Hs.compiled)){Hs.compiled(Ps);return}const Ls=this._createMaskCanvas(As),Os=Ls.canvas;Ps.save(),Ps.setTransform(1,0,0,1,0,0),Ps.drawImage(Os,Ls.offsetX,Ls.offsetY),Ps.restore(),this.compose()}paintImageMaskXObjectRepeat(As,_s,Ps=0,Hs=0,Ls,Os){if(!this.contentVisible)return;As=this.getObject(As.data,As);const Ws=this.ctx;Ws.save();const Gs=(0,rs.getCurrentTransform)(Ws);Ws.transform(_s,Ps,Hs,Ls,0,0);const lr=this._createMaskCanvas(As);Ws.setTransform(1,0,0,1,lr.offsetX-Gs[4],lr.offsetY-Gs[5]);for(let jr=0,br=Os.length;jr<br;jr+=2){const Nr=ns.Util.transform(Gs,[_s,Ps,Hs,Ls,Os[jr],Os[jr+1]]),[wr,dr]=ns.Util.applyTransform([0,0],Nr);Ws.drawImage(lr.canvas,wr,dr)}Ws.restore(),this.compose()}paintImageMaskXObjectGroup(As){if(!this.contentVisible)return;const _s=this.ctx,Ps=this.current.fillColor,Hs=this.current.patternFill;for(const Ls of As){const{data:Os,width:Ws,height:Gs,transform:lr}=Ls,jr=this.cachedCanvases.getCanvas("maskCanvas",Ws,Gs),br=jr.context;br.save();const Nr=this.getObject(Os,Ls);ws(br,Nr),br.globalCompositeOperation="source-in",br.fillStyle=Hs?Ps.getPattern(br,this,(0,rs.getCurrentTransformInverse)(_s),os.PathType.FILL):Ps,br.fillRect(0,0,Ws,Gs),br.restore(),_s.save(),_s.transform(...lr),_s.scale(1,-1),ps(_s,jr.canvas,0,0,Ws,Gs,0,-1,1,1),_s.restore()}this.compose()}paintImageXObject(As){if(!this.contentVisible)return;const _s=this.getObject(As);if(!_s){(0,ns.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(_s)}paintImageXObjectRepeat(As,_s,Ps,Hs){if(!this.contentVisible)return;const Ls=this.getObject(As);if(!Ls){(0,ns.warn)("Dependent image isn't ready yet");return}const Os=Ls.width,Ws=Ls.height,Gs=[];for(let lr=0,jr=Hs.length;lr<jr;lr+=2)Gs.push({transform:[_s,0,0,Ps,Hs[lr],Hs[lr+1]],x:0,y:0,w:Os,h:Ws});this.paintInlineImageXObjectGroup(Ls,Gs)}applyTransferMapsToCanvas(As){return this.current.transferMaps!=="none"&&(As.filter=this.current.transferMaps,As.drawImage(As.canvas,0,0),As.filter="none"),As.canvas}applyTransferMapsToBitmap(As){if(this.current.transferMaps==="none")return As.bitmap;const{bitmap:_s,width:Ps,height:Hs}=As,Ls=this.cachedCanvases.getCanvas("inlineImage",Ps,Hs),Os=Ls.context;return Os.filter=this.current.transferMaps,Os.drawImage(_s,0,0),Os.filter="none",Ls.canvas}paintInlineImageXObject(As){if(!this.contentVisible)return;const _s=As.width,Ps=As.height,Hs=this.ctx;if(this.save(),!ns.isNodeJS){const{filter:Ws}=Hs;Ws!=="none"&&Ws!==""&&(Hs.filter="none")}Hs.scale(1/_s,-1/Ps);let Ls;if(As.bitmap)Ls=this.applyTransferMapsToBitmap(As);else if(typeof HTMLElement=="function"&&As instanceof HTMLElement||!As.data)Ls=As;else{const Gs=this.cachedCanvases.getCanvas("inlineImage",_s,Ps).context;vs(Gs,As),Ls=this.applyTransferMapsToCanvas(Gs)}const Os=this._scaleImage(Ls,(0,rs.getCurrentTransformInverse)(Hs));Hs.imageSmoothingEnabled=Ms((0,rs.getCurrentTransform)(Hs),As.interpolate),ps(Hs,Os.img,0,0,Os.paintWidth,Os.paintHeight,0,-Ps,_s,Ps),this.compose(),this.restore()}paintInlineImageXObjectGroup(As,_s){if(!this.contentVisible)return;const Ps=this.ctx;let Hs;if(As.bitmap)Hs=As.bitmap;else{const Ls=As.width,Os=As.height,Gs=this.cachedCanvases.getCanvas("inlineImage",Ls,Os).context;vs(Gs,As),Hs=this.applyTransferMapsToCanvas(Gs)}for(const Ls of _s)Ps.save(),Ps.transform(...Ls.transform),Ps.scale(1,-1),ps(Ps,Hs,Ls.x,Ls.y,Ls.w,Ls.h,0,-1,1,1),Ps.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(As){}markPointProps(As,_s){}beginMarkedContent(As){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(As,_s){As==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(_s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(As){const _s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(As);const Ps=this.ctx;this.pendingClip&&(_s||(this.pendingClip===Zs?Ps.clip("evenodd"):Ps.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),Ps.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const As=(0,rs.getCurrentTransform)(this.ctx);if(As[1]===0&&As[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(As[0]),Math.abs(As[3]));else{const _s=Math.abs(As[0]*As[3]-As[2]*As[1]),Ps=Math.hypot(As[0],As[2]),Hs=Math.hypot(As[1],As[3]);this._cachedGetSinglePixelWidth=Math.max(Ps,Hs)/_s}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:As}=this.current,{a:_s,b:Ps,c:Hs,d:Ls}=this.ctx.getTransform();let Os,Ws;if(Ps===0&&Hs===0){const Gs=Math.abs(_s),lr=Math.abs(Ls);if(Gs===lr)if(As===0)Os=Ws=1/Gs;else{const jr=Gs*As;Os=Ws=jr<1?1/jr:1}else if(As===0)Os=1/Gs,Ws=1/lr;else{const jr=Gs*As,br=lr*As;Os=jr<1?1/jr:1,Ws=br<1?1/br:1}}else{const Gs=Math.abs(_s*Ls-Ps*Hs),lr=Math.hypot(_s,Ps),jr=Math.hypot(Hs,Ls);if(As===0)Os=jr/Gs,Ws=lr/Gs;else{const br=As*Gs;Os=jr>br?jr/br:1,Ws=lr>br?lr/br:1}}this._cachedScaleForStroking[0]=Os,this._cachedScaleForStroking[1]=Ws}return this._cachedScaleForStroking}rescaleAndStroke(As){const{ctx:_s}=this,{lineWidth:Ps}=this.current,[Hs,Ls]=this.getScaleForStroking();if(_s.lineWidth=Ps||1,Hs===1&&Ls===1){_s.stroke();return}const Os=_s.getLineDash();if(As&&_s.save(),_s.scale(Hs,Ls),Os.length>0){const Ws=Math.max(Hs,Ls);_s.setLineDash(Os.map(Gs=>Gs/Ws)),_s.lineDashOffset/=Ws}_s.stroke(),As&&_s.restore()}isContentVisible(){for(let As=this.markedContentStack.length-1;As>=0;As--)if(!this.markedContentStack[As].visible)return!1;return!0}};Ks=new WeakSet,na=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},xa=function(){if(this.pageColors){const As=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(As!=="none"){const _s=this.ctx.filter;this.ctx.filter=As,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=_s}}};let Vs=Xs;ts.CanvasGraphics=Vs;for(const Fs in ns.OPS)Vs.prototype[Fs]!==void 0&&(Vs.prototype[ns.OPS[Fs]]=Vs.prototype[Fs])},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.TilingPattern=ts.PathType=void 0,ts.getShadingPattern=gs;var ns=ss(1),rs=ss(6);const os={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};ts.PathType=os;function as(ms,hs){if(!hs)return;const vs=hs[2]-hs[0],ws=hs[3]-hs[1],ys=new Path2D;ys.rect(hs[0],hs[1],vs,ws),ms.clip(ys)}class cs{constructor(){this.constructor===cs&&(0,ns.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,ns.unreachable)("Abstract method `getPattern` called.")}}class ls extends cs{constructor(hs){super(),this._type=hs[1],this._bbox=hs[2],this._colorStops=hs[3],this._p0=hs[4],this._p1=hs[5],this._r0=hs[6],this._r1=hs[7],this.matrix=null}_createGradient(hs){let vs;this._type==="axial"?vs=hs.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(vs=hs.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const ws of this._colorStops)vs.addColorStop(ws[0],ws[1]);return vs}getPattern(hs,vs,ws,ys){let Rs;if(ys===os.STROKE||ys===os.FILL){const bs=vs.current.getClippedPathBoundingBox(ys,(0,rs.getCurrentTransform)(hs))||[0,0,0,0],Ns=Math.ceil(bs[2]-bs[0])||1,Ss=Math.ceil(bs[3]-bs[1])||1,Ts=vs.cachedCanvases.getCanvas("pattern",Ns,Ss,!0),Cs=Ts.context;Cs.clearRect(0,0,Cs.canvas.width,Cs.canvas.height),Cs.beginPath(),Cs.rect(0,0,Cs.canvas.width,Cs.canvas.height),Cs.translate(-bs[0],-bs[1]),ws=ns.Util.transform(ws,[1,0,0,1,bs[0],bs[1]]),Cs.transform(...vs.baseTransform),this.matrix&&Cs.transform(...this.matrix),as(Cs,this._bbox),Cs.fillStyle=this._createGradient(Cs),Cs.fill(),Rs=hs.createPattern(Ts.canvas,"no-repeat");const Ms=new DOMMatrix(ws);Rs.setTransform(Ms)}else as(hs,this._bbox),Rs=this._createGradient(hs);return Rs}}function us(ms,hs,vs,ws,ys,Rs,bs,Ns){const Ss=hs.coords,Ts=hs.colors,Cs=ms.data,Ms=ms.width*4;let Is;Ss[vs+1]>Ss[ws+1]&&(Is=vs,vs=ws,ws=Is,Is=Rs,Rs=bs,bs=Is),Ss[ws+1]>Ss[ys+1]&&(Is=ws,ws=ys,ys=Is,Is=bs,bs=Ns,Ns=Is),Ss[vs+1]>Ss[ws+1]&&(Is=vs,vs=ws,ws=Is,Is=Rs,Rs=bs,bs=Is);const Qs=(Ss[vs]+hs.offsetX)*hs.scaleX,Ys=(Ss[vs+1]+hs.offsetY)*hs.scaleY,Zs=(Ss[ws]+hs.offsetX)*hs.scaleX,Vs=(Ss[ws+1]+hs.offsetY)*hs.scaleY,Ks=(Ss[ys]+hs.offsetX)*hs.scaleX,Ds=(Ss[ys+1]+hs.offsetY)*hs.scaleY;if(Ys>=Ds)return;const $s=Ts[Rs],Xs=Ts[Rs+1],Fs=Ts[Rs+2],As=Ts[bs],_s=Ts[bs+1],Ps=Ts[bs+2],Hs=Ts[Ns],Ls=Ts[Ns+1],Os=Ts[Ns+2],Ws=Math.round(Ys),Gs=Math.round(Ds);let lr,jr,br,Nr,wr,dr,hr,Bs;for(let qs=Ws;qs<=Gs;qs++){if(qs<Vs){const Cr=qs<Ys?0:(Ys-qs)/(Ys-Vs);lr=Qs-(Qs-Zs)*Cr,jr=$s-($s-As)*Cr,br=Xs-(Xs-_s)*Cr,Nr=Fs-(Fs-Ps)*Cr}else{let Cr;qs>Ds?Cr=1:Vs===Ds?Cr=0:Cr=(Vs-qs)/(Vs-Ds),lr=Zs-(Zs-Ks)*Cr,jr=As-(As-Hs)*Cr,br=_s-(_s-Ls)*Cr,Nr=Ps-(Ps-Os)*Cr}let cr;qs<Ys?cr=0:qs>Ds?cr=1:cr=(Ys-qs)/(Ys-Ds),wr=Qs-(Qs-Ks)*cr,dr=$s-($s-Hs)*cr,hr=Xs-(Xs-Ls)*cr,Bs=Fs-(Fs-Os)*cr;const xr=Math.round(Math.min(lr,wr)),yr=Math.round(Math.max(lr,wr));let Ar=Ms*qs+xr*4;for(let Cr=xr;Cr<=yr;Cr++)cr=(lr-Cr)/(lr-wr),cr<0?cr=0:cr>1&&(cr=1),Cs[Ar++]=jr-(jr-dr)*cr|0,Cs[Ar++]=br-(br-hr)*cr|0,Cs[Ar++]=Nr-(Nr-Bs)*cr|0,Cs[Ar++]=255}}function ds(ms,hs,vs){const ws=hs.coords,ys=hs.colors;let Rs,bs;switch(hs.type){case"lattice":const Ns=hs.verticesPerRow,Ss=Math.floor(ws.length/Ns)-1,Ts=Ns-1;for(Rs=0;Rs<Ss;Rs++){let Cs=Rs*Ns;for(let Ms=0;Ms<Ts;Ms++,Cs++)us(ms,vs,ws[Cs],ws[Cs+1],ws[Cs+Ns],ys[Cs],ys[Cs+1],ys[Cs+Ns]),us(ms,vs,ws[Cs+Ns+1],ws[Cs+1],ws[Cs+Ns],ys[Cs+Ns+1],ys[Cs+1],ys[Cs+Ns])}break;case"triangles":for(Rs=0,bs=ws.length;Rs<bs;Rs+=3)us(ms,vs,ws[Rs],ws[Rs+1],ws[Rs+2],ys[Rs],ys[Rs+1],ys[Rs+2]);break;default:throw new Error("illegal figure")}}class xs extends cs{constructor(hs){super(),this._coords=hs[2],this._colors=hs[3],this._figures=hs[4],this._bounds=hs[5],this._bbox=hs[7],this._background=hs[8],this.matrix=null}_createMeshCanvas(hs,vs,ws){const Ns=Math.floor(this._bounds[0]),Ss=Math.floor(this._bounds[1]),Ts=Math.ceil(this._bounds[2])-Ns,Cs=Math.ceil(this._bounds[3])-Ss,Ms=Math.min(Math.ceil(Math.abs(Ts*hs[0]*1.1)),3e3),Is=Math.min(Math.ceil(Math.abs(Cs*hs[1]*1.1)),3e3),Qs=Ts/Ms,Ys=Cs/Is,Zs={coords:this._coords,colors:this._colors,offsetX:-Ns,offsetY:-Ss,scaleX:1/Qs,scaleY:1/Ys},Vs=Ms+2*2,Ks=Is+2*2,Ds=ws.getCanvas("mesh",Vs,Ks,!1),$s=Ds.context,Xs=$s.createImageData(Ms,Is);if(vs){const As=Xs.data;for(let _s=0,Ps=As.length;_s<Ps;_s+=4)As[_s]=vs[0],As[_s+1]=vs[1],As[_s+2]=vs[2],As[_s+3]=255}for(const As of this._figures)ds(Xs,As,Zs);return $s.putImageData(Xs,2,2),{canvas:Ds.canvas,offsetX:Ns-2*Qs,offsetY:Ss-2*Ys,scaleX:Qs,scaleY:Ys}}getPattern(hs,vs,ws,ys){as(hs,this._bbox);let Rs;if(ys===os.SHADING)Rs=ns.Util.singularValueDecompose2dScale((0,rs.getCurrentTransform)(hs));else if(Rs=ns.Util.singularValueDecompose2dScale(vs.baseTransform),this.matrix){const Ns=ns.Util.singularValueDecompose2dScale(this.matrix);Rs=[Rs[0]*Ns[0],Rs[1]*Ns[1]]}const bs=this._createMeshCanvas(Rs,ys===os.SHADING?null:this._background,vs.cachedCanvases);return ys!==os.SHADING&&(hs.setTransform(...vs.baseTransform),this.matrix&&hs.transform(...this.matrix)),hs.translate(bs.offsetX,bs.offsetY),hs.scale(bs.scaleX,bs.scaleY),hs.createPattern(bs.canvas,"no-repeat")}}class fs extends cs{getPattern(){return"hotpink"}}function gs(ms){switch(ms[0]){case"RadialAxial":return new ls(ms);case"Mesh":return new xs(ms);case"Dummy":return new fs}throw new Error(`Unknown IR type: ${ms[0]}`)}const Es={COLORED:1,UNCOLORED:2},ps=class ps{constructor(hs,vs,ws,ys,Rs){this.operatorList=hs[2],this.matrix=hs[3]||[1,0,0,1,0,0],this.bbox=hs[4],this.xstep=hs[5],this.ystep=hs[6],this.paintType=hs[7],this.tilingType=hs[8],this.color=vs,this.ctx=ws,this.canvasGraphicsFactory=ys,this.baseTransform=Rs}createPatternCanvas(hs){const vs=this.operatorList,ws=this.bbox,ys=this.xstep,Rs=this.ystep,bs=this.paintType,Ns=this.tilingType,Ss=this.color,Ts=this.canvasGraphicsFactory;(0,ns.info)("TilingType: "+Ns);const Cs=ws[0],Ms=ws[1],Is=ws[2],Qs=ws[3],Ys=ns.Util.singularValueDecompose2dScale(this.matrix),Zs=ns.Util.singularValueDecompose2dScale(this.baseTransform),Vs=[Ys[0]*Zs[0],Ys[1]*Zs[1]],Ks=this.getSizeAndScale(ys,this.ctx.canvas.width,Vs[0]),Ds=this.getSizeAndScale(Rs,this.ctx.canvas.height,Vs[1]),$s=hs.cachedCanvases.getCanvas("pattern",Ks.size,Ds.size,!0),Xs=$s.context,Fs=Ts.createCanvasGraphics(Xs);Fs.groupLevel=hs.groupLevel,this.setFillAndStrokeStyleToContext(Fs,bs,Ss);let As=Cs,_s=Ms,Ps=Is,Hs=Qs;return Cs<0&&(As=0,Ps+=Math.abs(Cs)),Ms<0&&(_s=0,Hs+=Math.abs(Ms)),Xs.translate(-(Ks.scale*As),-(Ds.scale*_s)),Fs.transform(Ks.scale,0,0,Ds.scale,0,0),Xs.save(),this.clipBbox(Fs,As,_s,Ps,Hs),Fs.baseTransform=(0,rs.getCurrentTransform)(Fs.ctx),Fs.executeOperatorList(vs),Fs.endDrawing(),{canvas:$s.canvas,scaleX:Ks.scale,scaleY:Ds.scale,offsetX:As,offsetY:_s}}getSizeAndScale(hs,vs,ws){hs=Math.abs(hs);const ys=Math.max(ps.MAX_PATTERN_SIZE,vs);let Rs=Math.ceil(hs*ws);return Rs>=ys?Rs=ys:ws=Rs/hs,{scale:ws,size:Rs}}clipBbox(hs,vs,ws,ys,Rs){const bs=ys-vs,Ns=Rs-ws;hs.ctx.rect(vs,ws,bs,Ns),hs.current.updateRectMinMax((0,rs.getCurrentTransform)(hs.ctx),[vs,ws,ys,Rs]),hs.clip(),hs.endPath()}setFillAndStrokeStyleToContext(hs,vs,ws){const ys=hs.ctx,Rs=hs.current;switch(vs){case Es.COLORED:const bs=this.ctx;ys.fillStyle=bs.fillStyle,ys.strokeStyle=bs.strokeStyle,Rs.fillColor=bs.fillStyle,Rs.strokeColor=bs.strokeStyle;break;case Es.UNCOLORED:const Ns=ns.Util.makeHexColor(ws[0],ws[1],ws[2]);ys.fillStyle=Ns,ys.strokeStyle=Ns,Rs.fillColor=Ns,Rs.strokeColor=Ns;break;default:throw new ns.FormatError(`Unsupported paint type: ${vs}`)}}getPattern(hs,vs,ws,ys){let Rs=ws;ys!==os.SHADING&&(Rs=ns.Util.transform(Rs,vs.baseTransform),this.matrix&&(Rs=ns.Util.transform(Rs,this.matrix)));const bs=this.createPatternCanvas(vs);let Ns=new DOMMatrix(Rs);Ns=Ns.translate(bs.offsetX,bs.offsetY),Ns=Ns.scale(1/bs.scaleX,1/bs.scaleY);const Ss=hs.createPattern(bs.canvas,"repeat");return Ss.setTransform(Ns),Ss}};eo(ps,"MAX_PATTERN_SIZE",3e3);let js=ps;ts.TilingPattern=js},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.convertBlackAndWhiteToRGBA=os,ts.convertToRGBA=rs,ts.grayToRGBA=cs;var ns=ss(1);function rs(ls){switch(ls.kind){case ns.ImageKind.GRAYSCALE_1BPP:return os(ls);case ns.ImageKind.RGB_24BPP:return as(ls)}return null}function os({src:ls,srcPos:us=0,dest:ds,width:xs,height:fs,nonBlackColor:gs=4294967295,inverseDecode:Es=!1}){const js=ns.FeatureTest.isLittleEndian?4278190080:255,[ps,ms]=Es?[gs,js]:[js,gs],hs=xs>>3,vs=xs&7,ws=ls.length;ds=new Uint32Array(ds.buffer);let ys=0;for(let Rs=0;Rs<fs;Rs++){for(const Ns=us+hs;us<Ns;us++){const Ss=us<ws?ls[us]:255;ds[ys++]=Ss&128?ms:ps,ds[ys++]=Ss&64?ms:ps,ds[ys++]=Ss&32?ms:ps,ds[ys++]=Ss&16?ms:ps,ds[ys++]=Ss&8?ms:ps,ds[ys++]=Ss&4?ms:ps,ds[ys++]=Ss&2?ms:ps,ds[ys++]=Ss&1?ms:ps}if(vs===0)continue;const bs=us<ws?ls[us++]:255;for(let Ns=0;Ns<vs;Ns++)ds[ys++]=bs&1<<7-Ns?ms:ps}return{srcPos:us,destPos:ys}}function as({src:ls,srcPos:us=0,dest:ds,destPos:xs=0,width:fs,height:gs}){let Es=0;const js=ls.length>>2,ps=new Uint32Array(ls.buffer,us,js);if(ns.FeatureTest.isLittleEndian){for(;Es<js-2;Es+=3,xs+=4){const ms=ps[Es],hs=ps[Es+1],vs=ps[Es+2];ds[xs]=ms|4278190080,ds[xs+1]=ms>>>24|hs<<8|4278190080,ds[xs+2]=hs>>>16|vs<<16|4278190080,ds[xs+3]=vs>>>8|4278190080}for(let ms=Es*4,hs=ls.length;ms<hs;ms+=3)ds[xs++]=ls[ms]|ls[ms+1]<<8|ls[ms+2]<<16|4278190080}else{for(;Es<js-2;Es+=3,xs+=4){const ms=ps[Es],hs=ps[Es+1],vs=ps[Es+2];ds[xs]=ms|255,ds[xs+1]=ms<<24|hs>>>8|255,ds[xs+2]=hs<<16|vs>>>16|255,ds[xs+3]=vs<<8|255}for(let ms=Es*4,hs=ls.length;ms<hs;ms+=3)ds[xs++]=ls[ms]<<24|ls[ms+1]<<16|ls[ms+2]<<8|255}return{srcPos:us,destPos:xs}}function cs(ls,us){if(ns.FeatureTest.isLittleEndian)for(let ds=0,xs=ls.length;ds<xs;ds++)us[ds]=ls[ds]*65793|4278190080;else for(let ds=0,xs=ls.length;ds<xs;ds++)us[ds]=ls[ds]*16843008|255}},(es,ts)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.GlobalWorkerOptions=void 0;const ss=Object.create(null);ts.GlobalWorkerOptions=ss,ss.workerPort=null,ss.workerSrc=""},(es,ts,ss)=>{var ls,Gl,Xl,_o;Object.defineProperty(ts,"__esModule",{value:!0}),ts.MessageHandler=void 0;var ns=ss(1);const rs={DATA:1,ERROR:2},os={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function as(fs){switch(fs instanceof Error||typeof fs=="object"&&fs!==null||(0,ns.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),fs.name){case"AbortException":return new ns.AbortException(fs.message);case"MissingPDFException":return new ns.MissingPDFException(fs.message);case"PasswordException":return new ns.PasswordException(fs.message,fs.code);case"UnexpectedResponseException":return new ns.UnexpectedResponseException(fs.message,fs.status);case"UnknownErrorException":return new ns.UnknownErrorException(fs.message,fs.details);default:return new ns.UnknownErrorException(fs.message,fs.toString())}}class cs{constructor(gs,Es,js){mr(this,ls);this.sourceName=gs,this.targetName=Es,this.comObj=js,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=ps=>{const ms=ps.data;if(ms.targetName!==this.sourceName)return;if(ms.stream){ar(this,ls,Xl).call(this,ms);return}if(ms.callback){const vs=ms.callbackId,ws=this.callbackCapabilities[vs];if(!ws)throw new Error(`Cannot resolve callback ${vs}`);if(delete this.callbackCapabilities[vs],ms.callback===rs.DATA)ws.resolve(ms.data);else if(ms.callback===rs.ERROR)ws.reject(as(ms.reason));else throw new Error("Unexpected callback case");return}const hs=this.actionHandler[ms.action];if(!hs)throw new Error(`Unknown action from worker: ${ms.action}`);if(ms.callbackId){const vs=this.sourceName,ws=ms.sourceName;new Promise(function(ys){ys(hs(ms.data))}).then(function(ys){js.postMessage({sourceName:vs,targetName:ws,callback:rs.DATA,callbackId:ms.callbackId,data:ys})},function(ys){js.postMessage({sourceName:vs,targetName:ws,callback:rs.ERROR,callbackId:ms.callbackId,reason:as(ys)})});return}if(ms.streamId){ar(this,ls,Gl).call(this,ms);return}hs(ms.data)},js.addEventListener("message",this._onComObjOnMessage)}on(gs,Es){const js=this.actionHandler;if(js[gs])throw new Error(`There is already an actionName called "${gs}"`);js[gs]=Es}send(gs,Es,js){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:gs,data:Es},js)}sendWithPromise(gs,Es,js){const ps=this.callbackId++,ms=new ns.PromiseCapability;this.callbackCapabilities[ps]=ms;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:gs,callbackId:ps,data:Es},js)}catch(hs){ms.reject(hs)}return ms.promise}sendWithStream(gs,Es,js,ps){const ms=this.streamId++,hs=this.sourceName,vs=this.targetName,ws=this.comObj;return new ReadableStream({start:ys=>{const Rs=new ns.PromiseCapability;return this.streamControllers[ms]={controller:ys,startCall:Rs,pullCall:null,cancelCall:null,isClosed:!1},ws.postMessage({sourceName:hs,targetName:vs,action:gs,streamId:ms,data:Es,desiredSize:ys.desiredSize},ps),Rs.promise},pull:ys=>{const Rs=new ns.PromiseCapability;return this.streamControllers[ms].pullCall=Rs,ws.postMessage({sourceName:hs,targetName:vs,stream:os.PULL,streamId:ms,desiredSize:ys.desiredSize}),Rs.promise},cancel:ys=>{(0,ns.assert)(ys instanceof Error,"cancel must have a valid reason");const Rs=new ns.PromiseCapability;return this.streamControllers[ms].cancelCall=Rs,this.streamControllers[ms].isClosed=!0,ws.postMessage({sourceName:hs,targetName:vs,stream:os.CANCEL,streamId:ms,reason:as(ys)}),Rs.promise}},js)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}ls=new WeakSet,Gl=function(gs){const Es=gs.streamId,js=this.sourceName,ps=gs.sourceName,ms=this.comObj,hs=this,vs=this.actionHandler[gs.action],ws={enqueue(ys,Rs=1,bs){if(this.isCancelled)return;const Ns=this.desiredSize;this.desiredSize-=Rs,Ns>0&&this.desiredSize<=0&&(this.sinkCapability=new ns.PromiseCapability,this.ready=this.sinkCapability.promise),ms.postMessage({sourceName:js,targetName:ps,stream:os.ENQUEUE,streamId:Es,chunk:ys},bs)},close(){this.isCancelled||(this.isCancelled=!0,ms.postMessage({sourceName:js,targetName:ps,stream:os.CLOSE,streamId:Es}),delete hs.streamSinks[Es])},error(ys){(0,ns.assert)(ys instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,ms.postMessage({sourceName:js,targetName:ps,stream:os.ERROR,streamId:Es,reason:as(ys)}))},sinkCapability:new ns.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:gs.desiredSize,ready:null};ws.sinkCapability.resolve(),ws.ready=ws.sinkCapability.promise,this.streamSinks[Es]=ws,new Promise(function(ys){ys(vs(gs.data,ws))}).then(function(){ms.postMessage({sourceName:js,targetName:ps,stream:os.START_COMPLETE,streamId:Es,success:!0})},function(ys){ms.postMessage({sourceName:js,targetName:ps,stream:os.START_COMPLETE,streamId:Es,reason:as(ys)})})},Xl=function(gs){const Es=gs.streamId,js=this.sourceName,ps=gs.sourceName,ms=this.comObj,hs=this.streamControllers[Es],vs=this.streamSinks[Es];switch(gs.stream){case os.START_COMPLETE:gs.success?hs.startCall.resolve():hs.startCall.reject(as(gs.reason));break;case os.PULL_COMPLETE:gs.success?hs.pullCall.resolve():hs.pullCall.reject(as(gs.reason));break;case os.PULL:if(!vs){ms.postMessage({sourceName:js,targetName:ps,stream:os.PULL_COMPLETE,streamId:Es,success:!0});break}vs.desiredSize<=0&&gs.desiredSize>0&&vs.sinkCapability.resolve(),vs.desiredSize=gs.desiredSize,new Promise(function(ws){var ys;ws((ys=vs.onPull)==null?void 0:ys.call(vs))}).then(function(){ms.postMessage({sourceName:js,targetName:ps,stream:os.PULL_COMPLETE,streamId:Es,success:!0})},function(ws){ms.postMessage({sourceName:js,targetName:ps,stream:os.PULL_COMPLETE,streamId:Es,reason:as(ws)})});break;case os.ENQUEUE:if((0,ns.assert)(hs,"enqueue should have stream controller"),hs.isClosed)break;hs.controller.enqueue(gs.chunk);break;case os.CLOSE:if((0,ns.assert)(hs,"close should have stream controller"),hs.isClosed)break;hs.isClosed=!0,hs.controller.close(),ar(this,ls,_o).call(this,hs,Es);break;case os.ERROR:(0,ns.assert)(hs,"error should have stream controller"),hs.controller.error(as(gs.reason)),ar(this,ls,_o).call(this,hs,Es);break;case os.CANCEL_COMPLETE:gs.success?hs.cancelCall.resolve():hs.cancelCall.reject(as(gs.reason)),ar(this,ls,_o).call(this,hs,Es);break;case os.CANCEL:if(!vs)break;new Promise(function(ws){var ys;ws((ys=vs.onCancel)==null?void 0:ys.call(vs,as(gs.reason)))}).then(function(){ms.postMessage({sourceName:js,targetName:ps,stream:os.CANCEL_COMPLETE,streamId:Es,success:!0})},function(ws){ms.postMessage({sourceName:js,targetName:ps,stream:os.CANCEL_COMPLETE,streamId:Es,reason:as(ws)})}),vs.sinkCapability.reject(as(gs.reason)),vs.isCancelled=!0,delete this.streamSinks[Es];break;default:throw new Error("Unexpected stream case")}},_o=async function(gs,Es){var js,ps,ms;await Promise.allSettled([(js=gs.startCall)==null?void 0:js.promise,(ps=gs.pullCall)==null?void 0:ps.promise,(ms=gs.cancelCall)==null?void 0:ms.promise]),delete this.streamControllers[Es]},ts.MessageHandler=cs},(es,ts,ss)=>{var os,as;Object.defineProperty(ts,"__esModule",{value:!0}),ts.Metadata=void 0;var ns=ss(1);class rs{constructor({parsedData:ls,rawData:us}){mr(this,os);mr(this,as);fr(this,os,ls),fr(this,as,us)}getRaw(){return ks(this,as)}get(ls){return ks(this,os).get(ls)??null}getAll(){return(0,ns.objectFromMap)(ks(this,os))}has(ls){return ks(this,os).has(ls)}}os=new WeakMap,as=new WeakMap,ts.Metadata=rs},(es,ts,ss)=>{var ls,us,ds,xs,fs,gs,ga;Object.defineProperty(ts,"__esModule",{value:!0}),ts.OptionalContentConfig=void 0;var ns=ss(1),rs=ss(8);const os=Symbol("INTERNAL");class as{constructor(ps,ms){mr(this,ls,!0);this.name=ps,this.intent=ms}get visible(){return ks(this,ls)}_setVisible(ps,ms){ps!==os&&(0,ns.unreachable)("Internal method `_setVisible` called."),fr(this,ls,ms)}}ls=new WeakMap;class cs{constructor(ps){mr(this,gs);mr(this,us,null);mr(this,ds,new Map);mr(this,xs,null);mr(this,fs,null);if(this.name=null,this.creator=null,ps!==null){this.name=ps.name,this.creator=ps.creator,fr(this,fs,ps.order);for(const ms of ps.groups)ks(this,ds).set(ms.id,new as(ms.name,ms.intent));if(ps.baseState==="OFF")for(const ms of ks(this,ds).values())ms._setVisible(os,!1);for(const ms of ps.on)ks(this,ds).get(ms)._setVisible(os,!0);for(const ms of ps.off)ks(this,ds).get(ms)._setVisible(os,!1);fr(this,xs,this.getHash())}}isVisible(ps){if(ks(this,ds).size===0)return!0;if(!ps)return(0,ns.warn)("Optional content group not defined."),!0;if(ps.type==="OCG")return ks(this,ds).has(ps.id)?ks(this,ds).get(ps.id).visible:((0,ns.warn)(`Optional content group not found: ${ps.id}`),!0);if(ps.type==="OCMD"){if(ps.expression)return ar(this,gs,ga).call(this,ps.expression);if(!ps.policy||ps.policy==="AnyOn"){for(const ms of ps.ids){if(!ks(this,ds).has(ms))return(0,ns.warn)(`Optional content group not found: ${ms}`),!0;if(ks(this,ds).get(ms).visible)return!0}return!1}else if(ps.policy==="AllOn"){for(const ms of ps.ids){if(!ks(this,ds).has(ms))return(0,ns.warn)(`Optional content group not found: ${ms}`),!0;if(!ks(this,ds).get(ms).visible)return!1}return!0}else if(ps.policy==="AnyOff"){for(const ms of ps.ids){if(!ks(this,ds).has(ms))return(0,ns.warn)(`Optional content group not found: ${ms}`),!0;if(!ks(this,ds).get(ms).visible)return!0}return!1}else if(ps.policy==="AllOff"){for(const ms of ps.ids){if(!ks(this,ds).has(ms))return(0,ns.warn)(`Optional content group not found: ${ms}`),!0;if(ks(this,ds).get(ms).visible)return!1}return!0}return(0,ns.warn)(`Unknown optional content policy ${ps.policy}.`),!0}return(0,ns.warn)(`Unknown group type ${ps.type}.`),!0}setVisibility(ps,ms=!0){if(!ks(this,ds).has(ps)){(0,ns.warn)(`Optional content group not found: ${ps}`);return}ks(this,ds).get(ps)._setVisible(os,!!ms),fr(this,us,null)}get hasInitialVisibility(){return ks(this,xs)===null||this.getHash()===ks(this,xs)}getOrder(){return ks(this,ds).size?ks(this,fs)?ks(this,fs).slice():[...ks(this,ds).keys()]:null}getGroups(){return ks(this,ds).size>0?(0,ns.objectFromMap)(ks(this,ds)):null}getGroup(ps){return ks(this,ds).get(ps)||null}getHash(){if(ks(this,us)!==null)return ks(this,us);const ps=new rs.MurmurHash3_64;for(const[ms,hs]of ks(this,ds))ps.update(`${ms}:${hs.visible}`);return fr(this,us,ps.hexdigest())}}us=new WeakMap,ds=new WeakMap,xs=new WeakMap,fs=new WeakMap,gs=new WeakSet,ga=function(ps){const ms=ps.length;if(ms<2)return!0;const hs=ps[0];for(let vs=1;vs<ms;vs++){const ws=ps[vs];let ys;if(Array.isArray(ws))ys=ar(this,gs,ga).call(this,ws);else if(ks(this,ds).has(ws))ys=ks(this,ds).get(ws).visible;else return(0,ns.warn)(`Optional content group not found: ${ws}`),!0;switch(hs){case"And":if(!ys)return!1;break;case"Or":if(ys)return!0;break;case"Not":return!ys;default:return!0}}return hs==="And"},ts.OptionalContentConfig=cs},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.PDFDataTransportStream=void 0;var ns=ss(1),rs=ss(6);class os{constructor({length:us,initialData:ds,progressiveDone:xs=!1,contentDispositionFilename:fs=null,disableRange:gs=!1,disableStream:Es=!1},js){if((0,ns.assert)(js,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=xs,this._contentDispositionFilename=fs,(ds==null?void 0:ds.length)>0){const ps=ds instanceof Uint8Array&&ds.byteLength===ds.buffer.byteLength?ds.buffer:new Uint8Array(ds).buffer;this._queuedChunks.push(ps)}this._pdfDataRangeTransport=js,this._isStreamingSupported=!Es,this._isRangeSupported=!gs,this._contentLength=us,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((ps,ms)=>{this._onReceiveData({begin:ps,chunk:ms})}),this._pdfDataRangeTransport.addProgressListener((ps,ms)=>{this._onProgress({loaded:ps,total:ms})}),this._pdfDataRangeTransport.addProgressiveReadListener(ps=>{this._onReceiveData({chunk:ps})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:us,chunk:ds}){const xs=ds instanceof Uint8Array&&ds.byteLength===ds.buffer.byteLength?ds.buffer:new Uint8Array(ds).buffer;if(us===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(xs):this._queuedChunks.push(xs);else{const fs=this._rangeReaders.some(function(gs){return gs._begin!==us?!1:(gs._enqueue(xs),!0)});(0,ns.assert)(fs,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var us;return((us=this._fullRequestReader)==null?void 0:us._loaded)??0}_onProgress(us){var ds,xs,fs,gs;us.total===void 0?(xs=(ds=this._rangeReaders[0])==null?void 0:ds.onProgress)==null||xs.call(ds,{loaded:us.loaded}):(gs=(fs=this._fullRequestReader)==null?void 0:fs.onProgress)==null||gs.call(fs,{loaded:us.loaded,total:us.total})}_onProgressiveDone(){var us;(us=this._fullRequestReader)==null||us.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(us){const ds=this._rangeReaders.indexOf(us);ds>=0&&this._rangeReaders.splice(ds,1)}getFullReader(){(0,ns.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const us=this._queuedChunks;return this._queuedChunks=null,new as(this,us,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(us,ds){if(ds<=this._progressiveDataLength)return null;const xs=new cs(this,us,ds);return this._pdfDataRangeTransport.requestDataRange(us,ds),this._rangeReaders.push(xs),xs}cancelAllRequests(us){var ds;(ds=this._fullRequestReader)==null||ds.cancel(us);for(const xs of this._rangeReaders.slice(0))xs.cancel(us);this._pdfDataRangeTransport.abort()}}ts.PDFDataTransportStream=os;class as{constructor(us,ds,xs=!1,fs=null){this._stream=us,this._done=xs||!1,this._filename=(0,rs.isPdfFile)(fs)?fs:null,this._queuedChunks=ds||[],this._loaded=0;for(const gs of this._queuedChunks)this._loaded+=gs.byteLength;this._requests=[],this._headersReady=Promise.resolve(),us._fullRequestReader=this,this.onProgress=null}_enqueue(us){this._done||(this._requests.length>0?this._requests.shift().resolve({value:us,done:!1}):this._queuedChunks.push(us),this._loaded+=us.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const us=new ns.PromiseCapability;return this._requests.push(us),us.promise}cancel(us){this._done=!0;for(const ds of this._requests)ds.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class cs{constructor(us,ds,xs){this._stream=us,this._begin=ds,this._end=xs,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(us){if(!this._done){if(this._requests.length===0)this._queuedChunk=us;else{this._requests.shift().resolve({value:us,done:!1});for(const xs of this._requests)xs.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const ds=this._queuedChunk;return this._queuedChunk=null,{value:ds,done:!1}}if(this._done)return{value:void 0,done:!0};const us=new ns.PromiseCapability;return this._requests.push(us),us.promise}cancel(us){this._done=!0;for(const ds of this._requests)ds.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.PDFFetchStream=void 0;var ns=ss(1),rs=ss(20);function os(xs,fs,gs){return{method:"GET",headers:xs,signal:gs.signal,mode:"cors",credentials:fs?"include":"same-origin",redirect:"follow"}}function as(xs){const fs=new Headers;for(const gs in xs){const Es=xs[gs];Es!==void 0&&fs.append(gs,Es)}return fs}function cs(xs){return xs instanceof Uint8Array?xs.buffer:xs instanceof ArrayBuffer?xs:((0,ns.warn)(`getArrayBuffer - unexpected data format: ${xs}`),new Uint8Array(xs).buffer)}class ls{constructor(fs){this.source=fs,this.isHttp=/^https?:/i.test(fs.url),this.httpHeaders=this.isHttp&&fs.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var fs;return((fs=this._fullRequestReader)==null?void 0:fs._loaded)??0}getFullReader(){return(0,ns.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new us(this),this._fullRequestReader}getRangeReader(fs,gs){if(gs<=this._progressiveDataLength)return null;const Es=new ds(this,fs,gs);return this._rangeRequestReaders.push(Es),Es}cancelAllRequests(fs){var gs;(gs=this._fullRequestReader)==null||gs.cancel(fs);for(const Es of this._rangeRequestReaders.slice(0))Es.cancel(fs)}}ts.PDFFetchStream=ls;class us{constructor(fs){this._stream=fs,this._reader=null,this._loaded=0,this._filename=null;const gs=fs.source;this._withCredentials=gs.withCredentials||!1,this._contentLength=gs.length,this._headersCapability=new ns.PromiseCapability,this._disableRange=gs.disableRange||!1,this._rangeChunkSize=gs.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!gs.disableStream,this._isRangeSupported=!gs.disableRange,this._headers=as(this._stream.httpHeaders);const Es=gs.url;fetch(Es,os(this._headers,this._withCredentials,this._abortController)).then(js=>{if(!(0,rs.validateResponseStatus)(js.status))throw(0,rs.createResponseStatusError)(js.status,Es);this._reader=js.body.getReader(),this._headersCapability.resolve();const ps=vs=>js.headers.get(vs),{allowRangeRequests:ms,suggestedLength:hs}=(0,rs.validateRangeRequestCapabilities)({getResponseHeader:ps,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=ms,this._contentLength=hs||this._contentLength,this._filename=(0,rs.extractFilenameFromHeader)(ps),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new ns.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Es;await this._headersCapability.promise;const{value:fs,done:gs}=await this._reader.read();return gs?{value:fs,done:gs}:(this._loaded+=fs.byteLength,(Es=this.onProgress)==null||Es.call(this,{loaded:this._loaded,total:this._contentLength}),{value:cs(fs),done:!1})}cancel(fs){var gs;(gs=this._reader)==null||gs.cancel(fs),this._abortController.abort()}}class ds{constructor(fs,gs,Es){this._stream=fs,this._reader=null,this._loaded=0;const js=fs.source;this._withCredentials=js.withCredentials||!1,this._readCapability=new ns.PromiseCapability,this._isStreamingSupported=!js.disableStream,this._abortController=new AbortController,this._headers=as(this._stream.httpHeaders),this._headers.append("Range",`bytes=${gs}-${Es-1}`);const ps=js.url;fetch(ps,os(this._headers,this._withCredentials,this._abortController)).then(ms=>{if(!(0,rs.validateResponseStatus)(ms.status))throw(0,rs.createResponseStatusError)(ms.status,ps);this._readCapability.resolve(),this._reader=ms.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Es;await this._readCapability.promise;const{value:fs,done:gs}=await this._reader.read();return gs?{value:fs,done:gs}:(this._loaded+=fs.byteLength,(Es=this.onProgress)==null||Es.call(this,{loaded:this._loaded}),{value:cs(fs),done:!1})}cancel(fs){var gs;(gs=this._reader)==null||gs.cancel(fs),this._abortController.abort()}}},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.createResponseStatusError=ls,ts.extractFilenameFromHeader=cs,ts.validateRangeRequestCapabilities=as,ts.validateResponseStatus=us;var ns=ss(1),rs=ss(21),os=ss(6);function as({getResponseHeader:ds,isHttp:xs,rangeChunkSize:fs,disableRange:gs}){const Es={allowRangeRequests:!1,suggestedLength:void 0},js=parseInt(ds("Content-Length"),10);return!Number.isInteger(js)||(Es.suggestedLength=js,js<=2*fs)||gs||!xs||ds("Accept-Ranges")!=="bytes"||(ds("Content-Encoding")||"identity")!=="identity"||(Es.allowRangeRequests=!0),Es}function cs(ds){const xs=ds("Content-Disposition");if(xs){let fs=(0,rs.getFilenameFromContentDispositionHeader)(xs);if(fs.includes("%"))try{fs=decodeURIComponent(fs)}catch{}if((0,os.isPdfFile)(fs))return fs}return null}function ls(ds,xs){return ds===404||ds===0&&xs.startsWith("file:")?new ns.MissingPDFException('Missing PDF "'+xs+'".'):new ns.UnexpectedResponseException(`Unexpected server response (${ds}) while retrieving PDF "${xs}".`,ds)}function us(ds){return ds===200||ds===206}},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.getFilenameFromContentDispositionHeader=rs;var ns=ss(1);function rs(os){let as=!0,cs=ls("filename\\*","i").exec(os);if(cs){cs=cs[1];let js=fs(cs);return js=unescape(js),js=gs(js),js=Es(js),ds(js)}if(cs=xs(os),cs){const js=Es(cs);return ds(js)}if(cs=ls("filename","i").exec(os),cs){cs=cs[1];let js=fs(cs);return js=Es(js),ds(js)}function ls(js,ps){return new RegExp("(?:^|;)\\s*"+js+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',ps)}function us(js,ps){if(js){if(!/^[\x00-\xFF]+$/.test(ps))return ps;try{const ms=new TextDecoder(js,{fatal:!0}),hs=(0,ns.stringToBytes)(ps);ps=ms.decode(hs),as=!1}catch{}}return ps}function ds(js){return as&&/[\x80-\xff]/.test(js)&&(js=us("utf-8",js),as&&(js=us("iso-8859-1",js))),js}function xs(js){const ps=[];let ms;const hs=ls("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(ms=hs.exec(js))!==null;){let[,ws,ys,Rs]=ms;if(ws=parseInt(ws,10),ws in ps){if(ws===0)break;continue}ps[ws]=[ys,Rs]}const vs=[];for(let ws=0;ws<ps.length&&ws in ps;++ws){let[ys,Rs]=ps[ws];Rs=fs(Rs),ys&&(Rs=unescape(Rs),ws===0&&(Rs=gs(Rs))),vs.push(Rs)}return vs.join("")}function fs(js){if(js.startsWith('"')){const ps=js.slice(1).split('\\"');for(let ms=0;ms<ps.length;++ms){const hs=ps[ms].indexOf('"');hs!==-1&&(ps[ms]=ps[ms].slice(0,hs),ps.length=ms+1),ps[ms]=ps[ms].replaceAll(/\\(.)/g,"$1")}js=ps.join('"')}return js}function gs(js){const ps=js.indexOf("'");if(ps===-1)return js;const ms=js.slice(0,ps),vs=js.slice(ps+1).replace(/^[^']*'/,"");return us(ms,vs)}function Es(js){return!js.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(js)?js:js.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(ps,ms,hs,vs){if(hs==="q"||hs==="Q")return vs=vs.replaceAll("_"," "),vs=vs.replaceAll(/=([0-9a-fA-F]{2})/g,function(ws,ys){return String.fromCharCode(parseInt(ys,16))}),us(ms,vs);try{vs=atob(vs)}catch{}return us(ms,vs)})}return""}},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.PDFNetworkStream=void 0;var ns=ss(1),rs=ss(20);const os=200,as=206;function cs(fs){const gs=fs.response;return typeof gs!="string"?gs:(0,ns.stringToBytes)(gs).buffer}class ls{constructor(gs,Es={}){this.url=gs,this.isHttp=/^https?:/i.test(gs),this.httpHeaders=this.isHttp&&Es.httpHeaders||Object.create(null),this.withCredentials=Es.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(gs,Es,js){const ps={begin:gs,end:Es};for(const ms in js)ps[ms]=js[ms];return this.request(ps)}requestFull(gs){return this.request(gs)}request(gs){const Es=new XMLHttpRequest,js=this.currXhrId++,ps=this.pendingRequests[js]={xhr:Es};Es.open("GET",this.url),Es.withCredentials=this.withCredentials;for(const ms in this.httpHeaders){const hs=this.httpHeaders[ms];hs!==void 0&&Es.setRequestHeader(ms,hs)}return this.isHttp&&"begin"in gs&&"end"in gs?(Es.setRequestHeader("Range",`bytes=${gs.begin}-${gs.end-1}`),ps.expectedStatus=as):ps.expectedStatus=os,Es.responseType="arraybuffer",gs.onError&&(Es.onerror=function(ms){gs.onError(Es.status)}),Es.onreadystatechange=this.onStateChange.bind(this,js),Es.onprogress=this.onProgress.bind(this,js),ps.onHeadersReceived=gs.onHeadersReceived,ps.onDone=gs.onDone,ps.onError=gs.onError,ps.onProgress=gs.onProgress,Es.send(null),js}onProgress(gs,Es){var ps;const js=this.pendingRequests[gs];js&&((ps=js.onProgress)==null||ps.call(js,Es))}onStateChange(gs,Es){var ws,ys,Rs;const js=this.pendingRequests[gs];if(!js)return;const ps=js.xhr;if(ps.readyState>=2&&js.onHeadersReceived&&(js.onHeadersReceived(),delete js.onHeadersReceived),ps.readyState!==4||!(gs in this.pendingRequests))return;if(delete this.pendingRequests[gs],ps.status===0&&this.isHttp){(ws=js.onError)==null||ws.call(js,ps.status);return}const ms=ps.status||os;if(!(ms===os&&js.expectedStatus===as)&&ms!==js.expectedStatus){(ys=js.onError)==null||ys.call(js,ps.status);return}const vs=cs(ps);if(ms===as){const bs=ps.getResponseHeader("Content-Range"),Ns=/bytes (\d+)-(\d+)\/(\d+)/.exec(bs);js.onDone({begin:parseInt(Ns[1],10),chunk:vs})}else vs?js.onDone({begin:0,chunk:vs}):(Rs=js.onError)==null||Rs.call(js,ps.status)}getRequestXhr(gs){return this.pendingRequests[gs].xhr}isPendingRequest(gs){return gs in this.pendingRequests}abortRequest(gs){const Es=this.pendingRequests[gs].xhr;delete this.pendingRequests[gs],Es.abort()}}class us{constructor(gs){this._source=gs,this._manager=new ls(gs.url,{httpHeaders:gs.httpHeaders,withCredentials:gs.withCredentials}),this._rangeChunkSize=gs.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(gs){const Es=this._rangeRequestReaders.indexOf(gs);Es>=0&&this._rangeRequestReaders.splice(Es,1)}getFullReader(){return(0,ns.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new ds(this._manager,this._source),this._fullRequestReader}getRangeReader(gs,Es){const js=new xs(this._manager,gs,Es);return js.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(js),js}cancelAllRequests(gs){var Es;(Es=this._fullRequestReader)==null||Es.cancel(gs);for(const js of this._rangeRequestReaders.slice(0))js.cancel(gs)}}ts.PDFNetworkStream=us;class ds{constructor(gs,Es){this._manager=gs;const js={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Es.url,this._fullRequestId=gs.requestFull(js),this._headersReceivedCapability=new ns.PromiseCapability,this._disableRange=Es.disableRange||!1,this._contentLength=Es.length,this._rangeChunkSize=Es.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const gs=this._fullRequestId,Es=this._manager.getRequestXhr(gs),js=hs=>Es.getResponseHeader(hs),{allowRangeRequests:ps,suggestedLength:ms}=(0,rs.validateRangeRequestCapabilities)({getResponseHeader:js,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});ps&&(this._isRangeSupported=!0),this._contentLength=ms||this._contentLength,this._filename=(0,rs.extractFilenameFromHeader)(js),this._isRangeSupported&&this._manager.abortRequest(gs),this._headersReceivedCapability.resolve()}_onDone(gs){if(gs&&(this._requests.length>0?this._requests.shift().resolve({value:gs.chunk,done:!1}):this._cachedChunks.push(gs.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const Es of this._requests)Es.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(gs){this._storedError=(0,rs.createResponseStatusError)(gs,this._url),this._headersReceivedCapability.reject(this._storedError);for(const Es of this._requests)Es.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(gs){var Es;(Es=this.onProgress)==null||Es.call(this,{loaded:gs.loaded,total:gs.lengthComputable?gs.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const gs=new ns.PromiseCapability;return this._requests.push(gs),gs.promise}cancel(gs){this._done=!0,this._headersReceivedCapability.reject(gs);for(const Es of this._requests)Es.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class xs{constructor(gs,Es,js){this._manager=gs;const ps={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=gs.url,this._requestId=gs.requestRange(Es,js,ps),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var gs;(gs=this.onClosed)==null||gs.call(this,this)}_onDone(gs){const Es=gs.chunk;this._requests.length>0?this._requests.shift().resolve({value:Es,done:!1}):this._queuedChunk=Es,this._done=!0;for(const js of this._requests)js.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(gs){this._storedError=(0,rs.createResponseStatusError)(gs,this._url);for(const Es of this._requests)Es.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(gs){var Es;this.isStreamingSupported||(Es=this.onProgress)==null||Es.call(this,{loaded:gs.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const Es=this._queuedChunk;return this._queuedChunk=null,{value:Es,done:!1}}if(this._done)return{value:void 0,done:!0};const gs=new ns.PromiseCapability;return this._requests.push(gs),gs.promise}cancel(gs){this._done=!0;for(const Es of this._requests)Es.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.PDFNodeStream=void 0;var ns=ss(1),rs=ss(20);const os=/^file:\/\/\/[a-zA-Z]:\//;function as(js){const ps=require$$5,ms=ps.parse(js);return ms.protocol==="file:"||ms.host?ms:/^[a-z]:[/\\]/i.test(js)?ps.parse(`file:///${js}`):(ms.host||(ms.protocol="file:"),ms)}class cs{constructor(ps){this.source=ps,this.url=as(ps.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&ps.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var ps;return((ps=this._fullRequestReader)==null?void 0:ps._loaded)??0}getFullReader(){return(0,ns.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new gs(this):new xs(this),this._fullRequestReader}getRangeReader(ps,ms){if(ms<=this._progressiveDataLength)return null;const hs=this.isFsUrl?new Es(this,ps,ms):new fs(this,ps,ms);return this._rangeRequestReaders.push(hs),hs}cancelAllRequests(ps){var ms;(ms=this._fullRequestReader)==null||ms.cancel(ps);for(const hs of this._rangeRequestReaders.slice(0))hs.cancel(ps)}}ts.PDFNodeStream=cs;class ls{constructor(ps){this._url=ps.url,this._done=!1,this._storedError=null,this.onProgress=null;const ms=ps.source;this._contentLength=ms.length,this._loaded=0,this._filename=null,this._disableRange=ms.disableRange||!1,this._rangeChunkSize=ms.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!ms.disableStream,this._isRangeSupported=!ms.disableRange,this._readableStream=null,this._readCapability=new ns.PromiseCapability,this._headersCapability=new ns.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var hs;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const ps=this._readableStream.read();return ps===null?(this._readCapability=new ns.PromiseCapability,this.read()):(this._loaded+=ps.length,(hs=this.onProgress)==null||hs.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(ps).buffer,done:!1})}cancel(ps){if(!this._readableStream){this._error(ps);return}this._readableStream.destroy(ps)}_error(ps){this._storedError=ps,this._readCapability.resolve()}_setReadableStream(ps){this._readableStream=ps,ps.on("readable",()=>{this._readCapability.resolve()}),ps.on("end",()=>{ps.destroy(),this._done=!0,this._readCapability.resolve()}),ps.on("error",ms=>{this._error(ms)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new ns.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class us{constructor(ps){this._url=ps.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new ns.PromiseCapability;const ms=ps.source;this._isStreamingSupported=!ms.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var hs;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const ps=this._readableStream.read();return ps===null?(this._readCapability=new ns.PromiseCapability,this.read()):(this._loaded+=ps.length,(hs=this.onProgress)==null||hs.call(this,{loaded:this._loaded}),{value:new Uint8Array(ps).buffer,done:!1})}cancel(ps){if(!this._readableStream){this._error(ps);return}this._readableStream.destroy(ps)}_error(ps){this._storedError=ps,this._readCapability.resolve()}_setReadableStream(ps){this._readableStream=ps,ps.on("readable",()=>{this._readCapability.resolve()}),ps.on("end",()=>{ps.destroy(),this._done=!0,this._readCapability.resolve()}),ps.on("error",ms=>{this._error(ms)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function ds(js,ps){return{protocol:js.protocol,auth:js.auth,host:js.hostname,port:js.port,path:js.path,method:"GET",headers:ps}}class xs extends ls{constructor(ps){super(ps);const ms=hs=>{if(hs.statusCode===404){const Rs=new ns.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Rs,this._headersCapability.reject(Rs);return}this._headersCapability.resolve(),this._setReadableStream(hs);const vs=Rs=>this._readableStream.headers[Rs.toLowerCase()],{allowRangeRequests:ws,suggestedLength:ys}=(0,rs.validateRangeRequestCapabilities)({getResponseHeader:vs,isHttp:ps.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=ws,this._contentLength=ys||this._contentLength,this._filename=(0,rs.extractFilenameFromHeader)(vs)};if(this._request=null,this._url.protocol==="http:"){const hs=require$$5;this._request=hs.request(ds(this._url,ps.httpHeaders),ms)}else{const hs=require$$5;this._request=hs.request(ds(this._url,ps.httpHeaders),ms)}this._request.on("error",hs=>{this._storedError=hs,this._headersCapability.reject(hs)}),this._request.end()}}class fs extends us{constructor(ps,ms,hs){super(ps),this._httpHeaders={};for(const ws in ps.httpHeaders){const ys=ps.httpHeaders[ws];ys!==void 0&&(this._httpHeaders[ws]=ys)}this._httpHeaders.Range=`bytes=${ms}-${hs-1}`;const vs=ws=>{if(ws.statusCode===404){const ys=new ns.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=ys;return}this._setReadableStream(ws)};if(this._request=null,this._url.protocol==="http:"){const ws=require$$5;this._request=ws.request(ds(this._url,this._httpHeaders),vs)}else{const ws=require$$5;this._request=ws.request(ds(this._url,this._httpHeaders),vs)}this._request.on("error",ws=>{this._storedError=ws}),this._request.end()}}class gs extends ls{constructor(ps){super(ps);let ms=decodeURIComponent(this._url.path);os.test(this._url.href)&&(ms=ms.replace(/^\//,""));const hs=require$$5;hs.lstat(ms,(vs,ws)=>{if(vs){vs.code==="ENOENT"&&(vs=new ns.MissingPDFException(`Missing PDF "${ms}".`)),this._storedError=vs,this._headersCapability.reject(vs);return}this._contentLength=ws.size,this._setReadableStream(hs.createReadStream(ms)),this._headersCapability.resolve()})}}class Es extends us{constructor(ps,ms,hs){super(ps);let vs=decodeURIComponent(this._url.path);os.test(this._url.href)&&(vs=vs.replace(/^\//,""));const ws=require$$5;this._setReadableStream(ws.createReadStream(vs,{start:ms,end:hs-1}))}}},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.SVGGraphics=void 0;var ns=ss(6),rs=ss(1);const os={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},as="http://www.w3.org/XML/1998/namespace",cs="http://www.w3.org/1999/xlink",ls=["butt","round","square"],us=["miter","round","bevel"],ds=function(ws,ys="",Rs=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!Rs)return URL.createObjectURL(new Blob([ws],{type:ys}));const bs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Ns=`data:${ys};base64,`;for(let Ss=0,Ts=ws.length;Ss<Ts;Ss+=3){const Cs=ws[Ss]&255,Ms=ws[Ss+1]&255,Is=ws[Ss+2]&255,Qs=Cs>>2,Ys=(Cs&3)<<4|Ms>>4,Zs=Ss+1<Ts?(Ms&15)<<2|Is>>6:64,Vs=Ss+2<Ts?Is&63:64;Ns+=bs[Qs]+bs[Ys]+bs[Zs]+bs[Vs]}return Ns},xs=function(){const ws=new Uint8Array([137,80,78,71,13,10,26,10]),ys=12,Rs=new Int32Array(256);for(let Is=0;Is<256;Is++){let Qs=Is;for(let Ys=0;Ys<8;Ys++)Qs=Qs&1?3988292384^Qs>>1&2147483647:Qs>>1&2147483647;Rs[Is]=Qs}function bs(Is,Qs,Ys){let Zs=-1;for(let Vs=Qs;Vs<Ys;Vs++){const Ks=(Zs^Is[Vs])&255,Ds=Rs[Ks];Zs=Zs>>>8^Ds}return Zs^-1}function Ns(Is,Qs,Ys,Zs){let Vs=Zs;const Ks=Qs.length;Ys[Vs]=Ks>>24&255,Ys[Vs+1]=Ks>>16&255,Ys[Vs+2]=Ks>>8&255,Ys[Vs+3]=Ks&255,Vs+=4,Ys[Vs]=Is.charCodeAt(0)&255,Ys[Vs+1]=Is.charCodeAt(1)&255,Ys[Vs+2]=Is.charCodeAt(2)&255,Ys[Vs+3]=Is.charCodeAt(3)&255,Vs+=4,Ys.set(Qs,Vs),Vs+=Qs.length;const Ds=bs(Ys,Zs+4,Vs);Ys[Vs]=Ds>>24&255,Ys[Vs+1]=Ds>>16&255,Ys[Vs+2]=Ds>>8&255,Ys[Vs+3]=Ds&255}function Ss(Is,Qs,Ys){let Zs=1,Vs=0;for(let Ks=Qs;Ks<Ys;++Ks)Zs=(Zs+(Is[Ks]&255))%65521,Vs=(Vs+Zs)%65521;return Vs<<16|Zs}function Ts(Is){if(!rs.isNodeJS)return Cs(Is);try{const Qs=parseInt(process.versions.node)>=8?Is:Buffer.from(Is),Ys=require$$5.deflateSync(Qs,{level:9});return Ys instanceof Uint8Array?Ys:new Uint8Array(Ys)}catch(Qs){(0,rs.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Qs)}return Cs(Is)}function Cs(Is){let Qs=Is.length;const Ys=65535,Zs=Math.ceil(Qs/Ys),Vs=new Uint8Array(2+Qs+Zs*5+4);let Ks=0;Vs[Ks++]=120,Vs[Ks++]=156;let Ds=0;for(;Qs>Ys;)Vs[Ks++]=0,Vs[Ks++]=255,Vs[Ks++]=255,Vs[Ks++]=0,Vs[Ks++]=0,Vs.set(Is.subarray(Ds,Ds+Ys),Ks),Ks+=Ys,Ds+=Ys,Qs-=Ys;Vs[Ks++]=1,Vs[Ks++]=Qs&255,Vs[Ks++]=Qs>>8&255,Vs[Ks++]=~Qs&65535&255,Vs[Ks++]=(~Qs&65535)>>8&255,Vs.set(Is.subarray(Ds),Ks),Ks+=Is.length-Ds;const $s=Ss(Is,0,Is.length);return Vs[Ks++]=$s>>24&255,Vs[Ks++]=$s>>16&255,Vs[Ks++]=$s>>8&255,Vs[Ks++]=$s&255,Vs}function Ms(Is,Qs,Ys,Zs){const Vs=Is.width,Ks=Is.height;let Ds,$s,Xs;const Fs=Is.data;switch(Qs){case rs.ImageKind.GRAYSCALE_1BPP:$s=0,Ds=1,Xs=Vs+7>>3;break;case rs.ImageKind.RGB_24BPP:$s=2,Ds=8,Xs=Vs*3;break;case rs.ImageKind.RGBA_32BPP:$s=6,Ds=8,Xs=Vs*4;break;default:throw new Error("invalid format")}const As=new Uint8Array((1+Xs)*Ks);let _s=0,Ps=0;for(let lr=0;lr<Ks;++lr)As[_s++]=0,As.set(Fs.subarray(Ps,Ps+Xs),_s),Ps+=Xs,_s+=Xs;if(Qs===rs.ImageKind.GRAYSCALE_1BPP&&Zs){_s=0;for(let lr=0;lr<Ks;lr++){_s++;for(let jr=0;jr<Xs;jr++)As[_s++]^=255}}const Hs=new Uint8Array([Vs>>24&255,Vs>>16&255,Vs>>8&255,Vs&255,Ks>>24&255,Ks>>16&255,Ks>>8&255,Ks&255,Ds,$s,0,0,0]),Ls=Ts(As),Os=ws.length+ys*3+Hs.length+Ls.length,Ws=new Uint8Array(Os);let Gs=0;return Ws.set(ws,Gs),Gs+=ws.length,Ns("IHDR",Hs,Ws,Gs),Gs+=ys+Hs.length,Ns("IDATA",Ls,Ws,Gs),Gs+=ys+Ls.length,Ns("IEND",new Uint8Array(0),Ws,Gs),ds(Ws,"image/png",Ys)}return function(Qs,Ys,Zs){const Vs=Qs.kind===void 0?rs.ImageKind.GRAYSCALE_1BPP:Qs.kind;return Ms(Qs,Vs,Ys,Zs)}}();class fs{constructor(){this.fontSizeScale=1,this.fontWeight=os.fontWeight,this.fontSize=0,this.textMatrix=rs.IDENTITY_MATRIX,this.fontMatrix=rs.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=rs.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=os.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(ys,Rs){this.x=ys,this.y=Rs}}function gs(ws){let ys=[];const Rs=[];for(const bs of ws){if(bs.fn==="save"){ys.push({fnId:92,fn:"group",items:[]}),Rs.push(ys),ys=ys.at(-1).items;continue}bs.fn==="restore"?ys=Rs.pop():ys.push(bs)}return ys}function Es(ws){if(Number.isInteger(ws))return ws.toString();const ys=ws.toFixed(10);let Rs=ys.length-1;if(ys[Rs]!=="0")return ys;do Rs--;while(ys[Rs]==="0");return ys.substring(0,ys[Rs]==="."?Rs:Rs+1)}function js(ws){if(ws[4]===0&&ws[5]===0){if(ws[1]===0&&ws[2]===0)return ws[0]===1&&ws[3]===1?"":`scale(${Es(ws[0])} ${Es(ws[3])})`;if(ws[0]===ws[3]&&ws[1]===-ws[2]){const ys=Math.acos(ws[0])*180/Math.PI;return`rotate(${Es(ys)})`}}else if(ws[0]===1&&ws[1]===0&&ws[2]===0&&ws[3]===1)return`translate(${Es(ws[4])} ${Es(ws[5])})`;return`matrix(${Es(ws[0])} ${Es(ws[1])} ${Es(ws[2])} ${Es(ws[3])} ${Es(ws[4])} ${Es(ws[5])})`}let ps=0,ms=0,hs=0;class vs{constructor(ys,Rs,bs=!1){(0,ns.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new ns.DOMSVGFactory,this.current=new fs,this.transformMatrix=rs.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=ys,this.objs=Rs,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!bs,this._operatorIdMapping=[];for(const Ns in rs.OPS)this._operatorIdMapping[rs.OPS[Ns]]=Ns}getObject(ys,Rs=null){return typeof ys=="string"?ys.startsWith("g_")?this.commonObjs.get(ys):this.objs.get(ys):Rs}save(){this.transformStack.push(this.transformMatrix);const ys=this.current;this.extraStack.push(ys),this.current=ys.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(ys){this.save(),this.executeOpTree(ys),this.restore()}loadDependencies(ys){const Rs=ys.fnArray,bs=ys.argsArray;for(let Ns=0,Ss=Rs.length;Ns<Ss;Ns++)if(Rs[Ns]===rs.OPS.dependency)for(const Ts of bs[Ns]){const Cs=Ts.startsWith("g_")?this.commonObjs:this.objs,Ms=new Promise(Is=>{Cs.get(Ts,Is)});this.current.dependencies.push(Ms)}return Promise.all(this.current.dependencies)}transform(ys,Rs,bs,Ns,Ss,Ts){const Cs=[ys,Rs,bs,Ns,Ss,Ts];this.transformMatrix=rs.Util.transform(this.transformMatrix,Cs),this.tgrp=null}getSVG(ys,Rs){this.viewport=Rs;const bs=this._initialize(Rs);return this.loadDependencies(ys).then(()=>(this.transformMatrix=rs.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(ys)),bs))}convertOpList(ys){const Rs=this._operatorIdMapping,bs=ys.argsArray,Ns=ys.fnArray,Ss=[];for(let Ts=0,Cs=Ns.length;Ts<Cs;Ts++){const Ms=Ns[Ts];Ss.push({fnId:Ms,fn:Rs[Ms],args:bs[Ts]})}return gs(Ss)}executeOpTree(ys){for(const Rs of ys){const bs=Rs.fn,Ns=Rs.fnId,Ss=Rs.args;switch(Ns|0){case rs.OPS.beginText:this.beginText();break;case rs.OPS.dependency:break;case rs.OPS.setLeading:this.setLeading(Ss);break;case rs.OPS.setLeadingMoveText:this.setLeadingMoveText(Ss[0],Ss[1]);break;case rs.OPS.setFont:this.setFont(Ss);break;case rs.OPS.showText:this.showText(Ss[0]);break;case rs.OPS.showSpacedText:this.showText(Ss[0]);break;case rs.OPS.endText:this.endText();break;case rs.OPS.moveText:this.moveText(Ss[0],Ss[1]);break;case rs.OPS.setCharSpacing:this.setCharSpacing(Ss[0]);break;case rs.OPS.setWordSpacing:this.setWordSpacing(Ss[0]);break;case rs.OPS.setHScale:this.setHScale(Ss[0]);break;case rs.OPS.setTextMatrix:this.setTextMatrix(Ss[0],Ss[1],Ss[2],Ss[3],Ss[4],Ss[5]);break;case rs.OPS.setTextRise:this.setTextRise(Ss[0]);break;case rs.OPS.setTextRenderingMode:this.setTextRenderingMode(Ss[0]);break;case rs.OPS.setLineWidth:this.setLineWidth(Ss[0]);break;case rs.OPS.setLineJoin:this.setLineJoin(Ss[0]);break;case rs.OPS.setLineCap:this.setLineCap(Ss[0]);break;case rs.OPS.setMiterLimit:this.setMiterLimit(Ss[0]);break;case rs.OPS.setFillRGBColor:this.setFillRGBColor(Ss[0],Ss[1],Ss[2]);break;case rs.OPS.setStrokeRGBColor:this.setStrokeRGBColor(Ss[0],Ss[1],Ss[2]);break;case rs.OPS.setStrokeColorN:this.setStrokeColorN(Ss);break;case rs.OPS.setFillColorN:this.setFillColorN(Ss);break;case rs.OPS.shadingFill:this.shadingFill(Ss[0]);break;case rs.OPS.setDash:this.setDash(Ss[0],Ss[1]);break;case rs.OPS.setRenderingIntent:this.setRenderingIntent(Ss[0]);break;case rs.OPS.setFlatness:this.setFlatness(Ss[0]);break;case rs.OPS.setGState:this.setGState(Ss[0]);break;case rs.OPS.fill:this.fill();break;case rs.OPS.eoFill:this.eoFill();break;case rs.OPS.stroke:this.stroke();break;case rs.OPS.fillStroke:this.fillStroke();break;case rs.OPS.eoFillStroke:this.eoFillStroke();break;case rs.OPS.clip:this.clip("nonzero");break;case rs.OPS.eoClip:this.clip("evenodd");break;case rs.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case rs.OPS.paintImageXObject:this.paintImageXObject(Ss[0]);break;case rs.OPS.paintInlineImageXObject:this.paintInlineImageXObject(Ss[0]);break;case rs.OPS.paintImageMaskXObject:this.paintImageMaskXObject(Ss[0]);break;case rs.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(Ss[0],Ss[1]);break;case rs.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case rs.OPS.closePath:this.closePath();break;case rs.OPS.closeStroke:this.closeStroke();break;case rs.OPS.closeFillStroke:this.closeFillStroke();break;case rs.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case rs.OPS.nextLine:this.nextLine();break;case rs.OPS.transform:this.transform(Ss[0],Ss[1],Ss[2],Ss[3],Ss[4],Ss[5]);break;case rs.OPS.constructPath:this.constructPath(Ss[0],Ss[1]);break;case rs.OPS.endPath:this.endPath();break;case 92:this.group(Rs.items);break;default:(0,rs.warn)(`Unimplemented operator ${bs}`);break}}}setWordSpacing(ys){this.current.wordSpacing=ys}setCharSpacing(ys){this.current.charSpacing=ys}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(ys,Rs,bs,Ns,Ss,Ts){const Cs=this.current;Cs.textMatrix=Cs.lineMatrix=[ys,Rs,bs,Ns,Ss,Ts],Cs.textMatrixScale=Math.hypot(ys,Rs),Cs.x=Cs.lineX=0,Cs.y=Cs.lineY=0,Cs.xcoords=[],Cs.ycoords=[],Cs.tspan=this.svgFactory.createElement("svg:tspan"),Cs.tspan.setAttributeNS(null,"font-family",Cs.fontFamily),Cs.tspan.setAttributeNS(null,"font-size",`${Es(Cs.fontSize)}px`),Cs.tspan.setAttributeNS(null,"y",Es(-Cs.y)),Cs.txtElement=this.svgFactory.createElement("svg:text"),Cs.txtElement.append(Cs.tspan)}beginText(){const ys=this.current;ys.x=ys.lineX=0,ys.y=ys.lineY=0,ys.textMatrix=rs.IDENTITY_MATRIX,ys.lineMatrix=rs.IDENTITY_MATRIX,ys.textMatrixScale=1,ys.tspan=this.svgFactory.createElement("svg:tspan"),ys.txtElement=this.svgFactory.createElement("svg:text"),ys.txtgrp=this.svgFactory.createElement("svg:g"),ys.xcoords=[],ys.ycoords=[]}moveText(ys,Rs){const bs=this.current;bs.x=bs.lineX+=ys,bs.y=bs.lineY+=Rs,bs.xcoords=[],bs.ycoords=[],bs.tspan=this.svgFactory.createElement("svg:tspan"),bs.tspan.setAttributeNS(null,"font-family",bs.fontFamily),bs.tspan.setAttributeNS(null,"font-size",`${Es(bs.fontSize)}px`),bs.tspan.setAttributeNS(null,"y",Es(-bs.y))}showText(ys){const Rs=this.current,bs=Rs.font,Ns=Rs.fontSize;if(Ns===0)return;const Ss=Rs.fontSizeScale,Ts=Rs.charSpacing,Cs=Rs.wordSpacing,Ms=Rs.fontDirection,Is=Rs.textHScale*Ms,Qs=bs.vertical,Ys=Qs?1:-1,Zs=bs.defaultVMetrics,Vs=Ns*Rs.fontMatrix[0];let Ks=0;for(const Xs of ys){if(Xs===null){Ks+=Ms*Cs;continue}else if(typeof Xs=="number"){Ks+=Ys*Xs*Ns/1e3;continue}const Fs=(Xs.isSpace?Cs:0)+Ts,As=Xs.fontChar;let _s,Ps,Hs=Xs.width;if(Qs){let Os;const Ws=Xs.vmetric||Zs;Os=Xs.vmetric?Ws[1]:Hs*.5,Os=-Os*Vs;const Gs=Ws[2]*Vs;Hs=Ws?-Ws[0]:Hs,_s=Os/Ss,Ps=(Ks+Gs)/Ss}else _s=Ks/Ss,Ps=0;(Xs.isInFont||bs.missingFile)&&(Rs.xcoords.push(Rs.x+_s),Qs&&Rs.ycoords.push(-Rs.y+Ps),Rs.tspan.textContent+=As);const Ls=Qs?Hs*Vs-Fs*Ms:Hs*Vs+Fs*Ms;Ks+=Ls}Rs.tspan.setAttributeNS(null,"x",Rs.xcoords.map(Es).join(" ")),Qs?Rs.tspan.setAttributeNS(null,"y",Rs.ycoords.map(Es).join(" ")):Rs.tspan.setAttributeNS(null,"y",Es(-Rs.y)),Qs?Rs.y-=Ks:Rs.x+=Ks*Is,Rs.tspan.setAttributeNS(null,"font-family",Rs.fontFamily),Rs.tspan.setAttributeNS(null,"font-size",`${Es(Rs.fontSize)}px`),Rs.fontStyle!==os.fontStyle&&Rs.tspan.setAttributeNS(null,"font-style",Rs.fontStyle),Rs.fontWeight!==os.fontWeight&&Rs.tspan.setAttributeNS(null,"font-weight",Rs.fontWeight);const Ds=Rs.textRenderingMode&rs.TextRenderingMode.FILL_STROKE_MASK;if(Ds===rs.TextRenderingMode.FILL||Ds===rs.TextRenderingMode.FILL_STROKE?(Rs.fillColor!==os.fillColor&&Rs.tspan.setAttributeNS(null,"fill",Rs.fillColor),Rs.fillAlpha<1&&Rs.tspan.setAttributeNS(null,"fill-opacity",Rs.fillAlpha)):Rs.textRenderingMode===rs.TextRenderingMode.ADD_TO_PATH?Rs.tspan.setAttributeNS(null,"fill","transparent"):Rs.tspan.setAttributeNS(null,"fill","none"),Ds===rs.TextRenderingMode.STROKE||Ds===rs.TextRenderingMode.FILL_STROKE){const Xs=1/(Rs.textMatrixScale||1);this._setStrokeAttributes(Rs.tspan,Xs)}let $s=Rs.textMatrix;Rs.textRise!==0&&($s=$s.slice(),$s[5]+=Rs.textRise),Rs.txtElement.setAttributeNS(null,"transform",`${js($s)} scale(${Es(Is)}, -1)`),Rs.txtElement.setAttributeNS(as,"xml:space","preserve"),Rs.txtElement.append(Rs.tspan),Rs.txtgrp.append(Rs.txtElement),this._ensureTransformGroup().append(Rs.txtElement)}setLeadingMoveText(ys,Rs){this.setLeading(-Rs),this.moveText(ys,Rs)}addFontStyle(ys){if(!ys.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const Rs=ds(ys.data,ys.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${ys.loadedName}"; src: url(${Rs}); }
`}setFont(ys){const Rs=this.current,bs=this.commonObjs.get(ys[0]);let Ns=ys[1];Rs.font=bs,this.embedFonts&&!bs.missingFile&&!this.embeddedFonts[bs.loadedName]&&(this.addFontStyle(bs),this.embeddedFonts[bs.loadedName]=bs),Rs.fontMatrix=bs.fontMatrix||rs.FONT_IDENTITY_MATRIX;let Ss="normal";bs.black?Ss="900":bs.bold&&(Ss="bold");const Ts=bs.italic?"italic":"normal";Ns<0?(Ns=-Ns,Rs.fontDirection=-1):Rs.fontDirection=1,Rs.fontSize=Ns,Rs.fontFamily=bs.loadedName,Rs.fontWeight=Ss,Rs.fontStyle=Ts,Rs.tspan=this.svgFactory.createElement("svg:tspan"),Rs.tspan.setAttributeNS(null,"y",Es(-Rs.y)),Rs.xcoords=[],Rs.ycoords=[]}endText(){var Rs;const ys=this.current;ys.textRenderingMode&rs.TextRenderingMode.ADD_TO_PATH_FLAG&&((Rs=ys.txtElement)!=null&&Rs.hasChildNodes())&&(ys.element=ys.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(ys){ys>0&&(this.current.lineWidth=ys)}setLineCap(ys){this.current.lineCap=ls[ys]}setLineJoin(ys){this.current.lineJoin=us[ys]}setMiterLimit(ys){this.current.miterLimit=ys}setStrokeAlpha(ys){this.current.strokeAlpha=ys}setStrokeRGBColor(ys,Rs,bs){this.current.strokeColor=rs.Util.makeHexColor(ys,Rs,bs)}setFillAlpha(ys){this.current.fillAlpha=ys}setFillRGBColor(ys,Rs,bs){this.current.fillColor=rs.Util.makeHexColor(ys,Rs,bs),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(ys){this.current.strokeColor=this._makeColorN_Pattern(ys)}setFillColorN(ys){this.current.fillColor=this._makeColorN_Pattern(ys)}shadingFill(ys){const{width:Rs,height:bs}=this.viewport,Ns=rs.Util.inverseTransform(this.transformMatrix),[Ss,Ts,Cs,Ms]=rs.Util.getAxialAlignedBoundingBox([0,0,Rs,bs],Ns),Is=this.svgFactory.createElement("svg:rect");Is.setAttributeNS(null,"x",Ss),Is.setAttributeNS(null,"y",Ts),Is.setAttributeNS(null,"width",Cs-Ss),Is.setAttributeNS(null,"height",Ms-Ts),Is.setAttributeNS(null,"fill",this._makeShadingPattern(ys)),this.current.fillAlpha<1&&Is.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Is)}_makeColorN_Pattern(ys){return ys[0]==="TilingPattern"?this._makeTilingPattern(ys):this._makeShadingPattern(ys)}_makeTilingPattern(ys){const Rs=ys[1],bs=ys[2],Ns=ys[3]||rs.IDENTITY_MATRIX,[Ss,Ts,Cs,Ms]=ys[4],Is=ys[5],Qs=ys[6],Ys=ys[7],Zs=`shading${hs++}`,[Vs,Ks,Ds,$s]=rs.Util.normalizeRect([...rs.Util.applyTransform([Ss,Ts],Ns),...rs.Util.applyTransform([Cs,Ms],Ns)]),[Xs,Fs]=rs.Util.singularValueDecompose2dScale(Ns),As=Is*Xs,_s=Qs*Fs,Ps=this.svgFactory.createElement("svg:pattern");Ps.setAttributeNS(null,"id",Zs),Ps.setAttributeNS(null,"patternUnits","userSpaceOnUse"),Ps.setAttributeNS(null,"width",As),Ps.setAttributeNS(null,"height",_s),Ps.setAttributeNS(null,"x",`${Vs}`),Ps.setAttributeNS(null,"y",`${Ks}`);const Hs=this.svg,Ls=this.transformMatrix,Os=this.current.fillColor,Ws=this.current.strokeColor,Gs=this.svgFactory.create(Ds-Vs,$s-Ks);if(this.svg=Gs,this.transformMatrix=Ns,Ys===2){const lr=rs.Util.makeHexColor(...Rs);this.current.fillColor=lr,this.current.strokeColor=lr}return this.executeOpTree(this.convertOpList(bs)),this.svg=Hs,this.transformMatrix=Ls,this.current.fillColor=Os,this.current.strokeColor=Ws,Ps.append(Gs.childNodes[0]),this.defs.append(Ps),`url(#${Zs})`}_makeShadingPattern(ys){switch(typeof ys=="string"&&(ys=this.objs.get(ys)),ys[0]){case"RadialAxial":const Rs=`shading${hs++}`,bs=ys[3];let Ns;switch(ys[1]){case"axial":const Ss=ys[4],Ts=ys[5];Ns=this.svgFactory.createElement("svg:linearGradient"),Ns.setAttributeNS(null,"id",Rs),Ns.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Ns.setAttributeNS(null,"x1",Ss[0]),Ns.setAttributeNS(null,"y1",Ss[1]),Ns.setAttributeNS(null,"x2",Ts[0]),Ns.setAttributeNS(null,"y2",Ts[1]);break;case"radial":const Cs=ys[4],Ms=ys[5],Is=ys[6],Qs=ys[7];Ns=this.svgFactory.createElement("svg:radialGradient"),Ns.setAttributeNS(null,"id",Rs),Ns.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Ns.setAttributeNS(null,"cx",Ms[0]),Ns.setAttributeNS(null,"cy",Ms[1]),Ns.setAttributeNS(null,"r",Qs),Ns.setAttributeNS(null,"fx",Cs[0]),Ns.setAttributeNS(null,"fy",Cs[1]),Ns.setAttributeNS(null,"fr",Is);break;default:throw new Error(`Unknown RadialAxial type: ${ys[1]}`)}for(const Ss of bs){const Ts=this.svgFactory.createElement("svg:stop");Ts.setAttributeNS(null,"offset",Ss[0]),Ts.setAttributeNS(null,"stop-color",Ss[1]),Ns.append(Ts)}return this.defs.append(Ns),`url(#${Rs})`;case"Mesh":return(0,rs.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${ys[0]}`)}}setDash(ys,Rs){this.current.dashArray=ys,this.current.dashPhase=Rs}constructPath(ys,Rs){const bs=this.current;let Ns=bs.x,Ss=bs.y,Ts=[],Cs=0;for(const Ms of ys)switch(Ms|0){case rs.OPS.rectangle:Ns=Rs[Cs++],Ss=Rs[Cs++];const Is=Rs[Cs++],Qs=Rs[Cs++],Ys=Ns+Is,Zs=Ss+Qs;Ts.push("M",Es(Ns),Es(Ss),"L",Es(Ys),Es(Ss),"L",Es(Ys),Es(Zs),"L",Es(Ns),Es(Zs),"Z");break;case rs.OPS.moveTo:Ns=Rs[Cs++],Ss=Rs[Cs++],Ts.push("M",Es(Ns),Es(Ss));break;case rs.OPS.lineTo:Ns=Rs[Cs++],Ss=Rs[Cs++],Ts.push("L",Es(Ns),Es(Ss));break;case rs.OPS.curveTo:Ns=Rs[Cs+4],Ss=Rs[Cs+5],Ts.push("C",Es(Rs[Cs]),Es(Rs[Cs+1]),Es(Rs[Cs+2]),Es(Rs[Cs+3]),Es(Ns),Es(Ss)),Cs+=6;break;case rs.OPS.curveTo2:Ts.push("C",Es(Ns),Es(Ss),Es(Rs[Cs]),Es(Rs[Cs+1]),Es(Rs[Cs+2]),Es(Rs[Cs+3])),Ns=Rs[Cs+2],Ss=Rs[Cs+3],Cs+=4;break;case rs.OPS.curveTo3:Ns=Rs[Cs+2],Ss=Rs[Cs+3],Ts.push("C",Es(Rs[Cs]),Es(Rs[Cs+1]),Es(Ns),Es(Ss),Es(Ns),Es(Ss)),Cs+=4;break;case rs.OPS.closePath:Ts.push("Z");break}Ts=Ts.join(" "),bs.path&&ys.length>0&&ys[0]!==rs.OPS.rectangle&&ys[0]!==rs.OPS.moveTo?Ts=bs.path.getAttributeNS(null,"d")+Ts:(bs.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(bs.path)),bs.path.setAttributeNS(null,"d",Ts),bs.path.setAttributeNS(null,"fill","none"),bs.element=bs.path,bs.setCurrentPoint(Ns,Ss)}endPath(){const ys=this.current;if(ys.path=null,!this.pendingClip)return;if(!ys.element){this.pendingClip=null;return}const Rs=`clippath${ps++}`,bs=this.svgFactory.createElement("svg:clipPath");bs.setAttributeNS(null,"id",Rs),bs.setAttributeNS(null,"transform",js(this.transformMatrix));const Ns=ys.element.cloneNode(!0);if(this.pendingClip==="evenodd"?Ns.setAttributeNS(null,"clip-rule","evenodd"):Ns.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,bs.append(Ns),this.defs.append(bs),ys.activeClipUrl){ys.clipGroup=null;for(const Ss of this.extraStack)Ss.clipGroup=null;bs.setAttributeNS(null,"clip-path",ys.activeClipUrl)}ys.activeClipUrl=`url(#${Rs})`,this.tgrp=null}clip(ys){this.pendingClip=ys}closePath(){const ys=this.current;if(ys.path){const Rs=`${ys.path.getAttributeNS(null,"d")}Z`;ys.path.setAttributeNS(null,"d",Rs)}}setLeading(ys){this.current.leading=-ys}setTextRise(ys){this.current.textRise=ys}setTextRenderingMode(ys){this.current.textRenderingMode=ys}setHScale(ys){this.current.textHScale=ys/100}setRenderingIntent(ys){}setFlatness(ys){}setGState(ys){for(const[Rs,bs]of ys)switch(Rs){case"LW":this.setLineWidth(bs);break;case"LC":this.setLineCap(bs);break;case"LJ":this.setLineJoin(bs);break;case"ML":this.setMiterLimit(bs);break;case"D":this.setDash(bs[0],bs[1]);break;case"RI":this.setRenderingIntent(bs);break;case"FL":this.setFlatness(bs);break;case"Font":this.setFont(bs);break;case"CA":this.setStrokeAlpha(bs);break;case"ca":this.setFillAlpha(bs);break;default:(0,rs.warn)(`Unimplemented graphic state operator ${Rs}`);break}}fill(){const ys=this.current;ys.element&&(ys.element.setAttributeNS(null,"fill",ys.fillColor),ys.element.setAttributeNS(null,"fill-opacity",ys.fillAlpha),this.endPath())}stroke(){const ys=this.current;ys.element&&(this._setStrokeAttributes(ys.element),ys.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(ys,Rs=1){const bs=this.current;let Ns=bs.dashArray;Rs!==1&&Ns.length>0&&(Ns=Ns.map(function(Ss){return Rs*Ss})),ys.setAttributeNS(null,"stroke",bs.strokeColor),ys.setAttributeNS(null,"stroke-opacity",bs.strokeAlpha),ys.setAttributeNS(null,"stroke-miterlimit",Es(bs.miterLimit)),ys.setAttributeNS(null,"stroke-linecap",bs.lineCap),ys.setAttributeNS(null,"stroke-linejoin",bs.lineJoin),ys.setAttributeNS(null,"stroke-width",Es(Rs*bs.lineWidth)+"px"),ys.setAttributeNS(null,"stroke-dasharray",Ns.map(Es).join(" ")),ys.setAttributeNS(null,"stroke-dashoffset",Es(Rs*bs.dashPhase)+"px")}eoFill(){var ys;(ys=this.current.element)==null||ys.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var ys;(ys=this.current.element)==null||ys.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const ys=this.svgFactory.createElement("svg:rect");ys.setAttributeNS(null,"x","0"),ys.setAttributeNS(null,"y","0"),ys.setAttributeNS(null,"width","1px"),ys.setAttributeNS(null,"height","1px"),ys.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(ys)}paintImageXObject(ys){const Rs=this.getObject(ys);if(!Rs){(0,rs.warn)(`Dependent image with object ID ${ys} is not ready yet`);return}this.paintInlineImageXObject(Rs)}paintInlineImageXObject(ys,Rs){const bs=ys.width,Ns=ys.height,Ss=xs(ys,this.forceDataSchema,!!Rs),Ts=this.svgFactory.createElement("svg:rect");Ts.setAttributeNS(null,"x","0"),Ts.setAttributeNS(null,"y","0"),Ts.setAttributeNS(null,"width",Es(bs)),Ts.setAttributeNS(null,"height",Es(Ns)),this.current.element=Ts,this.clip("nonzero");const Cs=this.svgFactory.createElement("svg:image");Cs.setAttributeNS(cs,"xlink:href",Ss),Cs.setAttributeNS(null,"x","0"),Cs.setAttributeNS(null,"y",Es(-Ns)),Cs.setAttributeNS(null,"width",Es(bs)+"px"),Cs.setAttributeNS(null,"height",Es(Ns)+"px"),Cs.setAttributeNS(null,"transform",`scale(${Es(1/bs)} ${Es(-1/Ns)})`),Rs?Rs.append(Cs):this._ensureTransformGroup().append(Cs)}paintImageMaskXObject(ys){const Rs=this.getObject(ys.data,ys);if(Rs.bitmap){(0,rs.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const bs=this.current,Ns=Rs.width,Ss=Rs.height,Ts=bs.fillColor;bs.maskId=`mask${ms++}`;const Cs=this.svgFactory.createElement("svg:mask");Cs.setAttributeNS(null,"id",bs.maskId);const Ms=this.svgFactory.createElement("svg:rect");Ms.setAttributeNS(null,"x","0"),Ms.setAttributeNS(null,"y","0"),Ms.setAttributeNS(null,"width",Es(Ns)),Ms.setAttributeNS(null,"height",Es(Ss)),Ms.setAttributeNS(null,"fill",Ts),Ms.setAttributeNS(null,"mask",`url(#${bs.maskId})`),this.defs.append(Cs),this._ensureTransformGroup().append(Ms),this.paintInlineImageXObject(Rs,Cs)}paintFormXObjectBegin(ys,Rs){if(Array.isArray(ys)&&ys.length===6&&this.transform(ys[0],ys[1],ys[2],ys[3],ys[4],ys[5]),Rs){const bs=Rs[2]-Rs[0],Ns=Rs[3]-Rs[1],Ss=this.svgFactory.createElement("svg:rect");Ss.setAttributeNS(null,"x",Rs[0]),Ss.setAttributeNS(null,"y",Rs[1]),Ss.setAttributeNS(null,"width",Es(bs)),Ss.setAttributeNS(null,"height",Es(Ns)),this.current.element=Ss,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(ys){const Rs=this.svgFactory.create(ys.width,ys.height),bs=this.svgFactory.createElement("svg:defs");Rs.append(bs),this.defs=bs;const Ns=this.svgFactory.createElement("svg:g");return Ns.setAttributeNS(null,"transform",js(ys.transform)),Rs.append(Ns),this.svg=Ns,Rs}_ensureClipGroup(){if(!this.current.clipGroup){const ys=this.svgFactory.createElement("svg:g");ys.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(ys),this.current.clipGroup=ys}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",js(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}ts.SVGGraphics=vs},(es,ts)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.XfaText=void 0;class ss{static textContent(rs){const os=[],as={items:os,styles:Object.create(null)};function cs(ls){var xs;if(!ls)return;let us=null;const ds=ls.name;if(ds==="#text")us=ls.value;else if(ss.shouldBuildText(ds))(xs=ls==null?void 0:ls.attributes)!=null&&xs.textContent?us=ls.attributes.textContent:ls.value&&(us=ls.value);else return;if(us!==null&&os.push({str:us}),!!ls.children)for(const fs of ls.children)cs(fs)}return cs(rs),as}static shouldBuildText(rs){return!(rs==="textarea"||rs==="input"||rs==="option"||rs==="select")}}ts.XfaText=ss},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.TextLayerRenderTask=void 0,ts.renderTextLayer=js,ts.updateTextLayer=ps;var ns=ss(1),rs=ss(6);const os=1e5,as=30,cs=.8,ls=new Map;function us(ms,hs){let vs;if(hs&&ns.FeatureTest.isOffscreenCanvasSupported)vs=new OffscreenCanvas(ms,ms).getContext("2d",{alpha:!1});else{const ws=document.createElement("canvas");ws.width=ws.height=ms,vs=ws.getContext("2d",{alpha:!1})}return vs}function ds(ms,hs){const vs=ls.get(ms);if(vs)return vs;const ws=us(as,hs);ws.font=`${as}px ${ms}`;const ys=ws.measureText("");let Rs=ys.fontBoundingBoxAscent,bs=Math.abs(ys.fontBoundingBoxDescent);if(Rs){const Ss=Rs/(Rs+bs);return ls.set(ms,Ss),ws.canvas.width=ws.canvas.height=0,Ss}ws.strokeStyle="red",ws.clearRect(0,0,as,as),ws.strokeText("g",0,0);let Ns=ws.getImageData(0,0,as,as).data;bs=0;for(let Ss=Ns.length-1-3;Ss>=0;Ss-=4)if(Ns[Ss]>0){bs=Math.ceil(Ss/4/as);break}ws.clearRect(0,0,as,as),ws.strokeText("A",0,as),Ns=ws.getImageData(0,0,as,as).data,Rs=0;for(let Ss=0,Ts=Ns.length;Ss<Ts;Ss+=4)if(Ns[Ss]>0){Rs=as-Math.floor(Ss/4/as);break}if(ws.canvas.width=ws.canvas.height=0,Rs){const Ss=Rs/(Rs+bs);return ls.set(ms,Ss),Ss}return ls.set(ms,cs),cs}function xs(ms,hs,vs){const ws=document.createElement("span"),ys={angle:0,canvasWidth:0,hasText:hs.str!=="",hasEOL:hs.hasEOL,fontSize:0};ms._textDivs.push(ws);const Rs=ns.Util.transform(ms._transform,hs.transform);let bs=Math.atan2(Rs[1],Rs[0]);const Ns=vs[hs.fontName];Ns.vertical&&(bs+=Math.PI/2);const Ss=Math.hypot(Rs[2],Rs[3]),Ts=Ss*ds(Ns.fontFamily,ms._isOffscreenCanvasSupported);let Cs,Ms;bs===0?(Cs=Rs[4],Ms=Rs[5]-Ts):(Cs=Rs[4]+Ts*Math.sin(bs),Ms=Rs[5]-Ts*Math.cos(bs));const Is="calc(var(--scale-factor)*",Qs=ws.style;ms._container===ms._rootContainer?(Qs.left=`${(100*Cs/ms._pageWidth).toFixed(2)}%`,Qs.top=`${(100*Ms/ms._pageHeight).toFixed(2)}%`):(Qs.left=`${Is}${Cs.toFixed(2)}px)`,Qs.top=`${Is}${Ms.toFixed(2)}px)`),Qs.fontSize=`${Is}${Ss.toFixed(2)}px)`,Qs.fontFamily=Ns.fontFamily,ys.fontSize=Ss,ws.setAttribute("role","presentation"),ws.textContent=hs.str,ws.dir=hs.dir,ms._fontInspectorEnabled&&(ws.dataset.fontName=hs.fontName),bs!==0&&(ys.angle=bs*(180/Math.PI));let Ys=!1;if(hs.str.length>1)Ys=!0;else if(hs.str!==" "&&hs.transform[0]!==hs.transform[3]){const Zs=Math.abs(hs.transform[0]),Vs=Math.abs(hs.transform[3]);Zs!==Vs&&Math.max(Zs,Vs)/Math.min(Zs,Vs)>1.5&&(Ys=!0)}Ys&&(ys.canvasWidth=Ns.vertical?hs.height:hs.width),ms._textDivProperties.set(ws,ys),ms._isReadableStream&&ms._layoutText(ws)}function fs(ms){const{div:hs,scale:vs,properties:ws,ctx:ys,prevFontSize:Rs,prevFontFamily:bs}=ms,{style:Ns}=hs;let Ss="";if(ws.canvasWidth!==0&&ws.hasText){const{fontFamily:Ts}=Ns,{canvasWidth:Cs,fontSize:Ms}=ws;(Rs!==Ms||bs!==Ts)&&(ys.font=`${Ms*vs}px ${Ts}`,ms.prevFontSize=Ms,ms.prevFontFamily=Ts);const{width:Is}=ys.measureText(hs.textContent);Is>0&&(Ss=`scaleX(${Cs*vs/Is})`)}ws.angle!==0&&(Ss=`rotate(${ws.angle}deg) ${Ss}`),Ss.length>0&&(Ns.transform=Ss)}function gs(ms){if(ms._canceled)return;const hs=ms._textDivs,vs=ms._capability;if(hs.length>os){vs.resolve();return}if(!ms._isReadableStream)for(const ys of hs)ms._layoutText(ys);vs.resolve()}class Es{constructor({textContentSource:hs,container:vs,viewport:ws,textDivs:ys,textDivProperties:Rs,textContentItemsStr:bs,isOffscreenCanvasSupported:Ns}){var Is;this._textContentSource=hs,this._isReadableStream=hs instanceof ReadableStream,this._container=this._rootContainer=vs,this._textDivs=ys||[],this._textContentItemsStr=bs||[],this._isOffscreenCanvasSupported=Ns,this._fontInspectorEnabled=!!((Is=globalThis.FontInspector)!=null&&Is.enabled),this._reader=null,this._textDivProperties=Rs||new WeakMap,this._canceled=!1,this._capability=new ns.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:ws.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:us(0,Ns)};const{pageWidth:Ss,pageHeight:Ts,pageX:Cs,pageY:Ms}=ws.rawDims;this._transform=[1,0,0,-1,-Cs,Ms+Ts],this._pageWidth=Ss,this._pageHeight=Ts,(0,rs.setLayerDimensions)(vs,ws),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new ns.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new ns.AbortException("TextLayer task cancelled."))}_processItems(hs,vs){for(const ws of hs){if(ws.str===void 0){if(ws.type==="beginMarkedContentProps"||ws.type==="beginMarkedContent"){const ys=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),ws.id!==null&&this._container.setAttribute("id",`${ws.id}`),ys.append(this._container)}else ws.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(ws.str),xs(this,ws,vs)}}_layoutText(hs){const vs=this._layoutTextParams.properties=this._textDivProperties.get(hs);if(this._layoutTextParams.div=hs,fs(this._layoutTextParams),vs.hasText&&this._container.append(hs),vs.hasEOL){const ws=document.createElement("br");ws.setAttribute("role","presentation"),this._container.append(ws)}}_render(){const hs=new ns.PromiseCapability;let vs=Object.create(null);if(this._isReadableStream){const ws=()=>{this._reader.read().then(({value:ys,done:Rs})=>{if(Rs){hs.resolve();return}Object.assign(vs,ys.styles),this._processItems(ys.items,vs),ws()},hs.reject)};this._reader=this._textContentSource.getReader(),ws()}else if(this._textContentSource){const{items:ws,styles:ys}=this._textContentSource;this._processItems(ws,ys),hs.resolve()}else throw new Error('No "textContentSource" parameter specified.');hs.promise.then(()=>{vs=null,gs(this)},this._capability.reject)}}ts.TextLayerRenderTask=Es;function js(ms){!ms.textContentSource&&(ms.textContent||ms.textContentStream)&&((0,rs.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),ms.textContentSource=ms.textContent||ms.textContentStream);const{container:hs,viewport:vs}=ms,ws=getComputedStyle(hs),ys=ws.getPropertyValue("visibility"),Rs=parseFloat(ws.getPropertyValue("--scale-factor"));ys==="visible"&&(!Rs||Math.abs(Rs-vs.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const bs=new Es(ms);return bs._render(),bs}function ps({container:ms,viewport:hs,textDivs:vs,textDivProperties:ws,isOffscreenCanvasSupported:ys,mustRotate:Rs=!0,mustRescale:bs=!0}){if(Rs&&(0,rs.setLayerDimensions)(ms,{rotation:hs.rotation}),bs){const Ns=us(0,ys),Ts={prevFontSize:null,prevFontFamily:null,div:null,scale:hs.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:Ns};for(const Cs of vs)Ts.properties=ws.get(Cs),Ts.div=Cs,fs(Ts)}}},(es,ts,ss)=>{var ds,xs,fs,gs,Es,js,ps,ms,hs,vs,ws,ba,To,_a,$a;Object.defineProperty(ts,"__esModule",{value:!0}),ts.AnnotationEditorLayer=void 0;var ns=ss(1),rs=ss(4),os=ss(28),as=ss(33),cs=ss(6),ls=ss(34);const Ss=class Ss{constructor({uiManager:Cs,pageIndex:Ms,div:Is,accessibilityManager:Qs,annotationLayer:Ys,viewport:Zs,l10n:Vs}){mr(this,ws);mr(this,ds);mr(this,xs,!1);mr(this,fs,null);mr(this,gs,this.pointerup.bind(this));mr(this,Es,this.pointerdown.bind(this));mr(this,js,new Map);mr(this,ps,!1);mr(this,ms,!1);mr(this,hs,!1);mr(this,vs);const Ks=[os.FreeTextEditor,as.InkEditor,ls.StampEditor];if(!Ss._initialized){Ss._initialized=!0;for(const Ds of Ks)Ds.initialize(Vs)}Cs.registerEditorTypes(Ks),fr(this,vs,Cs),this.pageIndex=Ms,this.div=Is,fr(this,ds,Qs),fr(this,fs,Ys),this.viewport=Zs,ks(this,vs).addLayer(this)}get isEmpty(){return ks(this,js).size===0}updateToolbar(Cs){ks(this,vs).updateToolbar(Cs)}updateMode(Cs=ks(this,vs).getMode()){ar(this,ws,$a).call(this),Cs===ns.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),Cs!==ns.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",Cs===ns.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",Cs===ns.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",Cs===ns.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(Cs){if(!Cs&&ks(this,vs).getMode()!==ns.AnnotationEditorType.INK)return;if(!Cs){for(const Is of ks(this,js).values())if(Is.isEmpty()){Is.setInBackground();return}}ar(this,ws,To).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(Cs){ks(this,vs).setEditingState(Cs)}addCommands(Cs){ks(this,vs).addCommands(Cs)}enable(){this.div.style.pointerEvents="auto";const Cs=new Set;for(const Is of ks(this,js).values())Is.enableEditing(),Is.annotationElementId&&Cs.add(Is.annotationElementId);if(!ks(this,fs))return;const Ms=ks(this,fs).getEditableAnnotations();for(const Is of Ms){if(Is.hide(),ks(this,vs).isDeletedAnnotationElement(Is.data.id)||Cs.has(Is.data.id))continue;const Qs=this.deserialize(Is);Qs&&(this.addOrRebuild(Qs),Qs.enableEditing())}}disable(){var Ms;fr(this,hs,!0),this.div.style.pointerEvents="none";const Cs=new Set;for(const Is of ks(this,js).values()){if(Is.disableEditing(),!Is.annotationElementId||Is.serialize()!==null){Cs.add(Is.annotationElementId);continue}(Ms=this.getEditableAnnotation(Is.annotationElementId))==null||Ms.show(),Is.remove()}if(ks(this,fs)){const Is=ks(this,fs).getEditableAnnotations();for(const Qs of Is){const{id:Ys}=Qs.data;Cs.has(Ys)||ks(this,vs).isDeletedAnnotationElement(Ys)||Qs.show()}}ar(this,ws,$a).call(this),this.isEmpty&&(this.div.hidden=!0),fr(this,hs,!1)}getEditableAnnotation(Cs){var Ms;return((Ms=ks(this,fs))==null?void 0:Ms.getEditableAnnotation(Cs))||null}setActiveEditor(Cs){ks(this,vs).getActive()!==Cs&&ks(this,vs).setActiveEditor(Cs)}enableClick(){this.div.addEventListener("pointerdown",ks(this,Es)),this.div.addEventListener("pointerup",ks(this,gs))}disableClick(){this.div.removeEventListener("pointerdown",ks(this,Es)),this.div.removeEventListener("pointerup",ks(this,gs))}attach(Cs){ks(this,js).set(Cs.id,Cs);const{annotationElementId:Ms}=Cs;Ms&&ks(this,vs).isDeletedAnnotationElement(Ms)&&ks(this,vs).removeDeletedAnnotationElement(Cs)}detach(Cs){var Ms;ks(this,js).delete(Cs.id),(Ms=ks(this,ds))==null||Ms.removePointerInTextLayer(Cs.contentDiv),!ks(this,hs)&&Cs.annotationElementId&&ks(this,vs).addDeletedAnnotationElement(Cs)}remove(Cs){this.detach(Cs),ks(this,vs).removeEditor(Cs),Cs.div.contains(document.activeElement)&&setTimeout(()=>{ks(this,vs).focusMainContainer()},0),Cs.div.remove(),Cs.isAttachedToDOM=!1,ks(this,ms)||this.addInkEditorIfNeeded(!1)}changeParent(Cs){var Ms;Cs.parent!==this&&(Cs.annotationElementId&&(ks(this,vs).addDeletedAnnotationElement(Cs.annotationElementId),rs.AnnotationEditor.deleteAnnotationElement(Cs),Cs.annotationElementId=null),this.attach(Cs),(Ms=Cs.parent)==null||Ms.detach(Cs),Cs.setParent(this),Cs.div&&Cs.isAttachedToDOM&&(Cs.div.remove(),this.div.append(Cs.div)))}add(Cs){if(this.changeParent(Cs),ks(this,vs).addEditor(Cs),this.attach(Cs),!Cs.isAttachedToDOM){const Ms=Cs.render();this.div.append(Ms),Cs.isAttachedToDOM=!0}Cs.fixAndSetPosition(),Cs.onceAdded(),ks(this,vs).addToAnnotationStorage(Cs)}moveEditorInDOM(Cs){var Is;if(!Cs.isAttachedToDOM)return;const{activeElement:Ms}=document;Cs.div.contains(Ms)&&(Cs._focusEventsAllowed=!1,setTimeout(()=>{Cs.div.contains(document.activeElement)?Cs._focusEventsAllowed=!0:(Cs.div.addEventListener("focusin",()=>{Cs._focusEventsAllowed=!0},{once:!0}),Ms.focus())},0)),Cs._structTreeParentId=(Is=ks(this,ds))==null?void 0:Is.moveElementInDOM(this.div,Cs.div,Cs.contentDiv,!0)}addOrRebuild(Cs){Cs.needsToBeRebuilt()?Cs.rebuild():this.add(Cs)}addUndoableEditor(Cs){const Ms=()=>Cs._uiManager.rebuild(Cs),Is=()=>{Cs.remove()};this.addCommands({cmd:Ms,undo:Is,mustExec:!1})}getNextId(){return ks(this,vs).getId()}pasteEditor(Cs,Ms){ks(this,vs).updateToolbar(Cs),ks(this,vs).updateMode(Cs);const{offsetX:Is,offsetY:Qs}=ar(this,ws,_a).call(this),Ys=this.getNextId(),Zs=ar(this,ws,ba).call(this,{parent:this,id:Ys,x:Is,y:Qs,uiManager:ks(this,vs),isCentered:!0,...Ms});Zs&&this.add(Zs)}deserialize(Cs){switch(Cs.annotationType??Cs.annotationEditorType){case ns.AnnotationEditorType.FREETEXT:return os.FreeTextEditor.deserialize(Cs,this,ks(this,vs));case ns.AnnotationEditorType.INK:return as.InkEditor.deserialize(Cs,this,ks(this,vs));case ns.AnnotationEditorType.STAMP:return ls.StampEditor.deserialize(Cs,this,ks(this,vs))}return null}addNewEditor(){ar(this,ws,To).call(this,ar(this,ws,_a).call(this),!0)}setSelected(Cs){ks(this,vs).setSelected(Cs)}toggleSelected(Cs){ks(this,vs).toggleSelected(Cs)}isSelected(Cs){return ks(this,vs).isSelected(Cs)}unselect(Cs){ks(this,vs).unselect(Cs)}pointerup(Cs){const{isMac:Ms}=ns.FeatureTest.platform;if(!(Cs.button!==0||Cs.ctrlKey&&Ms)&&Cs.target===this.div&&ks(this,ps)){if(fr(this,ps,!1),!ks(this,xs)){fr(this,xs,!0);return}if(ks(this,vs).getMode()===ns.AnnotationEditorType.STAMP){ks(this,vs).unselectAll();return}ar(this,ws,To).call(this,Cs,!1)}}pointerdown(Cs){if(ks(this,ps)){fr(this,ps,!1);return}const{isMac:Ms}=ns.FeatureTest.platform;if(Cs.button!==0||Cs.ctrlKey&&Ms||Cs.target!==this.div)return;fr(this,ps,!0);const Is=ks(this,vs).getActive();fr(this,xs,!Is||Is.isEmpty())}findNewParent(Cs,Ms,Is){const Qs=ks(this,vs).findParent(Ms,Is);return Qs===null||Qs===this?!1:(Qs.changeParent(Cs),!0)}destroy(){var Cs,Ms;((Cs=ks(this,vs).getActive())==null?void 0:Cs.parent)===this&&(ks(this,vs).commitOrRemove(),ks(this,vs).setActiveEditor(null));for(const Is of ks(this,js).values())(Ms=ks(this,ds))==null||Ms.removePointerInTextLayer(Is.contentDiv),Is.setParent(null),Is.isAttachedToDOM=!1,Is.div.remove();this.div=null,ks(this,js).clear(),ks(this,vs).removeLayer(this)}render({viewport:Cs}){this.viewport=Cs,(0,cs.setLayerDimensions)(this.div,Cs);for(const Ms of ks(this,vs).getEditors(this.pageIndex))this.add(Ms);this.updateMode()}update({viewport:Cs}){ks(this,vs).commitOrRemove(),this.viewport=Cs,(0,cs.setLayerDimensions)(this.div,{rotation:Cs.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:Cs,pageHeight:Ms}=this.viewport.rawDims;return[Cs,Ms]}};ds=new WeakMap,xs=new WeakMap,fs=new WeakMap,gs=new WeakMap,Es=new WeakMap,js=new WeakMap,ps=new WeakMap,ms=new WeakMap,hs=new WeakMap,vs=new WeakMap,ws=new WeakSet,ba=function(Cs){switch(ks(this,vs).getMode()){case ns.AnnotationEditorType.FREETEXT:return new os.FreeTextEditor(Cs);case ns.AnnotationEditorType.INK:return new as.InkEditor(Cs);case ns.AnnotationEditorType.STAMP:return new ls.StampEditor(Cs)}return null},To=function(Cs,Ms){const Is=this.getNextId(),Qs=ar(this,ws,ba).call(this,{parent:this,id:Is,x:Cs.offsetX,y:Cs.offsetY,uiManager:ks(this,vs),isCentered:Ms});return Qs&&this.add(Qs),Qs},_a=function(){const{x:Cs,y:Ms,width:Is,height:Qs}=this.div.getBoundingClientRect(),Ys=Math.max(0,Cs),Zs=Math.max(0,Ms),Vs=Math.min(window.innerWidth,Cs+Is),Ks=Math.min(window.innerHeight,Ms+Qs),Ds=(Ys+Vs)/2-Cs,$s=(Zs+Ks)/2-Ms,[Xs,Fs]=this.viewport.rotation%180===0?[Ds,$s]:[$s,Ds];return{offsetX:Xs,offsetY:Fs}},$a=function(){fr(this,ms,!0);for(const Cs of ks(this,js).values())Cs.isEmpty()&&Cs.remove();fr(this,ms,!1)},eo(Ss,"_initialized",!1);let us=Ss;ts.AnnotationEditorLayer=us},(es,ts,ss)=>{var ls,us,ds,xs,fs,gs,Es,js,ps,ms,Yl,Kl,Jl,bo,xl,Ql,El;Object.defineProperty(ts,"__esModule",{value:!0}),ts.FreeTextEditor=void 0;var ns=ss(1),rs=ss(5),os=ss(4),as=ss(29);const Ss=class Ss extends os.AnnotationEditor{constructor(Ms){super({...Ms,name:"freeTextEditor"});mr(this,ms);mr(this,ls,this.editorDivBlur.bind(this));mr(this,us,this.editorDivFocus.bind(this));mr(this,ds,this.editorDivInput.bind(this));mr(this,xs,this.editorDivKeydown.bind(this));mr(this,fs);mr(this,gs,"");mr(this,Es,`${this.id}-editor`);mr(this,js);mr(this,ps,null);fr(this,fs,Ms.color||Ss._defaultColor||os.AnnotationEditor._defaultLineColor),fr(this,js,Ms.fontSize||Ss._defaultFontSize)}static get _keyboardManager(){const Ms=Ss.prototype,Is=Zs=>Zs.isEmpty(),Qs=rs.AnnotationEditorUIManager.TRANSLATE_SMALL,Ys=rs.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,ns.shadow)(this,"_keyboardManager",new rs.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Ms.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Ms.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Ms._translateEmpty,{args:[-Qs,0],checker:Is}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Ms._translateEmpty,{args:[-Ys,0],checker:Is}],[["ArrowRight","mac+ArrowRight"],Ms._translateEmpty,{args:[Qs,0],checker:Is}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Ms._translateEmpty,{args:[Ys,0],checker:Is}],[["ArrowUp","mac+ArrowUp"],Ms._translateEmpty,{args:[0,-Qs],checker:Is}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Ms._translateEmpty,{args:[0,-Ys],checker:Is}],[["ArrowDown","mac+ArrowDown"],Ms._translateEmpty,{args:[0,Qs],checker:Is}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Ms._translateEmpty,{args:[0,Ys],checker:Is}]]))}static initialize(Ms){os.AnnotationEditor.initialize(Ms,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Is=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Is.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Ms,Is){switch(Ms){case ns.AnnotationEditorParamsType.FREETEXT_SIZE:Ss._defaultFontSize=Is;break;case ns.AnnotationEditorParamsType.FREETEXT_COLOR:Ss._defaultColor=Is;break}}updateParams(Ms,Is){switch(Ms){case ns.AnnotationEditorParamsType.FREETEXT_SIZE:ar(this,ms,Yl).call(this,Is);break;case ns.AnnotationEditorParamsType.FREETEXT_COLOR:ar(this,ms,Kl).call(this,Is);break}}static get defaultPropertiesToUpdate(){return[[ns.AnnotationEditorParamsType.FREETEXT_SIZE,Ss._defaultFontSize],[ns.AnnotationEditorParamsType.FREETEXT_COLOR,Ss._defaultColor||os.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[ns.AnnotationEditorParamsType.FREETEXT_SIZE,ks(this,js)],[ns.AnnotationEditorParamsType.FREETEXT_COLOR,ks(this,fs)]]}_translateEmpty(Ms,Is){this._uiManager.translateSelectedEditors(Ms,Is,!0)}getInitialTranslation(){const Ms=this.parentScale;return[-Ss._internalPadding*Ms,-(Ss._internalPadding+ks(this,js))*Ms]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(ns.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",ks(this,xs)),this.editorDiv.addEventListener("focus",ks(this,us)),this.editorDiv.addEventListener("blur",ks(this,ls)),this.editorDiv.addEventListener("input",ks(this,ds)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",ks(this,Es)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",ks(this,xs)),this.editorDiv.removeEventListener("focus",ks(this,us)),this.editorDiv.removeEventListener("blur",ks(this,ls)),this.editorDiv.removeEventListener("input",ks(this,ds)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Ms){this._focusEventsAllowed&&(super.focusin(Ms),Ms.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var Ms;if(this.width){ar(this,ms,El).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(Ms=this._initialOptions)!=null&&Ms.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Ms=ks(this,gs),Is=fr(this,gs,ar(this,ms,Jl).call(this).trimEnd());if(Ms===Is)return;const Qs=Ys=>{if(fr(this,gs,Ys),!Ys){this.remove();return}ar(this,ms,xl).call(this),this._uiManager.rebuild(this),ar(this,ms,bo).call(this)};this.addCommands({cmd:()=>{Qs(Is)},undo:()=>{Qs(Ms)},mustExec:!1}),ar(this,ms,bo).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Ms){this.enterInEditMode()}keydown(Ms){Ms.target===this.div&&Ms.key==="Enter"&&(this.enterInEditMode(),Ms.preventDefault())}editorDivKeydown(Ms){Ss._keyboardManager.exec(this,Ms)}editorDivFocus(Ms){this.isEditing=!0}editorDivBlur(Ms){this.isEditing=!1}editorDivInput(Ms){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Ms,Is;this.width&&(Ms=this.x,Is=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",ks(this,Es)),this.enableEditing(),os.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Ys=>{var Zs;return(Zs=this.editorDiv)==null?void 0:Zs.setAttribute("aria-label",Ys)}),os.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Ys=>{var Zs;return(Zs=this.editorDiv)==null?void 0:Zs.setAttribute("default-content",Ys)}),this.editorDiv.contentEditable=!0;const{style:Qs}=this.editorDiv;if(Qs.fontSize=`calc(${ks(this,js)}px * var(--scale-factor))`,Qs.color=ks(this,fs),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,rs.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Ys,Zs]=this.parentDimensions;if(this.annotationElementId){const{position:Vs}=ks(this,ps);let[Ks,Ds]=this.getInitialTranslation();[Ks,Ds]=this.pageTranslationToScreen(Ks,Ds);const[$s,Xs]=this.pageDimensions,[Fs,As]=this.pageTranslation;let _s,Ps;switch(this.rotation){case 0:_s=Ms+(Vs[0]-Fs)/$s,Ps=Is+this.height-(Vs[1]-As)/Xs;break;case 90:_s=Ms+(Vs[0]-Fs)/$s,Ps=Is-(Vs[1]-As)/Xs,[Ks,Ds]=[Ds,-Ks];break;case 180:_s=Ms-this.width+(Vs[0]-Fs)/$s,Ps=Is-(Vs[1]-As)/Xs,[Ks,Ds]=[-Ks,-Ds];break;case 270:_s=Ms+(Vs[0]-Fs-this.height*Xs)/$s,Ps=Is+(Vs[1]-As-this.width*$s)/Xs,[Ks,Ds]=[-Ds,Ks];break}this.setAt(_s*Ys,Ps*Zs,Ks,Ds)}else this.setAt(Ms*Ys,Is*Zs,this.width*Ys,this.height*Zs);ar(this,ms,xl).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(Ms,Is,Qs){let Ys=null;if(Ms instanceof as.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Vs,fontColor:Ks},rect:Ds,rotation:$s,id:Xs},textContent:Fs,textPosition:As,parent:{page:{pageNumber:_s}}}=Ms;if(!Fs||Fs.length===0)return null;Ys=Ms={annotationType:ns.AnnotationEditorType.FREETEXT,color:Array.from(Ks),fontSize:Vs,value:Fs.join(`
`),position:As,pageIndex:_s-1,rect:Ds,rotation:$s,id:Xs,deleted:!1}}const Zs=super.deserialize(Ms,Is,Qs);return fr(Zs,js,Ms.fontSize),fr(Zs,fs,ns.Util.makeHexColor(...Ms.color)),fr(Zs,gs,Ms.value),Zs.annotationElementId=Ms.id||null,fr(Zs,ps,Ys),Zs}serialize(Ms=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Is=Ss._internalPadding*this.parentScale,Qs=this.getRect(Is,Is),Ys=os.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:ks(this,fs)),Zs={annotationType:ns.AnnotationEditorType.FREETEXT,color:Ys,fontSize:ks(this,js),value:ks(this,gs),pageIndex:this.pageIndex,rect:Qs,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Ms?Zs:this.annotationElementId&&!ar(this,ms,Ql).call(this,Zs)?null:(Zs.id=this.annotationElementId,Zs)}};ls=new WeakMap,us=new WeakMap,ds=new WeakMap,xs=new WeakMap,fs=new WeakMap,gs=new WeakMap,Es=new WeakMap,js=new WeakMap,ps=new WeakMap,ms=new WeakSet,Yl=function(Ms){const Is=Ys=>{this.editorDiv.style.fontSize=`calc(${Ys}px * var(--scale-factor))`,this.translate(0,-(Ys-ks(this,js))*this.parentScale),fr(this,js,Ys),ar(this,ms,bo).call(this)},Qs=ks(this,js);this.addCommands({cmd:()=>{Is(Ms)},undo:()=>{Is(Qs)},mustExec:!0,type:ns.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Kl=function(Ms){const Is=ks(this,fs);this.addCommands({cmd:()=>{fr(this,fs,this.editorDiv.style.color=Ms)},undo:()=>{fr(this,fs,this.editorDiv.style.color=Is)},mustExec:!0,type:ns.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Jl=function(){const Ms=this.editorDiv.getElementsByTagName("div");if(Ms.length===0)return this.editorDiv.innerText;const Is=[];for(const Qs of Ms)Is.push(Qs.innerText.replace(/\r\n?|\n/,""));return Is.join(`
`)},bo=function(){const[Ms,Is]=this.parentDimensions;let Qs;if(this.isAttachedToDOM)Qs=this.div.getBoundingClientRect();else{const{currentLayer:Ys,div:Zs}=this,Vs=Zs.style.display;Zs.style.display="hidden",Ys.div.append(this.div),Qs=Zs.getBoundingClientRect(),Zs.remove(),Zs.style.display=Vs}this.rotation%180===this.parentRotation%180?(this.width=Qs.width/Ms,this.height=Qs.height/Is):(this.width=Qs.height/Ms,this.height=Qs.width/Is),this.fixAndSetPosition()},xl=function(){if(this.editorDiv.replaceChildren(),!!ks(this,gs))for(const Ms of ks(this,gs).split(`
`)){const Is=document.createElement("div");Is.append(Ms?document.createTextNode(Ms):document.createElement("br")),this.editorDiv.append(Is)}},Ql=function(Ms){const{value:Is,fontSize:Qs,color:Ys,rect:Zs,pageIndex:Vs}=ks(this,ps);return Ms.value!==Is||Ms.fontSize!==Qs||Ms.rect.some((Ks,Ds)=>Math.abs(Ks-Zs[Ds])>=1)||Ms.color.some((Ks,Ds)=>Ks!==Ys[Ds])||Ms.pageIndex!==Vs},El=function(Ms=!1){if(!this.annotationElementId)return;if(ar(this,ms,bo).call(this),!Ms&&(this.width===0||this.height===0)){setTimeout(()=>ar(this,ms,El).call(this,!0),0);return}const Is=Ss._internalPadding*this.parentScale;ks(this,ps).rect=this.getRect(Is,Is)},eo(Ss,"_freeTextDefaultContent",""),eo(Ss,"_internalPadding",0),eo(Ss,"_defaultColor",null),eo(Ss,"_defaultFontSize",10),eo(Ss,"_type","freetext");let cs=Ss;ts.FreeTextEditor=cs},(es,ts,ss)=>{var Ps,Ls,uo,Zl,Gs,lr,jr,br,Nr,wr,dr,hr,Bs,qs,cr,xr,yr,Ar,Cr,ur,Pr,Tr,_c,Mo,yl,Rl,zr,Zr,to,kr,pr,gr,Ir,wl,qr,Js,Rr,Mr,eu,Nl;Object.defineProperty(ts,"__esModule",{value:!0}),ts.StampAnnotationElement=ts.InkAnnotationElement=ts.FreeTextAnnotationElement=ts.AnnotationLayer=void 0;var ns=ss(1),rs=ss(6),os=ss(3),as=ss(30),cs=ss(31),ls=ss(32);const us=1e3,ds=9,xs=new WeakSet;function fs(Dr){return{width:Dr[2]-Dr[0],height:Dr[3]-Dr[1]}}class gs{static create(zs){switch(zs.data.annotationType){case ns.AnnotationType.LINK:return new js(zs);case ns.AnnotationType.TEXT:return new ps(zs);case ns.AnnotationType.WIDGET:switch(zs.data.fieldType){case"Tx":return new hs(zs);case"Btn":return zs.data.radioButton?new ys(zs):zs.data.checkBox?new ws(zs):new Rs(zs);case"Ch":return new bs(zs);case"Sig":return new vs(zs)}return new ms(zs);case ns.AnnotationType.POPUP:return new Ns(zs);case ns.AnnotationType.FREETEXT:return new Ts(zs);case ns.AnnotationType.LINE:return new Cs(zs);case ns.AnnotationType.SQUARE:return new Ms(zs);case ns.AnnotationType.CIRCLE:return new Is(zs);case ns.AnnotationType.POLYLINE:return new Qs(zs);case ns.AnnotationType.CARET:return new Zs(zs);case ns.AnnotationType.INK:return new Vs(zs);case ns.AnnotationType.POLYGON:return new Ys(zs);case ns.AnnotationType.HIGHLIGHT:return new Ks(zs);case ns.AnnotationType.UNDERLINE:return new Ds(zs);case ns.AnnotationType.SQUIGGLY:return new $s(zs);case ns.AnnotationType.STRIKEOUT:return new Xs(zs);case ns.AnnotationType.STAMP:return new Fs(zs);case ns.AnnotationType.FILEATTACHMENT:return new As(zs);default:return new Es(zs)}}}const Hs=class Hs{constructor(zs,{isRenderable:Us=!1,ignoreBorder:or=!1,createQuadrilaterals:Er=!1}={}){mr(this,Ps,!1);this.isRenderable=Us,this.data=zs.data,this.layer=zs.layer,this.linkService=zs.linkService,this.downloadManager=zs.downloadManager,this.imageResourcesPath=zs.imageResourcesPath,this.renderForms=zs.renderForms,this.svgFactory=zs.svgFactory,this.annotationStorage=zs.annotationStorage,this.enableScripting=zs.enableScripting,this.hasJSActions=zs.hasJSActions,this._fieldObjects=zs.fieldObjects,this.parent=zs.parent,Us&&(this.container=this._createContainer(or)),Er&&this._createQuadrilaterals()}static _hasPopupData({titleObj:zs,contentsObj:Us,richText:or}){return!!(zs!=null&&zs.str||Us!=null&&Us.str||or!=null&&or.str)}get hasPopupData(){return Hs._hasPopupData(this.data)}_createContainer(zs){const{data:Us,parent:{page:or,viewport:Er}}=this,vr=document.createElement("section");vr.setAttribute("data-annotation-id",Us.id),this instanceof ms||(vr.tabIndex=us),vr.style.zIndex=this.parent.zIndex++,this.data.popupRef&&vr.setAttribute("aria-haspopup","dialog"),Us.noRotate&&vr.classList.add("norotate");const{pageWidth:Sr,pageHeight:_r,pageX:Hr,pageY:Fr}=Er.rawDims;if(!Us.rect||this instanceof Ns){const{rotation:Gr}=Us;return!Us.hasOwnCanvas&&Gr!==0&&this.setRotation(Gr,vr),vr}const{width:Lr,height:Yr}=fs(Us.rect),$r=ns.Util.normalizeRect([Us.rect[0],or.view[3]-Us.rect[1]+or.view[1],Us.rect[2],or.view[3]-Us.rect[3]+or.view[1]]);if(!zs&&Us.borderStyle.width>0){vr.style.borderWidth=`${Us.borderStyle.width}px`;const Gr=Us.borderStyle.horizontalCornerRadius,Kr=Us.borderStyle.verticalCornerRadius;if(Gr>0||Kr>0){const so=`calc(${Gr}px * var(--scale-factor)) / calc(${Kr}px * var(--scale-factor))`;vr.style.borderRadius=so}else if(this instanceof ys){const so=`calc(${Lr}px * var(--scale-factor)) / calc(${Yr}px * var(--scale-factor))`;vr.style.borderRadius=so}switch(Us.borderStyle.style){case ns.AnnotationBorderStyleType.SOLID:vr.style.borderStyle="solid";break;case ns.AnnotationBorderStyleType.DASHED:vr.style.borderStyle="dashed";break;case ns.AnnotationBorderStyleType.BEVELED:(0,ns.warn)("Unimplemented border style: beveled");break;case ns.AnnotationBorderStyleType.INSET:(0,ns.warn)("Unimplemented border style: inset");break;case ns.AnnotationBorderStyleType.UNDERLINE:vr.style.borderBottomStyle="solid";break}const _i=Us.borderColor||null;_i?(fr(this,Ps,!0),vr.style.borderColor=ns.Util.makeHexColor(_i[0]|0,_i[1]|0,_i[2]|0)):vr.style.borderWidth=0}vr.style.left=`${100*($r[0]-Hr)/Sr}%`,vr.style.top=`${100*($r[1]-Fr)/_r}%`;const{rotation:Wr}=Us;return Us.hasOwnCanvas||Wr===0?(vr.style.width=`${100*Lr/Sr}%`,vr.style.height=`${100*Yr/_r}%`):this.setRotation(Wr,vr),vr}setRotation(zs,Us=this.container){if(!this.data.rect)return;const{pageWidth:or,pageHeight:Er}=this.parent.viewport.rawDims,{width:vr,height:Sr}=fs(this.data.rect);let _r,Hr;zs%180===0?(_r=100*vr/or,Hr=100*Sr/Er):(_r=100*Sr/or,Hr=100*vr/Er),Us.style.width=`${_r}%`,Us.style.height=`${Hr}%`,Us.setAttribute("data-main-rotation",(360-zs)%360)}get _commonActions(){const zs=(Us,or,Er)=>{const vr=Er.detail[Us],Sr=vr[0],_r=vr.slice(1);Er.target.style[or]=as.ColorConverters[`${Sr}_HTML`](_r),this.annotationStorage.setValue(this.data.id,{[or]:as.ColorConverters[`${Sr}_rgb`](_r)})};return(0,ns.shadow)(this,"_commonActions",{display:Us=>{const{display:or}=Us.detail,Er=or%2===1;this.container.style.visibility=Er?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Er,noPrint:or===1||or===2})},print:Us=>{this.annotationStorage.setValue(this.data.id,{noPrint:!Us.detail.print})},hidden:Us=>{const{hidden:or}=Us.detail;this.container.style.visibility=or?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:or,noView:or})},focus:Us=>{setTimeout(()=>Us.target.focus({preventScroll:!1}),0)},userName:Us=>{Us.target.title=Us.detail.userName},readonly:Us=>{Us.target.disabled=Us.detail.readonly},required:Us=>{this._setRequired(Us.target,Us.detail.required)},bgColor:Us=>{zs("bgColor","backgroundColor",Us)},fillColor:Us=>{zs("fillColor","backgroundColor",Us)},fgColor:Us=>{zs("fgColor","color",Us)},textColor:Us=>{zs("textColor","color",Us)},borderColor:Us=>{zs("borderColor","borderColor",Us)},strokeColor:Us=>{zs("strokeColor","borderColor",Us)},rotation:Us=>{const or=Us.detail.rotation;this.setRotation(or),this.annotationStorage.setValue(this.data.id,{rotation:or})}})}_dispatchEventFromSandbox(zs,Us){const or=this._commonActions;for(const Er of Object.keys(Us.detail)){const vr=zs[Er]||or[Er];vr==null||vr(Us)}}_setDefaultPropertiesFromJS(zs){if(!this.enableScripting)return;const Us=this.annotationStorage.getRawValue(this.data.id);if(!Us)return;const or=this._commonActions;for(const[Er,vr]of Object.entries(Us)){const Sr=or[Er];if(Sr){const _r={detail:{[Er]:vr},target:zs};Sr(_r),delete Us[Er]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:zs}=this.data;if(!zs)return;const[Us,or,Er,vr]=this.data.rect;if(zs.length===1){const[,{x:Kr,y:_i},{x:so,y:ro}]=zs[0];if(Er===Kr&&vr===_i&&Us===so&&or===ro)return}const{style:Sr}=this.container;let _r;if(ks(this,Ps)){const{borderColor:Kr,borderWidth:_i}=Sr;Sr.borderWidth=0,_r=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Kr}" stroke-width="${_i}">`],this.container.classList.add("hasBorder")}const Hr=Er-Us,Fr=vr-or,{svgFactory:Lr}=this,Yr=Lr.createElement("svg");Yr.classList.add("quadrilateralsContainer"),Yr.setAttribute("width",0),Yr.setAttribute("height",0);const $r=Lr.createElement("defs");Yr.append($r);const Wr=Lr.createElement("clipPath"),Gr=`clippath_${this.data.id}`;Wr.setAttribute("id",Gr),Wr.setAttribute("clipPathUnits","objectBoundingBox"),$r.append(Wr);for(const[,{x:Kr,y:_i},{x:so,y:ro}]of zs){const no=Lr.createElement("rect"),oo=(so-Us)/Hr,lo=(vr-_i)/Fr,co=(Kr-so)/Hr,Dl=(_i-ro)/Fr;no.setAttribute("x",oo),no.setAttribute("y",lo),no.setAttribute("width",co),no.setAttribute("height",Dl),Wr.append(no),_r==null||_r.push(`<rect vector-effect="non-scaling-stroke" x="${oo}" y="${lo}" width="${co}" height="${Dl}"/>`)}ks(this,Ps)&&(_r.push("</g></svg>')"),Sr.backgroundImage=_r.join("")),this.container.append(Yr),this.container.style.clipPath=`url(#${Gr})`}_createPopup(){const{container:zs,data:Us}=this;zs.setAttribute("aria-haspopup","dialog");const or=new Ns({data:{color:Us.color,titleObj:Us.titleObj,modificationDate:Us.modificationDate,contentsObj:Us.contentsObj,richText:Us.richText,parentRect:Us.rect,borderStyle:0,id:`popup_${Us.id}`,rotation:Us.rotation},parent:this.parent,elements:[this]});this.parent.div.append(or.render())}render(){(0,ns.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(zs,Us=null){const or=[];if(this._fieldObjects){const Er=this._fieldObjects[zs];if(Er)for(const{page:vr,id:Sr,exportValues:_r}of Er){if(vr===-1||Sr===Us)continue;const Hr=typeof _r=="string"?_r:null,Fr=document.querySelector(`[data-element-id="${Sr}"]`);if(Fr&&!xs.has(Fr)){(0,ns.warn)(`_getElementsByName - element not allowed: ${Sr}`);continue}or.push({id:Sr,exportValue:Hr,domElement:Fr})}return or}for(const Er of document.getElementsByName(zs)){const{exportValue:vr}=Er,Sr=Er.getAttribute("data-element-id");Sr!==Us&&xs.has(Er)&&or.push({id:Sr,exportValue:vr,domElement:Er})}return or}show(){var zs;this.container&&(this.container.hidden=!1),(zs=this.popup)==null||zs.maybeShow()}hide(){var zs;this.container&&(this.container.hidden=!0),(zs=this.popup)==null||zs.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const zs=this.getElementsToTriggerPopup();if(Array.isArray(zs))for(const Us of zs)Us.classList.add("highlightArea");else zs.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:zs,data:{id:Us}}=this;this.container.addEventListener("dblclick",()=>{var or;(or=this.linkService.eventBus)==null||or.dispatch("switchannotationeditormode",{source:this,mode:zs,editId:Us})})}};Ps=new WeakMap;let Es=Hs;class js extends Es{constructor(Us,or=null){super(Us,{isRenderable:!0,ignoreBorder:!!(or!=null&&or.ignoreBorder),createQuadrilaterals:!0});mr(this,Ls);this.isTooltipOnly=Us.data.isTooltipOnly}render(){const{data:Us,linkService:or}=this,Er=document.createElement("a");Er.setAttribute("data-element-id",Us.id);let vr=!1;return Us.url?(or.addLinkAttributes(Er,Us.url,Us.newWindow),vr=!0):Us.action?(this._bindNamedAction(Er,Us.action),vr=!0):Us.attachment?(this._bindAttachment(Er,Us.attachment),vr=!0):Us.setOCGState?(ar(this,Ls,Zl).call(this,Er,Us.setOCGState),vr=!0):Us.dest?(this._bindLink(Er,Us.dest),vr=!0):(Us.actions&&(Us.actions.Action||Us.actions["Mouse Up"]||Us.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Er,Us),vr=!0),Us.resetForm?(this._bindResetFormAction(Er,Us.resetForm),vr=!0):this.isTooltipOnly&&!vr&&(this._bindLink(Er,""),vr=!0)),this.container.classList.add("linkAnnotation"),vr&&this.container.append(Er),this.container}_bindLink(Us,or){Us.href=this.linkService.getDestinationHash(or),Us.onclick=()=>(or&&this.linkService.goToDestination(or),!1),(or||or==="")&&ar(this,Ls,uo).call(this)}_bindNamedAction(Us,or){Us.href=this.linkService.getAnchorUrl(""),Us.onclick=()=>(this.linkService.executeNamedAction(or),!1),ar(this,Ls,uo).call(this)}_bindAttachment(Us,or){Us.href=this.linkService.getAnchorUrl(""),Us.onclick=()=>{var Er;return(Er=this.downloadManager)==null||Er.openOrDownloadData(this.container,or.content,or.filename),!1},ar(this,Ls,uo).call(this)}_bindJSAction(Us,or){Us.href=this.linkService.getAnchorUrl("");const Er=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const vr of Object.keys(or.actions)){const Sr=Er.get(vr);Sr&&(Us[Sr]=()=>{var _r;return(_r=this.linkService.eventBus)==null||_r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:or.id,name:vr}}),!1})}Us.onclick||(Us.onclick=()=>!1),ar(this,Ls,uo).call(this)}_bindResetFormAction(Us,or){const Er=Us.onclick;if(Er||(Us.href=this.linkService.getAnchorUrl("")),ar(this,Ls,uo).call(this),!this._fieldObjects){(0,ns.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Er||(Us.onclick=()=>!1);return}Us.onclick=()=>{var Yr;Er==null||Er();const{fields:vr,refs:Sr,include:_r}=or,Hr=[];if(vr.length!==0||Sr.length!==0){const $r=new Set(Sr);for(const Wr of vr){const Gr=this._fieldObjects[Wr]||[];for(const{id:Kr}of Gr)$r.add(Kr)}for(const Wr of Object.values(this._fieldObjects))for(const Gr of Wr)$r.has(Gr.id)===_r&&Hr.push(Gr)}else for(const $r of Object.values(this._fieldObjects))Hr.push(...$r);const Fr=this.annotationStorage,Lr=[];for(const $r of Hr){const{id:Wr}=$r;switch(Lr.push(Wr),$r.type){case"text":{const Kr=$r.defaultValue||"";Fr.setValue(Wr,{value:Kr});break}case"checkbox":case"radiobutton":{const Kr=$r.defaultValue===$r.exportValues;Fr.setValue(Wr,{value:Kr});break}case"combobox":case"listbox":{const Kr=$r.defaultValue||"";Fr.setValue(Wr,{value:Kr});break}default:continue}const Gr=document.querySelector(`[data-element-id="${Wr}"]`);if(Gr){if(!xs.has(Gr)){(0,ns.warn)(`_bindResetFormAction - element not allowed: ${Wr}`);continue}}else continue;Gr.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Yr=this.linkService.eventBus)==null||Yr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Lr,name:"ResetForm"}})),!1}}}Ls=new WeakSet,uo=function(){this.container.setAttribute("data-internal-link","")},Zl=function(Us,or){Us.href=this.linkService.getAnchorUrl(""),Us.onclick=()=>(this.linkService.executeSetOCGState(or),!1),ar(this,Ls,uo).call(this)};class ps extends Es{constructor(zs){super(zs,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const zs=document.createElement("img");return zs.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",zs.alt="[{{type}} Annotation]",zs.dataset.l10nId="text_annotation_type",zs.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(zs),this.container}}class ms extends Es{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(zs){var Us;this.data.hasOwnCanvas&&(((Us=zs.previousSibling)==null?void 0:Us.nodeName)==="CANVAS"&&(zs.previousSibling.hidden=!0),zs.hidden=!1)}_getKeyModifier(zs){const{isWin:Us,isMac:or}=ns.FeatureTest.platform;return Us&&zs.ctrlKey||or&&zs.metaKey}_setEventListener(zs,Us,or,Er,vr){or.includes("mouse")?zs.addEventListener(or,Sr=>{var _r;(_r=this.linkService.eventBus)==null||_r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Er,value:vr(Sr),shift:Sr.shiftKey,modifier:this._getKeyModifier(Sr)}})}):zs.addEventListener(or,Sr=>{var _r;if(or==="blur"){if(!Us.focused||!Sr.relatedTarget)return;Us.focused=!1}else if(or==="focus"){if(Us.focused)return;Us.focused=!0}vr&&((_r=this.linkService.eventBus)==null||_r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Er,value:vr(Sr)}}))})}_setEventListeners(zs,Us,or,Er){var vr,Sr,_r;for(const[Hr,Fr]of or)(Fr==="Action"||(vr=this.data.actions)!=null&&vr[Fr])&&((Fr==="Focus"||Fr==="Blur")&&(Us||(Us={focused:!1})),this._setEventListener(zs,Us,Hr,Fr,Er),Fr==="Focus"&&!((Sr=this.data.actions)!=null&&Sr.Blur)?this._setEventListener(zs,Us,"blur","Blur",null):Fr==="Blur"&&!((_r=this.data.actions)!=null&&_r.Focus)&&this._setEventListener(zs,Us,"focus","Focus",null))}_setBackgroundColor(zs){const Us=this.data.backgroundColor||null;zs.style.backgroundColor=Us===null?"transparent":ns.Util.makeHexColor(Us[0],Us[1],Us[2])}_setTextStyle(zs){const Us=["left","center","right"],{fontColor:or}=this.data.defaultAppearanceData,Er=this.data.defaultAppearanceData.fontSize||ds,vr=zs.style;let Sr;const _r=2,Hr=Fr=>Math.round(10*Fr)/10;if(this.data.multiLine){const Fr=Math.abs(this.data.rect[3]-this.data.rect[1]-_r),Lr=Math.round(Fr/(ns.LINE_FACTOR*Er))||1,Yr=Fr/Lr;Sr=Math.min(Er,Hr(Yr/ns.LINE_FACTOR))}else{const Fr=Math.abs(this.data.rect[3]-this.data.rect[1]-_r);Sr=Math.min(Er,Hr(Fr/ns.LINE_FACTOR))}vr.fontSize=`calc(${Sr}px * var(--scale-factor))`,vr.color=ns.Util.makeHexColor(or[0],or[1],or[2]),this.data.textAlignment!==null&&(vr.textAlign=Us[this.data.textAlignment])}_setRequired(zs,Us){Us?zs.setAttribute("required",!0):zs.removeAttribute("required"),zs.setAttribute("aria-required",Us)}}class hs extends ms{constructor(zs){const Us=zs.renderForms||!zs.data.hasAppearance&&!!zs.data.fieldValue;super(zs,{isRenderable:Us})}setPropertyOnSiblings(zs,Us,or,Er){const vr=this.annotationStorage;for(const Sr of this._getElementsByName(zs.name,zs.id))Sr.domElement&&(Sr.domElement[Us]=or),vr.setValue(Sr.id,{[Er]:or})}render(){var Er,vr;const zs=this.annotationStorage,Us=this.data.id;this.container.classList.add("textWidgetAnnotation");let or=null;if(this.renderForms){const Sr=zs.getValue(Us,{value:this.data.fieldValue});let _r=Sr.value||"";const Hr=zs.getValue(Us,{charLimit:this.data.maxLen}).charLimit;Hr&&_r.length>Hr&&(_r=_r.slice(0,Hr));let Fr=Sr.formattedValue||((Er=this.data.textContent)==null?void 0:Er.join(`
`))||null;Fr&&this.data.comb&&(Fr=Fr.replaceAll(/\s+/g,""));const Lr={userValue:_r,formattedValue:Fr,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(or=document.createElement("textarea"),or.textContent=Fr??_r,this.data.doNotScroll&&(or.style.overflowY="hidden")):(or=document.createElement("input"),or.type="text",or.setAttribute("value",Fr??_r),this.data.doNotScroll&&(or.style.overflowX="hidden")),this.data.hasOwnCanvas&&(or.hidden=!0),xs.add(or),or.setAttribute("data-element-id",Us),or.disabled=this.data.readOnly,or.name=this.data.fieldName,or.tabIndex=us,this._setRequired(or,this.data.required),Hr&&(or.maxLength=Hr),or.addEventListener("input",$r=>{zs.setValue(Us,{value:$r.target.value}),this.setPropertyOnSiblings(or,"value",$r.target.value,"value"),Lr.formattedValue=null}),or.addEventListener("resetform",$r=>{const Wr=this.data.defaultFieldValue??"";or.value=Lr.userValue=Wr,Lr.formattedValue=null});let Yr=$r=>{const{formattedValue:Wr}=Lr;Wr!=null&&($r.target.value=Wr),$r.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){or.addEventListener("focus",Wr=>{if(Lr.focused)return;const{target:Gr}=Wr;Lr.userValue&&(Gr.value=Lr.userValue),Lr.lastCommittedValue=Gr.value,Lr.commitKey=1,Lr.focused=!0}),or.addEventListener("updatefromsandbox",Wr=>{this.showElementAndHideCanvas(Wr.target);const Gr={value(Kr){Lr.userValue=Kr.detail.value??"",zs.setValue(Us,{value:Lr.userValue.toString()}),Kr.target.value=Lr.userValue},formattedValue(Kr){const{formattedValue:_i}=Kr.detail;Lr.formattedValue=_i,_i!=null&&Kr.target!==document.activeElement&&(Kr.target.value=_i),zs.setValue(Us,{formattedValue:_i})},selRange(Kr){Kr.target.setSelectionRange(...Kr.detail.selRange)},charLimit:Kr=>{var no;const{charLimit:_i}=Kr.detail,{target:so}=Kr;if(_i===0){so.removeAttribute("maxLength");return}so.setAttribute("maxLength",_i);let ro=Lr.userValue;!ro||ro.length<=_i||(ro=ro.slice(0,_i),so.value=Lr.userValue=ro,zs.setValue(Us,{value:ro}),(no=this.linkService.eventBus)==null||no.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Us,name:"Keystroke",value:ro,willCommit:!0,commitKey:1,selStart:so.selectionStart,selEnd:so.selectionEnd}}))}};this._dispatchEventFromSandbox(Gr,Wr)}),or.addEventListener("keydown",Wr=>{var _i;Lr.commitKey=1;let Gr=-1;if(Wr.key==="Escape"?Gr=0:Wr.key==="Enter"&&!this.data.multiLine?Gr=2:Wr.key==="Tab"&&(Lr.commitKey=3),Gr===-1)return;const{value:Kr}=Wr.target;Lr.lastCommittedValue!==Kr&&(Lr.lastCommittedValue=Kr,Lr.userValue=Kr,(_i=this.linkService.eventBus)==null||_i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Us,name:"Keystroke",value:Kr,willCommit:!0,commitKey:Gr,selStart:Wr.target.selectionStart,selEnd:Wr.target.selectionEnd}}))});const $r=Yr;Yr=null,or.addEventListener("blur",Wr=>{var Kr;if(!Lr.focused||!Wr.relatedTarget)return;Lr.focused=!1;const{value:Gr}=Wr.target;Lr.userValue=Gr,Lr.lastCommittedValue!==Gr&&((Kr=this.linkService.eventBus)==null||Kr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Us,name:"Keystroke",value:Gr,willCommit:!0,commitKey:Lr.commitKey,selStart:Wr.target.selectionStart,selEnd:Wr.target.selectionEnd}})),$r(Wr)}),(vr=this.data.actions)!=null&&vr.Keystroke&&or.addEventListener("beforeinput",Wr=>{var lo;Lr.lastCommittedValue=null;const{data:Gr,target:Kr}=Wr,{value:_i,selectionStart:so,selectionEnd:ro}=Kr;let no=so,oo=ro;switch(Wr.inputType){case"deleteWordBackward":{const co=_i.substring(0,so).match(/\w*[^\w]*$/);co&&(no-=co[0].length);break}case"deleteWordForward":{const co=_i.substring(so).match(/^[^\w]*\w*/);co&&(oo+=co[0].length);break}case"deleteContentBackward":so===ro&&(no-=1);break;case"deleteContentForward":so===ro&&(oo+=1);break}Wr.preventDefault(),(lo=this.linkService.eventBus)==null||lo.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Us,name:"Keystroke",value:_i,change:Gr||"",willCommit:!1,selStart:no,selEnd:oo}})}),this._setEventListeners(or,Lr,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Wr=>Wr.target.value)}if(Yr&&or.addEventListener("blur",Yr),this.data.comb){const Wr=(this.data.rect[2]-this.data.rect[0])/Hr;or.classList.add("comb"),or.style.letterSpacing=`calc(${Wr}px * var(--scale-factor) - 1ch)`}}else or=document.createElement("div"),or.textContent=this.data.fieldValue,or.style.verticalAlign="middle",or.style.display="table-cell";return this._setTextStyle(or),this._setBackgroundColor(or),this._setDefaultPropertiesFromJS(or),this.container.append(or),this.container}}class vs extends ms{constructor(zs){super(zs,{isRenderable:!!zs.data.hasOwnCanvas})}}class ws extends ms{constructor(zs){super(zs,{isRenderable:zs.renderForms})}render(){const zs=this.annotationStorage,Us=this.data,or=Us.id;let Er=zs.getValue(or,{value:Us.exportValue===Us.fieldValue}).value;typeof Er=="string"&&(Er=Er!=="Off",zs.setValue(or,{value:Er})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const vr=document.createElement("input");return xs.add(vr),vr.setAttribute("data-element-id",or),vr.disabled=Us.readOnly,this._setRequired(vr,this.data.required),vr.type="checkbox",vr.name=Us.fieldName,Er&&vr.setAttribute("checked",!0),vr.setAttribute("exportValue",Us.exportValue),vr.tabIndex=us,vr.addEventListener("change",Sr=>{const{name:_r,checked:Hr}=Sr.target;for(const Fr of this._getElementsByName(_r,or)){const Lr=Hr&&Fr.exportValue===Us.exportValue;Fr.domElement&&(Fr.domElement.checked=Lr),zs.setValue(Fr.id,{value:Lr})}zs.setValue(or,{value:Hr})}),vr.addEventListener("resetform",Sr=>{const _r=Us.defaultFieldValue||"Off";Sr.target.checked=_r===Us.exportValue}),this.enableScripting&&this.hasJSActions&&(vr.addEventListener("updatefromsandbox",Sr=>{const _r={value(Hr){Hr.target.checked=Hr.detail.value!=="Off",zs.setValue(or,{value:Hr.target.checked})}};this._dispatchEventFromSandbox(_r,Sr)}),this._setEventListeners(vr,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Sr=>Sr.target.checked)),this._setBackgroundColor(vr),this._setDefaultPropertiesFromJS(vr),this.container.append(vr),this.container}}class ys extends ms{constructor(zs){super(zs,{isRenderable:zs.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const zs=this.annotationStorage,Us=this.data,or=Us.id;let Er=zs.getValue(or,{value:Us.fieldValue===Us.buttonValue}).value;typeof Er=="string"&&(Er=Er!==Us.buttonValue,zs.setValue(or,{value:Er}));const vr=document.createElement("input");if(xs.add(vr),vr.setAttribute("data-element-id",or),vr.disabled=Us.readOnly,this._setRequired(vr,this.data.required),vr.type="radio",vr.name=Us.fieldName,Er&&vr.setAttribute("checked",!0),vr.tabIndex=us,vr.addEventListener("change",Sr=>{const{name:_r,checked:Hr}=Sr.target;for(const Fr of this._getElementsByName(_r,or))zs.setValue(Fr.id,{value:!1});zs.setValue(or,{value:Hr})}),vr.addEventListener("resetform",Sr=>{const _r=Us.defaultFieldValue;Sr.target.checked=_r!=null&&_r===Us.buttonValue}),this.enableScripting&&this.hasJSActions){const Sr=Us.buttonValue;vr.addEventListener("updatefromsandbox",_r=>{const Hr={value:Fr=>{const Lr=Sr===Fr.detail.value;for(const Yr of this._getElementsByName(Fr.target.name)){const $r=Lr&&Yr.id===or;Yr.domElement&&(Yr.domElement.checked=$r),zs.setValue(Yr.id,{value:$r})}}};this._dispatchEventFromSandbox(Hr,_r)}),this._setEventListeners(vr,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_r=>_r.target.checked)}return this._setBackgroundColor(vr),this._setDefaultPropertiesFromJS(vr),this.container.append(vr),this.container}}class Rs extends js{constructor(zs){super(zs,{ignoreBorder:zs.data.hasAppearance})}render(){const zs=super.render();zs.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(zs.title=this.data.alternativeText);const Us=zs.lastChild;return this.enableScripting&&this.hasJSActions&&Us&&(this._setDefaultPropertiesFromJS(Us),Us.addEventListener("updatefromsandbox",or=>{this._dispatchEventFromSandbox({},or)})),zs}}class bs extends ms{constructor(zs){super(zs,{isRenderable:zs.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const zs=this.annotationStorage,Us=this.data.id,or=zs.getValue(Us,{value:this.data.fieldValue}),Er=document.createElement("select");xs.add(Er),Er.setAttribute("data-element-id",Us),Er.disabled=this.data.readOnly,this._setRequired(Er,this.data.required),Er.name=this.data.fieldName,Er.tabIndex=us;let vr=this.data.combo&&this.data.options.length>0;this.data.combo||(Er.size=this.data.options.length,this.data.multiSelect&&(Er.multiple=!0)),Er.addEventListener("resetform",Lr=>{const Yr=this.data.defaultFieldValue;for(const $r of Er.options)$r.selected=$r.value===Yr});for(const Lr of this.data.options){const Yr=document.createElement("option");Yr.textContent=Lr.displayValue,Yr.value=Lr.exportValue,or.value.includes(Lr.exportValue)&&(Yr.setAttribute("selected",!0),vr=!1),Er.append(Yr)}let Sr=null;if(vr){const Lr=document.createElement("option");Lr.value=" ",Lr.setAttribute("hidden",!0),Lr.setAttribute("selected",!0),Er.prepend(Lr),Sr=()=>{Lr.remove(),Er.removeEventListener("input",Sr),Sr=null},Er.addEventListener("input",Sr)}const _r=Lr=>{const Yr=Lr?"value":"textContent",{options:$r,multiple:Wr}=Er;return Wr?Array.prototype.filter.call($r,Gr=>Gr.selected).map(Gr=>Gr[Yr]):$r.selectedIndex===-1?null:$r[$r.selectedIndex][Yr]};let Hr=_r(!1);const Fr=Lr=>{const Yr=Lr.target.options;return Array.prototype.map.call(Yr,$r=>({displayValue:$r.textContent,exportValue:$r.value}))};return this.enableScripting&&this.hasJSActions?(Er.addEventListener("updatefromsandbox",Lr=>{const Yr={value($r){Sr==null||Sr();const Wr=$r.detail.value,Gr=new Set(Array.isArray(Wr)?Wr:[Wr]);for(const Kr of Er.options)Kr.selected=Gr.has(Kr.value);zs.setValue(Us,{value:_r(!0)}),Hr=_r(!1)},multipleSelection($r){Er.multiple=!0},remove($r){const Wr=Er.options,Gr=$r.detail.remove;Wr[Gr].selected=!1,Er.remove(Gr),Wr.length>0&&Array.prototype.findIndex.call(Wr,_i=>_i.selected)===-1&&(Wr[0].selected=!0),zs.setValue(Us,{value:_r(!0),items:Fr($r)}),Hr=_r(!1)},clear($r){for(;Er.length!==0;)Er.remove(0);zs.setValue(Us,{value:null,items:[]}),Hr=_r(!1)},insert($r){const{index:Wr,displayValue:Gr,exportValue:Kr}=$r.detail.insert,_i=Er.children[Wr],so=document.createElement("option");so.textContent=Gr,so.value=Kr,_i?_i.before(so):Er.append(so),zs.setValue(Us,{value:_r(!0),items:Fr($r)}),Hr=_r(!1)},items($r){const{items:Wr}=$r.detail;for(;Er.length!==0;)Er.remove(0);for(const Gr of Wr){const{displayValue:Kr,exportValue:_i}=Gr,so=document.createElement("option");so.textContent=Kr,so.value=_i,Er.append(so)}Er.options.length>0&&(Er.options[0].selected=!0),zs.setValue(Us,{value:_r(!0),items:Fr($r)}),Hr=_r(!1)},indices($r){const Wr=new Set($r.detail.indices);for(const Gr of $r.target.options)Gr.selected=Wr.has(Gr.index);zs.setValue(Us,{value:_r(!0)}),Hr=_r(!1)},editable($r){$r.target.disabled=!$r.detail.editable}};this._dispatchEventFromSandbox(Yr,Lr)}),Er.addEventListener("input",Lr=>{var $r;const Yr=_r(!0);zs.setValue(Us,{value:Yr}),Lr.preventDefault(),($r=this.linkService.eventBus)==null||$r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Us,name:"Keystroke",value:Hr,changeEx:Yr,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Er,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Lr=>Lr.target.value)):Er.addEventListener("input",function(Lr){zs.setValue(Us,{value:_r(!0)})}),this.data.combo&&this._setTextStyle(Er),this._setBackgroundColor(Er),this._setDefaultPropertiesFromJS(Er),this.container.append(Er),this.container}}class Ns extends Es{constructor(zs){const{data:Us,elements:or}=zs;super(zs,{isRenderable:Es._hasPopupData(Us)}),this.elements=or}render(){this.container.classList.add("popupAnnotation");const zs=new Ss({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),Us=[];for(const or of this.elements)or.popup=zs,Us.push(or.data.id),or.addHighlightArea();return this.container.setAttribute("aria-controls",Us.map(or=>`${ns.AnnotationPrefix}${or}`).join(",")),this.container}}class Ss{constructor({container:zs,color:Us,elements:or,titleObj:Er,modificationDate:vr,contentsObj:Sr,richText:_r,parent:Hr,rect:Fr,parentRect:Lr,open:Yr}){mr(this,Tr);mr(this,Gs,null);mr(this,lr,ar(this,Tr,_c).bind(this));mr(this,jr,ar(this,Tr,Rl).bind(this));mr(this,br,ar(this,Tr,yl).bind(this));mr(this,Nr,ar(this,Tr,Mo).bind(this));mr(this,wr,null);mr(this,dr,null);mr(this,hr,null);mr(this,Bs,null);mr(this,qs,null);mr(this,cr,null);mr(this,xr,!1);mr(this,yr,null);mr(this,Ar,null);mr(this,Cr,null);mr(this,ur,null);mr(this,Pr,!1);var Wr;fr(this,dr,zs),fr(this,ur,Er),fr(this,hr,Sr),fr(this,Cr,_r),fr(this,qs,Hr),fr(this,wr,Us),fr(this,Ar,Fr),fr(this,cr,Lr),fr(this,Bs,or);const $r=rs.PDFDateString.toDateObject(vr);$r&&fr(this,Gs,Hr.l10n.get("annotation_date_string",{date:$r.toLocaleDateString(),time:$r.toLocaleTimeString()})),this.trigger=or.flatMap(Gr=>Gr.getElementsToTriggerPopup());for(const Gr of this.trigger)Gr.addEventListener("click",ks(this,Nr)),Gr.addEventListener("mouseenter",ks(this,br)),Gr.addEventListener("mouseleave",ks(this,jr)),Gr.classList.add("popupTriggerArea");for(const Gr of or)(Wr=Gr.container)==null||Wr.addEventListener("keydown",ks(this,lr));ks(this,dr).hidden=!0,Yr&&ar(this,Tr,Mo).call(this)}render(){if(ks(this,yr))return;const{page:{view:zs},viewport:{rawDims:{pageWidth:Us,pageHeight:or,pageX:Er,pageY:vr}}}=ks(this,qs),Sr=fr(this,yr,document.createElement("div"));if(Sr.className="popup",ks(this,wr)){const no=Sr.style.outlineColor=ns.Util.makeHexColor(...ks(this,wr));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Sr.style.backgroundColor=`color-mix(in srgb, ${no} 30%, white)`:Sr.style.backgroundColor=ns.Util.makeHexColor(...ks(this,wr).map(lo=>Math.floor(.7*(255-lo)+lo)))}const _r=document.createElement("span");_r.className="header";const Hr=document.createElement("h1");if(_r.append(Hr),{dir:Hr.dir,str:Hr.textContent}=ks(this,ur),Sr.append(_r),ks(this,Gs)){const no=document.createElement("span");no.classList.add("popupDate"),ks(this,Gs).then(oo=>{no.textContent=oo}),_r.append(no)}const Fr=ks(this,hr),Lr=ks(this,Cr);if(Lr!=null&&Lr.str&&(!(Fr!=null&&Fr.str)||Fr.str===Lr.str))ls.XfaLayer.render({xfaHtml:Lr.html,intent:"richText",div:Sr}),Sr.lastChild.classList.add("richText","popupContent");else{const no=this._formatContents(Fr);Sr.append(no)}let Yr=!!ks(this,cr),$r=Yr?ks(this,cr):ks(this,Ar);for(const no of ks(this,Bs))if(!$r||ns.Util.intersect(no.data.rect,$r)!==null){$r=no.data.rect,Yr=!0;break}const Wr=ns.Util.normalizeRect([$r[0],zs[3]-$r[1]+zs[1],$r[2],zs[3]-$r[3]+zs[1]]),Kr=Yr?$r[2]-$r[0]+5:0,_i=Wr[0]+Kr,so=Wr[1],{style:ro}=ks(this,dr);ro.left=`${100*(_i-Er)/Us}%`,ro.top=`${100*(so-vr)/or}%`,ks(this,dr).append(Sr)}_formatContents({str:zs,dir:Us}){const or=document.createElement("p");or.classList.add("popupContent"),or.dir=Us;const Er=zs.split(/(?:\r\n?|\n)/);for(let vr=0,Sr=Er.length;vr<Sr;++vr){const _r=Er[vr];or.append(document.createTextNode(_r)),vr<Sr-1&&or.append(document.createElement("br"))}return or}forceHide(){fr(this,Pr,this.isVisible),ks(this,Pr)&&(ks(this,dr).hidden=!0)}maybeShow(){ks(this,Pr)&&(fr(this,Pr,!1),ks(this,dr).hidden=!1)}get isVisible(){return ks(this,dr).hidden===!1}}Gs=new WeakMap,lr=new WeakMap,jr=new WeakMap,br=new WeakMap,Nr=new WeakMap,wr=new WeakMap,dr=new WeakMap,hr=new WeakMap,Bs=new WeakMap,qs=new WeakMap,cr=new WeakMap,xr=new WeakMap,yr=new WeakMap,Ar=new WeakMap,Cr=new WeakMap,ur=new WeakMap,Pr=new WeakMap,Tr=new WeakSet,_c=function(zs){zs.altKey||zs.shiftKey||zs.ctrlKey||zs.metaKey||(zs.key==="Enter"||zs.key==="Escape"&&ks(this,xr))&&ar(this,Tr,Mo).call(this)},Mo=function(){fr(this,xr,!ks(this,xr)),ks(this,xr)?(ar(this,Tr,yl).call(this),ks(this,dr).addEventListener("click",ks(this,Nr)),ks(this,dr).addEventListener("keydown",ks(this,lr))):(ar(this,Tr,Rl).call(this),ks(this,dr).removeEventListener("click",ks(this,Nr)),ks(this,dr).removeEventListener("keydown",ks(this,lr)))},yl=function(){ks(this,yr)||this.render(),this.isVisible?ks(this,xr)&&ks(this,dr).classList.add("focused"):(ks(this,dr).hidden=!1,ks(this,dr).style.zIndex=parseInt(ks(this,dr).style.zIndex)+1e3)},Rl=function(){ks(this,dr).classList.remove("focused"),!(ks(this,xr)||!this.isVisible)&&(ks(this,dr).hidden=!0,ks(this,dr).style.zIndex=parseInt(ks(this,dr).style.zIndex)-1e3)};class Ts extends Es{constructor(zs){super(zs,{isRenderable:!0,ignoreBorder:!0}),this.textContent=zs.data.textContent,this.textPosition=zs.data.textPosition,this.annotationEditorType=ns.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const zs=document.createElement("div");zs.classList.add("annotationTextContent"),zs.setAttribute("role","comment");for(const Us of this.textContent){const or=document.createElement("span");or.textContent=Us,zs.append(or)}this.container.append(zs)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}ts.FreeTextAnnotationElement=Ts;class Cs extends Es{constructor(Us){super(Us,{isRenderable:!0,ignoreBorder:!0});mr(this,zr,null)}render(){this.container.classList.add("lineAnnotation");const Us=this.data,{width:or,height:Er}=fs(Us.rect),vr=this.svgFactory.create(or,Er,!0),Sr=fr(this,zr,this.svgFactory.createElement("svg:line"));return Sr.setAttribute("x1",Us.rect[2]-Us.lineCoordinates[0]),Sr.setAttribute("y1",Us.rect[3]-Us.lineCoordinates[1]),Sr.setAttribute("x2",Us.rect[2]-Us.lineCoordinates[2]),Sr.setAttribute("y2",Us.rect[3]-Us.lineCoordinates[3]),Sr.setAttribute("stroke-width",Us.borderStyle.width||1),Sr.setAttribute("stroke","transparent"),Sr.setAttribute("fill","transparent"),vr.append(Sr),this.container.append(vr),!Us.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ks(this,zr)}addHighlightArea(){this.container.classList.add("highlightArea")}}zr=new WeakMap;class Ms extends Es{constructor(Us){super(Us,{isRenderable:!0,ignoreBorder:!0});mr(this,Zr,null)}render(){this.container.classList.add("squareAnnotation");const Us=this.data,{width:or,height:Er}=fs(Us.rect),vr=this.svgFactory.create(or,Er,!0),Sr=Us.borderStyle.width,_r=fr(this,Zr,this.svgFactory.createElement("svg:rect"));return _r.setAttribute("x",Sr/2),_r.setAttribute("y",Sr/2),_r.setAttribute("width",or-Sr),_r.setAttribute("height",Er-Sr),_r.setAttribute("stroke-width",Sr||1),_r.setAttribute("stroke","transparent"),_r.setAttribute("fill","transparent"),vr.append(_r),this.container.append(vr),!Us.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ks(this,Zr)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zr=new WeakMap;class Is extends Es{constructor(Us){super(Us,{isRenderable:!0,ignoreBorder:!0});mr(this,to,null)}render(){this.container.classList.add("circleAnnotation");const Us=this.data,{width:or,height:Er}=fs(Us.rect),vr=this.svgFactory.create(or,Er,!0),Sr=Us.borderStyle.width,_r=fr(this,to,this.svgFactory.createElement("svg:ellipse"));return _r.setAttribute("cx",or/2),_r.setAttribute("cy",Er/2),_r.setAttribute("rx",or/2-Sr/2),_r.setAttribute("ry",Er/2-Sr/2),_r.setAttribute("stroke-width",Sr||1),_r.setAttribute("stroke","transparent"),_r.setAttribute("fill","transparent"),vr.append(_r),this.container.append(vr),!Us.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ks(this,to)}addHighlightArea(){this.container.classList.add("highlightArea")}}to=new WeakMap;class Qs extends Es{constructor(Us){super(Us,{isRenderable:!0,ignoreBorder:!0});mr(this,kr,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const Us=this.data,{width:or,height:Er}=fs(Us.rect),vr=this.svgFactory.create(or,Er,!0);let Sr=[];for(const Hr of Us.vertices){const Fr=Hr.x-Us.rect[0],Lr=Us.rect[3]-Hr.y;Sr.push(Fr+","+Lr)}Sr=Sr.join(" ");const _r=fr(this,kr,this.svgFactory.createElement(this.svgElementName));return _r.setAttribute("points",Sr),_r.setAttribute("stroke-width",Us.borderStyle.width||1),_r.setAttribute("stroke","transparent"),_r.setAttribute("fill","transparent"),vr.append(_r),this.container.append(vr),!Us.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ks(this,kr)}addHighlightArea(){this.container.classList.add("highlightArea")}}kr=new WeakMap;class Ys extends Qs{constructor(zs){super(zs),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Zs extends Es{constructor(zs){super(zs,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Vs extends Es{constructor(Us){super(Us,{isRenderable:!0,ignoreBorder:!0});mr(this,pr,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=ns.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const Us=this.data,{width:or,height:Er}=fs(Us.rect),vr=this.svgFactory.create(or,Er,!0);for(const Sr of Us.inkLists){let _r=[];for(const Fr of Sr){const Lr=Fr.x-Us.rect[0],Yr=Us.rect[3]-Fr.y;_r.push(`${Lr},${Yr}`)}_r=_r.join(" ");const Hr=this.svgFactory.createElement(this.svgElementName);ks(this,pr).push(Hr),Hr.setAttribute("points",_r),Hr.setAttribute("stroke-width",Us.borderStyle.width||1),Hr.setAttribute("stroke","transparent"),Hr.setAttribute("fill","transparent"),!Us.popupRef&&this.hasPopupData&&this._createPopup(),vr.append(Hr)}return this.container.append(vr),this.container}getElementsToTriggerPopup(){return ks(this,pr)}addHighlightArea(){this.container.classList.add("highlightArea")}}pr=new WeakMap,ts.InkAnnotationElement=Vs;class Ks extends Es{constructor(zs){super(zs,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Ds extends Es{constructor(zs){super(zs,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class $s extends Es{constructor(zs){super(zs,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Xs extends Es{constructor(zs){super(zs,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Fs extends Es{constructor(zs){super(zs,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}ts.StampAnnotationElement=Fs;class As extends Es{constructor(Us){var vr;super(Us,{isRenderable:!0});mr(this,Ir);mr(this,gr,null);const{filename:or,content:Er}=this.data.file;this.filename=(0,rs.getFilenameFromUrl)(or,!0),this.content=Er,(vr=this.linkService.eventBus)==null||vr.dispatch("fileattachmentannotation",{source:this,filename:or,content:Er})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:Us,data:or}=this;let Er;or.hasAppearance||or.fillAlpha===0?Er=document.createElement("div"):(Er=document.createElement("img"),Er.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(or.name)?"paperclip":"pushpin"}.svg`,or.fillAlpha&&or.fillAlpha<1&&(Er.style=`filter: opacity(${Math.round(or.fillAlpha*100)}%);`)),Er.addEventListener("dblclick",ar(this,Ir,wl).bind(this)),fr(this,gr,Er);const{isMac:vr}=ns.FeatureTest.platform;return Us.addEventListener("keydown",Sr=>{Sr.key==="Enter"&&(vr?Sr.metaKey:Sr.ctrlKey)&&ar(this,Ir,wl).call(this)}),!or.popupRef&&this.hasPopupData?this._createPopup():Er.classList.add("popupTriggerArea"),Us.append(Er),Us}getElementsToTriggerPopup(){return ks(this,gr)}addHighlightArea(){this.container.classList.add("highlightArea")}}gr=new WeakMap,Ir=new WeakSet,wl=function(){var Us;(Us=this.downloadManager)==null||Us.openOrDownloadData(this.container,this.content,this.filename)};class _s{constructor({div:zs,accessibilityManager:Us,annotationCanvasMap:or,l10n:Er,page:vr,viewport:Sr}){mr(this,Mr);mr(this,qr,null);mr(this,Js,null);mr(this,Rr,new Map);this.div=zs,fr(this,qr,Us),fr(this,Js,or),this.l10n=Er,this.page=vr,this.viewport=Sr,this.zIndex=0,this.l10n||(this.l10n=cs.NullL10n)}async render(zs){const{annotations:Us}=zs,or=this.div;(0,rs.setLayerDimensions)(or,this.viewport);const Er=new Map,vr={data:null,layer:or,linkService:zs.linkService,downloadManager:zs.downloadManager,imageResourcesPath:zs.imageResourcesPath||"",renderForms:zs.renderForms!==!1,svgFactory:new rs.DOMSVGFactory,annotationStorage:zs.annotationStorage||new os.AnnotationStorage,enableScripting:zs.enableScripting===!0,hasJSActions:zs.hasJSActions,fieldObjects:zs.fieldObjects,parent:this,elements:null};for(const Sr of Us){if(Sr.noHTML)continue;const _r=Sr.annotationType===ns.AnnotationType.POPUP;if(_r){const Lr=Er.get(Sr.id);if(!Lr)continue;vr.elements=Lr}else{const{width:Lr,height:Yr}=fs(Sr.rect);if(Lr<=0||Yr<=0)continue}vr.data=Sr;const Hr=gs.create(vr);if(!Hr.isRenderable)continue;if(!_r&&Sr.popupRef){const Lr=Er.get(Sr.popupRef);Lr?Lr.push(Hr):Er.set(Sr.popupRef,[Hr])}Hr.annotationEditorType>0&&ks(this,Rr).set(Hr.data.id,Hr);const Fr=Hr.render();Sr.hidden&&(Fr.style.visibility="hidden"),ar(this,Mr,eu).call(this,Fr,Sr.id)}ar(this,Mr,Nl).call(this),await this.l10n.translate(or)}update({viewport:zs}){const Us=this.div;this.viewport=zs,(0,rs.setLayerDimensions)(Us,{rotation:zs.rotation}),ar(this,Mr,Nl).call(this),Us.hidden=!1}getEditableAnnotations(){return Array.from(ks(this,Rr).values())}getEditableAnnotation(zs){return ks(this,Rr).get(zs)}}qr=new WeakMap,Js=new WeakMap,Rr=new WeakMap,Mr=new WeakSet,eu=function(zs,Us){var Er;const or=zs.firstChild||zs;or.id=`${ns.AnnotationPrefix}${Us}`,this.div.append(zs),(Er=ks(this,qr))==null||Er.moveElementInDOM(this.div,zs,or,!1)},Nl=function(){if(!ks(this,Js))return;const zs=this.div;for(const[Us,or]of ks(this,Js)){const Er=zs.querySelector(`[data-annotation-id="${Us}"]`);if(!Er)continue;const{firstChild:vr}=Er;vr?vr.nodeName==="CANVAS"?vr.replaceWith(or):vr.before(or):Er.append(or)}ks(this,Js).clear()},ts.AnnotationLayer=_s},(es,ts)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.ColorConverters=void 0;function ss(os){return Math.floor(Math.max(0,Math.min(1,os))*255).toString(16).padStart(2,"0")}function ns(os){return Math.max(0,Math.min(255,255*os))}class rs{static CMYK_G([as,cs,ls,us]){return["G",1-Math.min(1,.3*as+.59*ls+.11*cs+us)]}static G_CMYK([as]){return["CMYK",0,0,0,1-as]}static G_RGB([as]){return["RGB",as,as,as]}static G_rgb([as]){return as=ns(as),[as,as,as]}static G_HTML([as]){const cs=ss(as);return`#${cs}${cs}${cs}`}static RGB_G([as,cs,ls]){return["G",.3*as+.59*cs+.11*ls]}static RGB_rgb(as){return as.map(ns)}static RGB_HTML(as){return`#${as.map(ss).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([as,cs,ls,us]){return["RGB",1-Math.min(1,as+us),1-Math.min(1,ls+us),1-Math.min(1,cs+us)]}static CMYK_rgb([as,cs,ls,us]){return[ns(1-Math.min(1,as+us)),ns(1-Math.min(1,ls+us)),ns(1-Math.min(1,cs+us))]}static CMYK_HTML(as){const cs=this.CMYK_RGB(as).slice(1);return this.RGB_HTML(cs)}static RGB_CMYK([as,cs,ls]){const us=1-as,ds=1-cs,xs=1-ls,fs=Math.min(us,ds,xs);return["CMYK",us,ds,xs,fs]}}ts.ColorConverters=rs},(es,ts)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.NullL10n=void 0,ts.getL10nFallback=ns;const ss={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};ss.print_progress_percent="{{progress}}%";function ns(as,cs){switch(as){case"find_match_count":as=`find_match_count[${cs.total===1?"one":"other"}]`;break;case"find_match_count_limit":as=`find_match_count_limit[${cs.limit===1?"one":"other"}]`;break}return ss[as]||""}function rs(as,cs){return cs?as.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(ls,us)=>us in cs?cs[us]:"{{"+us+"}}"):as}const os={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(as,cs=null,ls=ns(as,cs)){return rs(ls,cs)},async translate(as){}};ts.NullL10n=os},(es,ts,ss)=>{Object.defineProperty(ts,"__esModule",{value:!0}),ts.XfaLayer=void 0;var ns=ss(25);class rs{static setupStorage(as,cs,ls,us,ds){const xs=us.getValue(cs,{value:null});switch(ls.name){case"textarea":if(xs.value!==null&&(as.textContent=xs.value),ds==="print")break;as.addEventListener("input",fs=>{us.setValue(cs,{value:fs.target.value})});break;case"input":if(ls.attributes.type==="radio"||ls.attributes.type==="checkbox"){if(xs.value===ls.attributes.xfaOn?as.setAttribute("checked",!0):xs.value===ls.attributes.xfaOff&&as.removeAttribute("checked"),ds==="print")break;as.addEventListener("change",fs=>{us.setValue(cs,{value:fs.target.checked?fs.target.getAttribute("xfaOn"):fs.target.getAttribute("xfaOff")})})}else{if(xs.value!==null&&as.setAttribute("value",xs.value),ds==="print")break;as.addEventListener("input",fs=>{us.setValue(cs,{value:fs.target.value})})}break;case"select":if(xs.value!==null){as.setAttribute("value",xs.value);for(const fs of ls.children)fs.attributes.value===xs.value?fs.attributes.selected=!0:fs.attributes.hasOwnProperty("selected")&&delete fs.attributes.selected}as.addEventListener("input",fs=>{const gs=fs.target.options,Es=gs.selectedIndex===-1?"":gs[gs.selectedIndex].value;us.setValue(cs,{value:Es})});break}}static setAttributes({html:as,element:cs,storage:ls=null,intent:us,linkService:ds}){const{attributes:xs}=cs,fs=as instanceof HTMLAnchorElement;xs.type==="radio"&&(xs.name=`${xs.name}-${us}`);for(const[gs,Es]of Object.entries(xs))if(Es!=null)switch(gs){case"class":Es.length&&as.setAttribute(gs,Es.join(" "));break;case"dataId":break;case"id":as.setAttribute("data-element-id",Es);break;case"style":Object.assign(as.style,Es);break;case"textContent":as.textContent=Es;break;default:(!fs||gs!=="href"&&gs!=="newWindow")&&as.setAttribute(gs,Es)}fs&&ds.addLinkAttributes(as,xs.href,xs.newWindow),ls&&xs.dataId&&this.setupStorage(as,xs.dataId,cs,ls)}static render(as){var js;const cs=as.annotationStorage,ls=as.linkService,us=as.xfaHtml,ds=as.intent||"display",xs=document.createElement(us.name);us.attributes&&this.setAttributes({html:xs,element:us,intent:ds,linkService:ls});const fs=[[us,-1,xs]],gs=as.div;if(gs.append(xs),as.viewport){const ps=`matrix(${as.viewport.transform.join(",")})`;gs.style.transform=ps}ds!=="richText"&&gs.setAttribute("class","xfaLayer xfaFont");const Es=[];for(;fs.length>0;){const[ps,ms,hs]=fs.at(-1);if(ms+1===ps.children.length){fs.pop();continue}const vs=ps.children[++fs.at(-1)[1]];if(vs===null)continue;const{name:ws}=vs;if(ws==="#text"){const Rs=document.createTextNode(vs.value);Es.push(Rs),hs.append(Rs);continue}const ys=(js=vs==null?void 0:vs.attributes)!=null&&js.xmlns?document.createElementNS(vs.attributes.xmlns,ws):document.createElement(ws);if(hs.append(ys),vs.attributes&&this.setAttributes({html:ys,element:vs,storage:cs,intent:ds,linkService:ls}),vs.children&&vs.children.length>0)fs.push([vs,-1,ys]);else if(vs.value){const Rs=document.createTextNode(vs.value);ns.XfaText.shouldBuildText(ws)&&Es.push(Rs),ys.append(Rs)}}for(const ps of gs.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))ps.setAttribute("readOnly",!0);return{textDivs:Es}}static update(as){const cs=`matrix(${as.viewport.transform.join(",")})`;as.div.style.transform=cs,as.div.hidden=!1}}ts.XfaLayer=rs},(es,ts,ss)=>{var us,ds,xs,fs,gs,Es,js,ps,ms,hs,vs,ws,ys,Rs,bs,tu,su,nu,ru,Sl,iu,Cl,ou,au,lu,cu,uu,ao,Al,Po,Lo,po,_l,Do,Ls,du,Tl,hu,xu,Ml,Io,fo;Object.defineProperty(ts,"__esModule",{value:!0}),ts.InkEditor=void 0;var ns=ss(1),rs=ss(4),os=ss(29),as=ss(6),cs=ss(5);const wr=class wr extends rs.AnnotationEditor{constructor(Bs){super({...Bs,name:"inkEditor"});mr(this,bs);mr(this,us,0);mr(this,ds,0);mr(this,xs,this.canvasPointermove.bind(this));mr(this,fs,this.canvasPointerleave.bind(this));mr(this,gs,this.canvasPointerup.bind(this));mr(this,Es,this.canvasPointerdown.bind(this));mr(this,js,new Path2D);mr(this,ps,!1);mr(this,ms,!1);mr(this,hs,!1);mr(this,vs,null);mr(this,ws,0);mr(this,ys,0);mr(this,Rs,null);this.color=Bs.color||null,this.thickness=Bs.thickness||null,this.opacity=Bs.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Bs){rs.AnnotationEditor.initialize(Bs,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Bs,qs){switch(Bs){case ns.AnnotationEditorParamsType.INK_THICKNESS:wr._defaultThickness=qs;break;case ns.AnnotationEditorParamsType.INK_COLOR:wr._defaultColor=qs;break;case ns.AnnotationEditorParamsType.INK_OPACITY:wr._defaultOpacity=qs/100;break}}updateParams(Bs,qs){switch(Bs){case ns.AnnotationEditorParamsType.INK_THICKNESS:ar(this,bs,tu).call(this,qs);break;case ns.AnnotationEditorParamsType.INK_COLOR:ar(this,bs,su).call(this,qs);break;case ns.AnnotationEditorParamsType.INK_OPACITY:ar(this,bs,nu).call(this,qs);break}}static get defaultPropertiesToUpdate(){return[[ns.AnnotationEditorParamsType.INK_THICKNESS,wr._defaultThickness],[ns.AnnotationEditorParamsType.INK_COLOR,wr._defaultColor||rs.AnnotationEditor._defaultLineColor],[ns.AnnotationEditorParamsType.INK_OPACITY,Math.round(wr._defaultOpacity*100)]]}get propertiesToUpdate(){return[[ns.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||wr._defaultThickness],[ns.AnnotationEditorParamsType.INK_COLOR,this.color||wr._defaultColor||rs.AnnotationEditor._defaultLineColor],[ns.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??wr._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(ar(this,bs,Po).call(this),ar(this,bs,Lo).call(this)),this.isAttachedToDOM||(this.parent.add(this),ar(this,bs,po).call(this)),ar(this,bs,fo).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,ks(this,vs).disconnect(),fr(this,vs,null),super.remove())}setParent(Bs){!this.parent&&Bs?this._uiManager.removeShouldRescale(this):this.parent&&Bs===null&&this._uiManager.addShouldRescale(this),super.setParent(Bs)}onScaleChanging(){const[Bs,qs]=this.parentDimensions,cr=this.width*Bs,xr=this.height*qs;this.setDimensions(cr,xr)}enableEditMode(){ks(this,ps)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",ks(this,Es)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",ks(this,Es)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){ks(this,ps)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),fr(this,ps,!0),this.div.classList.add("disabled"),ar(this,bs,fo).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Bs){this._focusEventsAllowed&&(super.focusin(Bs),this.enableEditMode())}canvasPointerdown(Bs){Bs.button!==0||!this.isInEditMode()||ks(this,ps)||(this.setInForeground(),Bs.preventDefault(),Bs.type!=="mouse"&&this.div.focus(),ar(this,bs,iu).call(this,Bs.offsetX,Bs.offsetY))}canvasPointermove(Bs){Bs.preventDefault(),ar(this,bs,Cl).call(this,Bs.offsetX,Bs.offsetY)}canvasPointerup(Bs){Bs.preventDefault(),ar(this,bs,Al).call(this,Bs)}canvasPointerleave(Bs){ar(this,bs,Al).call(this,Bs)}get isResizable(){return!this.isEmpty()&&ks(this,ps)}render(){if(this.div)return this.div;let Bs,qs;this.width&&(Bs=this.x,qs=this.y),super.render(),rs.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Cr=>{var ur;return(ur=this.div)==null?void 0:ur.setAttribute("aria-label",Cr)});const[cr,xr,yr,Ar]=ar(this,bs,ru).call(this);if(this.setAt(cr,xr,0,0),this.setDims(yr,Ar),ar(this,bs,Po).call(this),this.width){const[Cr,ur]=this.parentDimensions;this.setAspectRatio(this.width*Cr,this.height*ur),this.setAt(Bs*Cr,qs*ur,this.width*Cr,this.height*ur),fr(this,hs,!0),ar(this,bs,po).call(this),this.setDims(this.width*Cr,this.height*ur),ar(this,bs,ao).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ar(this,bs,Lo).call(this),this.div}setDimensions(Bs,qs){const cr=Math.round(Bs),xr=Math.round(qs);if(ks(this,ws)===cr&&ks(this,ys)===xr)return;fr(this,ws,cr),fr(this,ys,xr),this.canvas.style.visibility="hidden";const[yr,Ar]=this.parentDimensions;this.width=Bs/yr,this.height=qs/Ar,this.fixAndSetPosition(),ks(this,ps)&&ar(this,bs,_l).call(this,Bs,qs),ar(this,bs,po).call(this),ar(this,bs,ao).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Bs,qs,cr){var zr,Zr,to;if(Bs instanceof os.InkAnnotationElement)return null;const xr=super.deserialize(Bs,qs,cr);xr.thickness=Bs.thickness,xr.color=ns.Util.makeHexColor(...Bs.color),xr.opacity=Bs.opacity;const[yr,Ar]=xr.pageDimensions,Cr=xr.width*yr,ur=xr.height*Ar,Pr=xr.parentScale,Tr=Bs.thickness/2;fr(xr,ps,!0),fr(xr,ws,Math.round(Cr)),fr(xr,ys,Math.round(ur));const{paths:Xr,rect:Vr,rotation:Qr}=Bs;for(let{bezier:kr}of Xr){kr=ar(zr=wr,Ls,hu).call(zr,kr,Vr,Qr);const pr=[];xr.paths.push(pr);let gr=Pr*(kr[0]-Tr),Ir=Pr*(kr[1]-Tr);for(let qr=2,Js=kr.length;qr<Js;qr+=6){const Rr=Pr*(kr[qr]-Tr),Mr=Pr*(kr[qr+1]-Tr),Br=Pr*(kr[qr+2]-Tr),Ur=Pr*(kr[qr+3]-Tr),Dr=Pr*(kr[qr+4]-Tr),zs=Pr*(kr[qr+5]-Tr);pr.push([[gr,Ir],[Rr,Mr],[Br,Ur],[Dr,zs]]),gr=Dr,Ir=zs}const Jr=ar(this,Ls,du).call(this,pr);xr.bezierPath2D.push(Jr)}const Or=ar(Zr=xr,bs,Ml).call(Zr);return fr(xr,ds,Math.max(rs.AnnotationEditor.MIN_SIZE,Or[2]-Or[0])),fr(xr,us,Math.max(rs.AnnotationEditor.MIN_SIZE,Or[3]-Or[1])),ar(to=xr,bs,_l).call(to,Cr,ur),xr}serialize(){if(this.isEmpty())return null;const Bs=this.getRect(0,0),qs=rs.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:ns.AnnotationEditorType.INK,color:qs,thickness:this.thickness,opacity:this.opacity,paths:ar(this,bs,xu).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Bs),pageIndex:this.pageIndex,rect:Bs,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};us=new WeakMap,ds=new WeakMap,xs=new WeakMap,fs=new WeakMap,gs=new WeakMap,Es=new WeakMap,js=new WeakMap,ps=new WeakMap,ms=new WeakMap,hs=new WeakMap,vs=new WeakMap,ws=new WeakMap,ys=new WeakMap,Rs=new WeakMap,bs=new WeakSet,tu=function(Bs){const qs=this.thickness;this.addCommands({cmd:()=>{this.thickness=Bs,ar(this,bs,fo).call(this)},undo:()=>{this.thickness=qs,ar(this,bs,fo).call(this)},mustExec:!0,type:ns.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},su=function(Bs){const qs=this.color;this.addCommands({cmd:()=>{this.color=Bs,ar(this,bs,ao).call(this)},undo:()=>{this.color=qs,ar(this,bs,ao).call(this)},mustExec:!0,type:ns.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},nu=function(Bs){Bs/=100;const qs=this.opacity;this.addCommands({cmd:()=>{this.opacity=Bs,ar(this,bs,ao).call(this)},undo:()=>{this.opacity=qs,ar(this,bs,ao).call(this)},mustExec:!0,type:ns.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},ru=function(){const{parentRotation:Bs,parentDimensions:[qs,cr]}=this;switch(Bs){case 90:return[0,cr,cr,qs];case 180:return[qs,cr,qs,cr];case 270:return[qs,0,cr,qs];default:return[0,0,qs,cr]}},Sl=function(){const{ctx:Bs,color:qs,opacity:cr,thickness:xr,parentScale:yr,scaleFactor:Ar}=this;Bs.lineWidth=xr*yr/Ar,Bs.lineCap="round",Bs.lineJoin="round",Bs.miterLimit=10,Bs.strokeStyle=`${qs}${(0,cs.opacityToHex)(cr)}`},iu=function(Bs,qs){this.canvas.addEventListener("contextmenu",as.noContextMenu),this.canvas.addEventListener("pointerleave",ks(this,fs)),this.canvas.addEventListener("pointermove",ks(this,xs)),this.canvas.addEventListener("pointerup",ks(this,gs)),this.canvas.removeEventListener("pointerdown",ks(this,Es)),this.isEditing=!0,ks(this,hs)||(fr(this,hs,!0),ar(this,bs,po).call(this),this.thickness||(this.thickness=wr._defaultThickness),this.color||(this.color=wr._defaultColor||rs.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=wr._defaultOpacity)),this.currentPath.push([Bs,qs]),fr(this,ms,!1),ar(this,bs,Sl).call(this),fr(this,Rs,()=>{ar(this,bs,lu).call(this),ks(this,Rs)&&window.requestAnimationFrame(ks(this,Rs))}),window.requestAnimationFrame(ks(this,Rs))},Cl=function(Bs,qs){const[cr,xr]=this.currentPath.at(-1);if(this.currentPath.length>1&&Bs===cr&&qs===xr)return;const yr=this.currentPath;let Ar=ks(this,js);if(yr.push([Bs,qs]),fr(this,ms,!0),yr.length<=2){Ar.moveTo(...yr[0]),Ar.lineTo(Bs,qs);return}yr.length===3&&(fr(this,js,Ar=new Path2D),Ar.moveTo(...yr[0])),ar(this,bs,cu).call(this,Ar,...yr.at(-3),...yr.at(-2),Bs,qs)},ou=function(){if(this.currentPath.length===0)return;const Bs=this.currentPath.at(-1);ks(this,js).lineTo(...Bs)},au=function(Bs,qs){fr(this,Rs,null),Bs=Math.min(Math.max(Bs,0),this.canvas.width),qs=Math.min(Math.max(qs,0),this.canvas.height),ar(this,bs,Cl).call(this,Bs,qs),ar(this,bs,ou).call(this);let cr;if(this.currentPath.length!==1)cr=ar(this,bs,uu).call(this);else{const ur=[Bs,qs];cr=[[ur,ur.slice(),ur.slice(),ur]]}const xr=ks(this,js),yr=this.currentPath;this.currentPath=[],fr(this,js,new Path2D);const Ar=()=>{this.allRawPaths.push(yr),this.paths.push(cr),this.bezierPath2D.push(xr),this.rebuild()},Cr=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ar(this,bs,Po).call(this),ar(this,bs,Lo).call(this)),ar(this,bs,fo).call(this))};this.addCommands({cmd:Ar,undo:Cr,mustExec:!0})},lu=function(){if(!ks(this,ms))return;fr(this,ms,!1);const Bs=Math.ceil(this.thickness*this.parentScale),qs=this.currentPath.slice(-3),cr=qs.map(Ar=>Ar[0]),xr=qs.map(Ar=>Ar[1]);Math.min(...cr)-Bs,Math.max(...cr)+Bs,Math.min(...xr)-Bs,Math.max(...xr)+Bs;const{ctx:yr}=this;yr.save(),yr.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Ar of this.bezierPath2D)yr.stroke(Ar);yr.stroke(ks(this,js)),yr.restore()},cu=function(Bs,qs,cr,xr,yr,Ar,Cr){const ur=(qs+xr)/2,Pr=(cr+yr)/2,Tr=(xr+Ar)/2,Xr=(yr+Cr)/2;Bs.bezierCurveTo(ur+2*(xr-ur)/3,Pr+2*(yr-Pr)/3,Tr+2*(xr-Tr)/3,Xr+2*(yr-Xr)/3,Tr,Xr)},uu=function(){const Bs=this.currentPath;if(Bs.length<=2)return[[Bs[0],Bs[0],Bs.at(-1),Bs.at(-1)]];const qs=[];let cr,[xr,yr]=Bs[0];for(cr=1;cr<Bs.length-2;cr++){const[Vr,Qr]=Bs[cr],[Or,zr]=Bs[cr+1],Zr=(Vr+Or)/2,to=(Qr+zr)/2,kr=[xr+2*(Vr-xr)/3,yr+2*(Qr-yr)/3],pr=[Zr+2*(Vr-Zr)/3,to+2*(Qr-to)/3];qs.push([[xr,yr],kr,pr,[Zr,to]]),[xr,yr]=[Zr,to]}const[Ar,Cr]=Bs[cr],[ur,Pr]=Bs[cr+1],Tr=[xr+2*(Ar-xr)/3,yr+2*(Cr-yr)/3],Xr=[ur+2*(Ar-ur)/3,Pr+2*(Cr-Pr)/3];return qs.push([[xr,yr],Tr,Xr,[ur,Pr]]),qs},ao=function(){if(this.isEmpty()){ar(this,bs,Do).call(this);return}ar(this,bs,Sl).call(this);const{canvas:Bs,ctx:qs}=this;qs.setTransform(1,0,0,1,0,0),qs.clearRect(0,0,Bs.width,Bs.height),ar(this,bs,Do).call(this);for(const cr of this.bezierPath2D)qs.stroke(cr)},Al=function(Bs){this.canvas.removeEventListener("pointerleave",ks(this,fs)),this.canvas.removeEventListener("pointermove",ks(this,xs)),this.canvas.removeEventListener("pointerup",ks(this,gs)),this.canvas.addEventListener("pointerdown",ks(this,Es)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",as.noContextMenu)},10),ar(this,bs,au).call(this,Bs.offsetX,Bs.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Po=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",rs.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Bs=>{var qs;return(qs=this.canvas)==null?void 0:qs.setAttribute("aria-label",Bs)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Lo=function(){fr(this,vs,new ResizeObserver(Bs=>{const qs=Bs[0].contentRect;qs.width&&qs.height&&this.setDimensions(qs.width,qs.height)})),ks(this,vs).observe(this.div)},po=function(){if(!ks(this,hs))return;const[Bs,qs]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Bs),this.canvas.height=Math.ceil(this.height*qs),ar(this,bs,Do).call(this)},_l=function(Bs,qs){const cr=ar(this,bs,Io).call(this),xr=(Bs-cr)/ks(this,ds),yr=(qs-cr)/ks(this,us);this.scaleFactor=Math.min(xr,yr)},Do=function(){const Bs=ar(this,bs,Io).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Bs,this.translationY*this.scaleFactor+Bs)},Ls=new WeakSet,du=function(Bs){const qs=new Path2D;for(let cr=0,xr=Bs.length;cr<xr;cr++){const[yr,Ar,Cr,ur]=Bs[cr];cr===0&&qs.moveTo(...yr),qs.bezierCurveTo(Ar[0],Ar[1],Cr[0],Cr[1],ur[0],ur[1])}return qs},Tl=function(Bs,qs,cr){const[xr,yr,Ar,Cr]=qs;switch(cr){case 0:for(let ur=0,Pr=Bs.length;ur<Pr;ur+=2)Bs[ur]+=xr,Bs[ur+1]=Cr-Bs[ur+1];break;case 90:for(let ur=0,Pr=Bs.length;ur<Pr;ur+=2){const Tr=Bs[ur];Bs[ur]=Bs[ur+1]+xr,Bs[ur+1]=Tr+yr}break;case 180:for(let ur=0,Pr=Bs.length;ur<Pr;ur+=2)Bs[ur]=Ar-Bs[ur],Bs[ur+1]+=yr;break;case 270:for(let ur=0,Pr=Bs.length;ur<Pr;ur+=2){const Tr=Bs[ur];Bs[ur]=Ar-Bs[ur+1],Bs[ur+1]=Cr-Tr}break;default:throw new Error("Invalid rotation")}return Bs},hu=function(Bs,qs,cr){const[xr,yr,Ar,Cr]=qs;switch(cr){case 0:for(let ur=0,Pr=Bs.length;ur<Pr;ur+=2)Bs[ur]-=xr,Bs[ur+1]=Cr-Bs[ur+1];break;case 90:for(let ur=0,Pr=Bs.length;ur<Pr;ur+=2){const Tr=Bs[ur];Bs[ur]=Bs[ur+1]-yr,Bs[ur+1]=Tr-xr}break;case 180:for(let ur=0,Pr=Bs.length;ur<Pr;ur+=2)Bs[ur]=Ar-Bs[ur],Bs[ur+1]-=yr;break;case 270:for(let ur=0,Pr=Bs.length;ur<Pr;ur+=2){const Tr=Bs[ur];Bs[ur]=Cr-Bs[ur+1],Bs[ur+1]=Ar-Tr}break;default:throw new Error("Invalid rotation")}return Bs},xu=function(Bs,qs,cr,xr){var Pr,Tr;const yr=[],Ar=this.thickness/2,Cr=Bs*qs+Ar,ur=Bs*cr+Ar;for(const Xr of this.paths){const Vr=[],Qr=[];for(let Or=0,zr=Xr.length;Or<zr;Or++){const[Zr,to,kr,pr]=Xr[Or],gr=Bs*Zr[0]+Cr,Ir=Bs*Zr[1]+ur,Jr=Bs*to[0]+Cr,qr=Bs*to[1]+ur,Js=Bs*kr[0]+Cr,Rr=Bs*kr[1]+ur,Mr=Bs*pr[0]+Cr,Br=Bs*pr[1]+ur;Or===0&&(Vr.push(gr,Ir),Qr.push(gr,Ir)),Vr.push(Jr,qr,Js,Rr,Mr,Br),Qr.push(Jr,qr),Or===zr-1&&Qr.push(Mr,Br)}yr.push({bezier:ar(Pr=wr,Ls,Tl).call(Pr,Vr,xr,this.rotation),points:ar(Tr=wr,Ls,Tl).call(Tr,Qr,xr,this.rotation)})}return yr},Ml=function(){let Bs=1/0,qs=-1/0,cr=1/0,xr=-1/0;for(const yr of this.paths)for(const[Ar,Cr,ur,Pr]of yr){const Tr=ns.Util.bezierBoundingBox(...Ar,...Cr,...ur,...Pr);Bs=Math.min(Bs,Tr[0]),cr=Math.min(cr,Tr[1]),qs=Math.max(qs,Tr[2]),xr=Math.max(xr,Tr[3])}return[Bs,cr,qs,xr]},Io=function(){return ks(this,ps)?Math.ceil(this.thickness*this.parentScale):0},fo=function(Bs=!1){if(this.isEmpty())return;if(!ks(this,ps)){ar(this,bs,ao).call(this);return}const qs=ar(this,bs,Ml).call(this),cr=ar(this,bs,Io).call(this);fr(this,ds,Math.max(rs.AnnotationEditor.MIN_SIZE,qs[2]-qs[0])),fr(this,us,Math.max(rs.AnnotationEditor.MIN_SIZE,qs[3]-qs[1]));const xr=Math.ceil(cr+ks(this,ds)*this.scaleFactor),yr=Math.ceil(cr+ks(this,us)*this.scaleFactor),[Ar,Cr]=this.parentDimensions;this.width=xr/Ar,this.height=yr/Cr,this.setAspectRatio(xr,yr);const ur=this.translationX,Pr=this.translationY;this.translationX=-qs[0],this.translationY=-qs[1],ar(this,bs,po).call(this),ar(this,bs,ao).call(this),fr(this,ws,xr),fr(this,ys,yr),this.setDims(xr,yr);const Tr=Bs?cr/this.scaleFactor/2:0;this.translate(ur-this.translationX-Tr,Pr-this.translationY-Tr)},mr(wr,Ls),eo(wr,"_defaultColor",null),eo(wr,"_defaultOpacity",1),eo(wr,"_defaultThickness",1),eo(wr,"_type","ink");let ls=wr;ts.InkEditor=ls},(es,ts,ss)=>{var ls,us,ds,xs,fs,gs,Es,js,ps,ms,hs,Ro,wo,Oo,Pl,mu,pu,Ll,Fo,fu;Object.defineProperty(ts,"__esModule",{value:!0}),ts.StampEditor=void 0;var ns=ss(1),rs=ss(4),os=ss(6),as=ss(29);const Ms=class Ms extends rs.AnnotationEditor{constructor(Ys){super({...Ys,name:"stampEditor"});mr(this,hs);mr(this,ls,null);mr(this,us,null);mr(this,ds,null);mr(this,xs,null);mr(this,fs,null);mr(this,gs,null);mr(this,Es,null);mr(this,js,null);mr(this,ps,!1);mr(this,ms,!1);fr(this,xs,Ys.bitmapUrl),fr(this,fs,Ys.bitmapFile)}static initialize(Ys){rs.AnnotationEditor.initialize(Ys)}static get supportedTypes(){const Ys=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,ns.shadow)(this,"supportedTypes",Ys.map(Zs=>`image/${Zs}`))}static get supportedTypesStr(){return(0,ns.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(Ys){return this.supportedTypes.includes(Ys)}static paste(Ys,Zs){Zs.pasteEditor(ns.AnnotationEditorType.STAMP,{bitmapFile:Ys.getAsFile()})}remove(){var Ys,Zs;ks(this,us)&&(fr(this,ls,null),this._uiManager.imageManager.deleteId(ks(this,us)),(Ys=ks(this,gs))==null||Ys.remove(),fr(this,gs,null),(Zs=ks(this,Es))==null||Zs.disconnect(),fr(this,Es,null)),super.remove()}rebuild(){if(!this.parent){ks(this,us)&&ar(this,hs,Oo).call(this);return}super.rebuild(),this.div!==null&&(ks(this,us)&&ar(this,hs,Oo).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(ks(this,ds)||ks(this,ls)||ks(this,xs)||ks(this,fs))}get isResizable(){return!0}render(){if(this.div)return this.div;let Ys,Zs;if(this.width&&(Ys=this.x,Zs=this.y),super.render(),this.div.hidden=!0,ks(this,ls)?ar(this,hs,Pl).call(this):ar(this,hs,Oo).call(this),this.width){const[Vs,Ks]=this.parentDimensions;this.setAt(Ys*Vs,Zs*Ks,this.width*Vs,this.height*Ks)}return this.div}static deserialize(Ys,Zs,Vs){if(Ys instanceof as.StampAnnotationElement)return null;const Ks=super.deserialize(Ys,Zs,Vs),{rect:Ds,bitmapUrl:$s,bitmapId:Xs,isSvg:Fs,accessibilityData:As}=Ys;Xs&&Vs.imageManager.isValidId(Xs)?fr(Ks,us,Xs):fr(Ks,xs,$s),fr(Ks,ps,Fs);const[_s,Ps]=Ks.pageDimensions;return Ks.width=(Ds[2]-Ds[0])/_s,Ks.height=(Ds[3]-Ds[1])/Ps,As&&(Ks.altTextData=As),Ks}serialize(Ys=!1,Zs=null){if(this.isEmpty())return null;const Vs={annotationType:ns.AnnotationEditorType.STAMP,bitmapId:ks(this,us),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:ks(this,ps),structTreeParentId:this._structTreeParentId};if(Ys)return Vs.bitmapUrl=ar(this,hs,Fo).call(this,!0),Vs.accessibilityData=this.altTextData,Vs;const{decorative:Ks,altText:Ds}=this.altTextData;if(!Ks&&Ds&&(Vs.accessibilityData={type:"Figure",alt:Ds}),Zs===null)return Vs;Zs.stamps||(Zs.stamps=new Map);const $s=ks(this,ps)?(Vs.rect[2]-Vs.rect[0])*(Vs.rect[3]-Vs.rect[1]):null;if(!Zs.stamps.has(ks(this,us)))Zs.stamps.set(ks(this,us),{area:$s,serialized:Vs}),Vs.bitmap=ar(this,hs,Fo).call(this,!1);else if(ks(this,ps)){const Xs=Zs.stamps.get(ks(this,us));$s>Xs.area&&(Xs.area=$s,Xs.serialized.bitmap.close(),Xs.serialized.bitmap=ar(this,hs,Fo).call(this,!1))}return Vs}};ls=new WeakMap,us=new WeakMap,ds=new WeakMap,xs=new WeakMap,fs=new WeakMap,gs=new WeakMap,Es=new WeakMap,js=new WeakMap,ps=new WeakMap,ms=new WeakMap,hs=new WeakSet,Ro=function(Ys,Zs=!1){if(!Ys){this.remove();return}fr(this,ls,Ys.bitmap),Zs||(fr(this,us,Ys.id),fr(this,ps,Ys.isSvg)),ar(this,hs,Pl).call(this)},wo=function(){fr(this,ds,null),this._uiManager.enableWaiting(!1),ks(this,gs)&&this.div.focus()},Oo=function(){if(ks(this,us)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(ks(this,us)).then(Zs=>ar(this,hs,Ro).call(this,Zs,!0)).finally(()=>ar(this,hs,wo).call(this));return}if(ks(this,xs)){const Zs=ks(this,xs);fr(this,xs,null),this._uiManager.enableWaiting(!0),fr(this,ds,this._uiManager.imageManager.getFromUrl(Zs).then(Vs=>ar(this,hs,Ro).call(this,Vs)).finally(()=>ar(this,hs,wo).call(this)));return}if(ks(this,fs)){const Zs=ks(this,fs);fr(this,fs,null),this._uiManager.enableWaiting(!0),fr(this,ds,this._uiManager.imageManager.getFromFile(Zs).then(Vs=>ar(this,hs,Ro).call(this,Vs)).finally(()=>ar(this,hs,wo).call(this)));return}const Ys=document.createElement("input");Ys.type="file",Ys.accept=Ms.supportedTypesStr,fr(this,ds,new Promise(Zs=>{Ys.addEventListener("change",async()=>{if(!Ys.files||Ys.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const Vs=await this._uiManager.imageManager.getFromFile(Ys.files[0]);ar(this,hs,Ro).call(this,Vs)}Zs()}),Ys.addEventListener("cancel",()=>{this.remove(),Zs()})}).finally(()=>ar(this,hs,wo).call(this))),Ys.click()},Pl=function(){const{div:Ys}=this;let{width:Zs,height:Vs}=ks(this,ls);const[Ks,Ds]=this.pageDimensions,$s=.75;if(this.width)Zs=this.width*Ks,Vs=this.height*Ds;else if(Zs>$s*Ks||Vs>$s*Ds){const _s=Math.min($s*Ks/Zs,$s*Ds/Vs);Zs*=_s,Vs*=_s}const[Xs,Fs]=this.parentDimensions;this.setDims(Zs*Xs/Ks,Vs*Fs/Ds),this._uiManager.enableWaiting(!1);const As=fr(this,gs,document.createElement("canvas"));Ys.append(As),Ys.hidden=!1,ar(this,hs,Ll).call(this,Zs,Vs),ar(this,hs,fu).call(this),ks(this,ms)||(this.parent.addUndoableEditor(this),fr(this,ms,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},mu=function(Ys,Zs){var $s;const[Vs,Ks]=this.parentDimensions;this.width=Ys/Vs,this.height=Zs/Ks,this.setDims(Ys,Zs),($s=this._initialOptions)!=null&&$s.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,ks(this,js)!==null&&clearTimeout(ks(this,js)),fr(this,js,setTimeout(()=>{fr(this,js,null),ar(this,hs,Ll).call(this,Ys,Zs)},200))},pu=function(Ys,Zs){const{width:Vs,height:Ks}=ks(this,ls);let Ds=Vs,$s=Ks,Xs=ks(this,ls);for(;Ds>2*Ys||$s>2*Zs;){const Fs=Ds,As=$s;Ds>2*Ys&&(Ds=Ds>=16384?Math.floor(Ds/2)-1:Math.ceil(Ds/2)),$s>2*Zs&&($s=$s>=16384?Math.floor($s/2)-1:Math.ceil($s/2));const _s=new OffscreenCanvas(Ds,$s);_s.getContext("2d").drawImage(Xs,0,0,Fs,As,0,0,Ds,$s),Xs=_s.transferToImageBitmap()}return Xs},Ll=function(Ys,Zs){Ys=Math.ceil(Ys),Zs=Math.ceil(Zs);const Vs=ks(this,gs);if(!Vs||Vs.width===Ys&&Vs.height===Zs)return;Vs.width=Ys,Vs.height=Zs;const Ks=ks(this,ps)?ks(this,ls):ar(this,hs,pu).call(this,Ys,Zs),Ds=Vs.getContext("2d");Ds.filter=this._uiManager.hcmFilter,Ds.drawImage(Ks,0,0,Ks.width,Ks.height,0,0,Ys,Zs)},Fo=function(Ys){if(Ys){if(ks(this,ps)){const Ks=this._uiManager.imageManager.getSvgUrl(ks(this,us));if(Ks)return Ks}const Zs=document.createElement("canvas");return{width:Zs.width,height:Zs.height}=ks(this,ls),Zs.getContext("2d").drawImage(ks(this,ls),0,0),Zs.toDataURL()}if(ks(this,ps)){const[Zs,Vs]=this.pageDimensions,Ks=Math.round(this.width*Zs*os.PixelsPerInch.PDF_TO_CSS_UNITS),Ds=Math.round(this.height*Vs*os.PixelsPerInch.PDF_TO_CSS_UNITS),$s=new OffscreenCanvas(Ks,Ds);return $s.getContext("2d").drawImage(ks(this,ls),0,0,ks(this,ls).width,ks(this,ls).height,0,0,Ks,Ds),$s.transferToImageBitmap()}return structuredClone(ks(this,ls))},fu=function(){fr(this,Es,new ResizeObserver(Ys=>{const Zs=Ys[0].contentRect;Zs.width&&Zs.height&&ar(this,hs,mu).call(this,Zs.width,Zs.height)})),ks(this,Es).observe(this.div)},eo(Ms,"_type","stamp");let cs=Ms;ts.StampEditor=cs}],__webpack_module_cache__={};function __w_pdfjs_require__(es){var ts=__webpack_module_cache__[es];if(ts!==void 0)return ts.exports;var ss=__webpack_module_cache__[es]={exports:{}};return __webpack_modules__[es](ss,ss.exports,__w_pdfjs_require__),ss.exports}var __webpack_exports__={};return(()=>{var es=__webpack_exports__;Object.defineProperty(es,"__esModule",{value:!0}),Object.defineProperty(es,"AbortException",{enumerable:!0,get:function(){return ts.AbortException}}),Object.defineProperty(es,"AnnotationEditorLayer",{enumerable:!0,get:function(){return os.AnnotationEditorLayer}}),Object.defineProperty(es,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return ts.AnnotationEditorParamsType}}),Object.defineProperty(es,"AnnotationEditorType",{enumerable:!0,get:function(){return ts.AnnotationEditorType}}),Object.defineProperty(es,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return as.AnnotationEditorUIManager}}),Object.defineProperty(es,"AnnotationLayer",{enumerable:!0,get:function(){return cs.AnnotationLayer}}),Object.defineProperty(es,"AnnotationMode",{enumerable:!0,get:function(){return ts.AnnotationMode}}),Object.defineProperty(es,"CMapCompressionType",{enumerable:!0,get:function(){return ts.CMapCompressionType}}),Object.defineProperty(es,"DOMSVGFactory",{enumerable:!0,get:function(){return ns.DOMSVGFactory}}),Object.defineProperty(es,"FeatureTest",{enumerable:!0,get:function(){return ts.FeatureTest}}),Object.defineProperty(es,"GlobalWorkerOptions",{enumerable:!0,get:function(){return ls.GlobalWorkerOptions}}),Object.defineProperty(es,"ImageKind",{enumerable:!0,get:function(){return ts.ImageKind}}),Object.defineProperty(es,"InvalidPDFException",{enumerable:!0,get:function(){return ts.InvalidPDFException}}),Object.defineProperty(es,"MissingPDFException",{enumerable:!0,get:function(){return ts.MissingPDFException}}),Object.defineProperty(es,"OPS",{enumerable:!0,get:function(){return ts.OPS}}),Object.defineProperty(es,"PDFDataRangeTransport",{enumerable:!0,get:function(){return ss.PDFDataRangeTransport}}),Object.defineProperty(es,"PDFDateString",{enumerable:!0,get:function(){return ns.PDFDateString}}),Object.defineProperty(es,"PDFWorker",{enumerable:!0,get:function(){return ss.PDFWorker}}),Object.defineProperty(es,"PasswordResponses",{enumerable:!0,get:function(){return ts.PasswordResponses}}),Object.defineProperty(es,"PermissionFlag",{enumerable:!0,get:function(){return ts.PermissionFlag}}),Object.defineProperty(es,"PixelsPerInch",{enumerable:!0,get:function(){return ns.PixelsPerInch}}),Object.defineProperty(es,"PromiseCapability",{enumerable:!0,get:function(){return ts.PromiseCapability}}),Object.defineProperty(es,"RenderingCancelledException",{enumerable:!0,get:function(){return ns.RenderingCancelledException}}),Object.defineProperty(es,"SVGGraphics",{enumerable:!0,get:function(){return ss.SVGGraphics}}),Object.defineProperty(es,"UnexpectedResponseException",{enumerable:!0,get:function(){return ts.UnexpectedResponseException}}),Object.defineProperty(es,"Util",{enumerable:!0,get:function(){return ts.Util}}),Object.defineProperty(es,"VerbosityLevel",{enumerable:!0,get:function(){return ts.VerbosityLevel}}),Object.defineProperty(es,"XfaLayer",{enumerable:!0,get:function(){return us.XfaLayer}}),Object.defineProperty(es,"build",{enumerable:!0,get:function(){return ss.build}}),Object.defineProperty(es,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return ts.createValidAbsoluteUrl}}),Object.defineProperty(es,"getDocument",{enumerable:!0,get:function(){return ss.getDocument}}),Object.defineProperty(es,"getFilenameFromUrl",{enumerable:!0,get:function(){return ns.getFilenameFromUrl}}),Object.defineProperty(es,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return ns.getPdfFilenameFromUrl}}),Object.defineProperty(es,"getXfaPageViewport",{enumerable:!0,get:function(){return ns.getXfaPageViewport}}),Object.defineProperty(es,"isDataScheme",{enumerable:!0,get:function(){return ns.isDataScheme}}),Object.defineProperty(es,"isPdfFile",{enumerable:!0,get:function(){return ns.isPdfFile}}),Object.defineProperty(es,"loadScript",{enumerable:!0,get:function(){return ns.loadScript}}),Object.defineProperty(es,"noContextMenu",{enumerable:!0,get:function(){return ns.noContextMenu}}),Object.defineProperty(es,"normalizeUnicode",{enumerable:!0,get:function(){return ts.normalizeUnicode}}),Object.defineProperty(es,"renderTextLayer",{enumerable:!0,get:function(){return rs.renderTextLayer}}),Object.defineProperty(es,"setLayerDimensions",{enumerable:!0,get:function(){return ns.setLayerDimensions}}),Object.defineProperty(es,"shadow",{enumerable:!0,get:function(){return ts.shadow}}),Object.defineProperty(es,"updateTextLayer",{enumerable:!0,get:function(){return rs.updateTextLayer}}),Object.defineProperty(es,"version",{enumerable:!0,get:function(){return ss.version}});var ts=__w_pdfjs_require__(1),ss=__w_pdfjs_require__(2),ns=__w_pdfjs_require__(6),rs=__w_pdfjs_require__(26),os=__w_pdfjs_require__(27),as=__w_pdfjs_require__(5),cs=__w_pdfjs_require__(29),ls=__w_pdfjs_require__(14),us=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;function aiDebugLog(...es){console.log("[AIService]",...es)}async function callAI(es,ts={}){var cs;const{system:ss,maxTokens:ns=4e3,maxRetries:rs=3}=ts;aiDebugLog("callAI started, maxTokens:",ns,"prompt length:",es.length);const os=[{role:"user",content:es}];let as=null;for(let ls=0;ls<rs;ls++)try{aiDebugLog(`Attempt ${ls+1}/${rs}...`);const ds=await fetch("/api/ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:os,system:ss,maxTokens:ns,model:"claude-sonnet-4-20250514"})});if(aiDebugLog("Response status:",ds.status),!ds.ok){const fs=await ds.json().catch(()=>({})),gs=((cs=fs.error)==null?void 0:cs.message)||fs.error||"";if(aiDebugLog("API error:",ds.status,gs),ds.status===429){const Es=Math.pow(2,ls+1)*1e3;aiDebugLog(`Rate limited, waiting ${Es}ms before retry...`),await new Promise(js=>setTimeout(js,Es));continue}if(ds.status===529){const Es=Math.pow(2,ls+1)*1e3;aiDebugLog(`Server overloaded, waiting ${Es}ms before retry...`),await new Promise(js=>setTimeout(js,Es));continue}if(ds.status===400&&(gs.includes("credit balance")||gs.includes("purchase credits")))throw new Error("Insufficient API credits. Please add credits at console.anthropic.com");if(ds.status===401||ds.status===403)throw new Error("Invalid API key. Please check your configuration.");if(ds.status>=500){const Es=Math.pow(2,ls+1)*1e3;aiDebugLog(`Server error ${ds.status}, waiting ${Es}ms before retry...`),await new Promise(js=>setTimeout(js,Es));continue}throw new Error(fs.error||`API error: ${ds.status}`)}const xs=await ds.json();if(xs.content&&xs.content.length>0){const fs=xs.content[0].text;return aiDebugLog("AI call successful, response length:",fs.length),xs.usage&&aiDebugLog("Token usage:",xs.usage),fs}throw new Error("Empty response from AI")}catch(us){as=us,aiDebugLog(`AI call attempt ${ls+1} failed:`,us),console.error(`AI call attempt ${ls+1} failed:`,us);const ds=as.message||"";if(ds.includes("Insufficient API credits")||ds.includes("Invalid API key"))throw as;if(ls<rs-1){const xs=Math.pow(2,ls+1)*1e3;aiDebugLog(`Waiting ${xs}ms before retry...`),await new Promise(fs=>setTimeout(fs,xs))}}throw aiDebugLog("All retries failed, throwing error"),as||new Error("AI call failed after retries")}async function generateSceneSynopsis(es,ts){const ss=`Generate a brief 15-25 word synopsis for this screenplay scene:

Scene: ${es}

Content:
${ts.slice(0,2e3)}

Return ONLY the synopsis text, no quotes or explanation.`;try{return(await callAI(ss,{maxTokens:100})).trim().replace(/^["']|["']$/g,"")}catch(ns){return console.error("Failed to generate synopsis:",ns),""}}pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;async function extractTextFromPDF$2(es){const ts=await es.arrayBuffer(),ss=await pdfExports.getDocument({data:ts}).promise;let ns="";for(let rs=1;rs<=ss.numPages;rs++){const cs=(await(await ss.getPage(rs)).getTextContent()).items.map(ls=>ls.str).join(" ");ns+=cs+`
`}return ns}async function parseCallSheetText(es,ts){const ss=`You are an expert at parsing film/TV production call sheets. Your job is to extract structured data from call sheet text that has been extracted from a PDF.

IMPORTANT: Call sheets vary significantly between productions and ADs. The text extraction may lose table structure, so look for patterns and context clues.

Common patterns to look for:
- Production day: "DAY X" or "DAY X OF Y" or "SHOOT DAY X" or "CALL SHEET X OF Y"
- Dates: Various formats like "MONDAY 24TH NOVEMBER 2025" or "24/11/25"
- Unit call time: "UNIT CALL" or "UNIT CALL TIME" followed by time
- Pre-calls: HMU, COSTUME, ADs, LIGHTING, CAMERA times (often earlier than unit call)
  - May include location like "07:45 @ UB" (at Unit Base)
- Meal times: BREAKFAST, LUNCH with times and possibly locations (HOTBOX, IN HAND, etc.)
- Wrap estimates: "EST. WRAP", "CAMERA WRAP", "WRAP"
- Weather: Temperature (High/Low), conditions, sunrise/sunset times
- Locations: UNIT BASE, LOCATION, LOC 1, LOC 2, CREW PARKING with addresses and What3Words (///word.word.word)
- Scene schedules: Usually in table format with scene numbers, INT/EXT, location, D/N, pages, cast numbers, timings
- Cast information: Actor names, characters, call times, H&MU times, costume times, travel, on-set times

Time formats vary: "0730", "07:30", "7:30 AM", "7.30", "08:00 AM"

Return ONLY valid JSON with no additional text or markdown.`,ns=`Parse this call sheet text and extract ALL available information including locations, weather, and timing details.

CALL SHEET TEXT:
---
${es.slice(0,15e3)}
---

Return a JSON object with this structure (include only fields that have data in the call sheet):
{
  "date": "YYYY-MM-DD format",
  "productionDay": number,
  "totalProductionDays": number or null,
  "dayType": "e.g., 10 HRS CONTINUOUS WORKING DAY, STANDARD WORKING DAY, SEMI-CONTINUOUS",
  "unitCallTime": "HH:MM 24-hour format",
  "rehearsalsTime": "HH:MM or null (REHEARSALS ON SET FOR)",
  "firstShotTime": "HH:MM or null (TO SHOOT FOR)",
  "preCalls": {
    "ads": "HH:MM or null",
    "hmu": "HH:MM or null",
    "costume": "HH:MM or null",
    "production": "HH:MM or null",
    "lighting": "HH:MM or null",
    "camera": "HH:MM or null",
    "location": "where pre-calls happen e.g., 'Unit Base', 'UB', 'On Set'"
  },
  "breakfastTime": "HH:MM or HH:MM - HH:MM",
  "breakfastLocation": "location description or null",
  "lunchTime": "HH:MM or HH:MM - HH:MM",
  "lunchLocation": "HOTBOX, IN HAND, location name, etc.",
  "cameraWrapEstimate": "HH:MM",
  "wrapEstimate": "HH:MM",
  "weather": {
    "conditions": "Overcast, Sunny, Showers, Mostly Cloudy, Scattered Showers, etc.",
    "tempHigh": number in Celsius,
    "tempLow": number in Celsius,
    "sunrise": "HH:MM",
    "sunset": "HH:MM"
  },
  "unitBase": {
    "name": "Location name",
    "address": "Full street address",
    "what3words": "///word.word.word format if present"
  },
  "shootLocations": [
    {
      "id": "LOC 1 or LOC1 or main",
      "name": "Location name",
      "address": "Full street address",
      "what3words": "///word.word.word format if present"
    }
  ],
  "crewParking": {
    "name": "Parking location name",
    "address": "Address if different from unit base",
    "notes": "Any parking instructions"
  },
  "unitNotes": ["array of important notes from UNIT NOTES section"],
  "scenes": [
    {
      "sceneNumber": "1" or "1A" (string, exactly as shown),
      "locationId": "LOC 1, LOC 2, etc. if shown",
      "setDescription": "INT. LOCATION - DESCRIPTION or EXT. etc",
      "dayNight": "D" or "N" or "D/N" or "D1" or "D2" etc,
      "pages": "1/8" or "2" or "1 5/8" etc,
      "cast": ["1", "2", "4"] (cast numbers as strings),
      "estimatedTime": "08:20 - 09:00 or 09:20 - 10:30",
      "notes": "any HMU notes, SFX notes, AV notes, PROP notes for this scene"
    }
  ],
  "castCalls": [
    {
      "id": "1" (cast number from ID column),
      "name": "ACTOR NAME",
      "character": "CHARACTER NAME or ROLE",
      "status": "SW" or "SWF" or "W" or "WF" etc,
      "pickup": "HH:MM or null",
      "driver": "RW, LW, MINIBUS, etc. or null",
      "callTime": "HH:MM (CALL column)",
      "breakfastTime": "HH:MM (B/FAST column) or null",
      "costumeCall": "HH:MM (COSTUME column) or null",
      "hmuCall": "HH:MM (H&MU column) or null",
      "travelTime": "HH:MM (TRAVEL column) or null",
      "onSetTime": "HH:MM (ON SET column) or null",
      "notes": "any notes for this cast member"
    }
  ],
  "supportingArtists": [
    {
      "id": "SA1 or number",
      "name": "NAME",
      "designation": "Role description",
      "callTime": "HH:MM"
    }
  ]
}

IMPORTANT:
- All times should be in 24-hour HH:MM format (convert "0730" to "07:30", "8:00 AM" to "08:00")
- Scene numbers should be extracted exactly as shown (may be numeric or alphanumeric like "4A", "18B")
- Extract What3Words addresses - they look like "///word.word.word" or "W3W - ///word.word.word"
- Look for LOCATION: and UNIT BASE: lines for address information
- Camera wrap and estimated wrap are often separate times
- Pre-calls may be listed as "PRE-CALLS" or "PRE CALLS" with department times
- Extract weather including conditions like "Overcast with Scattered Showers"
- If a field has no data, omit it or use null
- CRITICAL: Only extract scenes for the CURRENT shooting day. Do NOT include scenes from "ADVANCE SCHEDULE", "ADVANCE", "NEXT DAYS", or any section showing future production days. These appear at the end of call sheets and show upcoming days - ignore them completely.`;try{const rs=await callAI(ns,{system:ss,maxTokens:4e3}),os=rs.match(/\{[\s\S]*\}/);if(!os)throw console.error("No JSON found in AI response:",rs),new Error("Failed to parse call sheet - invalid AI response");const as=JSON.parse(os[0]),ls=(as.scenes||[]).filter(ps=>{const ms=(ps.notes||"").toLowerCase();return!(ms.includes("advance schedule")||ms.includes("advance day")||ps.productionDay&&as.productionDay&&ps.productionDay!==as.productionDay)}).map((ps,ms)=>({sceneNumber:String(ps.sceneNumber||ms+1),location:ps.locationId||ps.location||void 0,setDescription:ps.setDescription||"Unknown Scene",action:ps.action||void 0,dayNight:ps.dayNight||"D",pages:ps.pages||void 0,cast:Array.isArray(ps.cast)?ps.cast.map(String):[],notes:ps.notes||void 0,estimatedTime:ps.estimatedTime||void 0,startTime:ps.startTime||void 0,endTime:ps.endTime||void 0,shootOrder:ms+1,status:"upcoming"})),us=(as.castCalls||[]).map(ps=>({id:String(ps.id||""),name:ps.name||"",character:ps.character||"",status:ps.status||"W",pickup:ps.pickup||void 0,driver:ps.driver||void 0,callTime:ps.callTime||"",makeupCall:ps.makeupCall||ps.breakfastTime||void 0,costumeCall:ps.costumeCall||void 0,hmuCall:ps.hmuCall||void 0,travelTime:ps.travelTime||void 0,onSetTime:ps.onSetTime||void 0,notes:ps.notes||void 0})),ds=(as.supportingArtists||[]).map(ps=>({id:String(ps.id||""),name:ps.name||"",designation:ps.designation||"",status:ps.status||"-",callTime:ps.callTime||"",makeupCall:ps.makeupCall||void 0,costumeCall:ps.costumeCall||void 0,hmuCall:ps.hmuCall||void 0,travelTime:ps.travelTime||void 0,onSetTime:ps.onSetTime||void 0,notes:ps.notes||void 0})),xs=as.weather?{conditions:as.weather.conditions||void 0,tempHigh:as.weather.tempHigh||void 0,tempLow:as.weather.tempLow||void 0,sunrise:as.weather.sunrise||void 0,sunset:as.weather.sunset||void 0}:void 0,fs=as.preCalls?{ads:as.preCalls.ads||void 0,hmu:as.preCalls.hmu||void 0,costume:as.preCalls.costume||void 0,production:as.preCalls.production||void 0,lighting:as.preCalls.lighting||void 0,camera:as.preCalls.camera||void 0,location:as.preCalls.location||void 0}:void 0,gs=as.unitBase?{name:as.unitBase.name||"",address:as.unitBase.address||void 0,what3words:as.unitBase.what3words||void 0,notes:as.unitBase.notes||void 0}:void 0;let Es;if(as.shootLocation)Es={name:as.shootLocation.name||"",address:as.shootLocation.address||void 0,what3words:as.shootLocation.what3words||void 0,notes:as.shootLocation.notes||void 0};else if(as.shootLocations&&as.shootLocations.length>0){const ps=as.shootLocations[0],ms=as.shootLocations.slice(1),hs=ms.length>0?ms.map(vs=>`${vs.id||""}: ${vs.name||""} ${vs.address||""}`).join("; "):void 0;Es={name:ps.name||ps.id||"",address:ps.address||void 0,what3words:ps.what3words||void 0,notes:hs||ps.notes||void 0}}const js=as.crewParking?{name:as.crewParking.name||"Crew Parking",address:as.crewParking.address||void 0,what3words:as.crewParking.what3words||void 0,notes:as.crewParking.notes||void 0}:void 0;return{id:v4(),date:as.date||new Date().toISOString().split("T")[0],productionDay:as.productionDay||1,totalProductionDays:as.totalProductionDays||void 0,dayType:as.dayType||void 0,unitCallTime:as.unitCallTime||"06:00",rehearsalsTime:as.rehearsalsTime||void 0,firstShotTime:as.firstShotTime||void 0,preCalls:fs,breakfastTime:as.breakfastTime||void 0,lunchTime:as.lunchTime||void 0,lunchLocation:as.lunchLocation||as.breakfastLocation||void 0,cameraWrapEstimate:as.cameraWrapEstimate||void 0,wrapEstimate:as.wrapEstimate||void 0,weather:xs,unitBase:gs,shootLocation:Es,crewParking:js,unitNotes:Array.isArray(as.unitNotes)?as.unitNotes:void 0,scenes:ls,castCalls:us,supportingArtists:ds,uploadedAt:new Date,pdfUri:ts,rawText:es}}catch(rs){return console.error("AI call sheet parsing failed:",rs),fallbackParseCallSheetText(es,ts)}}function fallbackParseCallSheetText(es,ts){const ss=Fs=>{if(!Fs)return;const As=Fs[1].padStart(2,"0"),_s=Fs[2]||"00";return`${As}:${_s}`},ns=es.match(/DAY\s*(\d+)\s*(?:OF\s*(\d+))?/i);let rs=1,os;ns&&(rs=parseInt(ns[1],10),os=ns[2]?parseInt(ns[2],10):void 0);const as=es.match(/CALL\s*SHEET\s*(\d+)\s*OF\s*(\d+)/i);as&&!ns&&(rs=parseInt(as[1],10),os=parseInt(as[2],10));let cs=new Date().toISOString().split("T")[0];const ls=es.match(/(\d{1,2})(?:ST|ND|RD|TH)?\s*(JANUARY|FEBRUARY|MARCH|APRIL|MAY|JUNE|JULY|AUGUST|SEPTEMBER|OCTOBER|NOVEMBER|DECEMBER)\s*(\d{4})/i);if(ls){const Fs={JANUARY:"01",FEBRUARY:"02",MARCH:"03",APRIL:"04",MAY:"05",JUNE:"06",JULY:"07",AUGUST:"08",SEPTEMBER:"09",OCTOBER:"10",NOVEMBER:"11",DECEMBER:"12"},As=ls[1].padStart(2,"0"),_s=Fs[ls[2].toUpperCase()]||"01";cs=`${ls[3]}-${_s}-${As}`}const us=es.match(/UNIT\s*CALL[:\s]*TIME?[:\s]*(\d{1,2})[:\.]?(\d{2})/i),ds=ss(us)||"06:00",xs=es.match(/(?:EST\.?\s*)?WRAP[:\s]*(\d{1,2})[:\.]?(\d{2})/i),fs=ss(xs),gs=es.match(/CAMERA\s*WRAP[:\s]*(\d{1,2})[:\.]?(\d{2})/i),Es=ss(gs),js=es.match(/BREAKFAST[:\s]*(\d{1,2})[:\.]?(\d{2})/i),ps=ss(js),ms=es.match(/(?:EST\.?\s*)?LUNCH[:\s]*(\d{1,2})[:\.]?(\d{2})/i),hs=ss(ms);let vs;const ws=es.match(/(?:HIGH|TEMP)[:\s]*(\d+)\s*[]?/i),ys=es.match(/LOW[:\s]*(\d+)\s*[]?/i),Rs=es.match(/(?:SUN\s*)?RISE[S]?[:\s]*(\d{1,2})[:\.]?(\d{2})/i),bs=es.match(/(?:SUN\s*)?SET[S]?[:\s]*(\d{1,2})[:\.]?(\d{2})/i),Ns=es.match(/WEATHER[:\s]*([A-Za-z\s,]+?)(?:\s*(?:TEMP|HIGH|LOW|\d))/i);(ws||ys||Rs||bs)&&(vs={conditions:Ns?Ns[1].trim():void 0,tempHigh:ws?parseInt(ws[1],10):void 0,tempLow:ys?parseInt(ys[1],10):void 0,sunrise:ss(Rs),sunset:ss(bs)});let Ss;const Ts=es.match(/HMU[:\s]*(\d{1,2})[:\.]?(\d{2})/i),Cs=es.match(/COSTUME[:\s]*(\d{1,2})[:\.]?(\d{2})/i),Ms=es.match(/ADs?[:\s]*(\d{1,2})[:\.]?(\d{2})/i);(Ts||Cs||Ms)&&(Ss={hmu:ss(Ts),costume:ss(Cs),ads:ss(Ms)});let Is;const Qs=es.match(/(?:LOCATION|UNIT\s*BASE)[:\s]*([^,\n]+(?:,[^,\n]+)*)/i),Ys=es.match(/(?:W3W|what3words)[:\s-]*\/\/\/([a-z]+\.[a-z]+\.[a-z]+)/i);Qs&&(Is={name:Qs[1].trim().split(",")[0],address:Qs[1].trim(),what3words:Ys?`///${Ys[1]}`:void 0});const Zs=es.search(/ADVANCE\s*SCHEDULE/i),Vs=Zs>0?es.slice(0,Zs):es,Ks=[],Ds=/(?:SC|SCENE)?\s*(\d+[A-Z]?)\s+((?:INT|EXT)[.\s/][^D\d]*?)\s*(D\d?|N\d?|D\/N)/gi;let $s,Xs=1;for(;($s=Ds.exec(Vs))!==null;)Ks.push({sceneNumber:$s[1],setDescription:$s[2].trim(),dayNight:$s[3],shootOrder:Xs++,status:"upcoming"});return{id:v4(),date:cs,productionDay:rs,totalProductionDays:os,unitCallTime:ds,breakfastTime:ps,lunchTime:hs,cameraWrapEstimate:Es,wrapEstimate:fs,weather:vs,preCalls:Ss,unitBase:Is,scenes:Ks,castCalls:[],supportingArtists:[],uploadedAt:new Date,pdfUri:ts,rawText:es}}async function parseCallSheetPDF(es){const ts=await new Promise(ns=>{const rs=new FileReader;rs.onload=()=>ns(rs.result),rs.readAsDataURL(es)}),ss=await extractTextFromPDF$2(es);return parseCallSheetText(ss,ts)}const STORE_VERSION=2;function validateCallSheet(es){return!es.id||!es.date||!Array.isArray(es.scenes)?!1:es.scenes.length>50?(console.warn(`Call sheet ${es.id} has ${es.scenes.length} scenes - possible data corruption`),!1):!0}const useCallSheetStore=create()(persist((es,ts)=>({callSheets:[],activeCallSheetId:null,isUploading:!1,uploadError:null,uploadCallSheet:async ss=>{es({isUploading:!0,uploadError:null});try{const ns=await parseCallSheetPDF(ss),rs={...ns,scenes:[...ns.scenes]},os=ts().callSheets.find(as=>as.date===rs.date||as.productionDay===rs.productionDay);if(os){const as={...rs,id:os.id};return es(cs=>({callSheets:cs.callSheets.map(ls=>ls.id===os.id?as:ls),isUploading:!1,activeCallSheetId:os.id})),as}return es(as=>({callSheets:[...as.callSheets,rs].sort((cs,ls)=>cs.productionDay-ls.productionDay),isUploading:!1,activeCallSheetId:rs.id})),rs}catch(ns){const rs=ns instanceof Error?ns.message:"Failed to parse call sheet";throw es({isUploading:!1,uploadError:rs}),ns}},setActiveCallSheet:ss=>{es({activeCallSheetId:ss})},getActiveCallSheet:()=>{const ss=ts();return ss.activeCallSheetId?ss.callSheets.find(ns=>ns.id===ss.activeCallSheetId)||null:[...ss.callSheets].sort((rs,os)=>new Date(os.date).getTime()-new Date(rs.date).getTime())[0]||null},getCallSheetByDate:ss=>ts().callSheets.find(ns=>ns.date===ss)||null,getCallSheetByDay:ss=>ts().callSheets.find(ns=>ns.productionDay===ss)||null,deleteCallSheet:ss=>{es(ns=>({callSheets:ns.callSheets.filter(rs=>rs.id!==ss),activeCallSheetId:ns.activeCallSheetId===ss?null:ns.activeCallSheetId}))},updateSceneStatus:(ss,ns,rs)=>{es(os=>({callSheets:os.callSheets.map(as=>as.id!==ss?as:{...as,scenes:as.scenes.map(cs=>cs.sceneNumber===ns?{...cs,status:rs}:cs)})}))},updateSceneFilmingStatus:(ss,ns,rs,os)=>{es(as=>({callSheets:as.callSheets.map(cs=>cs.id!==ss?cs:{...cs,scenes:cs.scenes.map(ls=>ls.sceneNumber===ns?{...ls,filmingStatus:rs,filmingNotes:os,status:"wrapped"}:ls)})}))},clearAll:()=>{es({callSheets:[],activeCallSheetId:null})}}),{name:"hair-makeup-callsheets",version:STORE_VERSION,storage:createHybridStorage("hair-makeup-callsheets"),partialize:es=>({callSheets:es.callSheets,activeCallSheetId:es.activeCallSheetId}),migrate:(es,ts)=>{const ss=es;if(ts<STORE_VERSION){console.log(`Migrating call sheet store from version ${ts} to ${STORE_VERSION}`);const ns=(ss.callSheets||[]).filter(validateCallSheet);return ns.length!==(ss.callSheets||[]).length&&console.warn("Removed corrupted call sheet data during migration"),{callSheets:ns,activeCallSheetId:ss.activeCallSheetId||null,isUploading:!1,uploadError:null}}return ss},merge:(es,ts)=>{const ss=es,ns=(ss.callSheets||[]).filter(validateCallSheet);return{...ts,callSheets:ns,activeCallSheetId:ss.activeCallSheetId||null}}})),demoReceipts=[{id:"r1",date:new Date(Date.now()-2*24*60*60*1e3).toISOString().split("T")[0],vendor:"Camera Ready Cosmetics",amount:245,category:"Kit Supplies",description:"Foundation restocks, setting spray",synced:!0},{id:"r2",date:new Date(Date.now()-3*24*60*60*1e3).toISOString().split("T")[0],vendor:"Uber",amount:32.5,category:"Transportation",description:"To set - Day 3",synced:!0},{id:"r3",date:new Date(Date.now()-5*24*60*60*1e3).toISOString().split("T")[0],vendor:"Kryolan",amount:189.99,category:"Kit Supplies",description:"Blood products, prosthetic adhesive",synced:!1},{id:"r4",date:new Date(Date.now()-6*24*60*60*1e3).toISOString().split("T")[0],vendor:"Costco",amount:67.25,category:"Consumables",description:"Tissues, cotton rounds, alcohol",synced:!0}],demoBudgetSummary={totalBudget:2500,totalSpent:534.74,byCategory:{"Kit Supplies":434.99,Consumables:67.25,Transportation:32.5,Equipment:0,Other:0}};function generateDemoScenes(){const es=[{slugline:"SARAH'S APARTMENT - LIVING ROOM",intExt:"INT"},{slugline:"COFFEE SHOP",intExt:"INT"},{slugline:"CITY STREET",intExt:"EXT"},{slugline:"HOSPITAL CORRIDOR",intExt:"INT"},{slugline:"DR. WILSON'S OFFICE",intExt:"INT"},{slugline:"SARAH'S APARTMENT - BEDROOM",intExt:"INT"},{slugline:"PARK",intExt:"EXT"},{slugline:"MIKE'S CAR",intExt:"INT"},{slugline:"RESTAURANT",intExt:"INT"},{slugline:"ROOFTOP BAR",intExt:"EXT"}],ts=["DAY","NIGHT","MORNING","EVENING"],ss={1:["char-sarah","char-mike"],2:["char-sarah"],3:["char-sarah","char-mike"],4:["char-sarah","char-wilson"],5:["char-wilson"],6:["char-sarah"],7:["char-sarah","char-mike"],8:["char-sarah","char-mike","char-wilson"],9:["char-mike"],10:["char-sarah"],11:["char-sarah","char-mike"],12:["char-sarah","char-wilson"],13:["char-sarah"],14:["char-sarah","char-mike"],15:["char-sarah"],16:["char-wilson"],17:["char-sarah","char-wilson"],18:["char-sarah","char-mike","char-wilson"],19:["char-mike"],20:["char-sarah"]};return Array.from({length:42},(ns,rs)=>{const os=rs+1,as=rs%es.length,cs=es[as],ls=Math.floor(rs/10)%ts.length;let us;ss[os]?us=ss[os]:os%5===0?us=["char-sarah","char-mike","char-wilson"]:os%3===0?us=["char-sarah","char-wilson"]:os%2===0?us=["char-sarah","char-mike"]:us=["char-sarah"];const ds=getDemoSynopsis(os);return{id:`scene-${os}`,sceneNumber:String(os),slugline:`${cs.intExt}. ${cs.slugline} - ${ts[ls]}`,intExt:cs.intExt,timeOfDay:ts[ls],synopsis:ds||void 0,scriptContent:os<=3?getDemoScriptContent(os):void 0,characters:us,isComplete:os<=3,completedAt:os<=3?new Date(Date.now()-(4-os)*864e5):void 0}})}function getDemoSynopsis(es){return{1:"Sarah wakes up late and rushes to get ready while Mike waits impatiently. The tension between them is palpable.",2:"Sarah meets an old friend at the coffee shop and learns disturbing news about her past.",3:"Sarah and Mike argue on the busy street. A confrontation escalates unexpectedly.",4:"Sarah receives test results from Dr. Wilson. The news changes everything.",5:"Dr. Wilson reviews patient files alone, discovering a pattern that concerns him.",8:"Sarah, Mike, and Dr. Wilson meet at the restaurant to discuss the treatment plan.",12:"Sarah confronts Dr. Wilson about the test results in his office.",15:"Sarah reflects alone in her bedroom, making a difficult decision about her future.",16:"Dr. Wilson makes an urgent phone call that could change everything.",23:"The group gathers at the rooftop bar for a tense celebration."}[es]??""}function getDemoScriptContent(es){return{1:`FADE IN:

INT. SARAH'S APARTMENT - LIVING ROOM - MORNING

Sunlight streams through partially closed blinds. SARAH CHEN (30s, disheveled) rushes out from the bedroom, still pulling on a sweater.

MIKE (O.S.)
Sarah! We're going to be late!

SARAH
I know, I know! Just give me two minutes.

She grabs her bag, knocking over a stack of papers.

SARAH (CONT'D)
(muttering)
Where are my keys...

MIKE enters from the kitchen, holding a coffee cup.

MIKE
On the counter. Where you always leave them.

Sarah shoots him a look but grabs the keys.`,2:`INT. COFFEE SHOP - DAY

Sarah sits alone at a corner table, nervously stirring her latte. The door chimes. She looks up to see JENNIFER (40s, elegant) approaching.

JENNIFER
Sarah! It's been what, ten years?

SARAH
(standing, awkward hug)
Something like that. You look... well.

They sit. An uncomfortable silence.

JENNIFER
I wasn't sure you'd come. After everything.

SARAH
I almost didn't.

Jennifer reaches into her purse, pulls out a worn photograph.`,3:`EXT. CITY STREET - DAY

Sarah and Mike walk quickly through the crowded sidewalk. Their body language screams tension.

MIKE
You can't keep doing this, Sarah.

SARAH
Doing what? Living my life?

MIKE
Running from everything. Everyone who tries to help you.

Sarah stops abruptly. Pedestrians flow around them.

SARAH
(voice rising)
Help me? Is that what you call it?

MIKE
Keep your voice down.

SARAH
No! I'm done keeping quiet.`}[es]??""}const demoCharacters=[{id:"char-sarah",name:"Sarah Chen",initials:"SC",avatarColour:"#C9A962"},{id:"char-mike",name:"Mike",initials:"M",avatarColour:"#5B8DEF"},{id:"char-wilson",name:"Dr. Wilson",initials:"DW",avatarColour:"#7B68EE"}],demoLooks=[{id:"look-sarah-1",characterId:"char-sarah",name:"Day 1 - Professional",scenes:["1","2","3","4","5","6","7","8"],estimatedTime:30,makeup:{...createEmptyMakeupDetails(),foundation:"MAC Studio Fix NC25",coverage:"Medium",concealer:"NARS Radiant Creamy",concealerPlacement:"Under eyes, nose bridge",contour:"Charlotte Tilbury Filmstar Bronze",contourPlacement:"Hollows of cheeks, jawline",highlight:"Becca Champagne Pop",highlightPlacement:"Cheekbones, brow bone, cupid's bow",blush:"NARS Orgasm",blushPlacement:"Apples of cheeks",browProduct:"Anastasia Brow Wiz - Medium Brown",browShape:"Natural arch, slightly filled",eyePrimer:"Urban Decay Primer Potion",lidColour:"Soft champagne shimmer",creaseColour:"Warm taupe",outerV:"Deep brown",liner:"Tight line - dark brown",lashes:"Individual clusters outer corner",lipLiner:"MAC Spice",lipColour:"Charlotte Tilbury Pillow Talk",setting:"MAC Fix+, Laura Mercier powder T-zone"},hair:{...createEmptyHairDetails(),style:"Soft waves, parted slightly off-center to the left",products:"Oribe Dry Texturizing Spray, GHD curl hold spray",parting:"Left of center",piecesOut:"Face-framing layers around cheekbones",pins:"None visible - bobby pins hidden at crown if needed",accessories:"None"}},{id:"look-sarah-2",characterId:"char-sarah",name:"Day 2 - Casual",scenes:["9","10","11","12","13","14","15"],estimatedTime:20,makeup:{...createEmptyMakeupDetails(),foundation:"MAC Studio Fix NC25 - lighter application",coverage:"Light-Medium",concealer:"NARS Radiant Creamy",concealerPlacement:"Under eyes only",blush:"Glossier Cloud Paint - Dusk",blushPlacement:"Diffused across cheeks",browProduct:"Anastasia Brow Wiz - Medium Brown",browShape:"Natural, brushed up",lidColour:"Cream shimmer",liner:"None",lashes:"Mascara only - Benefit Roller Lash",lipColour:"Fresh Lip Balm tinted - Rose"},hair:{...createEmptyHairDetails(),style:"Loose ponytail, slightly messy",products:"Texture spray, smoothing serum on flyaways",parting:"Center",piecesOut:"Loose tendrils around face",pins:"Clear elastic, hidden bobby pins",accessories:"None"}},{id:"look-mike-1",characterId:"char-mike",name:"Standard Look",scenes:["1","3","7","8","9","11","14","18","19"],estimatedTime:10,makeup:{...createEmptyMakeupDetails(),foundation:"Light powder for shine control",coverage:"Minimal",concealer:"Touch of concealer for blemishes if needed",setting:"Blotting papers throughout day"},hair:{...createEmptyHairDetails(),style:"Short, textured, modern professional",products:"American Crew Fiber",parting:"None - swept back and to side"}},{id:"look-wilson-1",characterId:"char-wilson",name:"Doctor Look",scenes:["4","5","8","12","16","17","18"],estimatedTime:15,makeup:{...createEmptyMakeupDetails(),foundation:"Light powder",coverage:"Minimal - natural",concealer:"Under eye if needed",browProduct:"Clear brow gel",setting:"Mattifying setting spray"},hair:{...createEmptyHairDetails(),style:"Distinguished gray, neatly combed back",products:"Light pomade for control",parting:"Side part - right"}}],demoProject={id:"demo-project",name:"Demo Production",isDemoProject:!0,createdAt:new Date("2024-01-15"),updatedAt:new Date,scenes:generateDemoScenes(),characters:demoCharacters,looks:demoLooks},demoCallSheet={id:"call-1",date:new Date().toISOString().split("T")[0],productionDay:4,unitCallTime:"06:00",firstShotTime:"07:30",lunchTime:"13:00",wrapEstimate:"19:00",weather:{conditions:"Sunny",tempHigh:22},scenes:[{sceneNumber:"12",setDescription:"INT. COFFEE SHOP - DAY",dayNight:"D",shootOrder:1,estimatedTime:"07:30",status:"wrapped",filmingStatus:"complete"},{sceneNumber:"15",setDescription:"EXT. PARK - DAY",dayNight:"D",shootOrder:2,estimatedTime:"09:15",status:"wrapped",filmingStatus:"partial",filmingNotes:"Missing wide shot due to lighting"},{sceneNumber:"16",setDescription:"INT. APARTMENT - DAY",dayNight:"D",shootOrder:3,estimatedTime:"11:00",status:"in-progress"},{sceneNumber:"8",setDescription:"EXT. STREET - NIGHT",dayNight:"N",shootOrder:4,estimatedTime:"14:00",status:"upcoming"},{sceneNumber:"23",setDescription:"INT. OFFICE - DAY",dayNight:"D",shootOrder:5,estimatedTime:"16:30",status:"upcoming"}],uploadedAt:new Date};function Today({onSceneSelect:es}){var Ps,Hs;const{currentProject:ts,sceneCaptures:ss,updateSceneFilmingStatus:ns}=useProjectStore(),rs=useCallSheetStore(Ls=>Ls.callSheets),os=useCallSheetStore(Ls=>Ls.activeCallSheetId),as=useCallSheetStore(Ls=>Ls.getCallSheetByDate),cs=useCallSheetStore(Ls=>Ls.uploadCallSheet),ls=useCallSheetStore(Ls=>Ls.isUploading),us=useCallSheetStore(Ls=>Ls.uploadError),ds=useCallSheetStore(Ls=>Ls.updateSceneStatus),[xs,fs]=reactExports.useState(new Date),[gs,Es]=reactExports.useState(!1),[js,ps]=reactExports.useState(new Map),ms=reactExports.useMemo(()=>{const Ls=xs.toISOString().split("T")[0];return as(Ls)},[xs,as,rs]),hs=reactExports.useMemo(()=>os?rs.find(Ls=>Ls.id===os)||null:[...rs].sort((Os,Ws)=>new Date(Ws.date).getTime()-new Date(Os.date).getTime())[0]||null,[rs,os]),vs=ms||hs||(ts!=null&&ts.isDemoProject?demoCallSheet:null),ws=reactExports.useMemo(()=>vs?js.size===0?vs:{...vs,scenes:vs.scenes.map(Ls=>{const Os=js.get(Ls.sceneNumber);return Os?{...Ls,...Os}:Ls})}:null,[vs,js]);reactExports.useEffect(()=>{ps(new Map)},[vs==null?void 0:vs.id]),reactExports.useEffect(()=>{hs!=null&&hs.date&&fs(new Date(hs.date))},[hs==null?void 0:hs.id,hs==null?void 0:hs.date]);const[ys,Rs]=reactExports.useState(null),bs=reactExports.useRef(null),Ns=async Ls=>{var Ws;const Os=(Ws=Ls.target.files)==null?void 0:Ws[0];if(Os&&Os.type==="application/pdf")try{await cs(Os)}catch(Gs){console.error("Failed to upload call sheet:",Gs)}bs.current&&(bs.current.value="")},Ss=Ls=>{const Os=new Date(xs);Os.setDate(Os.getDate()+Ls),fs(Os),ps(new Map)},Ts=reactExports.useMemo(()=>{if(!ws)return[];if(gs)return[...ws.scenes].sort((Os,Ws)=>Os.shootOrder-Ws.shootOrder);const Ls={"in-progress":0,upcoming:1,wrapped:2};return[...ws.scenes].sort((Os,Ws)=>{const Gs=Ls[Os.status]-Ls[Ws.status];return Gs!==0?Gs:Os.shootOrder-Ws.shootOrder})},[ws,gs]),Cs=(Ls,Os)=>{if(!ws)return;const Ws=[...ws.scenes].sort((wr,dr)=>wr.shootOrder-dr.shootOrder),Gs=Ws.findIndex(wr=>wr.sceneNumber===Ls);if(Gs===-1||Os==="up"&&Gs===0||Os==="down"&&Gs===Ws.length-1)return;const lr=Os==="up"?Gs-1:Gs+1,jr=Ws[Gs].shootOrder,br=Ws[lr].shootOrder,Nr=Ws[lr].sceneNumber;ps(wr=>{const dr=new Map(wr),hr=dr.get(Ls)||{},Bs=dr.get(Nr)||{};return dr.set(Ls,{...hr,shootOrder:br}),dr.set(Nr,{...Bs,shootOrder:jr}),dr})},Ms=reactExports.useMemo(()=>ts?new Map(ts.scenes.map(Ls=>[Ls.sceneNumber,Ls])):new Map,[ts==null?void 0:ts.scenes]),Is=reactExports.useMemo(()=>ts?new Map(ts.characters.map(Ls=>[Ls.id,Ls])):new Map,[ts==null?void 0:ts.characters]),Qs=reactExports.useMemo(()=>{if(!ts)return new Map;const Ls=new Map;for(const Os of ts.scenes){const Ws=Os.characters.map(Gs=>Is.get(Gs)).filter(Gs=>Gs!==void 0);Ls.set(Os.sceneNumber,Ws)}return Ls},[ts==null?void 0:ts.scenes,Is]),Ys=reactExports.useMemo(()=>{if(!ts)return new Map;const Ls=new Map;for(const Os of ts.scenes){const Ws=Os.characters.every(Gs=>{const lr=`${Os.id}-${Gs}`,jr=ss[lr];return jr&&Object.keys(jr.photos).length>0});Ls.set(Os.sceneNumber,Ws)}return Ls},[ts==null?void 0:ts.scenes,ss]),Zs=reactExports.useMemo(()=>{if(!ts)return new Map;const Ls=new Map;for(const Os of ts.looks)for(const Ws of Os.scenes)Ls.set(`${Os.characterId}-${Ws}`,Os);return Ls},[ts==null?void 0:ts.looks]),Vs=Ls=>Ms.get(Ls),Ks=Ls=>Qs.get(Ls)||[],Ds=(Ls,Os)=>Zs.get(`${Ls}-${Os}`),$s=Ls=>Ys.get(Ls)||!1,Xs=reactExports.useMemo(()=>ws!=null&&ws.castCalls?ws.castCalls.filter(Ls=>Ls.hmuCall||Ls.makeupCall).sort((Ls,Os)=>{const Ws=Ls.hmuCall||Ls.makeupCall||"",Gs=Os.hmuCall||Os.makeupCall||"";return Ws.localeCompare(Gs)}):[],[ws==null?void 0:ws.castCalls]),Fs=(Ls,Os)=>{vs&&(ps(Ws=>{const Gs=new Map(Ws),lr=Gs.get(Ls)||{};return Gs.set(Ls,{...lr,status:Os}),Gs}),ds(vs.id,Ls,Os))},As=(Ls,Os,Ws)=>{vs&&(ps(Gs=>{const lr=new Map(Gs),jr=lr.get(Ls)||{};return lr.set(Ls,{...jr,status:"wrapped"}),lr}),ds(vs.id,Ls,"wrapped"),ns(Ls,Os,Ws))},_s=Ls=>{const Os=Vs(Ls);Os&&es(Os.id)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx("input",{ref:bs,type:"file",accept:".pdf",onChange:Ns,className:"hidden"}),jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsxs("div",{className:"mobile-container",children:[jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Ss(-1),className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:formatShortDate(xs)}),jsxRuntimeExports.jsx("button",{onClick:()=>Ss(1),className:"p-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{var Ls;return(Ls=bs.current)==null?void 0:Ls.click()},className:"p-2 text-gold active:opacity-70 transition-opacity touch-manipulation",disabled:ls,title:"Upload call sheet",children:ls?jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})}),ws&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>Es(!gs),className:clsx("p-2 rounded-lg transition-colors touch-manipulation",gs?"bg-gold text-white":"text-text-muted hover:text-gold"),title:gs?"Done reordering":"Reorder scenes",children:gs?jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})}),jsxRuntimeExports.jsxs("span",{className:"px-2.5 py-1 text-xs font-semibold rounded-full bg-gold-100 text-gold",children:["Day ",ws.productionDay]})]})]})]}),((Ps=ws==null?void 0:ws.weather)==null?void 0:Ps.conditions)&&jsxRuntimeExports.jsx("div",{className:"px-4 pb-3 -mt-1",children:jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"})}),ws.weather.conditions,ws.weather.tempHigh&&`, ${ws.weather.tempHigh}C`]})})]})}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-4 space-y-4",children:[us&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-600",children:us})}),ws?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"CALL TIMES"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Unit Call"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:ws.unitCallTime})]}),((Hs=ws.preCalls)==null?void 0:Hs.hmu)&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"HMU Pre-call"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-gold",children:ws.preCalls.hmu})]}),ws.firstShotTime&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"First Shot"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:ws.firstShotTime})]}),ws.lunchTime&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Lunch"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:ws.lunchTime})]}),ws.cameraWrapEstimate&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Camera Wrap"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:ws.cameraWrapEstimate})]}),ws.wrapEstimate&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Est. Wrap"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:ws.wrapEstimate})]})]})]}),Xs.length>0&&jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"HMU CALLS"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:Xs.map(Ls=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-border/30 last:border-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary truncate block",children:Ls.character}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted truncate block",children:Ls.name})]}),jsxRuntimeExports.jsxs("div",{className:"text-right ml-3",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-gold",children:Ls.hmuCall||Ls.makeupCall}),Ls.onSetTime&&jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted block",children:["On set: ",Ls.onSetTime]})]})]},Ls.id))})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between",children:jsxRuntimeExports.jsxs("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light",children:["TODAY'S SCENES (",Ts.length,")"]})}),gs&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"Drag to reorder shooting schedule"}),jsxRuntimeExports.jsx("button",{onClick:()=>Es(!1),className:"text-sm font-medium text-gold",children:"Done"})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2.5",children:Ts.map((Ls,Os)=>{const Ws=Vs(Ls.sceneNumber),Gs=Ks(Ls.sceneNumber),lr=$s(Ls.sceneNumber);return jsxRuntimeExports.jsx(TodaySceneCard,{shootingScene:Ls,scene:Ws,characters:Gs,isCaptured:lr,getLookForCharacter:Ds,onTap:()=>_s(Ls.sceneNumber),onSynopsisClick:jr=>Rs(jr),onStatusChange:jr=>Fs(Ls.sceneNumber,jr),onFilmingStatusChange:(jr,br)=>As(Ls.sceneNumber,jr,br),isReorderMode:gs,isFirst:Os===0,isLast:Os===Ts.length-1,onMoveUp:()=>Cs(Ls.sceneNumber,"up"),onMoveDown:()=>Cs(Ls.sceneNumber,"down")},Ls.sceneNumber)})})]}):jsxRuntimeExports.jsx(EmptyState$3,{hasAnyCallSheets:rs.length>0,onUploadClick:()=>{var Ls;return(Ls=bs.current)==null?void 0:Ls.click()},isUploading:ls})]}),ys&&jsxRuntimeExports.jsx(SceneScriptModal,{scene:ys,onClose:()=>Rs(null)})]})}const TodaySceneCard=reactExports.memo(function es({shootingScene:ts,scene:ss,characters:ns,isCaptured:rs,getLookForCharacter:os,onTap:as,onSynopsisClick:cs,onStatusChange:ls,onFilmingStatusChange:us,isReorderMode:ds=!1,isFirst:xs=!1,isLast:fs=!1,onMoveUp:gs,onMoveDown:Es}){const[js,ps]=reactExports.useState(!1),[ms,hs]=reactExports.useState(!1),[vs,ws]=reactExports.useState(!1),[ys,Rs]=reactExports.useState((ss==null?void 0:ss.filmingNotes)||""),bs=reactExports.useRef(null);reactExports.useEffect(()=>{const Ds=$s=>{bs.current&&!bs.current.contains($s.target)&&ws(!1)};return document.addEventListener("mousedown",Ds),()=>document.removeEventListener("mousedown",Ds)},[]);const Ns=reactExports.useMemo(()=>{if(ss)return null;const Ds=ts.setDescription||"",$s=Ds.match(/^(INT|EXT)\./i),Xs=Ds.match(/- (DAY|NIGHT|MORNING|EVENING|DUSK|DAWN|CONTINUOUS)$/i),Fs=Ds.match(/^(?:INT|EXT)\.\s*(.+?)(?:\s*-\s*(?:DAY|NIGHT|MORNING|EVENING|DUSK|DAWN|CONTINUOUS))?$/i);return{intExt:$s?$s[1].toUpperCase():null,timeOfDay:Xs?Xs[1].toUpperCase():null,location:Fs?Fs[1].trim():Ds}},[ss,ts.setDescription]),Ss=ss==null?void 0:ss.filmingStatus,Ts=ss==null?void 0:ss.filmingNotes,Ms=(()=>{if(!Ss)return null;switch(Ss){case"complete":return"scene-glass-complete";case"partial":return"scene-glass-partial";case"not-filmed":return"scene-glass-incomplete";default:return null}})(),Is={upcoming:"Upcoming","in-progress":"In Progress",wrapped:"Wrapped"},Ys=(()=>{if(Ss){const $s=SCENE_FILMING_STATUS_CONFIG[Ss];return{bg:$s.bgClass,text:$s.textClass,label:$s.shortLabel,color:$s.color}}return{...{upcoming:{bg:"bg-gray-100",text:"text-text-muted",color:"#6b7280"},"in-progress":{bg:"bg-gold-100/50",text:"text-gold",color:"#C9A962"},wrapped:{bg:"bg-green-50",text:"text-green-600",color:"#22c55e"}}[ts.status],label:Is[ts.status]}})(),Zs=()=>{ps(!0)},Vs=Ds=>{Ds==="not-filmed"||Ds==="partial"?(hs(!0),ws(!1)):(us(Ds),ws(!1))},Ks=Ds=>{us(Ds,ys),hs(!1),ps(!1)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:clsx("relative",vs&&"z-40"),children:[ds&&jsxRuntimeExports.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 z-20 flex flex-col gap-1",children:[jsxRuntimeExports.jsx("button",{onClick:Ds=>{Ds.stopPropagation(),gs==null||gs()},disabled:xs,className:clsx("p-2 rounded-lg transition-all touch-manipulation",xs?"text-gray-300 cursor-not-allowed":"text-text-muted hover:text-gold hover:bg-gold/10 active:scale-95"),children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})})}),jsxRuntimeExports.jsx("button",{onClick:Ds=>{Ds.stopPropagation(),Es==null||Es()},disabled:fs,className:clsx("p-2 rounded-lg transition-all touch-manipulation",fs?"text-gray-300 cursor-not-allowed":"text-text-muted hover:text-gold hover:bg-gold/10 active:scale-95"),children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})})]}),jsxRuntimeExports.jsxs("div",{onClick:ds?void 0:as,onContextMenu:Ds=>{ds||(Ds.preventDefault(),Zs())},className:clsx("w-full text-left card transition-all relative overflow-hidden",ds?"pr-16":"active:scale-[0.98] cursor-pointer"),children:[Ms&&jsxRuntimeExports.jsx("div",{className:clsx("scene-glass-overlay",Ms)}),jsxRuntimeExports.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 rounded-l-card",style:{background:ts.status==="in-progress"?"linear-gradient(180deg, #d4a853 0%, #c9a962 100%)":ts.status==="wrapped"?Ss==="complete"?"linear-gradient(180deg, #10b981 0%, #059669 100%)":Ss==="partial"?"linear-gradient(180deg, #d4a853 0%, #c9a962 100%)":Ss==="not-filmed"?"linear-gradient(180deg, #f87171 0%, #ef4444 100%)":"linear-gradient(180deg, #d1d5db 0%, #9ca3af 100%)":"transparent"}}),jsxRuntimeExports.jsxs("div",{className:"relative z-10 pl-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-text-primary",children:ts.sceneNumber}),(ss||Ns)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[((ss==null?void 0:ss.intExt)||(Ns==null?void 0:Ns.intExt))&&jsxRuntimeExports.jsx("span",{className:`px-1.5 py-0.5 text-[10px] font-bold rounded ${((ss==null?void 0:ss.intExt)||(Ns==null?void 0:Ns.intExt))==="INT"?"bg-slate-100 text-slate-600":"bg-stone-100 text-stone-600"}`,children:(ss==null?void 0:ss.intExt)||(Ns==null?void 0:Ns.intExt)}),((ss==null?void 0:ss.timeOfDay)||(Ns==null?void 0:Ns.timeOfDay))&&jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:(ss==null?void 0:ss.timeOfDay)||(Ns==null?void 0:Ns.timeOfDay)})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[rs&&jsxRuntimeExports.jsx("span",{className:"text-green-500",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),jsxRuntimeExports.jsxs("div",{ref:bs,className:"relative",children:[jsxRuntimeExports.jsxs("button",{onClick:Ds=>{Ds.stopPropagation(),ws(!vs)},className:"status-dropdown-btn touch-manipulation",style:{borderColor:Ss?Ys.color:void 0},children:[jsxRuntimeExports.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:Ys.color}}),jsxRuntimeExports.jsx("span",{className:Ys.text,children:Ys.label}),jsxRuntimeExports.jsx("svg",{className:clsx("w-3 h-3 text-text-muted transition-transform",vs&&"rotate-180"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),vs&&jsxRuntimeExports.jsx("div",{className:"absolute right-0 top-full mt-1 w-44 bg-card border border-border rounded-lg shadow-lg z-50 overflow-hidden animate-fadeIn",children:["complete","partial","not-filmed"].map(Ds=>{const $s=SCENE_FILMING_STATUS_CONFIG[Ds],Xs=Ss===Ds;return jsxRuntimeExports.jsxs("button",{onClick:Fs=>{Fs.stopPropagation(),Vs(Ds)},className:clsx("w-full px-3 py-2.5 text-left text-sm flex items-center gap-2.5 transition-colors",Xs?$s.bgClass:"hover:bg-gray-50"),children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:$s.color}}),jsxRuntimeExports.jsx("span",{className:clsx("font-medium",Xs&&$s.textClass),children:$s.label}),Xs&&jsxRuntimeExports.jsx("svg",{className:clsx("w-4 h-4 ml-auto",$s.textClass),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})]},Ds)})})]})]})]}),(ss||(Ns==null?void 0:Ns.location))&&jsxRuntimeExports.jsxs("div",{className:"mb-3",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary line-clamp-1",children:ss?ss.slugline.replace(/^(INT|EXT)\.\s*/,"").replace(/\s*-\s*(DAY|NIGHT|MORNING|EVENING|CONTINUOUS)$/i,""):Ns==null?void 0:Ns.location}),ss!=null&&ss.synopsis?jsxRuntimeExports.jsxs("button",{onClick:Ds=>{Ds.stopPropagation(),cs(ss)},className:"w-full text-left group mt-1",children:[jsxRuntimeExports.jsx("p",{className:"text-[13px] text-[#666] italic line-clamp-1 group-hover:text-gold transition-colors",children:ss.synopsis}),jsxRuntimeExports.jsxs("span",{className:"text-[10px] text-gold flex items-center gap-1 mt-0.5 opacity-80",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"View full scene"]})]}):ss!=null&&ss.scriptContent?jsxRuntimeExports.jsxs("button",{onClick:Ds=>{Ds.stopPropagation(),cs(ss)},className:"text-[10px] text-gold flex items-center gap-1 mt-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"View full scene"]}):null]}),Ss&&Ss!=="complete"&&Ts&&jsxRuntimeExports.jsxs("div",{className:clsx("mb-3 px-2 py-1.5 rounded text-xs",Ss==="partial"?"bg-amber-50 text-amber-700":"bg-red-50 text-red-700"),children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Note:"})," ",Ts]}),ns.length>0&&jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:ns.map(Ds=>{const $s=os(Ds.id,ts.sceneNumber);return jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-50 rounded-full pl-1 pr-2.5 py-1",children:[jsxRuntimeExports.jsx(CharacterAvatar,{character:Ds,size:"xs"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium text-text-primary",children:Ds.name.split(" ")[0]}),$s&&jsxRuntimeExports.jsxs("span",{className:"text-[10px] text-text-muted",children:[" ",$s.name]})]},Ds.id)})}),ts.estimatedTime&&jsxRuntimeExports.jsxs("div",{className:"mt-2 pt-2 border-t border-border/50 flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted",children:["Est. ",ts.estimatedTime]})]})]})]})]}),js&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/50 p-4",onClick:()=>ps(!1),children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl overflow-hidden",onClick:Ds=>Ds.stopPropagation(),children:[jsxRuntimeExports.jsx("div",{className:"p-4 border-b border-border",children:jsxRuntimeExports.jsxs("h3",{className:"text-base font-semibold text-text-primary",children:["Scene ",ts.sceneNumber]})}),jsxRuntimeExports.jsxs("div",{className:"py-2",children:[ts.status!=="in-progress"&&jsxRuntimeExports.jsxs("button",{onClick:()=>{ls("in-progress"),ps(!1)},className:"w-full px-4 py-3 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"})}),"Mark In Progress"]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-border mt-2 pt-2",children:[jsxRuntimeExports.jsx("div",{className:"px-4 py-2",children:jsxRuntimeExports.jsx("span",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light",children:"FILMING STATUS"})}),jsxRuntimeExports.jsxs("button",{onClick:()=>Ks("complete"),className:"w-full px-4 py-3 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Complete"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Scene fully filmed"})]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>hs(!0),className:"w-full px-4 py-3 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-amber-500 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Part Complete"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Some shots still needed"})]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>hs(!0),className:"w-full px-4 py-3 text-left text-sm text-text-primary hover:bg-gray-50 flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-red-500 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Incomplete"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Scene not filmed"})]})]})]}),ts.status!=="upcoming"&&jsxRuntimeExports.jsxs("button",{onClick:()=>{ls("upcoming"),ps(!1)},className:"w-full px-4 py-3 text-left text-sm text-text-muted hover:bg-gray-50 flex items-center gap-3 border-t border-border mt-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})}),"Revert to Upcoming"]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>ps(!1),className:"w-full p-4 text-center text-sm font-medium text-gold border-t border-border",children:"Cancel"})]})}),ms&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>hs(!1),children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl overflow-hidden",onClick:Ds=>Ds.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-border",children:[jsxRuntimeExports.jsxs("h3",{className:"text-base font-semibold text-text-primary",children:["Scene ",ts.sceneNumber," - Add Notes"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Why wasn't this scene fully filmed?"})]}),jsxRuntimeExports.jsx("div",{className:"p-4",children:jsxRuntimeExports.jsx("textarea",{value:ys,onChange:Ds=>Rs(Ds.target.value),placeholder:"e.g., Ran out of time, weather issues, actor unavailable...",rows:3,className:"w-full p-3 border border-border rounded-lg text-sm bg-input-bg text-text-primary resize-none"})}),jsxRuntimeExports.jsxs("div",{className:"p-4 border-t border-border flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Ks("partial"),className:"flex-1 py-2.5 rounded-button bg-amber-500 text-white text-sm font-medium",children:"Part Complete"}),jsxRuntimeExports.jsx("button",{onClick:()=>Ks("not-filmed"),className:"flex-1 py-2.5 rounded-button bg-red-500 text-white text-sm font-medium",children:"Incomplete"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>hs(!1),className:"w-full p-3 text-center text-sm text-text-muted border-t border-border",children:"Cancel"})]})})]})}),EmptyState$3=reactExports.memo(function es({hasAnyCallSheets:ts,onUploadClick:ss,isUploading:ns}){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx("svg",{className:"w-10 h-10 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:ts?jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"}):jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m6.75 12l-3-3m0 0l-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})})}),ts?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:"No Call Sheet for This Date"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted text-center mb-6",children:"Upload a call sheet for this production day to see today's scenes"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:"Upload a Call Sheet"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted text-center mb-6",children:"Upload your first call sheet to see today's scenes and start tracking continuity"})]}),jsxRuntimeExports.jsx("button",{onClick:ss,disabled:ns,className:"px-6 py-2.5 rounded-button gold-gradient text-white text-sm font-medium active:scale-95 transition-transform disabled:opacity-50",children:ns?"Uploading...":"Upload Call Sheet PDF"})]})});pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;async function extractTextFromPDF$1(es){const ts=await es.arrayBuffer(),ss=await pdfExports.getDocument({data:ts}).promise;let ns="";for(let rs=1;rs<=ss.numPages;rs++){const as=await(await ss.getPage(rs)).getTextContent(),cs=new Map;for(const us of as.items){if(!us.str||us.str.trim()==="")continue;const ds=Math.round(us.transform[5]/3)*3,xs=us.transform[4];cs.has(ds)||cs.set(ds,[]),cs.get(ds).push({x:xs,text:us.str,width:us.width||0})}const ls=Array.from(cs.keys()).sort((us,ds)=>ds-us);for(const us of ls){const ds=cs.get(us);ds.sort((Es,js)=>Es.x-js.x);let xs="",fs=0,gs=0;for(const Es of ds){const js=Es.x-(fs+gs);fs>0&&js>15?xs+="	":fs>0&&js>3&&(xs+=" "),xs+=Es.text,fs=Es.x,gs=Es.width}ns+=xs.trimEnd()+`
`}ns+=`
=== PAGE ${rs} ===

`}return ns}function parseScheduleText(es,ts){const ss=extractCastListFast(es),ns=parseAllDaysFast(es),rs=extractMetadata(es);return{id:v4(),productionName:rs.productionName,scriptVersion:rs.scriptVersion,scheduleVersion:rs.scheduleVersion,castList:ss,days:ns,totalDays:ns.length,uploadedAt:new Date,pdfUri:ts,rawText:es}}function extractCastListFast(es){const ts=[],ss=es.slice(0,8e3),ns=/\b(\d{1,2})\s*[.\-]\s*([A-Z][A-Z'\-\s]{1,25}?)(?=\s+\d{1,2}\s*[.\-]|\s*\n|\s*$)/g,rs=/(?:^|\n|\t)(\d{1,2})\s+([A-Z][A-Z'\-]{1,25})(?:\s|$)/gm,os=ss.match(/CAST[:\s]*\n([\s\S]*?)(?=\n\s*\n|\nDAY|\nSCENE|$)/i);if(os){const cs=os[1],ls=/(\d{1,2})\s*[.\-]?\s*([A-Z][A-Z'\-\s]{2,25})/g;let us;for(;(us=ls.exec(cs))!==null;)addCastMember(ts,us[1],us[2])}let as;for(;(as=ns.exec(ss))!==null;)addCastMember(ts,as[1],as[2]);if(ts.length<5)for(;(as=rs.exec(ss))!==null;)addCastMember(ts,as[1],as[2]);return ts.sort((cs,ls)=>cs.number-ls.number),ts}function addCastMember(es,ts,ss){const ns=parseInt(ts,10),rs=ss.trim().replace(/\s+/g," ");ns<=0||ns>99||rs.length<2||rs.length>30||/^(INT|EXT|DAY|NIGHT|MORNING|HOURS|PAGE|SCENE|EST|TIME|CALL|UNIT)/i.test(rs)||es.find(os=>os.number===ns)||es.push({number:ns,name:rs})}function parseAllDaysFast(es){var cs;const ts=[],ss=/End of Shooting Day\s+(\d+)\s*[-]+\s*(\w+),?\s*(\d{1,2})\s+(\w+)\s+(\d{4})/gi,ns=/(?:^|\n)(?:Shooting\s+)?Day\s+(\d+)\s*[-]?\s*([A-Za-z\s\-\']*?)(?:\n|$)/gi,rs=[];let os;for(;(os=ss.exec(es))!==null;){const ls=parseInt(os[1],10),us=os[2],ds=os[3].padStart(2,"0"),xs=monthToNumber$1(os[4]),fs=os[5],gs=xs?`${fs}-${xs}-${ds}`:void 0;rs.find(Es=>Es.dayNum===ls)||rs.push({dayNum:ls,date:gs,dayOfWeek:us,endPos:os.index})}const as=[];for(;(os=ns.exec(es))!==null;){const ls=parseInt(os[1],10),us=(os[2]||"").trim();as.find(ds=>ds.dayNum===ls)||as.push({dayNum:ls,location:us,startPos:os.index})}if(rs.length>0){rs.sort((ls,us)=>ls.endPos-us.endPos);for(let ls=0;ls<rs.length;ls++){const us=rs[ls],ds=ls>0?rs[ls-1].endPos:0,xs=es.slice(ds,us.endPos+200),fs=parseDaySectionFast(us.dayNum,"",xs,us.date,us.dayOfWeek);ts.push(fs)}}else if(as.length>0){as.sort((ls,us)=>ls.startPos-us.startPos);for(let ls=0;ls<as.length;ls++){const us=as[ls],ds=((cs=as[ls+1])==null?void 0:cs.startPos)||es.length,xs=es.slice(us.startPos,ds),fs=parseDaySectionFast(us.dayNum,us.location,xs);ts.push(fs)}}else{const ls=parseSceneEntriesFast(es);if(ls.length>0){const us=new Map;for(const ds of ls){const xs=ds.dayNight.match(/[DN](\d+)/i),fs=xs?parseInt(xs[1],10):1;us.has(fs)||us.set(fs,[]),us.get(fs).push(ds)}for(const[ds,xs]of us)ts.push({dayNumber:ds,location:"",scenes:xs})}}return ts.sort((ls,us)=>ls.dayNumber-us.dayNumber),ts}function parseDaySectionFast(es,ts,ss,ns,rs){var ms;const os=ss.match(/HOURS?[:\s]*(\d{4})\s*[-]\s*(\d{4})/i),as=os?`${os[1]} - ${os[2]}`:void 0,cs=ss.match(/\b(CWD|SWD|SCWD)\b/i),ls=cs?cs[1].toUpperCase():void 0,us=ss.match(/SR[:\s]*(\d{2}):?(\d{2})/i),ds=ss.match(/SS[:\s]*(\d{2}):?(\d{2})/i),xs=us?`${us[1]}:${us[2]}`:void 0,fs=ds?`${ds[1]}:${ds[2]}`:void 0;if(!ns){const hs=ss.match(/(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday)[,\s]+(\d{1,2})\s+(\w+)\s+(\d{4})/i);if(hs){rs=(ms=ss.match(/(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday)/i))==null?void 0:ms[1];const vs=hs[1].padStart(2,"0"),ws=monthToNumber$1(hs[2]),ys=hs[3];ws&&(ns=`${ys}-${ws}-${vs}`)}}if(!ts){const hs=ss.match(/(?:^|\n)([A-Z][A-Za-z\s\'\-,]+?)(?:\n\s*Load|\n\s*Scene|\n\s*Est)/m);hs&&(ts=hs[1].trim())}const gs=[];/UNIT\s+MOVE/i.test(ss)&&gs.push("UNIT MOVE"),/Drone\s+Day/i.test(ss)&&gs.push("Drone Day"),/Load\s*in/i.test(ss)&&gs.push("Load In"),/Load\s*Out/i.test(ss)&&gs.push("Load Out"),/Lighting\s+Change/i.test(ss)&&gs.push("Lighting Change");const Es=ss.match(/(\d+\s*\d*\/?\d*)\s*Pages?/i),js=Es?Es[1].trim():void 0,ps=parseSceneEntriesFast(ss);return{dayNumber:es,date:ns,dayOfWeek:rs,location:ts,hours:as,dayType:ls,sunrise:xs,sunset:fs,notes:gs.length>0?gs:void 0,scenes:ps,totalPages:js}}function parseSceneEntriesFast(es){const ts=[],ss=es.split(`
`),ns=parseTwoRowTableFormat(ss);if(ns.length>0)return ns;const rs=[];let os="";for(const as of ss){const cs=as.trim();if(!cs||/^(DAY|HOURS|SR:|SS:|End of|UNIT MOVE|WRAP|Load|===|PAGE|Daylight|Est\.\s*Unit)/i.test(cs)||/^Lighting\s+Change/i.test(cs)||/^Set\s+Move/i.test(cs)||/^#\d+\s+H\/MU/i.test(cs)){os&&(rs.push(os),os="");continue}const ls=/^Scene\s*\d+/i.test(cs)||/^\d+[A-Za-z]?\s+\d+\s*\/?8?\s*pgs?/i.test(cs)||/^\d+[A-Za-z]?(?:pt)?\s+(?:\d+\s*)?(?:\d\/\d)?\s*pgs?\s+(?:INT|EXT)/i.test(cs);ls&&os?(rs.push(os),os=cs):ls?os=cs:os&&(os+=" "+cs)}os&&rs.push(os);for(const as of rs){const cs=parseSceneLine(as);cs&&!ts.find(ls=>ls.sceneNumber===cs.sceneNumber)&&(cs.shootOrder=ts.length+1,ts.push(cs))}return ts}function parseTwoRowTableFormat(es){var ss;const ts=[];for(let ns=0;ns<es.length-1;ns++){const rs=es[ns].trim(),os=((ss=es[ns+1])==null?void 0:ss.trim())||"",as=/^Scene(?:\s|\t|$)/i.test(rs)&&!/^Scene\s*\d/i.test(rs)&&/\b(INT|EXT)\b/i.test(rs),cs=/^(\d+[A-Za-z]?)(?:\s|\t|$)/.test(os);if(as&&cs){const ls=combineSceneRows(rs,os);ls&&!ts.find(us=>us.sceneNumber===ls.sceneNumber)&&(ls.shootOrder=ts.length+1,ts.push(ls)),ns++}}return ts}function combineSceneRows(es,ts){var bs;const ss=Ns=>{const Ss=Ns.split("	");return Ss.length>3?Ss.map(Ts=>Ts.trim()):Ns.split(/\s{2,}/).map(Ts=>Ts.trim())},ns=ss(es),rs=ss(ts),os=(bs=rs[0])==null?void 0:bs.match(/^(\d+[A-Za-z]?(?:pt)?)/i);if(!os)return null;const as=os[1].replace(/pt$/i,"");let cs;const ls=rs.findIndex(Ns=>/pgs?$/i.test(Ns));if(ls>0&&ns[ls]){const Ns=ns[ls].match(/(\d+\s*(?:\d\/\d)?)/);Ns&&(cs=Ns[1].trim())}if(!cs)for(const Ns of[...ns,...rs]){const Ss=Ns.match(/(\d+\s*(?:\d\/\d)?)\s*pgs?/i);if(Ss){cs=Ss[1].trim();break}}const us=es.match(/\b(INT|EXT)(?:\/(?:INT|EXT))?\b/i),ds=us?us[1].toUpperCase():"INT",xs=ts.match(/\b(Day|Night|Morning|Evening|Dawn|Dusk)\b/i),fs=xs?xs[1]:"Day",gs=ts.match(/\b([DN]\d+[DN]?)\b/i),Es=gs?gs[1].toUpperCase():fs;let js="";const ps=es.match(/\b(?:INT|EXT)(?:\/(?:INT|EXT))?\s+([A-Z][A-Z\s\-\'\/,\.]+?)(?:\t|\s{2,}|\d{1,2}(?:\s*,|\s+Est)|$)/);ps&&(js=ps[1].trim().replace(/\s+/g," ").replace(/[-]\s*$/,"").trim());let ms="";const hs=ts.match(/\b(?:Day|Night|Morning)\s+([A-Z][a-z][^0-9\t]{5,}?)(?:\d|\t|$)/i);if(hs)ms=hs[1].trim().replace(/\s+/g," ");else for(const Ns of rs)if(/^[A-Z][a-z]/.test(Ns)&&Ns.length>10&&!/pgs?$/i.test(Ns)){ms=Ns.trim();break}const vs=[],ws=es.match(/(?:MANOR|HOUSE|ROOM|GARDEN|HALL|KITCHEN|BEDROOM|PARLOUR|HALLWAY|STREETS|BRIDGE|DOOR|FOYER)\s+(\d{1,2}(?:\s*,\s*\d{1,2})*)/i);if(ws){const Ns=ws[1].match(/\d{1,2}/g);if(Ns)for(const Ss of Ns){const Ts=parseInt(Ss,10);Ts>0&&Ts<=50&&!vs.includes(Ts)&&vs.push(Ts)}}for(const Ns of[...ns,...rs])if(!(/pgs?$/i.test(Ns)||/^\d+:\d+$/.test(Ns)||/^[DN]\d+/i.test(Ns)||/^:\d+$/.test(Ns))&&/^\d{1,2}(?:\s*,\s*\d{1,2})*$/.test(Ns.trim())){const Ss=Ns.match(/\d{1,2}/g);if(Ss)for(const Ts of Ss){const Cs=parseInt(Ts,10);Cs>0&&Cs<=50&&!vs.includes(Cs)&&vs.push(Cs)}}const ys=ts.match(/\b(\d{1,2}:\d{2}|:\d{2})\b/),Rs=ys?ys[1]:void 0;return{sceneNumber:as,pages:cs,intExt:ds,dayNight:Es,setLocation:js,description:ms||void 0,castNumbers:vs,estimatedTime:Rs,shootOrder:0}}function parseSceneLine(es){const ts=es.match(/^(?:Scene\s*)?(\d+[A-Za-z]?(?:pt)?)/i);if(!ts)return null;const ss=ts[1].replace(/pt$/i,""),ns=es.match(/(\d+\s*(?:\d\/\d)?)\s*pgs?/i),rs=ns?ns[1].trim():void 0,os=es.match(/\b(INT|EXT)(?:\/(?:INT|EXT))?\b/i),as=os?os[1].toUpperCase():"INT",cs=es.match(/\b(Day|Night|Morning|Evening|Dawn|Dusk)\b/i),ls=cs?cs[1]:"Day",us=es.match(/\b([DN]\d+[DN]?)\b/i),ds=us?us[1].toUpperCase():ls,fs=es.slice(es.search(/\b(INT|EXT)\b/i)||0).match(/(?:Day|Night|Morning)\s+([A-Z][A-Z\s\-\'\/,]+?)(?:\s+[a-z]|\s+\d{1,2}(?:\s*,|\s+Est)|\s+Est\.?\s*Time|$)/);let gs="";fs&&(gs=fs[1].trim().replace(/\s+/g," ").replace(/[-]\s*$/,"").trim());const Es=es.match(/(?:^|[,\s])(\d{1,2}(?:\s*,\s*\d{1,2})+)(?:\s|$|,)/g);let js=[];if(Es)for(const ws of Es){const ys=ws.match(/\d{1,2}/g);if(ys)for(const Rs of ys){const bs=parseInt(Rs,10);bs>0&&bs<=50&&!js.includes(bs)&&js.push(bs)}}const ps=es.match(/(?:^|\t|\s{2,})(\d{1,2})(?:\s+Est\.?\s*Time|\s+Day:|\s+[DN]\d|\t|$)/);if(ps){const ws=parseInt(ps[1],10);ws>0&&ws<=50&&!js.includes(ws)&&js.push(ws)}let ms="";if(gs){const ws=es.indexOf(gs);if(ws>=0){const Rs=es.slice(ws+gs.length).match(/^\s*[-]?\s*([A-Z][a-z][^0-9\t]{10,}?)(?:\d{1,2}(?:\s*,|\s+Est)|\t|$)/);Rs&&(ms=Rs[1].trim().replace(/\s+/g," "))}}const hs=es.match(/(?:Est\.?\s*Time[:\s]*)?(\d*:?\d{2})(?:\s|$)/),vs=hs&&hs[1]!==ss?hs[1]:void 0;return{sceneNumber:ss,pages:rs,intExt:as,dayNight:ds,setLocation:gs,description:ms||void 0,castNumbers:js,estimatedTime:vs,shootOrder:0}}function extractMetadata(es){const ts=es.slice(0,2e3),ss=ts.match(/^[A-Z][A-Z\s\-\']+(?=\s*\n)/m),ns=ts.match(/(?:Script|Draft)[:\s]*([A-Za-z]+\s*\d*)/i),rs=ts.match(/(?:Schedule|Version)[:\s]*([A-Za-z0-9\s\-\/]+)/i);return{productionName:ss?ss[0].trim():void 0,scriptVersion:ns?ns[1].trim():void 0,scheduleVersion:rs?rs[1].trim():void 0}}function monthToNumber$1(es){return{january:"01",february:"02",march:"03",april:"04",may:"05",june:"06",july:"07",august:"08",september:"09",october:"10",november:"11",december:"12"}[es.toLowerCase()]||null}async function parseSchedulePDF(es){console.time("scheduleParser:total"),console.time("scheduleParser:readFile");const ts=await new Promise(rs=>{const os=new FileReader;os.onload=()=>rs(os.result),os.readAsDataURL(es)});console.timeEnd("scheduleParser:readFile"),console.time("scheduleParser:extractText");const ss=await extractTextFromPDF$1(es);console.timeEnd("scheduleParser:extractText"),console.log("Extracted schedule text length:",ss.length),console.time("scheduleParser:parseText");const ns=parseScheduleText(ss,ts);return console.timeEnd("scheduleParser:parseText"),console.log(`Parsed ${ns.castList.length} cast members, ${ns.days.length} days, ${ns.days.reduce((rs,os)=>rs+os.scenes.length,0)} scenes`),console.timeEnd("scheduleParser:total"),ns}function getCharacterNameByNumber(es,ts){const ss=es.find(ns=>ns.number===ts);return ss==null?void 0:ss.name}function getCharacterNamesForScene(es,ts){return ts.map(ss=>getCharacterNameByNumber(es,ss)).filter(ss=>!!ss)}function matchScheduleToScript(es,ts){const ss=new Map;for(const ns of es.days)for(const rs of ns.scenes){const os=ts.find(as=>normalizeSceneNumber(as.sceneNumber)===normalizeSceneNumber(rs.sceneNumber));if(os){const as=getCharacterNamesForScene(es.castList,rs.castNumbers);ss.set(rs.sceneNumber,{sceneId:os.id,characterNames:as,shootingDay:ns.dayNumber})}}return ss}function normalizeSceneNumber(es){return es.replace(/\s+/g,"").toUpperCase()}function debugLog(...es){console.log("[ScheduleAI]",...es)}function sanitizeAIJSON(es){let ts=es;ts=ts.replace(/^[\s\n]*```(?:json)?[\s\n]*/i,""),ts=ts.replace(/[\s\n]*```[\s\n]*$/i,"");const ss=ts.indexOf("{"),ns=ts.lastIndexOf("}");ss!==-1&&ns!==-1&&ns>ss&&(ts=ts.substring(ss,ns+1)),ts=ts.trim();let rs=0;for(;rs!==ts.length;)rs=ts.length,ts=ts.replace(/,(\s*[\]\}])/g,"$1");ts=ts.replace(/\}(\s*)\{/g,"},$1{"),ts=ts.replace(/"(\s*)\{/g,'",$1{'),ts=ts.replace(/\}(\s*)"/g,'},$1"'),ts=ts.replace(/(\d)(\s+)(\d)/g,"$1,$2$3"),ts=ts.replace(/(true|false|null)(\s+)(true|false|null|\d|"|\{|\[)/gi,"$1,$2$3"),ts=ts.replace(/: "([^"]*)"([^,}\]"]*)"([^,}\]]*)",/g,': "$1\\"$2\\"$3",'),ts=ts.replace(/: "null"/g,": null");const os=(ts.match(/\{/g)||[]).length,as=(ts.match(/\}/g)||[]).length,cs=(ts.match(/\[/g)||[]).length,ls=(ts.match(/\]/g)||[]).length;if(os>as||cs>ls){debugLog("Detected truncated JSON, attempting to repair...");const us=ts.match(/^([\s\S]*(?:[\]\}\"\d]|true|false|null))\s*,?\s*[^\]\}\"\d]*$/);us&&(ts=us[1]);for(let ds=0;ds<cs-ls;ds++)ts+="]";for(let ds=0;ds<os-as;ds++)ts+="}";ts=ts.replace(/,(\s*[\]\}])/g,"$1")}return ts}function parseAIJSON(es,ts="AI response"){if(debugLog(`parseAIJSON called for ${ts}, response length: ${(es==null?void 0:es.length)||0}`),!es||es.trim().length===0)throw debugLog("ERROR: Empty response"),new Error("Empty AI response");const ss=es.indexOf("{"),ns=es.lastIndexOf("}");if(ss===-1||ns===-1||ns<=ss)throw debugLog(`ERROR: No JSON object found in ${ts}`),console.error(`No JSON found in ${ts}:`,es.substring(0,500)),new Error("Failed to parse schedule - no valid JSON in AI response");const rs=es.substring(ss,ns+1);debugLog(`Extracted JSON, length: ${rs.length}`);try{const os=JSON.parse(rs);return debugLog("JSON parsed successfully on first try"),os}catch(os){debugLog("First JSON parse failed, attempting sanitization...");const as=sanitizeAIJSON(rs);try{debugLog("Retrying with sanitized JSON...");const cs=JSON.parse(as);return debugLog("JSON parsed successfully after sanitization"),cs}catch(cs){debugLog("Second parse failed, trying to extract days array...");try{const us=rs.match(/"days"\s*:\s*\[[\s\S]*?\]/);if(us){const ds=`{${us[0]}}`,xs=JSON.parse(ds);return debugLog("JSON parsed by extracting days array"),xs}}catch{}const ls=cs instanceof Error?cs.message:"Unknown parse error";throw debugLog(`ERROR: JSON parse failed for ${ts}: ${ls}`),console.error(`JSON parse failed for ${ts}:`),console.error("Original error:",os),console.error("After sanitization:",cs),console.error("Raw JSON (first 1000 chars):",rs.substring(0,1e3)),console.error("Sanitized JSON (first 1000 chars):",as.substring(0,1e3)),new Error(`Failed to parse AI response: ${ls}. The AI may have returned incomplete or malformed data.`)}}}async function parseScheduleWithAI(es,ts,ss){if(debugLog("Starting AI schedule parsing"),debugLog("Raw text length:",(es==null?void 0:es.length)||0),debugLog("Existing schedule days:",ts.days.length),debugLog("Existing cast list:",ts.castList.length),!es||es.length===0)return debugLog("ERROR: No raw text provided for AI parsing"),ss==null||ss({status:"error",progress:0,message:"No schedule text available for AI analysis",error:"Raw text is empty"}),ts;ss==null||ss({status:"processing",progress:10,message:"Starting AI analysis of schedule..."});try{const ns=ts.castList.length>0?`
CAST LIST (use these numbers to identify characters):
${ts.castList.map(ls=>`${ls.number}. ${ls.character||ls.name}`).join(`
`)}
`:"";debugLog("Cast reference built:",ns.length>0?"yes":"no"),ss==null||ss({status:"processing",progress:20,message:"Analyzing schedule structure..."});const rs=25e3;if(debugLog("Processing mode:",es.length<=rs?"full":"chunked"),es.length<=rs){debugLog("Calling analyzeFullSchedule...");const ls=await analyzeFullSchedule(es,ns);debugLog("analyzeFullSchedule result:",ls.days.length,"days");const us=ls.days.reduce((ds,xs)=>ds+xs.scenes.length,0);return debugLog("Total scenes found by AI:",us),ss==null||ss({status:"complete",progress:100,message:`Successfully identified ${us} scenes across ${ls.days.length} days`}),{...ts,days:ls.days.length>0?ls.days:ts.days,totalDays:ls.days.length>0?ls.days.length:ts.totalDays}}const os=splitScheduleByDays(es);debugLog("Split into",os.length,"day chunks"),ss==null||ss({status:"processing",progress:30,message:`Found ${os.length} shooting days to analyze...`});const as=[];for(let ls=0;ls<os.length;ls++){const us=os[ls],ds=30+Math.round(ls/os.length*60);debugLog(`Processing chunk ${ls+1}/${os.length}, day ${us.dayNumber}`),ss==null||ss({status:"processing",progress:ds,message:`Analyzing Day ${us.dayNumber||ls+1}...`});try{const xs=await analyzeDayChunk(us.text,us.dayNumber,ns);xs&&xs.scenes.length>0?(debugLog(`Day ${us.dayNumber}: found ${xs.scenes.length} scenes`),as.push(xs)):debugLog(`Day ${us.dayNumber}: no scenes found`)}catch(xs){debugLog(`ERROR: Failed to analyze day ${ls+1}:`,xs),console.error(`Failed to analyze day ${ls+1}:`,xs)}}ss==null||ss({status:"processing",progress:95,message:"Finalizing results..."}),as.sort((ls,us)=>ls.dayNumber-us.dayNumber);const cs=as.reduce((ls,us)=>ls+us.scenes.length,0);return debugLog("Total scenes found across all chunks:",cs),ss==null||ss({status:"complete",progress:100,message:`Successfully identified ${cs} scenes across ${as.length} days`}),{...ts,days:as.length>0?as:ts.days,totalDays:as.length>0?as.length:ts.totalDays}}catch(ns){const rs=ns instanceof Error?ns.message:"Unknown error";return debugLog("ERROR: AI schedule parsing failed:",rs),console.error("AI schedule parsing failed:",ns),ss==null||ss({status:"error",progress:0,message:"Failed to analyze schedule with AI",error:rs}),ts}}async function analyzeFullSchedule(es,ts){debugLog("analyzeFullSchedule called, text length:",es.length);const ss=`You are an expert at parsing film production shooting schedules. Your job is to extract ALL scenes from a schedule PDF that has been converted to text.

CRITICAL: The schedule uses a TABLE FORMAT where each scene has these columns:
1. Scene number (e.g., "Scene 21", "Scene 14", "Scene 49", "Scene 61A")
2. Page count (e.g., "2 pgs", "1 4/8 pgs", "2/8 pgs")
3. INT or EXT (interior/exterior)
4. Time of day (Day, Night, Morning)
5. Location in CAPS (e.g., "MARGOT'S BEDROOM - PLUMHILL MANOR", "KITCHEN - PLUMHILL MANOR")
6. Scene description in mixed case (the action/synopsis)
7. Cast numbers (single digits or comma-separated like "1, 3" or "1, 2, 3, 7")
8. Estimated time (like "3:00", "1:30", ":30")
9. Story day marker (D5, D4, D6, D8, N8, N7, etc. - this indicates which story day)
10. Remarks (optional notes)

IMPORTANT PATTERNS:
- "End of Shooting Day X" marks the end of each shooting day's scenes
- Look for scene rows that have "Scene" followed by a number
- Story day markers like "D5" mean "Day 5 in the story timeline", "N8" means "Night 8"
- Cast numbers reference the cast list and appear as single digits or lists
- Locations are typically ALL CAPS
- Scene descriptions/synopses are typically mixed case
- The schedule may have TWO-ROW format where "Scene" is on one line and scene number on next line

Return ONLY valid JSON with no additional text, no markdown code blocks.`,ns=`Extract ALL scenes from this shooting schedule, organized by shooting day.
${ts}
SCHEDULE TEXT:
---
${es}
---

Return a JSON object with this exact structure:
{
  "days": [
    {
      "dayNumber": 1,
      "date": "2024-05-21 or null",
      "dayOfWeek": "Tuesday or null",
      "location": "The Crown, Framlingham",
      "scenes": [
        {
          "sceneNumber": "21",
          "pages": "2",
          "intExt": "INT",
          "dayNight": "D5",
          "setLocation": "MARGOT'S BEDROOM - PLUMHILL MANOR",
          "description": "Margot wakes to a call from Calvaux.",
          "castNumbers": [1],
          "estimatedTime": "3:00",
          "shootOrder": 1
        }
      ]
    }
  ]
}

CRITICAL INSTRUCTIONS:
1. Extract EVERY scene you can find - don't skip any
2. Scene numbers should be exactly as shown (21, 14, 49, 62, 71, 73, 61A, 14pt, etc.)
3. dayNight should be the STORY DAY marker (D5, D4, N8, etc.) NOT just "Day" or "Night"
4. castNumbers should be an array of integers (the cast ID numbers)
5. shootOrder should be the order scenes appear within each shooting day (1, 2, 3...)
6. Group scenes by shooting day based on "End of Shooting Day X" markers
7. For intExt, use only "INT" or "EXT"
8. Look for patterns like "Scene 21" or "Sc 21" to identify scene entries
9. Extract the date from patterns like "Tuesday, 21 May 2024"
10. Return ONLY the JSON object, no explanation, no markdown`;try{debugLog("Calling AI for full schedule analysis...");const rs=await callAI(ns,{system:ss,maxTokens:8e3});if(debugLog("AI response received, length:",(rs==null?void 0:rs.length)||0),!rs)return debugLog("ERROR: Empty AI response"),{days:[]};debugLog("Response preview:",rs.substring(0,500));let os;try{os=parseAIJSON(rs,"full schedule analysis"),debugLog("JSON parsed successfully")}catch(cs){return debugLog("ERROR: JSON parsing failed:",cs),console.error("JSON parsing failed:",cs),{days:[]}}if(!os||!os.days)return debugLog("ERROR: Parsed response missing days array"),{days:[]};debugLog("Parsed days count:",os.days.length);const as=(os.days||[]).map((cs,ls)=>{const us=(cs.scenes||[]).map((ds,xs)=>{var fs;return{sceneNumber:String(ds.sceneNumber||""),pages:ds.pages||void 0,intExt:((fs=ds.intExt)==null?void 0:fs.toUpperCase())==="EXT"?"EXT":"INT",dayNight:ds.dayNight||"Day",setLocation:ds.setLocation||"",description:ds.description||void 0,castNumbers:Array.isArray(ds.castNumbers)?ds.castNumbers.filter(gs=>typeof gs=="number"):[],estimatedTime:ds.estimatedTime||void 0,shootOrder:ds.shootOrder||xs+1}}).filter(ds=>ds.sceneNumber);return debugLog(`Day ${ls+1}: ${us.length} valid scenes`),{dayNumber:cs.dayNumber||ls+1,date:cs.date||void 0,dayOfWeek:cs.dayOfWeek||void 0,location:cs.location||"",scenes:us}}).filter(cs=>cs.scenes.length>0);return debugLog("Final days with scenes:",as.length),{days:as}}catch(rs){return debugLog("ERROR: analyzeFullSchedule failed:",rs),console.error("analyzeFullSchedule error:",rs),{days:[]}}}function splitScheduleByDays(es){const ts=[],ss=/End of Shooting Day\s+(\d+)[^\n]*/gi,ns=[];let rs;for(;(rs=ss.exec(es))!==null;)ns.push({index:rs.index,endIndex:rs.index+rs[0].length,dayNumber:parseInt(rs[1],10)});if(ns.length===0)return[{text:es,dayNumber:1}];let os=0;for(const as of ns){const cs=es.slice(os,as.endIndex);ts.push({text:cs,dayNumber:as.dayNumber}),os=as.endIndex}return ts}async function analyzeDayChunk(es,ts,ss){debugLog(`analyzeDayChunk called for day ${ts}, text length: ${es.length}`);const ns=`You are an expert at parsing film production shooting schedules. Extract all scenes from this portion of a schedule.

The schedule uses a TABLE FORMAT with columns for:
- Scene number, Page count, INT/EXT, Time of day, Location, Description, Cast numbers, Est. time, Story day marker

Look for:
- "Scene X" patterns to identify scene entries
- Story day markers like D5, N8 (Day 5, Night 8 in the story)
- Cast numbers as single digits or comma-separated lists
- Locations in ALL CAPS
- Descriptions in mixed case
- The schedule may have TWO-ROW format where "Scene" is on one line and scene number on next line

Return ONLY valid JSON, no markdown code blocks.`,rs=`Extract ALL scenes from this shooting day.
${ss}
SCHEDULE TEXT FOR DAY ${ts}:
---
${es.slice(0,15e3)}
---

Return JSON:
{
  "date": "2024-05-21 or null",
  "dayOfWeek": "Tuesday or null",
  "location": "Main location name",
  "scenes": [
    {
      "sceneNumber": "21",
      "pages": "2",
      "intExt": "INT",
      "dayNight": "D5",
      "setLocation": "MARGOT'S BEDROOM - PLUMHILL MANOR",
      "description": "Scene action description",
      "castNumbers": [1, 3],
      "estimatedTime": "3:00",
      "shootOrder": 1
    }
  ]
}

Extract EVERY scene. Scene numbers exactly as shown. dayNight = story day marker (D5, N8, etc).
Return ONLY the JSON object, no explanation, no markdown.`;try{debugLog(`Calling AI for day ${ts}...`);const os=await callAI(rs,{system:ns,maxTokens:4e3});if(debugLog(`Day ${ts} AI response length:`,(os==null?void 0:os.length)||0),!os)return debugLog(`ERROR: Empty AI response for day ${ts}`),null;let as;try{as=parseAIJSON(os,`day ${ts} analysis`),debugLog(`Day ${ts} JSON parsed successfully`)}catch(js){return debugLog(`ERROR: No valid JSON in AI response for day ${ts}:`,js),console.error("No valid JSON in AI response for day",ts,js),null}const cs=es.match(/(\w+day)[,\s]+(\d{1,2})\s+(\w+)\s+(\d{4})/i);let ls=as.date,us=as.dayOfWeek;if(!ls&&cs){us=cs[1];const js=cs[2].padStart(2,"0"),ps=monthToNumber(cs[3]),ms=cs[4];ps&&(ls=`${ms}-${ps}-${js}`)}const ds=es.match(/SR[:\s]*(\d{2}):?(\d{2})/i),xs=es.match(/SS[:\s]*(\d{2}):?(\d{2})/i),fs=[];/UNIT\s+MOVE/i.test(es)&&fs.push("UNIT MOVE"),/Drone\s+Day/i.test(es)&&fs.push("Drone Day"),/Load\s*in/i.test(es)&&fs.push("Load In"),/Load\s*Out/i.test(es)&&fs.push("Load Out"),/Lighting\s+Change/i.test(es)&&fs.push("Lighting Change");const gs=es.match(/(\d+\s*\d*\/?\d*)\s*Pages?/i),Es=(as.scenes||[]).map((js,ps)=>{var ms;return{sceneNumber:String(js.sceneNumber||""),pages:js.pages||void 0,intExt:((ms=js.intExt)==null?void 0:ms.toUpperCase())==="EXT"?"EXT":"INT",dayNight:js.dayNight||"Day",setLocation:js.setLocation||"",description:js.description||void 0,castNumbers:Array.isArray(js.castNumbers)?js.castNumbers.filter(hs=>typeof hs=="number"):[],estimatedTime:js.estimatedTime||void 0,shootOrder:js.shootOrder||ps+1}}).filter(js=>js.sceneNumber);return{dayNumber:ts,date:ls||void 0,dayOfWeek:us||void 0,location:as.location||"",sunrise:ds?`${ds[1]}:${ds[2]}`:void 0,sunset:xs?`${xs[1]}:${xs[2]}`:void 0,notes:fs.length>0?fs:void 0,scenes:Es,totalPages:gs?gs[1].trim():void 0}}catch(os){return console.error("AI day chunk parsing failed:",os),null}}function monthToNumber(es){return{january:"01",february:"02",march:"03",april:"04",may:"05",june:"06",july:"07",august:"08",september:"09",october:"10",november:"11",december:"12"}[es.toLowerCase()]||null}function shouldUseAIProcessing(es){const ts=es.days.reduce((ns,rs)=>ns+rs.scenes.length,0);return ts===0||ts/(es.days.length||1)<3||es.rawText&&es.rawText.length>5e3&&ts<10,!0}const useScheduleStore=create()(persist((es,ts)=>({schedule:null,discrepancies:[],isUploading:!1,uploadError:null,showDiscrepancyModal:!1,aiProcessingStatus:{status:"idle",progress:0,message:""},isAIProcessing:!1,setSchedule:ss=>{es({schedule:ss,isUploading:!1,uploadError:null})},setAIProcessingStatus:ss=>{es({aiProcessingStatus:ss,isAIProcessing:ss.status==="processing"})},startAIProcessing:async()=>{var os;const{schedule:ss,setAIProcessingStatus:ns,setSchedule:rs}=ts();if(console.log("[ScheduleStore] startAIProcessing called"),console.log("[ScheduleStore] Has schedule:",!!ss),console.log("[ScheduleStore] Has rawText:",!!(ss!=null&&ss.rawText)),console.log("[ScheduleStore] rawText length:",((os=ss==null?void 0:ss.rawText)==null?void 0:os.length)||0),!ss||!ss.rawText){console.log("[ScheduleStore] No schedule or raw text available for AI processing"),ns({status:"complete",progress:100,message:"Using initial parsing results"});return}if(!shouldUseAIProcessing(ss)){console.log("[ScheduleStore] AI processing not needed - regex parsing was sufficient");const as=ss.days.reduce((cs,ls)=>cs+ls.scenes.length,0);ns({status:"complete",progress:100,message:`Schedule parsed: ${as} scenes across ${ss.days.length} days`});return}console.log("[ScheduleStore] Starting AI processing..."),es({isAIProcessing:!0});try{const as=await parseScheduleWithAI(ss.rawText,ss,us=>{console.log("[ScheduleStore] AI progress:",us.progress,us.message),ns(us)}),cs=as.days.reduce((us,ds)=>us+ds.scenes.length,0),ls=ss.days.reduce((us,ds)=>us+ds.scenes.length,0);console.log("[ScheduleStore] AI found",cs,"scenes, original had",ls),cs>0?(rs(as),ns({status:"complete",progress:100,message:`Successfully identified ${cs} scenes across ${as.days.length} days`})):(console.log("[ScheduleStore] AI found no scenes, keeping original results"),ns({status:"complete",progress:100,message:`Using initial parsing: ${ls} scenes across ${ss.days.length} days`}))}catch(as){const cs=as instanceof Error?as.message:"Unknown error";console.error("[ScheduleStore] AI schedule processing failed:",as);const ls=ss.days.reduce((us,ds)=>us+ds.scenes.length,0);ls>0?ns({status:"complete",progress:100,message:`Using initial parsing: ${ls} scenes (AI enhancement unavailable)`}):ns({status:"error",progress:0,message:"Schedule parsing failed",error:cs})}finally{es({isAIProcessing:!1})}},uploadSchedule:async ss=>{es({isUploading:!0,uploadError:null});try{const ns=await parseSchedulePDF(ss);return es({schedule:ns,isUploading:!1,aiProcessingStatus:{status:"idle",progress:0,message:"Initial parsing complete. Starting AI analysis..."}}),setTimeout(()=>{ts().startAIProcessing()},100),ns}catch(ns){const rs=ns instanceof Error?ns.message:"Failed to parse schedule";throw es({isUploading:!1,uploadError:rs}),ns}},clearSchedule:()=>{es({schedule:null,discrepancies:[],aiProcessingStatus:{status:"idle",progress:0,message:""},isAIProcessing:!1})},getCastMemberByNumber:ss=>{const ns=ts().schedule;return ns&&ns.castList.find(rs=>rs.number===ss)||null},getCastMemberByName:ss=>{const ns=ts().schedule;if(!ns)return null;const rs=ss.toUpperCase().trim();return ns.castList.find(os=>os.name.toUpperCase().includes(rs)||os.character&&os.character.toUpperCase().includes(rs))||null},getCastNamesForNumbers:ss=>{const ns=ts().schedule;return ns?ss.map(rs=>{const os=ns.castList.find(as=>as.number===rs);return os?os.character||os.name:`Cast #${rs}`}):[]},setDiscrepancies:ss=>{es({discrepancies:ss,showDiscrepancyModal:ss.length>0})},clearDiscrepancies:()=>{es({discrepancies:[],showDiscrepancyModal:!1})},getDiscrepancyForScene:ss=>ts().discrepancies.find(ns=>ns.sceneNumber===ss)||null,setShowDiscrepancyModal:ss=>{es({showDiscrepancyModal:ss})},crossReferenceWithBreakdown:ss=>{const ns=ts().schedule;if(!ns)return[];const rs=[],os=new Set(ss.map(ls=>ls.sceneNumber)),as=new Set,cs=new Map;for(const ls of ns.days)for(const us of ls.scenes)as.add(us.sceneNumber),cs.set(us.sceneNumber,{intExt:us.intExt,castNumbers:us.castNumbers,setLocation:us.setLocation});for(const ls of as)sceneExistsInSet(os,ls)||rs.push({sceneNumber:ls,type:"scene_not_in_breakdown",message:`Scene ${ls} is in the schedule but not found in the breakdown`,scheduleValue:"Present",breakdownValue:"Missing"});for(const ls of os)sceneExistsInSet(as,ls)||rs.push({sceneNumber:ls,type:"scene_not_in_schedule",message:`Scene ${ls} is in the breakdown but not found in the schedule`,scheduleValue:"Missing",breakdownValue:"Present"});for(const ls of ss){const us=findMatchingSceneData(cs,ls.sceneNumber);if(!us)continue;us.intExt!==ls.intExt&&rs.push({sceneNumber:ls.sceneNumber,type:"int_ext_mismatch",message:`Scene ${ls.sceneNumber} has different INT/EXT: Schedule says ${us.intExt}, breakdown says ${ls.intExt}`,scheduleValue:us.intExt,breakdownValue:ls.intExt});const ds=ts().getCastNamesForNumbers(us.castNumbers).map(Es=>Es.toUpperCase()),xs=ls.characters.map(Es=>Es.toUpperCase()),fs=ds.filter(Es=>!xs.some(js=>js.includes(Es)||Es.includes(js))),gs=xs.filter(Es=>!ds.some(js=>js.includes(Es)||Es.includes(js)));if(fs.length>0||gs.length>0){const Es=[];fs.length>0&&Es.push(`Schedule has: ${fs.join(", ")}`),gs.length>0&&Es.push(`Breakdown has: ${gs.join(", ")}`),rs.push({sceneNumber:ls.sceneNumber,type:"character_mismatch",message:`Scene ${ls.sceneNumber} has character differences. ${Es.join(". ")}`,scheduleCast:ds,breakdownCast:xs})}}return es({discrepancies:rs,showDiscrepancyModal:rs.length>0}),rs},getShootingDayForScene:ss=>{const ns=ts().schedule;if(!ns)return null;const rs=getBaseSceneNumber(ss);for(const os of ns.days)if(os.scenes.find(ls=>ls.sceneNumber===ss)||os.scenes.find(ls=>getBaseSceneNumber(ls.sceneNumber)===rs))return os.dayNumber;return null},getShootingInfoForScene:ss=>{const ns=ts().schedule;if(!ns)return null;const rs=getBaseSceneNumber(ss);for(const os of ns.days){const as=os.scenes.find(ls=>ls.sceneNumber===ss);if(as)return{dayNumber:os.dayNumber,shootOrder:as.shootOrder};const cs=os.scenes.find(ls=>getBaseSceneNumber(ls.sceneNumber)===rs);if(cs)return{dayNumber:os.dayNumber,shootOrder:cs.shootOrder}}return null}}),{name:"hair-makeup-schedule",storage:createHybridStorage("hair-makeup-schedule"),partialize:es=>({schedule:es.schedule,discrepancies:es.discrepancies})}));function SceneCharacterConfirmation({scene:es,onClose:ts,onConfirm:ss}){var ws;const{currentProject:ns,confirmSceneCharacters:rs,addCharacterFromScene:os}=useProjectStore(),[as,cs]=reactExports.useState(()=>new Set(es.characters||[])),[ls,us]=reactExports.useState(()=>{var bs;const ys=new Set;return ns&&((bs=es.characters)==null||bs.forEach(Ns=>{const Ss=ns.characters.find(Ts=>Ts.id===Ns);Ss&&ys.add(Ss.name)})),(es.suggestedCharacters||[]).forEach(Ns=>ys.add(Ns)),ys}),[ds,xs]=reactExports.useState(""),[fs,gs]=reactExports.useState(!1),Es=(ns==null?void 0:ns.characters)||[],js=reactExports.useMemo(()=>(es.suggestedCharacters||[]).map(Rs=>{const bs=Es.find(Ns=>Ns.name.toUpperCase()===Rs.toUpperCase());return{name:Rs,existingCharacter:bs||null,isInProject:!!bs}}),[es.suggestedCharacters,Es]),ps=(ys,Rs)=>{us(bs=>{const Ns=new Set(bs);return Ns.has(ys)?(Ns.delete(ys),Rs&&cs(Ss=>{const Ts=new Set(Ss);return Ts.delete(Rs.id),Ts})):(Ns.add(ys),Rs&&cs(Ss=>new Set([...Ss,Rs.id]))),Ns})},ms=()=>{const ys=ds.trim().toUpperCase();if(!ys)return;if(ls.has(ys)){xs(""),gs(!1);return}const Rs=Es.find(bs=>bs.name.toUpperCase()===ys);Rs?cs(bs=>new Set([...bs,Rs.id])):us(bs=>new Set([...bs,ys])),xs(""),gs(!1)},hs=()=>{const ys=new Set(as);ls.forEach(Rs=>{const bs=Es.find(Ns=>Ns.name.toUpperCase()===Rs.toUpperCase());if(bs)ys.add(bs.id);else{const Ns=os(es.id,Rs);ys.add(Ns.id)}}),rs(es.id,Array.from(ys)),ss()},vs=ls.size;return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-end justify-center",children:jsxRuntimeExports.jsxs("div",{className:"bg-card w-full max-w-lg rounded-t-3xl max-h-[85vh] flex flex-col safe-bottom",children:[jsxRuntimeExports.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between shrink-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("h3",{className:"text-base font-semibold text-text-primary truncate",children:["Scene ",es.sceneNumber]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted truncate",children:es.slugline})]}),jsxRuntimeExports.jsx("button",{onClick:ts,className:"p-2 -mr-2 text-text-muted active:text-gold",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),es.scriptContent&&jsxRuntimeExports.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-border max-h-48 overflow-y-auto shrink-0",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-text-secondary font-mono whitespace-pre-wrap",children:es.scriptContent})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[js.length>0&&jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("h4",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-2",children:"SUGGESTED CHARACTERS"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:js.map(({name:ys,existingCharacter:Rs})=>{const bs=ls.has(ys);return jsxRuntimeExports.jsxs("button",{onClick:()=>ps(ys,Rs),className:clsx("w-full flex items-center gap-3 p-3 rounded-xl border transition-all text-left",bs?"border-gold bg-gold/5":"border-border bg-card"),children:[jsxRuntimeExports.jsx("div",{className:clsx("w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 transition-all",bs?"border-gold bg-gold":"border-gray-300"),children:bs&&jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})})}),Rs?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CharacterAvatar,{character:Rs,size:"sm"}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-text-primary",children:Rs.name}),jsxRuntimeExports.jsx("span",{className:"text-xs text-green-600 ml-2",children:"In project"})]})]}):jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-text-primary",children:ys}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted ml-2",children:"New character"})]})]},ys)})})]}),es.characterConfirmationStatus==="detecting"&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-4 p-3 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Detecting characters..."]}),es.characterConfirmationStatus==="pending"&&!((ws=es.suggestedCharacters)!=null&&ws.length)&&jsxRuntimeExports.jsx("div",{className:"text-text-muted text-sm mb-4 p-3 bg-gray-50 rounded-lg",children:"No characters detected yet. Add characters manually below."}),jsxRuntimeExports.jsx("div",{className:"mt-4",children:fs?jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:ds,onChange:ys=>xs(ys.target.value.toUpperCase()),placeholder:"CHARACTER NAME",className:"flex-1 px-3 py-2 text-sm border border-border rounded-lg bg-card text-text-primary uppercase",autoFocus:!0,onKeyDown:ys=>{ys.key==="Enter"&&ms(),ys.key==="Escape"&&gs(!1)}}),jsxRuntimeExports.jsx("button",{onClick:ms,disabled:!ds.trim(),className:"px-3 py-2 bg-gold text-white rounded-lg text-sm font-medium disabled:opacity-50",children:"Add"}),jsxRuntimeExports.jsx("button",{onClick:()=>{gs(!1),xs("")},className:"px-3 py-2 text-text-muted",children:"Cancel"})]}):jsxRuntimeExports.jsxs("button",{onClick:()=>gs(!0),className:"w-full flex items-center justify-center gap-2 p-3 rounded-xl border border-dashed border-border text-text-muted hover:border-gold hover:text-gold transition-colors",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"Add character not detected"]})})]}),jsxRuntimeExports.jsx("div",{className:"px-4 py-4 border-t border-border shrink-0",children:jsxRuntimeExports.jsxs("button",{onClick:hs,className:"w-full py-3 rounded-button gold-gradient text-white font-semibold text-base shadow-lg active:scale-[0.98] transition-transform",children:["Confirm ",vs," Character",vs!==1?"s":""]})})]})})}function SceneCharacterStatus({scene:es,characters:ts,onConfirmClick:ss}){const ns=es.characterConfirmationStatus||"pending",rs=es.suggestedCharacters||[],os=ts.filter(as=>{var cs;return(cs=es.characters)==null?void 0:cs.includes(as.id)});return ns==="confirmed"?jsxRuntimeExports.jsxs("button",{onClick:ss,className:"w-full text-left group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-green-600 text-xs mb-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Characters confirmed"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-1",children:[os.slice(0,4).map(as=>jsxRuntimeExports.jsxs("span",{className:"text-[11px] text-text-secondary",children:[as.name,os.indexOf(as)<os.length-1&&os.indexOf(as)<3?",":""]},as.id)),os.length>4&&jsxRuntimeExports.jsxs("span",{className:"text-[11px] text-text-muted",children:["+",os.length-4," more"]})]}),jsxRuntimeExports.jsx("span",{className:"text-[10px] text-gold opacity-0 group-hover:opacity-100 transition-opacity",children:"Tap to edit"})]}):ns==="detecting"?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-xs py-1",children:[jsxRuntimeExports.jsxs("svg",{className:"w-3.5 h-3.5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Detecting characters..."]}):ns==="ready"&&rs.length>0?jsxRuntimeExports.jsxs("button",{onClick:ss,className:"w-full text-left",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-amber-600 text-xs mb-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Characters not confirmed"})]}),jsxRuntimeExports.jsxs("p",{className:"text-[11px] text-text-muted mb-1",children:["Suggested: ",rs.slice(0,3).join(", "),rs.length>3&&` +${rs.length-3} more`]}),jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] text-gold font-medium",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Tap to confirm characters"]})]}):jsxRuntimeExports.jsxs("button",{onClick:ss,className:"w-full text-left",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 text-text-muted text-xs mb-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),jsxRuntimeExports.jsx("span",{children:"No characters assigned"})]}),jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] text-gold font-medium",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"Tap to add characters"]})]})}function CharacterConfirmationProgress({totalScenes:es,confirmedScenes:ts}){const ss=es>0?Math.round(ts/es*100):0;return ts>=es?null:jsxRuntimeExports.jsxs("div",{className:"mx-4 mb-3 p-3 bg-amber-50 border border-amber-200 rounded-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-medium text-amber-700",children:"Character Confirmation"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-amber-600",children:[ts," / ",es," scenes"]})]}),jsxRuntimeExports.jsx("div",{className:"h-1.5 bg-amber-100 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-amber-500 rounded-full transition-all duration-300",style:{width:`${ss}%`}})}),jsxRuntimeExports.jsx("p",{className:"text-[10px] text-amber-600 mt-1.5",children:"Confirm characters in each scene to track continuity"})]})}function FilmingStatusDropdown({scene:es,onStatusChange:ts,onNotesModalOpen:ss}){const[ns,rs]=reactExports.useState(!1),os=reactExports.useRef(null);reactExports.useEffect(()=>{const ls=us=>{os.current&&!os.current.contains(us.target)&&rs(!1)};if(ns)return document.addEventListener("mousedown",ls),()=>document.removeEventListener("mousedown",ls)},[ns]);const as=es.filmingStatus?SCENE_FILMING_STATUS_CONFIG[es.filmingStatus]:null,cs=ls=>{rs(!1),ls==="complete"?ts(es.sceneNumber,ls):ss(es.sceneNumber,ls)};return jsxRuntimeExports.jsxs("div",{ref:os,className:"relative",children:[jsxRuntimeExports.jsxs("button",{onClick:ls=>{ls.stopPropagation(),rs(!ns)},className:clsx("flex items-center gap-1.5 px-2 py-1 text-[10px] font-semibold rounded-lg flex-shrink-0 border transition-colors",as?[as.bgClass,as.textClass,es.filmingStatus==="complete"&&"border-green-200",es.filmingStatus==="partial"&&"border-amber-200",es.filmingStatus==="not-filmed"&&"border-red-200"]:"bg-gray-100 text-text-muted border-gray-200 hover:border-gray-300"),children:[as?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:clsx("w-2 h-2 rounded-full",es.filmingStatus==="complete"&&"bg-green-500",es.filmingStatus==="partial"&&"bg-amber-500",es.filmingStatus==="not-filmed"&&"bg-red-500")}),as.shortLabel]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"w-2 h-2 rounded-full bg-gray-400"}),"Set Status"]}),jsxRuntimeExports.jsx("svg",{className:clsx("w-3 h-3 transition-transform",ns&&"rotate-180"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),ns&&jsxRuntimeExports.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 bg-white rounded-lg shadow-lg border border-border overflow-hidden min-w-[140px]",children:["complete","partial","not-filmed"].map(ls=>{const us=SCENE_FILMING_STATUS_CONFIG[ls],ds=es.filmingStatus===ls;return jsxRuntimeExports.jsxs("button",{onClick:xs=>{xs.stopPropagation(),cs(ls)},className:clsx("w-full flex items-center gap-2 px-3 py-2 text-xs font-medium transition-colors text-left",ds?`${us.bgClass} ${us.textClass}`:"hover:bg-gray-50 text-text-primary"),children:[jsxRuntimeExports.jsx("span",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:us.color}}),us.label,ds&&jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5 ml-auto text-current",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})]},ls)})})]})}function FilmingNotesModal({sceneNumber:es,status:ts,onConfirm:ss,onClose:ns}){const[rs,os]=reactExports.useState(""),as=SCENE_FILMING_STATUS_CONFIG[ts];return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/50",onClick:ns,children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-t-2xl w-full max-w-lg max-h-[80vh] overflow-y-auto",onClick:cs=>cs.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"sticky top-0 bg-card border-b border-border px-4 py-3 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:as.color}}),jsxRuntimeExports.jsxs("h2",{className:"text-lg font-semibold text-text-primary",children:["Scene ",es," - ",as.label]})]}),jsxRuntimeExports.jsx("button",{onClick:ns,className:"p-2 -mr-2 text-text-muted hover:text-text-primary transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:ts==="partial"?"What still needs to be filmed?":"Why wasn't this scene filmed?"}),jsxRuntimeExports.jsx("textarea",{value:rs,onChange:cs=>os(cs.target.value),placeholder:"e.g., Ran out of time, weather issues, actor unavailable...",className:"w-full px-3 py-2.5 text-sm border border-border rounded-lg bg-card text-text-primary resize-none focus:outline-none focus:ring-2 focus:ring-gold/50 focus:border-gold",rows:4,autoFocus:!0})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:ns,className:"flex-1 py-2.5 rounded-button border border-border text-text-muted text-sm font-medium",children:"Cancel"}),jsxRuntimeExports.jsxs("button",{onClick:()=>ss(rs),className:clsx("flex-1 py-2.5 rounded-button text-white text-sm font-medium",ts==="partial"?"bg-amber-500":"bg-red-500"),children:["Mark as ",as.label]})]})]})]})})}function Breakdown({onSceneSelect:es}){const{currentProject:ts,sceneCaptures:ss,updateSceneSynopsis:ns,updateSceneFilmingStatus:rs}=useProjectStore(),{getDiscrepancyForScene:os,getShootingInfoForScene:as,schedule:cs}=useScheduleStore(),[ls,us]=reactExports.useState("list"),[ds,xs]=reactExports.useState("sceneNumber"),[fs,gs]=reactExports.useState(!1),[Es,js]=reactExports.useState({characters:[],shootingDay:null,location:null,completionStatus:"all",filmingStatus:"all",lookId:null}),[ps,ms]=reactExports.useState(null),[hs,vs]=reactExports.useState(null),[ws,ys]=reactExports.useState(null),[Rs,bs]=reactExports.useState(null),[Ns,Ss]=reactExports.useState(null),Ts=(Ws,Gs,lr)=>{rs(Ws,Gs,lr)},Cs=(Ws,Gs)=>{Ss({sceneNumber:Ws,status:Gs})},Ms=Ws=>{Ns&&(rs(Ns.sceneNumber,Ns.status,Ws),Ss(null))},Is=async Ws=>{if(!ws){ys(Ws.id);try{const Gs=await generateSceneSynopsis(Ws.slugline,Ws.scriptContent||"");Gs&&ns(Ws.id,Gs)}catch(Gs){console.error("Failed to generate synopsis:",Gs)}finally{ys(null)}}},Qs=reactExports.useMemo(()=>!hs||!ts?null:ts.scenes.find(Ws=>Ws.id===hs)||null,[hs,ts]),Ys=reactExports.useMemo(()=>!Rs||!ts?null:ts.scenes.find(Ws=>Ws.id===Rs)||null,[Rs,ts]),Zs=reactExports.useMemo(()=>{if(!ts)return{total:0,confirmed:0};const Ws=ts.scenes.length,Gs=ts.scenes.filter(lr=>lr.characterConfirmationStatus==="confirmed").length;return{total:Ws,confirmed:Gs}},[ts]),Vs=reactExports.useMemo(()=>{if(!ts)return[];const Ws=new Set;return ts.scenes.forEach(Gs=>{const lr=Gs.slugline.match(/^(?:INT|EXT)\.\s*(.+?)\s*-/);lr&&Ws.add(lr[1].trim())}),Array.from(Ws).sort()},[ts]),Ks=reactExports.useMemo(()=>{if(!ts)return[];let Ws=[...ts.scenes];if(Es.characters.length>0&&(Ws=Ws.filter(Gs=>Es.characters.some(lr=>Gs.characters.includes(lr)))),Es.completionStatus==="complete"?Ws=Ws.filter(Gs=>Gs.isComplete):Es.completionStatus==="incomplete"&&(Ws=Ws.filter(Gs=>!Gs.isComplete)),Es.filmingStatus!=="all"&&(Ws=Ws.filter(Gs=>Gs.filmingStatus===Es.filmingStatus)),Es.location&&(Ws=Ws.filter(Gs=>Gs.slugline.toLowerCase().includes(Es.location.toLowerCase()))),Es.lookId){const Gs=ts.looks.find(lr=>lr.id===Es.lookId);Gs&&(Ws=Ws.filter(lr=>Gs.scenes.includes(lr.sceneNumber)))}return ds==="shootingOrder"?Ws.sort((Gs,lr)=>{const jr=as(Gs.sceneNumber),br=as(lr.sceneNumber);return!jr&&!br?Gs.sceneNumber.localeCompare(lr.sceneNumber,void 0,{numeric:!0}):jr?br?jr.dayNumber!==br.dayNumber?jr.dayNumber-br.dayNumber:jr.shootOrder-br.shootOrder:-1:1}):Ws.sort((Gs,lr)=>Gs.sceneNumber.localeCompare(lr.sceneNumber,void 0,{numeric:!0}))},[ts,Es,ds,as]),Ds=reactExports.useMemo(()=>ts?new Map(ts.characters.map(Ws=>[Ws.id,Ws])):new Map,[ts==null?void 0:ts.characters]),$s=reactExports.useMemo(()=>{if(!ts)return new Map;const Ws=new Map;for(const Gs of ts.scenes){const lr=Gs.characters.map(jr=>Ds.get(jr)).filter(jr=>jr!==void 0);Ws.set(Gs.id,lr)}return Ws},[ts==null?void 0:ts.scenes,Ds]),Xs=reactExports.useMemo(()=>{if(!ts)return new Map;const Ws=new Map;for(const Gs of ts.scenes){const lr=Gs.characters.length;let jr=0;Gs.characters.forEach(br=>{const Nr=`${Gs.id}-${br}`,wr=ss[Nr];wr&&Object.keys(wr.photos).length>0&&jr++}),Ws.set(Gs.id,{captured:jr,total:lr})}return Ws},[ts==null?void 0:ts.scenes,ss]),Fs=reactExports.useMemo(()=>{if(!ts)return new Map;const Ws=new Map;for(const Gs of ts.looks)for(const lr of Gs.scenes)Ws.set(`${Gs.characterId}-${lr}`,Gs);return Ws},[ts==null?void 0:ts.looks]),As=Ws=>Xs.get(Ws.id)||{captured:0,total:0},_s=Ws=>$s.get(Ws.id)||[],Ps=(Ws,Gs)=>Fs.get(`${Ws}-${Gs}`),Hs=(Ws,Gs)=>ss[`${Ws}-${Gs}`],Ls=()=>{js({characters:[],shootingDay:null,location:null,completionStatus:"all",filmingStatus:"all",lookId:null})},Os=Es.characters.length>0||Es.shootingDay!==null||Es.location!==null||Es.completionStatus!=="all"||Es.filmingStatus!=="all"||Es.lookId!==null;return ts?jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Breakdown"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>gs(!0),className:clsx("p-2 rounded-lg transition-colors touch-manipulation relative",Os?"text-gold bg-gold-100/50":"text-text-muted hover:text-gold"),children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"})}),Os&&jsxRuntimeExports.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 rounded-full bg-gold"})]}),jsxRuntimeExports.jsxs("div",{className:"flex rounded-lg overflow-hidden border border-border",children:[jsxRuntimeExports.jsx("button",{onClick:()=>us("list"),className:clsx("px-2.5 py-1.5 transition-colors touch-manipulation",ls==="list"?"bg-gold text-white":"bg-card text-text-muted"),children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})}),jsxRuntimeExports.jsx("button",{onClick:()=>us("grid"),className:clsx("px-2.5 py-1.5 transition-colors touch-manipulation",ls==="grid"?"bg-gold text-white":"bg-card text-text-muted"),children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})})]})]})]})})}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-3 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted",children:[Ks.length," scene",Ks.length!==1?"s":"",Os&&" (filtered)"]}),cs&&cs.days.length>0&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"Sort:"}),jsxRuntimeExports.jsxs("div",{className:"flex rounded-lg overflow-hidden border border-border text-xs",children:[jsxRuntimeExports.jsx("button",{onClick:()=>xs("sceneNumber"),className:clsx("px-2 py-1 transition-colors touch-manipulation",ds==="sceneNumber"?"bg-gold text-white":"bg-card text-text-muted"),children:"Scene #"}),jsxRuntimeExports.jsx("button",{onClick:()=>xs("shootingOrder"),className:clsx("px-2 py-1 transition-colors touch-manipulation",ds==="shootingOrder"?"bg-gold text-white":"bg-card text-text-muted"),children:"Shoot Order"})]})]})]}),Zs.total>0&&Zs.confirmed<Zs.total&&jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsx(CharacterConfirmationProgress,{totalScenes:Zs.total,confirmedScenes:Zs.confirmed})}),jsxRuntimeExports.jsx("div",{className:"mobile-container px-4 pb-4",children:Ks.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12",children:[jsxRuntimeExports.jsx("p",{className:"text-text-muted",children:"No scenes match your filters"}),jsxRuntimeExports.jsx("button",{onClick:Ls,className:"mt-3 text-sm text-gold font-medium",children:"Clear Filters"})]}):ls==="list"?jsxRuntimeExports.jsx(BreakdownListView,{scenes:Ks,expandedSceneId:ps,onToggleExpand:Ws=>ms(ps===Ws?null:Ws),onSceneSelect:es,onSynopsisClick:Ws=>vs(Ws),onGenerateSynopsis:Is,generatingSynopsisId:ws,getCharactersForScene:_s,getLookForCharacter:Ps,getCapture:Hs,getSceneProgress:As,getDiscrepancy:os,onCharacterConfirm:Ws=>bs(Ws),allCharacters:(ts==null?void 0:ts.characters)||[],onFilmingStatusChange:Ts,onNotesModalOpen:Cs}):jsxRuntimeExports.jsx(BreakdownGridView,{scenes:Ks,onSceneSelect:es,getCharactersForScene:_s,getSceneProgress:As,onFilmingStatusChange:Ts,onNotesModalOpen:Cs})}),fs&&jsxRuntimeExports.jsx(FilterDrawer,{filters:Es,characters:ts.characters,locations:Vs,looks:ts.looks,onFiltersChange:js,onClose:()=>gs(!1),onClear:Ls}),Qs&&jsxRuntimeExports.jsx(SceneScriptModal,{scene:Qs,onClose:()=>vs(null)}),Ys&&jsxRuntimeExports.jsx(SceneCharacterConfirmation,{scene:Ys,onClose:()=>bs(null),onConfirm:()=>bs(null)}),Ns&&jsxRuntimeExports.jsx(FilmingNotesModal,{sceneNumber:Ns.sceneNumber,status:Ns.status,onConfirm:Ms,onClose:()=>Ss(null)})]}):jsxRuntimeExports.jsx(EmptyState$2,{})}const getGlassOverlayClass=es=>{if(!es)return null;switch(es){case"complete":return"scene-glass-complete";case"partial":return"scene-glass-partial";case"not-filmed":return"scene-glass-incomplete";default:return null}};function BreakdownListView({scenes:es,expandedSceneId:ts,onToggleExpand:ss,onSceneSelect:ns,onSynopsisClick:rs,onGenerateSynopsis:os,generatingSynopsisId:as,getCharactersForScene:cs,getLookForCharacter:ls,getCapture:us,getSceneProgress:ds,getDiscrepancy:xs,onCharacterConfirm:fs,allCharacters:gs,onFilmingStatusChange:Es,onNotesModalOpen:js}){return jsxRuntimeExports.jsx("div",{className:"space-y-2",children:es.map(ps=>{const ms=ts===ps.id,hs=cs(ps),vs=ds(ps),ws=vs.total>0&&vs.captured===vs.total,ys=xs(ps.sceneNumber),Rs=ps.filmingStatus?SCENE_FILMING_STATUS_CONFIG[ps.filmingStatus]:null,bs=getGlassOverlayClass(ps.filmingStatus),Ns=()=>{if(!ps.filmingStatus)return"accent-bar-neutral";switch(ps.filmingStatus){case"complete":return"accent-bar-complete";case"partial":return"accent-bar-partial";case"not-filmed":return"accent-bar-incomplete";default:return"accent-bar-neutral"}};return jsxRuntimeExports.jsxs("div",{className:"relative",children:[bs&&jsxRuntimeExports.jsx("div",{className:clsx("scene-glass-overlay",bs)}),jsxRuntimeExports.jsxs("div",{className:"card overflow-hidden relative z-10",children:[jsxRuntimeExports.jsx("div",{className:clsx("absolute left-0 top-0 bottom-0 w-1 rounded-l-card",Ns())}),jsxRuntimeExports.jsxs("button",{onClick:()=>ss(ps.id),className:"w-full flex items-center gap-3 p-3 text-left touch-manipulation",children:[jsxRuntimeExports.jsxs("div",{className:"w-10 flex items-center justify-center gap-0.5",children:[jsxRuntimeExports.jsx("span",{className:"text-lg font-bold text-text-primary",children:ps.sceneNumber}),(ys||ps.hasScheduleDiscrepancy)&&jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5 text-amber-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})]}),jsxRuntimeExports.jsx("span",{className:clsx("px-1.5 py-0.5 text-[10px] font-bold rounded flex-shrink-0",ps.intExt==="INT"?"bg-slate-100 text-slate-600":"bg-stone-100 text-stone-600"),children:ps.intExt}),jsxRuntimeExports.jsx("span",{className:"flex-1 text-sm text-text-secondary truncate",children:ps.slugline.replace(/^(INT|EXT)\.\s*/,"").replace(/\s*-\s*(DAY|NIGHT|MORNING|EVENING|CONTINUOUS)$/i,"")}),jsxRuntimeExports.jsxs("span",{className:"flex-shrink-0 flex items-center -space-x-1.5",children:[hs.slice(0,3).map(Ss=>jsxRuntimeExports.jsx(CharacterAvatar,{character:Ss,size:"xs"},Ss.id)),hs.length>3&&jsxRuntimeExports.jsxs("span",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-[9px] font-bold text-text-muted",children:["+",hs.length-3]})]}),jsxRuntimeExports.jsx(FilmingStatusDropdown,{scene:ps,onStatusChange:Es,onNotesModalOpen:js}),ws&&jsxRuntimeExports.jsx("span",{className:"text-green-500 flex-shrink-0",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),!ws&&vs.captured>0&&jsxRuntimeExports.jsx("span",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0 bg-gold"}),jsxRuntimeExports.jsx("svg",{className:clsx("w-4 h-4 text-text-light transition-transform flex-shrink-0",ms&&"rotate-180"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),jsxRuntimeExports.jsxs("div",{className:"px-3 pb-3 pt-1 border-t border-border/50",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:ps.slugline}),(ps.synopsis||ps.scriptContent)&&jsxRuntimeExports.jsxs("button",{onClick:Ss=>{Ss.stopPropagation(),rs(ps.id)},className:"w-full text-left group mt-1.5",children:[ps.synopsis&&jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted italic line-clamp-2 group-hover:text-gold transition-colors",children:ps.synopsis}),ps.scriptContent&&jsxRuntimeExports.jsxs("span",{className:"text-[10px] text-gold flex items-center gap-1 mt-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Tap to view full scene"]})]}),(ps.characterConfirmationStatus!=="confirmed"||hs.length===0)&&jsxRuntimeExports.jsx("div",{className:"mt-2 pt-2 border-t border-border/30",children:jsxRuntimeExports.jsx(SceneCharacterStatus,{scene:ps,characters:gs,onConfirmClick:()=>fs(ps.id)})})]}),ms&&jsxRuntimeExports.jsxs("div",{className:"border-t border-border px-3 pb-3 pt-3 space-y-3",children:[ys&&jsxRuntimeExports.jsxs("div",{className:"p-2.5 bg-amber-50 border border-amber-200 rounded-lg flex items-start gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-500 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium text-amber-700",children:"Schedule Discrepancy"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-amber-600 mt-0.5",children:ys.message})]})]}),!ps.synopsis&&ps.scriptContent&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:Ss=>{Ss.stopPropagation(),os(ps)},disabled:as===ps.id,className:clsx("flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-medium transition-all",as===ps.id?"bg-gray-100 text-text-muted cursor-wait":"bg-gold-100 text-gold hover:bg-gold-200 active:scale-95"),children:as===ps.id?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("svg",{className:"w-3.5 h-3.5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"})}),"Generate Synopsis"]})}),jsxRuntimeExports.jsxs("button",{onClick:Ss=>{Ss.stopPropagation(),rs(ps.id)},className:"text-xs text-text-muted flex items-center gap-1 hover:text-gold transition-colors",children:[jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"View script"]})]}),ps.filmingStatus&&jsxRuntimeExports.jsxs("div",{className:clsx("p-2.5 rounded-lg",Rs==null?void 0:Rs.bgClass),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(FilmingStatusIcon,{status:ps.filmingStatus}),jsxRuntimeExports.jsx("span",{className:clsx("text-sm font-medium",Rs==null?void 0:Rs.textClass),children:Rs==null?void 0:Rs.label})]}),ps.filmingNotes&&jsxRuntimeExports.jsx("p",{className:clsx("text-xs mt-1.5",Rs==null?void 0:Rs.textClass),children:ps.filmingNotes})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:hs.map(Ss=>{const Ts=ls(Ss.id,ps.sceneNumber),Cs=us(ps.id,Ss.id),Ms=Cs&&Object.keys(Cs.photos).length>0,Is=Cs?Object.entries(Cs.continuityFlags).filter(([Qs,Ys])=>Ys).map(([Qs])=>Qs):[];return jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx(CharacterAvatar,{character:Ss,size:"sm"}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary",children:Ss.name}),Ts&&jsxRuntimeExports.jsxs("span",{className:"text-xs text-gold ml-2",children:[" ",Ts.name]})]}),Ms&&jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-green-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),Ts&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px]",children:[Ts.makeup.foundation&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-text-light",children:"Makeup:"})," ",jsxRuntimeExports.jsx("span",{className:"text-text-secondary",children:Ts.makeup.foundation})]}),Ts.hair.style&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-text-light",children:"Hair:"})," ",jsxRuntimeExports.jsx("span",{className:"text-text-secondary",children:Ts.hair.style})]})]}),Is.length>0&&jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Is.map(Qs=>jsxRuntimeExports.jsx("span",{className:"px-1.5 py-0.5 text-[9px] font-medium rounded bg-amber-100 text-amber-700 capitalize",children:Qs.replace(/([A-Z])/g," $1").trim()},Qs))}),Cs&&Object.keys(Cs.photos).length>0&&jsxRuntimeExports.jsx("div",{className:"flex gap-1 mt-2",children:["front","left","right","back"].map(Qs=>{const Ys=Cs.photos[Qs];return jsxRuntimeExports.jsx("div",{className:clsx("w-10 h-10 rounded overflow-hidden bg-gray-200",!Ys&&"opacity-30"),children:Ys&&jsxRuntimeExports.jsx("img",{src:Ys.thumbnail||Ys.uri,alt:Qs,className:"w-full h-full object-cover"})},Qs)})})]},Ss.id)})}),jsxRuntimeExports.jsx("button",{onClick:()=>ns(ps.id),className:"w-full py-2.5 rounded-button gold-gradient text-white text-sm font-medium active:scale-[0.98] transition-transform",children:vs.captured>0?"Edit Details":"Capture Continuity"})]})]})]},ps.id)})})}function FilmingStatusIcon({status:es}){const ts=SCENE_FILMING_STATUS_CONFIG[es];return es==="complete"?jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center",style:{backgroundColor:ts.color},children:jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}):es==="partial"?jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center",style:{backgroundColor:ts.color},children:jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}):jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center",style:{backgroundColor:ts.color},children:jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})}function BreakdownGridView({scenes:es,onSceneSelect:ts,getCharactersForScene:ss,getSceneProgress:ns,onFilmingStatusChange:rs,onNotesModalOpen:os}){return jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-2.5",children:es.map(as=>{const cs=ss(as),ls=ns(as),us=ls.total>0?ls.captured/ls.total*100:0,ds=ls.total>0&&ls.captured===ls.total,xs=getGlassOverlayClass(as.filmingStatus),fs=()=>{if(!as.filmingStatus)return"accent-bar-neutral";switch(as.filmingStatus){case"complete":return"accent-bar-complete";case"partial":return"accent-bar-partial";case"not-filmed":return"accent-bar-incomplete";default:return"accent-bar-neutral"}};return jsxRuntimeExports.jsxs("div",{className:"relative",children:[xs&&jsxRuntimeExports.jsx("div",{className:clsx("scene-glass-overlay",xs)}),jsxRuntimeExports.jsxs("div",{className:"card text-left w-full relative z-10 overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:clsx("absolute left-0 top-0 bottom-0 w-1",fs())}),jsxRuntimeExports.jsxs("button",{onClick:()=>ts(as.id),className:"w-full text-left active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("span",{className:"text-xl font-bold text-text-primary",children:as.sceneNumber}),ds&&jsxRuntimeExports.jsx("span",{className:"text-green-500",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1",children:jsxRuntimeExports.jsx("span",{className:clsx("px-1.5 py-0.5 text-[9px] font-bold rounded",as.intExt==="INT"?"bg-slate-100 text-slate-600":"bg-stone-100 text-stone-600"),children:as.intExt})})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted line-clamp-2 mb-2.5 min-h-[2.5rem]",children:as.slugline.replace(/^(INT|EXT)\.\s*/,"").replace(/\s*-\s*(DAY|NIGHT|MORNING|EVENING|CONTINUOUS)$/i,"")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center -space-x-1 mb-2.5",children:[cs.slice(0,4).map(gs=>jsxRuntimeExports.jsx(CharacterAvatar,{character:gs,size:"xs"},gs.id)),cs.length>4&&jsxRuntimeExports.jsxs("span",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-[9px] font-bold text-text-muted",children:["+",cs.length-4]})]}),jsxRuntimeExports.jsx("div",{className:"h-1.5 bg-gray-100/80 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${us}%`,background:as.filmingStatus==="complete"?"linear-gradient(90deg, #10b981 0%, #059669 100%)":as.filmingStatus==="partial"?"linear-gradient(90deg, #d4a853 0%, #c9a962 100%)":as.filmingStatus==="not-filmed"?"linear-gradient(90deg, #f87171 0%, #ef4444 100%)":us===100?"linear-gradient(90deg, #10b981 0%, #059669 100%)":"linear-gradient(90deg, #c9a962 0%, #d4a853 100%)"}})}),jsxRuntimeExports.jsxs("span",{className:"text-[10px] text-text-light mt-1 block",children:[ls.captured,"/",ls.total," captured"]})]}),jsxRuntimeExports.jsx("div",{className:"mt-2 pt-2 border-t border-border/50",children:jsxRuntimeExports.jsx(FilmingStatusDropdown,{scene:as,onStatusChange:rs,onNotesModalOpen:os})})]})]},as.id)})})}function FilterDrawer({filters:es,characters:ts,locations:ss,looks:ns,onFiltersChange:rs,onClose:os,onClear:as}){const cs=ls=>{const us=es.characters.includes(ls)?es.characters.filter(ds=>ds!==ls):[...es.characters,ls];rs({...es,characters:us})};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:os,children:jsxRuntimeExports.jsxs("div",{className:"absolute right-0 top-0 bottom-0 w-80 max-w-full bg-card shadow-xl overflow-y-auto",onClick:ls=>ls.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:"sticky top-0 bg-card border-b border-border px-4 py-3 flex items-center justify-between",children:[jsxRuntimeExports.jsx("h2",{className:"text-base font-semibold text-text-primary",children:"Filters"}),jsxRuntimeExports.jsx("button",{onClick:os,className:"p-1 text-text-muted hover:text-text-primary",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-5",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-2",children:"FILMING STATUS"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>rs({...es,filmingStatus:"all"}),className:clsx("px-3 py-1.5 text-xs font-medium rounded-full transition-colors",es.filmingStatus==="all"?"bg-gold text-white":"bg-gray-100 text-text-muted"),children:"All"}),["complete","partial","not-filmed"].map(ls=>{const us=SCENE_FILMING_STATUS_CONFIG[ls];return jsxRuntimeExports.jsxs("button",{onClick:()=>rs({...es,filmingStatus:ls}),className:clsx("px-3 py-1.5 text-xs font-medium rounded-full transition-colors flex items-center gap-1.5",es.filmingStatus===ls?`${us.bgClass} ${us.textClass}`:"bg-gray-100 text-text-muted"),children:[jsxRuntimeExports.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:us.color}}),us.shortLabel]},ls)})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-2",children:"CONTINUITY STATUS"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:["all","complete","incomplete"].map(ls=>jsxRuntimeExports.jsx("button",{onClick:()=>rs({...es,completionStatus:ls}),className:clsx("px-3 py-1.5 text-xs font-medium rounded-full transition-colors",es.completionStatus===ls?"bg-gold text-white":"bg-gray-100 text-text-muted"),children:ls==="all"?"All":ls==="complete"?"Captured":"Not Captured"},ls))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-2",children:"CHARACTERS"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:ts.map(ls=>jsxRuntimeExports.jsxs("button",{onClick:()=>cs(ls.id),className:clsx("flex items-center gap-1.5 px-2.5 py-1.5 rounded-full text-xs font-medium transition-colors",es.characters.includes(ls.id)?"bg-gold text-white":"bg-gray-100 text-text-muted"),children:[jsxRuntimeExports.jsx(CharacterAvatar,{character:ls,size:"xs"}),ls.name.split(" ")[0]]},ls.id))})]}),ss.length>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-2",children:"LOCATION"}),jsxRuntimeExports.jsxs("select",{value:es.location||"",onChange:ls=>rs({...es,location:ls.target.value||null}),className:"w-full px-3 py-2 text-sm border border-border rounded-lg bg-card text-text-primary",children:[jsxRuntimeExports.jsx("option",{value:"",children:"All Locations"}),ss.map(ls=>jsxRuntimeExports.jsx("option",{value:ls,children:ls},ls))]})]}),ns.length>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-2",children:"LOOK"}),jsxRuntimeExports.jsxs("select",{value:es.lookId||"",onChange:ls=>rs({...es,lookId:ls.target.value||null}),className:"w-full px-3 py-2 text-sm border border-border rounded-lg bg-card text-text-primary",children:[jsxRuntimeExports.jsx("option",{value:"",children:"All Looks"}),ns.map(ls=>{const us=ts.find(ds=>ds.id===ls.characterId);return jsxRuntimeExports.jsxs("option",{value:ls.id,children:[us==null?void 0:us.name.split(" ")[0]," - ",ls.name]},ls.id)})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"sticky bottom-0 bg-card border-t border-border p-4 flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:as,className:"flex-1 py-2.5 rounded-button border border-border text-text-muted text-sm font-medium",children:"Clear All"}),jsxRuntimeExports.jsx("button",{onClick:os,className:"flex-1 py-2.5 rounded-button gold-gradient text-white text-sm font-medium",children:"Apply"})]})]})})}function EmptyState$2(){return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsx("div",{className:"h-14 px-4 flex items-center",children:jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Breakdown"})})})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx("svg",{className:"w-10 h-10 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0112 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125"})})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:"No Breakdown Data"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted text-center mb-6",children:"Sync from desktop or upload a script to generate scenes"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{className:"px-4 py-2.5 rounded-button border border-gold text-gold text-sm font-medium active:scale-95 transition-transform",children:"Sync Now"}),jsxRuntimeExports.jsx("button",{className:"px-4 py-2.5 rounded-button gold-gradient text-white text-sm font-medium active:scale-95 transition-transform",children:"Upload Script"})]})]})]})}function LookCard({look:es,character:ts,progress:ss}){const[ns,rs]=reactExports.useState(!1),{currentProject:os,sceneCaptures:as,setActiveTab:cs,setCurrentScene:ls}=useProjectStore(),us=ss.total>0?ss.captured/ss.total*100:0,ds=vs=>{if(!os)return"not-captured";const ws=os.scenes.find(bs=>bs.sceneNumber===vs);if(!ws)return"not-captured";const ys=`${ws.id}-${es.characterId}`,Rs=as[ys];return Rs&&(Rs.photos.front||Rs.additionalPhotos.length>0)?"captured":"not-captured"},xs=vs=>{if(!os)return;const ws=os.scenes.find(ys=>ys.sceneNumber===vs);ws&&(cs("breakdown"),ls(ws.id))},fs=()=>{const vs=[];if(es.makeup.foundation&&vs.push(`Foundation: ${es.makeup.foundation}${es.makeup.coverage?` (${es.makeup.coverage})`:""}`),(es.makeup.lipColour||es.makeup.lipLiner)&&vs.push(`Lips: ${[es.makeup.lipLiner,es.makeup.lipColour].filter(Boolean).join(" + ")}`),es.makeup.lidColour||es.makeup.liner||es.makeup.lashes){const ws=[es.makeup.lidColour,es.makeup.liner,es.makeup.lashes].filter(Boolean);ws.length>0&&vs.push(`Eyes: ${ws.join(", ")}`)}return vs},gs=()=>{const vs=[];es.hair.style&&vs.push(es.hair.style);const ws=[es.hair.parting,es.hair.piecesOut,es.hair.accessories].filter(Boolean);return ws.length>0&&vs.push(ws.join("  ")),vs},Es=fs(),js=gs(),ps=ss.captured===ss.total&&ss.total>0,hs=(()=>{if(!os)return null;for(let vs=es.scenes.length-1;vs>=0;vs--){const ws=es.scenes[vs],ys=os.scenes.find(Rs=>Rs.sceneNumber===ws);if(ys){const Rs=`${ys.id}-${es.characterId}`,bs=as[Rs];if(bs&&(bs.photos.front||bs.additionalPhotos.length>0))return{sceneNum:ws,capture:bs}}}return null})();return jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-card overflow-hidden shadow-card",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>rs(!ns),className:"w-full p-4 text-left",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-2 mb-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("h4",{className:"text-[15px] font-bold text-text-primary",children:es.name}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Scenes ",es.scenes.join(", "),"  ~",es.estimatedTime," min"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:`text-[11px] font-semibold ${ps?"text-success":"text-gold"}`,children:[ss.captured,"/",ss.total]}),jsxRuntimeExports.jsx("svg",{className:`w-[18px] h-[18px] text-text-light transition-transform duration-200 ${ns?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("polyline",{points:"6 9 12 15 18 9"})})]})]}),jsxRuntimeExports.jsx("div",{className:"mb-3",children:jsxRuntimeExports.jsx("div",{className:"h-[3px] bg-gray-100 rounded-sm overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:`h-full rounded-sm transition-all duration-300 ${ps?"bg-success":"gold-gradient"}`,style:{width:`${us}%`}})})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-[60px] h-[60px] rounded-lg bg-input-bg border border-border flex-shrink-0 overflow-hidden flex items-center justify-center",children:es.masterReference?jsxRuntimeExports.jsx("img",{src:es.masterReference.thumbnail||es.masterReference.uri,alt:"Master reference",className:"w-full h-full object-cover"}):jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),jsxRuntimeExports.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),jsxRuntimeExports.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),hs?jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-[9px] font-semibold tracking-wider uppercase text-text-light block mb-1.5",children:["Scene ",hs.sceneNum]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-4 gap-1",children:["front","left","right","back"].map(vs=>{const ws=hs.capture.photos[vs];return jsxRuntimeExports.jsx("div",{className:`aspect-[3/4] rounded ${ws?"bg-gray-200 border border-gold":"bg-input-bg border border-border"} flex items-center justify-center`,children:ws?jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})}):jsxRuntimeExports.jsx("svg",{className:"w-2.5 h-2.5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"})})},vs)})})]}):jsxRuntimeExports.jsx("div",{className:"flex-1 bg-input-bg rounded-lg p-3 text-center",children:jsxRuntimeExports.jsx("span",{className:"text-[11px] text-text-light",children:"No captures yet"})})]})]}),jsxRuntimeExports.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${ns?"max-h-[1000px] opacity-100":"max-h-0 opacity-0"}`,children:jsxRuntimeExports.jsxs("div",{className:"px-3 pb-3 space-y-3 border-t border-border/50 pt-3",children:[(Es.length>0||js.length>0)&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[jsxRuntimeExports.jsx("h5",{className:"text-[9px] font-bold tracking-wider uppercase text-text-light mb-1.5",children:"MAKEUP"}),Es.length>0?jsxRuntimeExports.jsx("div",{className:"space-y-0.5",children:Es.map((vs,ws)=>jsxRuntimeExports.jsx("p",{className:"text-[11px] text-text-secondary",children:vs},ws))}):jsxRuntimeExports.jsx("p",{className:"text-[11px] text-text-placeholder",children:"Not specified"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-lg p-2.5",children:[jsxRuntimeExports.jsx("h5",{className:"text-[9px] font-bold tracking-wider uppercase text-text-light mb-1.5",children:"HAIR"}),js.length>0?jsxRuntimeExports.jsx("div",{className:"space-y-0.5",children:js.map((vs,ws)=>jsxRuntimeExports.jsx("p",{className:"text-[11px] text-text-secondary",children:vs},ws))}):jsxRuntimeExports.jsx("p",{className:"text-[11px] text-text-placeholder",children:"Not specified"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"text-[9px] font-bold tracking-wider uppercase text-text-light mb-2",children:"SCENE CAPTURES"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 overflow-x-auto hide-scrollbar pb-1",children:es.scenes.map(vs=>{const ys=ds(vs)==="captured";return jsxRuntimeExports.jsxs("button",{onClick:Rs=>{Rs.stopPropagation(),xs(vs)},className:`flex-shrink-0 w-16 rounded-lg border overflow-hidden transition-colors ${ys?"border-gold bg-gold-100/30":"border-gray-200 bg-gray-50"}`,children:[jsxRuntimeExports.jsx("div",{className:"aspect-[3/4] flex items-center justify-center",children:ys?jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})}):jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),jsxRuntimeExports.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),jsxRuntimeExports.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),jsxRuntimeExports.jsxs("div",{className:`py-1.5 text-center text-[10px] font-semibold ${ys?"text-gold":"text-text-muted"}`,children:["Sc ",vs]})]},vs)})})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 pt-1",children:[jsxRuntimeExports.jsx("button",{onClick:vs=>{vs.stopPropagation();const ws=es.scenes.find(ys=>ds(ys)==="not-captured");xs(ws||es.scenes[0])},className:"flex-1 py-2.5 px-4 rounded-button gold-gradient text-white text-sm font-medium active:scale-95 transition-transform",children:"View Full Look"}),jsxRuntimeExports.jsx("button",{onClick:vs=>{vs.stopPropagation()},className:"flex-1 py-2.5 px-4 rounded-button border border-gold text-gold text-sm font-medium active:scale-95 transition-transform",children:"Edit Details"})]})]})})]})}function CharacterSection({character:es,looks:ts,capturedScenes:ss,totalScenes:ns,getCaptureProgress:rs,onAddLook:os}){const[as,cs]=reactExports.useState(!0);return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("button",{onClick:()=>cs(!as),className:"w-full py-3 flex items-center justify-between text-left",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white text-sm font-semibold flex-shrink-0",style:{background:`linear-gradient(135deg, ${es.avatarColour||"#C9A962"} 0%, ${adjustColor(es.avatarColour||"#C9A962",-20)} 100%)`},children:es.initials}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-[17px] font-bold text-gold",children:es.name}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted mt-0.5",children:[ts.length," look",ts.length!==1?"s":"","  ",ss,"/",ns," scenes"]})]})]}),jsxRuntimeExports.jsx("svg",{className:`w-5 h-5 text-text-light transition-transform duration-200 flex-shrink-0 ${as?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),jsxRuntimeExports.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${as?"max-h-[3000px] opacity-100":"max-h-0 opacity-0"}`,children:jsxRuntimeExports.jsx("div",{className:"pl-[52px] space-y-2.5",children:ts.length>0?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[ts.map(ls=>jsxRuntimeExports.jsx(LookCard,{look:ls,character:es,progress:rs(ls)},ls.id)),jsxRuntimeExports.jsxs("button",{onClick:os,className:"w-full py-3.5 flex items-center justify-center gap-1.5 text-[13px] font-medium text-text-muted bg-card border-2 border-dashed border-gray-200 rounded-card hover:border-gold-300 hover:text-gold transition-colors",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"Add New Look"]})]}):jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-card p-6 text-center",children:[jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-gray-300 mx-auto mb-2.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253",strokeLinecap:"round",strokeLinejoin:"round"})}),jsxRuntimeExports.jsx("p",{className:"text-[13px] text-text-muted mb-1",children:"No looks defined"}),jsxRuntimeExports.jsx("p",{className:"text-[11px] text-text-light mb-3",children:"Sync from desktop or create manually"}),jsxRuntimeExports.jsx("button",{onClick:os,className:"px-5 py-2.5 rounded-full bg-gold-100/50 text-gold text-xs font-semibold",children:"+ Add Look"})]})})})]})}function adjustColor(es,ts){const ss=parseInt(es.replace("#",""),16),ns=Math.max(0,Math.min(255,(ss>>16)+ts)),rs=Math.max(0,Math.min(255,(ss>>8&255)+ts)),os=Math.max(0,Math.min(255,(ss&255)+ts));return`#${((1<<24)+(ns<<16)+(rs<<8)+os).toString(16).slice(1)}`}function AddLookModal({isOpen:es,onClose:ts,preselectedCharacterId:ss}){const{currentProject:ns,setProject:rs}=useProjectStore(),[os,as]=reactExports.useState(""),[cs,ls]=reactExports.useState(""),[us,ds]=reactExports.useState(""),[xs,fs]=reactExports.useState(""),[gs,Es]=reactExports.useState("30");reactExports.useEffect(()=>{var ps;es&&(as(ss||((ps=ns==null?void 0:ns.characters[0])==null?void 0:ps.id)||""),ls(""),ds(""),fs(""),Es("30"))},[es,ss,ns]),reactExports.useEffect(()=>{if(os&&ns){const ms=ns.looks.filter(hs=>hs.characterId===os).length+1;ls(`Day ${ms}`)}},[os,ns]);const js=()=>{if(!ns||!os||!cs.trim())return;const ps=parseInt(us,10)||1,ms=parseInt(xs,10)||ps,hs=[];for(let ws=Math.min(ps,ms);ws<=Math.max(ps,ms);ws++)hs.push(String(ws));const vs={id:v4(),characterId:os,name:cs.trim(),scenes:hs,estimatedTime:parseInt(gs,10)||30,makeup:createEmptyMakeupDetails(),hair:createEmptyHairDetails()};rs({...ns,looks:[...ns.looks,vs],updatedAt:new Date}),ts()};return reactExports.useEffect(()=>(es?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[es]),es?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/50 backdrop-blur-sm animate-fadeIn",children:jsxRuntimeExports.jsxs("div",{className:"w-full max-w-[430px] bg-card rounded-t-2xl shadow-xl animate-slideUp max-h-[85vh] overflow-hidden flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Add New Look"}),jsxRuntimeExports.jsx("button",{onClick:ts,className:"p-2 -m-2 text-text-muted hover:text-text-primary transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"CHARACTER"}),jsxRuntimeExports.jsx("select",{value:os,onChange:ps=>as(ps.target.value),className:"input-field w-full",children:ns==null?void 0:ns.characters.map(ps=>jsxRuntimeExports.jsx("option",{value:ps.id,children:ps.name},ps.id))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"LOOK NAME"}),jsxRuntimeExports.jsx("input",{type:"text",value:cs,onChange:ps=>ls(ps.target.value),placeholder:"e.g., Day 1 - Professional",className:"input-field w-full"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:'Suggest descriptive names like "Day 1 - Office", "Post-Fight", etc.'})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"SCENE RANGE"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("input",{type:"number",value:us,onChange:ps=>ds(ps.target.value),placeholder:"Start",min:"1",className:"input-field w-24 text-center"}),jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:"to"}),jsxRuntimeExports.jsx("input",{type:"number",value:xs,onChange:ps=>fs(ps.target.value),placeholder:"End",min:"1",className:"input-field w-24 text-center"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Which scenes use this look? You can adjust later."})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"ESTIMATED APPLICATION TIME"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"number",value:gs,onChange:ps=>Es(ps.target.value),min:"5",step:"5",className:"input-field w-24 text-center"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"minutes"})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-gold-50 rounded-lg p-3",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gold-dark font-medium",children:"Standalone Mode"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:"You can add makeup and hair details after creating the look, or sync from desktop for full specifications."})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 border-t border-border flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:ts,className:"flex-1 py-3 px-4 rounded-button bg-gray-100 text-text-primary font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:js,disabled:!os||!cs.trim(),className:"flex-1 py-3 px-4 rounded-button gold-gradient text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Look"})]})]})}):null}function Lookbooks(){const{currentProject:es,sceneCaptures:ts}=useProjectStore(),[ss,ns]=reactExports.useState(!1),[rs,os]=reactExports.useState(null),as="offline",cs=reactExports.useCallback(()=>{if(!es)return new Map;const Es=new Map;return es.characters.forEach(js=>{Es.set(js.id,[])}),es.looks.forEach(js=>{const ps=Es.get(js.characterId)||[];Es.set(js.characterId,[...ps,js])}),Es},[es]),ls=reactExports.useCallback(Es=>{if(!es)return{captured:0,total:0};const js=Es.scenes.length;let ps=0;return Es.scenes.forEach(ms=>{const hs=es.scenes.find(vs=>vs.sceneNumber===ms);if(hs){const vs=`${hs.id}-${Es.characterId}`,ws=ts[vs];ws&&(ws.photos.front||ws.additionalPhotos.length>0)&&ps++}}),{captured:ps,total:js}},[es,ts]),us=Es=>es==null?void 0:es.characters.find(js=>js.id===Es),ds=Es=>{os(Es||null),ns(!0)};if(!es)return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx(LookbooksHeader,{}),jsxRuntimeExports.jsx(EmptyState$1,{onAddLook:()=>ds()})]});const xs=cs(),fs=es.looks.length>0,gs=es.characters.length;return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx(LookbooksHeader,{}),jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"px-4 pt-4 pb-24",children:[jsxRuntimeExports.jsx(SyncBanner,{status:as}),fs?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"section-header mb-3",children:["CHARACTERS (",gs,")"]}),jsxRuntimeExports.jsx("div",{className:"space-y-5",children:Array.from(xs.entries()).map(([Es,js])=>{const ps=us(Es);if(!ps)return null;let ms=0,hs=0;return js.forEach(vs=>{const ws=ls(vs);ms+=ws.captured,hs+=ws.total}),jsxRuntimeExports.jsx(CharacterSection,{character:ps,looks:js,capturedScenes:ms,totalScenes:hs,getCaptureProgress:ls,onAddLook:()=>ds(Es)},Es)})})]}):jsxRuntimeExports.jsx(EmptyState$1,{onAddLook:()=>ds()})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>ds(),className:"fixed bottom-24 right-4 w-14 h-14 rounded-full gold-gradient shadow-lg flex items-center justify-center text-white z-40 active:scale-95 transition-transform","aria-label":"Add Look",children:jsxRuntimeExports.jsx("svg",{className:"w-7 h-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),jsxRuntimeExports.jsx(AddLookModal,{isOpen:ss,onClose:()=>ns(!1),preselectedCharacterId:rs})]})}function LookbooksHeader(){return jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsx("button",{className:"p-2 -ml-2 text-text-primary",children:jsxRuntimeExports.jsx("svg",{className:"w-[22px] h-[22px]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12",strokeLinecap:"round",strokeLinejoin:"round"})})}),jsxRuntimeExports.jsx("h1",{className:"text-[17px] font-bold text-text-primary",children:"Lookbook"}),jsxRuntimeExports.jsx("button",{className:"p-2 -mr-2 text-text-primary",children:jsxRuntimeExports.jsxs("svg",{className:"w-[22px] h-[22px]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[jsxRuntimeExports.jsx("circle",{cx:"11",cy:"11",r:"8"}),jsxRuntimeExports.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})})]})})})}function SyncBanner({status:es}){const ts={synced:"bg-success",pending:"bg-warning",offline:"bg-gray-400"},ss={synced:"Synced with desktop",pending:"Pending sync...",offline:"Working offline"};return jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-[10px] px-4 py-3 mb-4 flex items-center justify-between shadow-card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2.5",children:[jsxRuntimeExports.jsx("div",{className:`w-2 h-2 rounded-full ${ts[es]}`}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-secondary",children:ss[es]})]}),jsxRuntimeExports.jsx("span",{className:"text-[11px] text-text-light",children:"2 min ago"})]})}function EmptyState$1({onAddLook:es}){return jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center min-h-[60vh] px-8",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-full bg-gold-100 flex items-center justify-center mx-auto mb-4",children:jsxRuntimeExports.jsx("svg",{className:"w-10 h-10 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"No looks defined"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-6",children:"Sync from desktop or create looks manually"}),jsxRuntimeExports.jsxs("button",{onClick:es,className:"inline-flex items-center gap-2 px-6 py-3 rounded-button gold-gradient text-white font-medium shadow-sm active:scale-95 transition-transform",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Look"]})]})})}function timeToMinutes(es){if(!es)return 0;const[ts,ss]=es.split(":").map(Number);return isNaN(ts)||isNaN(ss)?0:ts*60+ss}function minutesToTime(es){const ts=(es%1440+1440)%1440,ss=Math.floor(ts/60),ns=ts%60;return`${ss.toString().padStart(2,"0")}:${ns.toString().padStart(2,"0")}`}function timeDiffHours(es,ts){if(!es||!ts)return 0;let ss=timeToMinutes(es),ns=timeToMinutes(ts);return ns<ss&&(ns+=24*60),(ns-ss)/60}function addHoursToTime(es,ts){const ss=timeToMinutes(es)+ts*60;return minutesToTime(ss)}const BASE_CONTRACTS={"10+1":{baseWorkHours:10,label:"10+1 (10 hours + 1hr lunch)"},"11+1":{baseWorkHours:11,label:"11+1 (11 hours + 1hr lunch)"}},DAY_TYPES$1={SWD:{name:"Standard Working Day",lunchMins:60,hourReduction:0},SCWD:{name:"Semi-Continuous Working Day",lunchMins:30,hourReduction:.5},CWD:{name:"Continuous Working Day",lunchMins:0,hourReduction:1}};function getContractedWorkHours(es,ts){const ss=BASE_CONTRACTS[es].baseWorkHours,ns=DAY_TYPES$1[ts].hourReduction;return ss-ns}function getLunchDuration(es){return DAY_TYPES$1[es].lunchMins}function getHourlyRate(es,ts,ss){const ns=getContractedWorkHours(ts,ss);return ns<=0?0:es/ns}function calculatePreCall(es,ts,ss,ns=1.5){if(!es||!ts)return{hours:0,pay:0};const rs=timeDiffHours(es,ts);return rs<=0?{hours:0,pay:0}:{hours:rs,pay:rs*(ss*ns)}}function calculateOvertime(es,ts,ss,ns=1.5){const rs=Math.max(0,es-ts),os=ss*ns;return{hours:rs,pay:rs*os}}function calculateBrokenLunch(es,ts,ss,ns,rs=1.5){if(ss==="CWD"||!ts||!es)return{hours:0,pay:0};const os=addHoursToTime(es,6),as=timeToMinutes(ts),cs=timeToMinutes(os);if(as<=cs)return{hours:0,pay:0};const ls=timeDiffHours(os,ts),us=ns*rs;return{hours:ls,pay:ls*us}}function calculateBrokenTurnaround(es,ts,ss,ns,rs=1.5,os=11){if(!es||!ss)return{hours:0,pay:0};let cs=timeDiffHours(es,ts||ss);if(cs<0&&(cs+=24),cs>=os)return{hours:0,pay:0};const ls=os-cs,us=ns*rs;return{hours:ls,pay:ls*us}}function calculateLateNight(es,ts,ss,ns,rs,os=2,as="23:00"){if(!ts||!es)return{hours:0,pay:0};const cs=timeToMinutes(ts),ls=timeToMinutes(as);let us=cs;if(cs<timeToMinutes(es)&&(us=cs+24*60),us<=ls&&cs>=timeToMinutes(es))return{hours:0,pay:0};let ds;us>ls,ds=us-ls;let xs=ds/60;if(ss){const gs=timeToMinutes(ss);(gs>ls||gs<timeToMinutes(es))&&(xs-=ns/60)}xs=Math.max(0,xs);const fs=rs*(os-1);return{hours:xs,pay:xs*fs}}function applyDayMultiplier(es,ts,ss,ns=1.5,rs=2){return ss?{multiplier:rs,total:es*rs}:ts?{multiplier:ns,total:es*ns}:{multiplier:1,total:es}}function calculateBECTUTimesheet(es){if(!es.unitCallTime||!es.wrapOutTime)return createEmptyCalculation$1();const ts=getContractedWorkHours(es.baseContract,es.dayType),ss=getHourlyRate(es.dayRate,es.baseContract,es.dayType),ns=ss*es.otMultiplier,rs=es.preCallTime||es.unitCallTime,os=timeDiffHours(rs,es.wrapOutTime),as=es.lunchDuration/60,cs=Math.max(0,os-as),ls=calculatePreCall(es.preCallTime,es.unitCallTime,ss,es.preCallMultiplier),us=timeDiffHours(es.unitCallTime,es.wrapOutTime)-as,ds=calculateOvertime(Math.max(0,us),ts,ss,es.otMultiplier),xs=calculateBrokenLunch(es.unitCallTime,es.lunchTime,es.dayType,ss,es.otMultiplier),fs=calculateBrokenTurnaround(es.previousWrapOut,es.preCallTime,es.unitCallTime,ss,es.otMultiplier),gs=calculateLateNight(es.unitCallTime,es.wrapOutTime,es.lunchTime,es.lunchDuration,ss,es.lateNightMultiplier),Es=es.dayRate,js=Es+ls.pay+ds.pay+xs.pay+fs.pay+gs.pay,ps=applyDayMultiplier(js,es.is6thDay,es.is7thDay,es.sixthDayMultiplier,es.seventhDayMultiplier);return{contractedHours:round2(ts),hourlyRate:round2(ss),otRate:round2(ns),actualWorkHours:round2(cs),preCallHours:round2(ls.hours),overtimeHours:round2(ds.hours),brokenLunchHours:round2(xs.hours),brokenTurnaroundHours:round2(fs.hours),lateNightHours:round2(gs.hours),basePay:round2(Es),preCallPay:round2(ls.pay),overtimePay:round2(ds.pay),brokenLunchPay:round2(xs.pay),brokenTurnaroundPay:round2(fs.pay),lateNightPay:round2(gs.pay),subtotal:round2(js),dayMultiplier:ps.multiplier,totalPay:round2(ps.total),hasBrokenLunch:xs.hours>0,hasBrokenTurnaround:fs.hours>0,hasLateNight:gs.hours>0,hasOvertime:ds.hours>0}}function createEmptyCalculation$1(){return{contractedHours:0,hourlyRate:0,otRate:0,actualWorkHours:0,preCallHours:0,overtimeHours:0,brokenLunchHours:0,brokenTurnaroundHours:0,lateNightHours:0,basePay:0,preCallPay:0,overtimePay:0,brokenLunchPay:0,brokenTurnaroundPay:0,lateNightPay:0,subtotal:0,dayMultiplier:1,totalPay:0,hasBrokenLunch:!1,hasBrokenTurnaround:!1,hasLateNight:!1,hasOvertime:!1}}function round2(es){return Math.round(es*100)/100}function baseDayHoursToContract(es){return es===10?"10+1":"11+1"}function parseDayTypeFromCallSheet(es){if(!es)return"SWD";const ts=es.toUpperCase();return ts.includes("SCWD")||ts.includes("SHORT CONTINUOUS")?"SCWD":ts.includes("CWD")||ts.includes("CONTINUOUS")?"CWD":"SWD"}function createEmptyCalculation(){return{contractedHours:0,hourlyRate:0,otRate:0,preCallHours:0,preCallEarnings:0,workingHours:0,actualWorkHours:0,baseHours:0,otHours:0,brokenLunchHours:0,brokenTurnaroundHours:0,lateNightHours:0,totalHours:0,dailyEarnings:0,basePay:0,otEarnings:0,overtimePay:0,brokenLunchPay:0,brokenTurnaroundPay:0,lateNightEarnings:0,lateNightPay:0,sixthDayBonus:0,seventhDayBonus:0,dayMultiplier:1,subtotal:0,kitRental:0,totalEarnings:0,totalPay:0,brokenLunch:!1,hasBrokenLunch:!1,brokenTurnaround:!1,hasBrokenTurnaround:!1,hasLateNight:!1,hasOvertime:!1}}function toBECTUEntry(es,ts,ss){const ns=ts.baseContract||baseDayHoursToContract(ts.baseDayHours);return{date:es.date,dayRate:ts.dailyRate,baseContract:ns,dayType:es.dayType,preCallTime:es.preCall||null,unitCallTime:es.unitCall,lunchTime:es.lunchStart||es.callSheetLunch||null,lunchDuration:es.lunchTaken||getLunchDuration(es.dayType),wrapOutTime:es.wrapOut,is6thDay:es.isSixthDay,is7thDay:es.isSeventhDay,previousWrapOut:es.previousWrapOut||ss||null,preCallMultiplier:ts.preCallMultiplier,otMultiplier:ts.otMultiplier,lateNightMultiplier:ts.lateNightMultiplier,sixthDayMultiplier:ts.sixthDayMultiplier,seventhDayMultiplier:ts.seventhDayMultiplier}}function formatDateString(es){return es.toISOString().split("T")[0]}function addDays(es,ts){const ss=new Date(es);return ss.setDate(ss.getDate()+ts),formatDateString(ss)}function getWeekStart(es){const ts=new Date(es),ss=ts.getDay(),ns=ts.getDate()-ss+(ss===0?-6:1);return ts.setDate(ns),formatDateString(ts)}const useTimesheetStore=create()(persist((es,ts)=>({rateCard:createDefaultRateCard(),entries:{},selectedDate:formatDateString(new Date),viewMode:"week",editingEntry:!1,updateRateCard:ss=>{es(ns=>({rateCard:{...ns.rateCard,...ss}}))},getEntry:ss=>ts().entries[ss]||createEmptyTimesheetEntry(ss),saveEntry:ss=>{es(ns=>({entries:{...ns.entries,[ss.date]:ss}}))},deleteEntry:ss=>{es(ns=>{const rs={...ns.entries};return delete rs[ss],{entries:rs}})},clearAll:()=>{es({rateCard:createDefaultRateCard(),entries:{},selectedDate:formatDateString(new Date),viewMode:"week",editingEntry:!1})},setSelectedDate:ss=>es({selectedDate:ss}),setViewMode:ss=>es({viewMode:ss}),setEditingEntry:ss=>es({editingEntry:ss}),navigateDay:ss=>{const ns=ts(),rs=addDays(ns.selectedDate,ss==="next"?1:-1);es({selectedDate:rs})},autoFillFromCallSheet:(ss,ns)=>{var us;const rs=ts().entries[ss]||createEmptyTimesheetEntry(ss),os=parseDayTypeFromCallSheet(ns.dayType),as=getLunchDurationForDayType(os),cs=((us=ns.preCalls)==null?void 0:us.hmu)||"";return{...rs,preCall:cs||rs.preCall,unitCall:ns.unitCallTime||rs.unitCall,dayType:os,wrapOut:rs.wrapOut||"",outOfChair:rs.outOfChair||"",lunchTaken:as,productionDay:ns.productionDay,autoFilledFrom:ns.id,callSheetUnitCall:ns.unitCallTime,callSheetLunch:ns.lunchTime,callSheetWrap:ns.wrapEstimate}},calculateEntry:(ss,ns)=>{const{rateCard:rs}=ts();if(!ss.unitCall||!ss.wrapOut)return createEmptyCalculation();const os=toBECTUEntry(ss,rs,ns),as=calculateBECTUTimesheet(os);let cs=0,ls=0;ss.isSeventhDay?ls=as.subtotal*(rs.seventhDayMultiplier-1):ss.isSixthDay&&(cs=as.subtotal*(rs.sixthDayMultiplier-1));const us=rs.kitRental,ds=as.totalPay+us;return{contractedHours:as.contractedHours,hourlyRate:as.hourlyRate,otRate:as.otRate,preCallHours:as.preCallHours,workingHours:as.actualWorkHours,actualWorkHours:as.actualWorkHours,baseHours:as.contractedHours,otHours:as.overtimeHours,brokenLunchHours:as.brokenLunchHours,brokenTurnaroundHours:as.brokenTurnaroundHours,lateNightHours:as.lateNightHours,totalHours:as.actualWorkHours+as.preCallHours,preCallEarnings:as.preCallPay,dailyEarnings:as.basePay,basePay:as.basePay,otEarnings:as.overtimePay,overtimePay:as.overtimePay,brokenLunchPay:as.brokenLunchPay,brokenTurnaroundPay:as.brokenTurnaroundPay,lateNightEarnings:as.lateNightPay,lateNightPay:as.lateNightPay,sixthDayBonus:Math.round(cs*100)/100,seventhDayBonus:Math.round(ls*100)/100,dayMultiplier:as.dayMultiplier,subtotal:as.subtotal,kitRental:us,totalEarnings:Math.round(ds*100)/100,totalPay:Math.round(ds*100)/100,brokenLunch:as.hasBrokenLunch,hasBrokenLunch:as.hasBrokenLunch,brokenTurnaround:as.hasBrokenTurnaround,hasBrokenTurnaround:as.hasBrokenTurnaround,hasLateNight:as.hasLateNight,hasOvertime:as.hasOvertime}},getPreviousWrapOut:ss=>{const ns=addDays(ss,-1),rs=ts().entries[ns];return(rs==null?void 0:rs.wrapOut)||void 0},getWeekSummary:ss=>{const ns=ts(),rs=[];for(let bs=0;bs<7;bs++){const Ns=addDays(ss,bs);ns.entries[Ns]&&rs.push(ns.entries[Ns])}let os=0,as=0,cs=0,ls=0,us=0,ds=0,xs=0,fs=0,gs=0,Es=0,js=0,ps=0,ms=0,hs=0,vs=0,ws=0,ys=0;const Rs=[...rs].sort((bs,Ns)=>bs.date.localeCompare(Ns.date));return Rs.forEach((bs,Ns)=>{const Ss=Ns>0?Rs[Ns-1].wrapOut:ns.getPreviousWrapOut(bs.date),Ts=ns.calculateEntry(bs,Ss);os+=Ts.totalHours,as+=Ts.preCallHours,cs+=Ts.baseHours,ls+=Ts.otHours,us+=Ts.lateNightHours,ds+=Ts.brokenLunchHours,xs+=Ts.brokenTurnaroundHours,bs.isSixthDay&&!bs.isSeventhDay&&(fs+=Ts.totalHours),bs.isSeventhDay&&(gs+=Ts.totalHours),Es+=Ts.totalEarnings,ps+=Ts.basePay,ms+=Ts.overtimePay,hs+=Ts.preCallEarnings,vs+=Ts.brokenLunchPay,ws+=Ts.brokenTurnaroundPay,ys+=Ts.lateNightPay,bs.unitCall&&bs.wrapOut&&(js+=ns.rateCard.kitRental)}),{startDate:ss,endDate:addDays(ss,6),totalHours:Math.round(os*10)/10,preCallHours:Math.round(as*10)/10,baseHours:Math.round(cs*10)/10,otHours:Math.round(ls*10)/10,sixthDayHours:Math.round(fs*10)/10,seventhDayHours:Math.round(gs*10)/10,lateNightHours:Math.round(us*10)/10,brokenLunchHours:Math.round(ds*10)/10,brokenTurnaroundHours:Math.round(xs*10)/10,kitRentalTotal:js,totalEarnings:Math.round(Es*100)/100,entries:rs,basePay:Math.round(ps*100)/100,overtimePay:Math.round(ms*100)/100,preCallPay:Math.round(hs*100)/100,brokenLunchPay:Math.round(vs*100)/100,brokenTurnaroundPay:Math.round(ws*100)/100,lateNightPay:Math.round(ys*100)/100}},getMonthEntries:(ss,ns)=>{const rs=ts(),os=[],as=new Date(ss,ns,1),cs=new Date(ss,ns+1,0),ls=new Date(as);for(;ls<=cs;){const us=formatDateString(ls);rs.entries[us]&&os.push(rs.entries[us]),ls.setDate(ls.getDate()+1)}return os}}),{name:"hair-makeup-timesheet-storage",storage:createHybridStorage("hair-makeup-timesheet-storage")})),DAY_LABELS=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],DAY_TYPES=["SWD","CWD","SCWD"];function WeekView({weekStartDate:es,onNavigate:ts}){const{entries:ss,calculateEntry:ns,saveEntry:rs,getEntry:os}=useTimesheetStore(),[as,cs]=reactExports.useState(null),[ls,us]=reactExports.useState(null),ds=()=>{const js=new Date(es),ps=new Date(addDays(es,6)),ms=js.getDate(),hs=ps.getDate(),vs=js.toLocaleDateString("en-GB",{month:"short"}),ws=ps.toLocaleDateString("en-GB",{month:"short"}),ys=DAY_LABELS[0][0],Rs=DAY_LABELS[6][0];return vs===ws?`${ys} ${ms} - ${Rs} ${hs} ${vs}`:`${ys} ${ms} ${vs} - ${Rs} ${hs} ${ws}`},xs=Array.from({length:7},(js,ps)=>{const ms=addDays(es,ps),hs=ss[ms],vs=hs?ns(hs):null,ws=new Date().toISOString().split("T")[0];return{date:ms,dayLabel:DAY_LABELS[ps],dayNumber:new Date(ms).getDate(),entry:hs,calc:vs,isToday:ms===ws,isWeekend:ps>=5}}),fs=js=>{as===js?(ls&&ls.date===js&&rs(ls),cs(null),us(null)):(ls&&rs(ls),cs(js),us(os(js)||createEmptyTimesheetEntry(js)))},gs=(js,ps)=>{if(!ls)return;const ms={...ls,[js]:ps};us(ms),rs(ms)},Es=js=>!(js!=null&&js.unitCall)||!(js!=null&&js.wrapOut)?null:`${js.preCall||js.unitCall}  ${js.wrapOut}`;return jsxRuntimeExports.jsxs("div",{className:"px-4 py-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ts("prev"),className:"w-9 h-9 rounded-full flex items-center justify-center transition-colors",style:{backgroundColor:"var(--color-card)",color:"var(--color-text-muted)"},children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--color-text-primary)"},children:ds()}),jsxRuntimeExports.jsx("button",{onClick:()=>ts("next"),className:"w-9 h-9 rounded-full flex items-center justify-center transition-colors",style:{backgroundColor:"var(--color-card)",color:"var(--color-text-muted)"},children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:xs.map(({date:js,dayLabel:ps,dayNumber:ms,entry:hs,calc:vs,isToday:ws,isWeekend:ys})=>{const Rs=hs&&hs.unitCall&&hs.wrapOut,bs=as===js,Ns=vs&&vs.otHours>0,Ss=vs&&vs.preCallHours>0,Ts=hs==null?void 0:hs.isSixthDay,Cs=hs==null?void 0:hs.isSeventhDay,Ms=Es(hs);return jsxRuntimeExports.jsxs("div",{className:`rounded-xl overflow-hidden border transition-all ${ws?"border-2 border-gold":"border-border"}`,style:{backgroundColor:"var(--color-card)"},children:[jsxRuntimeExports.jsxs("div",{onClick:()=>fs(js),className:"p-3.5 flex items-center cursor-pointer",children:[jsxRuntimeExports.jsxs("div",{className:"flex-shrink-0 w-11 text-center mr-3",children:[jsxRuntimeExports.jsx("div",{className:`text-[10px] font-medium uppercase ${ws||ys?"text-gold":""}`,style:{color:ws||ys?void 0:"var(--color-text-muted)"},children:ps}),jsxRuntimeExports.jsx("div",{className:`text-xl font-bold ${ws?"text-gold":""}`,style:{color:ws?void 0:"var(--color-text-primary)"},children:ms})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 min-w-0",children:Rs?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"text-[15px] font-medium",style:{color:"var(--color-text-primary)"},children:Ms}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-1",children:[jsxRuntimeExports.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-medium ${hs.dayType==="CWD"?"bg-blue-100 text-blue-600":hs.dayType==="SCWD"?"bg-pink-100 text-pink-600":""}`,style:hs.dayType==="SWD"?{backgroundColor:"var(--color-input-bg)",color:"var(--color-text-muted)"}:void 0,children:hs.dayType}),Ss&&jsxRuntimeExports.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full font-medium bg-emerald-100 text-emerald-600",children:["+",vs.preCallHours.toFixed(1)," Pre"]}),Ns&&jsxRuntimeExports.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full font-medium bg-gold text-white",children:["+",vs.otHours.toFixed(1)," OT"]}),Ts&&!Cs&&jsxRuntimeExports.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full font-medium bg-orange-100 text-orange-600",children:"6th Day"}),Cs&&jsxRuntimeExports.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full font-medium bg-red-100 text-red-600",children:"7th Day"})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:`text-[15px] font-medium ${ws?"text-gold":""}`,style:{color:ws?void 0:"var(--color-text-muted)"},children:ws?"Today":""}),jsxRuntimeExports.jsx("div",{className:"text-[13px] text-gold font-medium",children:"+ Add hours"})]})}),Rs&&jsxRuntimeExports.jsxs("div",{className:"text-right ml-3",children:[jsxRuntimeExports.jsx("div",{className:"text-xl font-bold",style:{color:"var(--color-text-primary)"},children:vs==null?void 0:vs.totalHours.toFixed(vs.totalHours%1===0?0:1)}),jsxRuntimeExports.jsx("div",{className:"text-[11px]",style:{color:"var(--color-text-muted)"},children:"hours"})]}),jsxRuntimeExports.jsx(StatusIndicator,{status:(hs==null?void 0:hs.status)||"draft",hasEntry:!!Rs}),jsxRuntimeExports.jsx("svg",{className:`w-2.5 h-2.5 ml-2 transition-transform ${bs?"rotate-180":""}`,style:{color:"var(--color-text-muted)"},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),bs&&ls&&jsxRuntimeExports.jsx(ExpandedDayContent,{entry:ls,updateField:gs,calculation:ns(ls)})]},js)})})]})}function StatusIndicator({status:es,hasEntry:ts}){if(!ts)return jsxRuntimeExports.jsx("div",{className:"w-2 h-2 rounded-full ml-2",style:{backgroundColor:"#e0e0e0"}});const ss={draft:"bg-warning",pending:"bg-gold",approved:"bg-success"};return jsxRuntimeExports.jsx("div",{className:`w-2 h-2 rounded-full ml-2 ${ss[es]}`})}function ExpandedDayContent({entry:es,updateField:ts,calculation:ss}){const ns=!!es.autoFilledFrom;return jsxRuntimeExports.jsxs("div",{className:"px-4 pb-4 pt-3 space-y-3",style:{borderTop:"1px solid var(--color-border)"},onClick:rs=>rs.stopPropagation(),children:[ns&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-emerald-600 bg-emerald-50 px-3 py-2 rounded-lg",children:[jsxRuntimeExports.jsx("span",{children:""}),jsxRuntimeExports.jsxs("span",{children:["Times auto-filled from Day ",es.productionDay," call sheet"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-[11px] uppercase tracking-wide font-medium min-w-[70px]",style:{color:"var(--color-text-muted)"},children:"Day Type"}),jsxRuntimeExports.jsx("select",{value:es.dayType,onChange:rs=>ts("dayType",rs.target.value),className:"flex-1 py-2.5 px-3 rounded-lg text-sm font-medium appearance-none bg-no-repeat",style:{backgroundColor:"var(--color-input-bg)",border:"1px solid var(--color-border)",color:"var(--color-text-primary)",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23999' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E")`,backgroundPosition:"right 12px center"},children:DAY_TYPES.map(rs=>jsxRuntimeExports.jsxs("option",{value:rs,children:[rs," - ",DAY_TYPE_LABELS[rs]]},rs))})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsxs("label",{className:`flex items-center gap-2 px-3.5 py-2.5 rounded-lg cursor-pointer border ${es.isSixthDay?"bg-orange-50 border-orange-400":""}`,style:es.isSixthDay?void 0:{backgroundColor:"var(--color-input-bg)",borderColor:"var(--color-border)"},children:[jsxRuntimeExports.jsx("div",{className:`w-[18px] h-[18px] rounded flex items-center justify-center text-xs ${es.isSixthDay?"bg-orange-500 border-orange-500 text-white":"border-2"}`,style:es.isSixthDay?void 0:{borderColor:"#ccc"},children:es.isSixthDay&&""}),jsxRuntimeExports.jsx("span",{className:"text-[13px] font-medium",style:{color:"var(--color-text-primary)"},children:"6th Day"}),jsxRuntimeExports.jsx("span",{className:"text-[11px] text-orange-500",children:"(1.5x)"}),jsxRuntimeExports.jsx("input",{type:"checkbox",checked:es.isSixthDay,onChange:rs=>{ts("isSixthDay",rs.target.checked),rs.target.checked&&ts("isSeventhDay",!1)},className:"sr-only"})]}),jsxRuntimeExports.jsxs("label",{className:`flex items-center gap-2 px-3.5 py-2.5 rounded-lg cursor-pointer border ${es.isSeventhDay?"bg-red-50 border-red-400":""}`,style:es.isSeventhDay?void 0:{backgroundColor:"var(--color-input-bg)",borderColor:"var(--color-border)"},children:[jsxRuntimeExports.jsx("div",{className:`w-[18px] h-[18px] rounded flex items-center justify-center text-xs ${es.isSeventhDay?"bg-red-600 border-red-600 text-white":"border-2"}`,style:es.isSeventhDay?void 0:{borderColor:"#ccc"},children:es.isSeventhDay&&""}),jsxRuntimeExports.jsx("span",{className:"text-[13px] font-medium",style:{color:"var(--color-text-primary)"},children:"7th Day"}),jsxRuntimeExports.jsx("span",{className:"text-[11px] text-red-600",children:"(2x)"}),jsxRuntimeExports.jsx("input",{type:"checkbox",checked:es.isSeventhDay,onChange:rs=>{ts("isSeventhDay",rs.target.checked),rs.target.checked&&ts("isSixthDay",!1)},className:"sr-only"})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2.5",children:[jsxRuntimeExports.jsx(TimeInputCell,{label:"Pre-Call",value:es.preCall,onChange:rs=>ts("preCall",rs),highlight:"gold",hint:"@ 1.5x"}),jsxRuntimeExports.jsx(TimeInputCell,{label:"Unit Call",value:es.unitCall,onChange:rs=>ts("unitCall",rs)}),jsxRuntimeExports.jsx(TimeInputCell,{label:"Lunch",value:es.lunchStart||"",onChange:rs=>ts("lunchStart",rs)}),jsxRuntimeExports.jsxs("div",{className:"p-2.5 rounded-lg",style:{backgroundColor:"var(--color-input-bg)",border:"1px solid var(--color-border)"},children:[jsxRuntimeExports.jsx("div",{className:"text-[10px] uppercase tracking-wide mb-0.5",style:{color:"var(--color-text-muted)"},children:"Lunch Duration"}),jsxRuntimeExports.jsxs("select",{value:es.lunchTaken,onChange:rs=>ts("lunchTaken",parseInt(rs.target.value)),className:"text-[15px] font-semibold bg-transparent w-full appearance-none",style:{color:"var(--color-text-primary)"},children:[jsxRuntimeExports.jsx("option",{value:30,children:"30 min"}),jsxRuntimeExports.jsx("option",{value:45,children:"45 min"}),jsxRuntimeExports.jsx("option",{value:60,children:"1 hr"}),jsxRuntimeExports.jsx("option",{value:0,children:"None"})]})]}),jsxRuntimeExports.jsx(TimeInputCell,{label:"Unit Wrap",value:es.outOfChair,onChange:rs=>ts("outOfChair",rs)}),jsxRuntimeExports.jsx(TimeInputCell,{label:"Wrap Out",value:es.wrapOut,onChange:rs=>ts("wrapOut",rs),highlight:ss.otHours>0?"orange":void 0,hint:ss.otHours>0?"OT":void 0})]}),ss.totalHours>0&&jsxRuntimeExports.jsxs("div",{className:"rounded-lg p-3.5",style:{backgroundColor:"var(--color-input-bg)"},children:[jsxRuntimeExports.jsx("div",{className:"text-[10px] uppercase tracking-wide font-medium mb-2.5",style:{color:"var(--color-text-muted)"},children:"Hours Breakdown"}),jsxRuntimeExports.jsxs("div",{className:"space-y-1.5",children:[ss.preCallHours>0&&jsxRuntimeExports.jsx(BreakdownRow,{label:"Pre-Call",hours:ss.preCallHours,rate:"@ 1.5x"}),jsxRuntimeExports.jsx(BreakdownRow,{label:"Base Hours",hours:ss.baseHours,rate:"@ 1x"}),ss.otHours>0&&jsxRuntimeExports.jsx(BreakdownRow,{label:"Overtime",hours:ss.otHours,rate:"@ 1.5x"}),ss.lateNightHours>0&&jsxRuntimeExports.jsx(BreakdownRow,{label:"Late Night",hours:ss.lateNightHours,rate:"@ 2x"}),jsxRuntimeExports.jsx(BreakdownRow,{label:"Lunch (unpaid)",hours:-(es.lunchTaken/60)}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center pt-2.5 mt-2.5",style:{borderTop:"1px solid var(--color-border)"},children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--color-text-primary)"},children:"Total Worked"}),jsxRuntimeExports.jsxs("span",{className:"text-base font-bold",style:{color:"var(--color-text-primary)"},children:[ss.totalHours.toFixed(1)," hrs"]})]})]})]}),ss.totalEarnings>0&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg gold-gradient text-white",children:[jsxRuntimeExports.jsx("span",{className:"text-[11px] uppercase tracking-wide opacity-90",children:"Day Earnings"}),jsxRuntimeExports.jsxs("span",{className:"text-lg font-bold",children:["",ss.totalEarnings.toFixed(2)]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"text-[10px] uppercase tracking-wide font-medium mb-1.5",style:{color:"var(--color-text-muted)"},children:["Notes / OT Reason",ss.otHours>0&&jsxRuntimeExports.jsx("span",{className:"text-orange-500 ml-1",children:"(Required for OT)"})]}),jsxRuntimeExports.jsx("textarea",{value:es.notes,onChange:rs=>ts("notes",rs.target.value),placeholder:"e.g., Extended for reshoots, rain delay...",rows:2,className:"w-full p-3 rounded-lg text-[13px] resize-none",style:{backgroundColor:"var(--color-input-bg)",border:`1px solid ${ss.otHours>0&&!es.notes?"rgba(249, 115, 22, 0.5)":"var(--color-border)"}`,color:"var(--color-text-primary)"}})]})]})}function TimeInputCell({label:es,value:ts,onChange:ss,highlight:ns,hint:rs}){const os=ns==="gold"?{backgroundColor:"#fffbeb",border:"1px solid var(--color-gold)"}:ns==="orange"?{backgroundColor:"#fff7ed",border:"1px solid #f97316"}:{backgroundColor:"var(--color-input-bg)",border:"1px solid var(--color-border)"};return jsxRuntimeExports.jsxs("div",{className:"p-2.5 rounded-lg",style:os,children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-[10px] uppercase tracking-wide",style:{color:"var(--color-text-muted)"},children:es}),rs&&jsxRuntimeExports.jsx("span",{className:"text-[9px] font-semibold",style:{color:ns==="orange"?"#f97316":"var(--color-gold)"},children:rs})]}),jsxRuntimeExports.jsx("input",{type:"time",value:ts||"",onChange:as=>ss(as.target.value),className:"text-[15px] font-semibold bg-transparent w-full",style:{color:ts?"var(--color-text-primary)":"var(--color-text-muted)"}})]})}function BreakdownRow({label:es,hours:ts,rate:ss}){return jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center text-[13px]",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5",style:{color:"var(--color-text-muted)"},children:[es,ss&&jsxRuntimeExports.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{backgroundColor:"var(--color-card)",color:"var(--color-text-muted)"},children:ss})]}),jsxRuntimeExports.jsxs("span",{className:"font-semibold",style:{color:"var(--color-text-primary)"},children:[(ts>0,""),ts.toFixed(1)," hrs"]})]})}const WEEKDAY_LABELS=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"];function MonthView({year:es,month:ts,onNavigate:ss,onDaySelect:ns,selectedDate:rs}){const{entries:os,calculateEntry:as}=useTimesheetStore(),cs=reactExports.useMemo(()=>{const ds=new Date(es,ts,1),fs=new Date(es,ts+1,0).getDate();let gs=ds.getDay()-1;gs<0&&(gs=6);const Es=[];let js=[];for(let ps=0;ps<gs;ps++)js.push({date:null,day:null,hours:null});for(let ps=1;ps<=fs;ps++){const ms=formatDateString(new Date(es,ts,ps)),hs=os[ms],vs=hs&&hs.unitCall&&hs.wrapOut?as(hs):null;js.push({date:ms,day:ps,hours:(vs==null?void 0:vs.totalHours)??null}),js.length===7&&(Es.push(js),js=[])}for(;js.length>0&&js.length<7;)js.push({date:null,day:null,hours:null});return js.length>0&&Es.push(js),Es},[es,ts,os,as]),ls=reactExports.useMemo(()=>{let ds=0,xs=0,fs=0;return Object.values(os).forEach(gs=>{const Es=new Date(gs.date);if(Es.getFullYear()===es&&Es.getMonth()===ts&&gs.unitCall&&gs.wrapOut){const js=as(gs);ds+=js.totalHours,xs+=js.totalEarnings,fs++}}),{totalHours:ds,totalEarnings:xs,daysWorked:fs}},[os,es,ts,as]),us=formatDateString(new Date);return jsxRuntimeExports.jsxs("div",{className:"px-4 py-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ss("prev"),className:"p-2 text-text-muted hover:text-text-primary transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsxs("h2",{className:"text-base font-semibold text-text-primary",children:[MONTH_NAMES[ts]," ",es]}),jsxRuntimeExports.jsx("button",{onClick:()=>ss("next"),className:"p-2 text-text-muted hover:text-text-primary transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-card border border-border overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"grid grid-cols-7 border-b border-border",children:WEEKDAY_LABELS.map((ds,xs)=>jsxRuntimeExports.jsx("div",{className:`py-2 text-center text-xs font-bold ${xs>=5?"text-gold":"text-text-muted"}`,children:ds},ds))}),cs.map((ds,xs)=>jsxRuntimeExports.jsx("div",{className:"grid grid-cols-7 border-b border-border last:border-b-0",children:ds.map((fs,gs)=>{var ms;if(!fs.date)return jsxRuntimeExports.jsx("div",{className:"h-16 bg-gray-50"},gs);const Es=fs.date===rs,js=fs.date===us,ps=fs.hours!==null;return jsxRuntimeExports.jsxs("button",{onClick:()=>ns(fs.date),className:`h-16 flex flex-col items-center justify-center transition-colors ${Es?"bg-gold-100":ps?"bg-gold-50 hover:bg-gold-100":"hover:bg-gray-50"}`,children:[jsxRuntimeExports.jsx("span",{className:`text-sm font-medium ${js?"w-6 h-6 rounded-full bg-gold text-white flex items-center justify-center":Es?"text-gold":"text-text-primary"}`,children:fs.day}),ps&&jsxRuntimeExports.jsxs("span",{className:"text-[10px] text-gold font-medium mt-0.5",children:[(ms=fs.hours)==null?void 0:ms.toFixed(1),"h"]})]},fs.date)})},xs))]}),jsxRuntimeExports.jsx("div",{className:"mt-4 p-4 bg-gold-50 rounded-card",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-text-muted uppercase tracking-wide",children:"Days"}),jsxRuntimeExports.jsx("div",{className:"text-lg font-bold text-text-primary",children:ls.daysWorked})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-text-muted uppercase tracking-wide",children:"Hours"}),jsxRuntimeExports.jsx("div",{className:"text-lg font-bold text-text-primary",children:ls.totalHours.toFixed(1)})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-text-muted uppercase tracking-wide",children:"Earnings"}),jsxRuntimeExports.jsxs("div",{className:"text-lg font-bold text-gold",children:["",ls.totalEarnings.toLocaleString("en-GB",{minimumFractionDigits:2})]})]})]})})]})}function SummaryCard({summary:es}){return es.entries.length>0?jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[jsxRuntimeExports.jsx(SummaryItem,{label:"Days",value:es.entries.length.toString()}),jsxRuntimeExports.jsx(SummaryItem,{label:"Base Hrs",value:es.baseHours.toFixed(0)}),jsxRuntimeExports.jsx(SummaryItem,{label:"Pre-Call",value:es.preCallHours.toFixed(1),subtext:"@ 1.5x"}),jsxRuntimeExports.jsx(SummaryItem,{label:"Overtime",value:es.otHours.toFixed(1),subtext:"@ 1.5x",highlight:!0})]}),(es.sixthDayHours>0||es.seventhDayHours>0||es.lateNightHours>0)&&jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mt-3 pt-3",style:{borderTop:"1px solid var(--color-border)"},children:[es.sixthDayHours>0&&jsxRuntimeExports.jsx(SummaryItem,{label:"6th Day",value:es.sixthDayHours.toFixed(1),subtext:"@ 1.5x"}),es.seventhDayHours>0&&jsxRuntimeExports.jsx(SummaryItem,{label:"7th Day",value:es.seventhDayHours.toFixed(1),subtext:"@ 2x"}),es.lateNightHours>0&&jsxRuntimeExports.jsx(SummaryItem,{label:"Late Night",value:es.lateNightHours.toFixed(1),subtext:"@ 2x"})]}),es.totalEarnings>0&&jsxRuntimeExports.jsxs("details",{className:"group mt-4",children:[jsxRuntimeExports.jsxs("summary",{className:"flex items-center justify-between cursor-pointer py-2",style:{borderTop:"1px solid var(--color-border)"},children:[jsxRuntimeExports.jsx("span",{className:"text-xs uppercase tracking-wide font-semibold",style:{color:"var(--color-text-muted)"},children:"Earnings Preview"}),jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 transition-transform group-open:rotate-180",style:{color:"var(--color-text-muted)"},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),jsxRuntimeExports.jsxs("div",{className:"pt-3 space-y-2",children:[es.kitRentalTotal>0&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsx("span",{style:{color:"var(--color-text-muted)"},children:"Kit Rental"}),jsxRuntimeExports.jsxs("span",{style:{color:"var(--color-text-primary)"},children:["",es.kitRentalTotal.toFixed(2)]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",style:{color:"var(--color-text-secondary)"},children:"Est. Total"}),jsxRuntimeExports.jsxs("span",{className:"text-lg font-bold text-gold",children:["",es.totalEarnings.toLocaleString("en-GB",{minimumFractionDigits:2})]})]})]})]})]}):jsxRuntimeExports.jsxs("div",{className:"card text-center py-8",children:[jsxRuntimeExports.jsx("svg",{className:"w-12 h-12 mx-auto mb-3",style:{color:"var(--color-text-placeholder)"},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsx("p",{className:"text-sm",style:{color:"var(--color-text-muted)"},children:"No entries this week"}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",style:{color:"var(--color-text-placeholder)"},children:"Tap a day to log your hours"})]})}function SummaryItem({label:es,value:ts,subtext:ss,highlight:ns}){return jsxRuntimeExports.jsxs("div",{className:"py-2 px-1",children:[jsxRuntimeExports.jsx("div",{className:"text-[9px] uppercase tracking-wide font-medium mb-1",style:{color:"var(--color-text-placeholder)"},children:es}),jsxRuntimeExports.jsx("div",{className:`text-lg font-bold ${ns?"text-gold":""}`,style:{color:ns?void 0:"var(--color-text-primary)"},children:ts}),ss&&jsxRuntimeExports.jsx("div",{className:"text-[10px]",style:{color:"var(--color-text-placeholder)"},children:ss})]})}function ExportModal({isOpen:es,onClose:ts,weekSummary:ss,weekStartDate:ns}){const{entries:rs,calculateEntry:os,rateCard:as}=useTimesheetStore(),[cs,ls]=reactExports.useState("pdf"),[us,ds]=reactExports.useState(!1),[xs,fs]=reactExports.useState(!1);if(!es)return null;const gs=()=>{const bs=[];for(let Ns=0;Ns<7;Ns++){const Ss=addDays(ns,Ns),Ts=rs[Ss];Ts&&bs.push({date:Ss,entry:Ts,calc:os(Ts)})}return bs},Es=ss.entries.length,ps=(()=>{let bs=0,Ns=0,Ss=0,Ts=0,Cs=0,Ms=0,Is=0,Qs=0;return ss.entries.forEach(Ys=>{const Zs=os(Ys);bs+=Zs.preCallHours,Ns+=Zs.preCallEarnings,Ss+=Zs.workingHours,Ts+=Zs.lateNightHours,Cs+=Zs.dailyEarnings,Ms+=Zs.otEarnings,Is+=Zs.lateNightEarnings,Qs+=Zs.sixthDayBonus}),{preCallHours:bs,preCallPay:Ns,workingHours:Ss,lateNightHours:Ts,basePay:Cs,otPay:Ms,lateNightPay:Is,sixthDayBonus:Qs}})(),ms=bs=>new Date(bs).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"}),hs=()=>{const bs=new Date(ns),Ns=new Date(addDays(ns,6));return`${bs.toLocaleDateString("en-GB",{day:"numeric",month:"short"})} - ${Ns.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`},vs=()=>{const bs=gs(),Ns=["Date","Day Type","Pre-Call","Unit Call","Out of Chair","Wrap Out","6th Day","Lunch (mins)","Pre-Call Hours","Working Hours","OT Hours","Late Night Hours","Total Hours","Pre-Call Pay","Base Pay","OT Pay","Late Night Pay","6th Day Bonus","Kit Rental","Total Earnings","Notes"],Ss=bs.map(({date:Ts,entry:Cs,calc:Ms})=>[ms(Ts),Cs.dayType,Cs.preCall||"",Cs.unitCall||"",Cs.outOfChair||"",Cs.wrapOut||"",Cs.isSixthDay?"Yes":"No",String(Cs.lunchTaken??60),Ms.preCallHours.toFixed(2),Ms.workingHours.toFixed(2),Ms.otHours.toFixed(2),Ms.lateNightHours.toFixed(2),Ms.totalHours.toFixed(2),Ms.preCallEarnings.toFixed(2),Ms.dailyEarnings.toFixed(2),Ms.otEarnings.toFixed(2),Ms.lateNightEarnings.toFixed(2),Ms.sixthDayBonus.toFixed(2),Ms.kitRental.toFixed(2),Ms.totalEarnings.toFixed(2),Cs.notes||""]);return Ss.push(["TOTAL","","","","","","","",ps.preCallHours.toFixed(2),ps.workingHours.toFixed(2),ss.otHours.toFixed(2),ps.lateNightHours.toFixed(2),ss.totalHours.toFixed(2),ps.preCallPay.toFixed(2),ps.basePay.toFixed(2),ps.otPay.toFixed(2),ps.lateNightPay.toFixed(2),ps.sixthDayBonus.toFixed(2),ss.kitRentalTotal.toFixed(2),ss.totalEarnings.toFixed(2),""]),[Ns.join(","),...Ss.map(Ts=>Ts.join(","))].join(`
`)},ws=()=>{const bs=gs(),Ns=as.dailyRate/as.baseDayHours;return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Timesheet - ${hs()}</title>
        <style>
          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
          h1 { color: #C9A962; font-size: 24px; margin-bottom: 4px; }
          .subtitle { color: #666; font-size: 14px; margin-bottom: 20px; }
          .rate-info { background: #f5f5f5; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 12px; }
          .rate-info span { margin-right: 20px; }
          table { width: 100%; border-collapse: collapse; font-size: 12px; }
          th { background: #C9A962; color: white; padding: 8px; text-align: left; }
          td { padding: 8px; border-bottom: 1px solid #eee; }
          tr:nth-child(even) { background: #f9f9f9; }
          .summary { margin-top: 20px; background: linear-gradient(135deg, #C9A962, #B8985A); color: white; padding: 16px; border-radius: 8px; }
          .summary h3 { margin: 0 0 12px 0; font-size: 16px; }
          .summary-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
          .summary-item { text-align: center; }
          .summary-item .label { font-size: 10px; opacity: 0.9; }
          .summary-item .value { font-size: 18px; font-weight: bold; }
          .total-box { background: rgba(255,255,255,0.2); padding: 12px; border-radius: 8px; text-align: center; margin-top: 12px; }
          .total-box .label { font-size: 12px; opacity: 0.9; }
          .total-box .value { font-size: 28px; font-weight: bold; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <h1>Timesheet</h1>
        <p class="subtitle">${hs()}</p>

        <div class="rate-info">
          <span><strong>Daily Rate:</strong> ${as.dailyRate.toFixed(2)}</span>
          <span><strong>Base Day:</strong> ${as.baseDayHours} hours</span>
          <span><strong>Hourly:</strong> ${Ns.toFixed(2)}/hr</span>
          <span><strong>Kit Rental:</strong> ${as.kitRental.toFixed(2)}/day</span>
        </div>

        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Pre-Call</th>
              <th>Unit Call</th>
              <th>Wrap</th>
              <th>Hours</th>
              <th>OT</th>
              <th>Earnings</th>
            </tr>
          </thead>
          <tbody>
            ${bs.map(({date:Ss,entry:Ts,calc:Cs})=>`
              <tr>
                <td><strong>${ms(Ss)}</strong>${Ts.isSixthDay?' <span style="color:#C9A962">(6th)</span>':""}</td>
                <td>${Ts.preCall||""}</td>
                <td>${Ts.unitCall||""}</td>
                <td>${Ts.wrapOut||""}</td>
                <td>${Cs.totalHours.toFixed(1)}</td>
                <td>${Cs.otHours>0?Cs.otHours.toFixed(1):""}</td>
                <td>${Cs.totalEarnings.toFixed(2)}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>

        <div class="summary">
          <h3>Week Summary</h3>
          <div class="summary-grid">
            <div class="summary-item">
              <div class="label">Total Hours</div>
              <div class="value">${ss.totalHours.toFixed(1)}</div>
            </div>
            <div class="summary-item">
              <div class="label">Days Worked</div>
              <div class="value">${Es}</div>
            </div>
            <div class="summary-item">
              <div class="label">OT Hours</div>
              <div class="value">${ss.otHours.toFixed(1)}</div>
            </div>
          </div>
          <div class="total-box">
            <div class="label">Total Earnings</div>
            <div class="value">${ss.totalEarnings.toFixed(2)}</div>
          </div>
        </div>
      </body>
      </html>
    `},ys=()=>{const bs=as.dailyRate/as.baseDayHours,Ns=`INV-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,Ss=new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${Ns}</title>
        <style>
          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; color: #333; }
          .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 40px; }
          .logo { font-size: 28px; font-weight: bold; color: #C9A962; }
          .invoice-title { text-align: right; }
          .invoice-title h1 { margin: 0; font-size: 32px; color: #C9A962; }
          .invoice-number { color: #666; font-size: 14px; }
          .details { display: flex; justify-content: space-between; margin-bottom: 40px; }
          .bill-to, .invoice-info { font-size: 14px; }
          .bill-to h3, .invoice-info h3 { margin: 0 0 8px 0; font-size: 12px; color: #999; text-transform: uppercase; }
          .period { font-size: 18px; font-weight: 600; margin-bottom: 30px; color: #333; border-bottom: 2px solid #C9A962; padding-bottom: 10px; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
          th { text-align: left; padding: 12px 8px; border-bottom: 2px solid #C9A962; font-size: 12px; color: #666; text-transform: uppercase; }
          td { padding: 12px 8px; border-bottom: 1px solid #eee; font-size: 14px; }
          .amount { text-align: right; }
          .subtotals { width: 300px; margin-left: auto; }
          .subtotals table { margin-bottom: 0; }
          .subtotals td { border-bottom: none; padding: 6px 0; }
          .subtotals .label { color: #666; }
          .subtotals .total { border-top: 2px solid #C9A962; font-size: 18px; font-weight: bold; }
          .total .value { color: #C9A962; }
          .footer { margin-top: 60px; padding-top: 20px; border-top: 1px solid #eee; font-size: 12px; color: #999; }
          @media print { body { padding: 20px; } }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="logo">Hair & Makeup Pro</div>
          <div class="invoice-title">
            <h1>INVOICE</h1>
            <p class="invoice-number">${Ns}</p>
          </div>
        </div>

        <div class="details">
          <div class="bill-to">
            <h3>Bill To</h3>
            <p>[Production Company Name]<br>
            [Address Line 1]<br>
            [City, Postcode]</p>
          </div>
          <div class="invoice-info">
            <h3>Invoice Details</h3>
            <p><strong>Date:</strong> ${Ss}<br>
            <strong>Due:</strong> 30 days from receipt<br>
            <strong>Period:</strong> ${hs()}</p>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Description</th>
              <th>Quantity</th>
              <th>Rate</th>
              <th class="amount">Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Hair & Makeup Services - Base Day Rate<br><small style="color:#666">${Es} days  ${as.baseDayHours} hours</small></td>
              <td>${Es}</td>
              <td>${as.dailyRate.toFixed(2)}</td>
              <td class="amount">${ps.basePay.toFixed(2)}</td>
            </tr>
            ${ss.otHours>0?`
            <tr>
              <td>Overtime Hours<br><small style="color:#666">At ${as.otMultiplier}x hourly rate (${(bs*as.otMultiplier).toFixed(2)}/hr)</small></td>
              <td>${ss.otHours.toFixed(1)} hrs</td>
              <td>${(bs*as.otMultiplier).toFixed(2)}</td>
              <td class="amount">${ps.otPay.toFixed(2)}</td>
            </tr>
            `:""}
            ${ps.sixthDayBonus>0?`
            <tr>
              <td>6th Day Premium<br><small style="color:#666">Additional 50% for 6th working day</small></td>
              <td></td>
              <td></td>
              <td class="amount">${ps.sixthDayBonus.toFixed(2)}</td>
            </tr>
            `:""}
            ${ss.kitRentalTotal>0?`
            <tr>
              <td>Kit / Box Rental<br><small style="color:#666">${Es} days @ ${as.kitRental.toFixed(2)}/day</small></td>
              <td>${Es}</td>
              <td>${as.kitRental.toFixed(2)}</td>
              <td class="amount">${ss.kitRentalTotal.toFixed(2)}</td>
            </tr>
            `:""}
          </tbody>
        </table>

        <div class="subtotals">
          <table>
            <tr>
              <td class="label">Subtotal (Base)</td>
              <td class="amount">${ps.basePay.toFixed(2)}</td>
            </tr>
            ${ps.otPay>0?`
            <tr>
              <td class="label">Overtime</td>
              <td class="amount">${ps.otPay.toFixed(2)}</td>
            </tr>
            `:""}
            ${ps.sixthDayBonus>0?`
            <tr>
              <td class="label">6th Day Premium</td>
              <td class="amount">${ps.sixthDayBonus.toFixed(2)}</td>
            </tr>
            `:""}
            ${ss.kitRentalTotal>0?`
            <tr>
              <td class="label">Kit Rental</td>
              <td class="amount">${ss.kitRentalTotal.toFixed(2)}</td>
            </tr>
            `:""}
            <tr class="total">
              <td class="label">Total Due</td>
              <td class="amount value">${ss.totalEarnings.toFixed(2)}</td>
            </tr>
          </table>
        </div>

        <div class="footer">
          <p>Payment terms: 30 days from invoice date<br>
          Please include invoice number with payment</p>
        </div>
      </body>
      </html>
    `},Rs=async()=>{ds(!0),fs(!1);try{let bs,Ns,Ss;switch(cs){case"csv":bs=vs(),Ns=`timesheet-${ns}.csv`,Ss="text/csv";break;case"pdf":bs=ws(),Ns=`timesheet-${ns}.html`,Ss="text/html";break;case"invoice":bs=ys(),Ns=`invoice-${ns}.html`,Ss="text/html";break}const Ts=new Blob([bs],{type:Ss}),Cs=URL.createObjectURL(Ts);if(cs==="pdf"||cs==="invoice"){const Ms=window.open(Cs,"_blank");Ms&&Ms.addEventListener("load",()=>{setTimeout(()=>Ms.print(),500)})}else{const Ms=document.createElement("a");Ms.href=Cs,Ms.download=Ns,document.body.appendChild(Ms),Ms.click(),document.body.removeChild(Ms)}URL.revokeObjectURL(Cs),fs(!0),setTimeout(()=>fs(!1),2e3)}catch(bs){console.error("Export failed:",bs)}finally{ds(!1)}};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-xl w-full max-w-sm overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Export Timesheet"}),jsxRuntimeExports.jsx("button",{onClick:ts,className:"p-1 text-text-muted hover:text-text-primary transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm text-text-muted mb-4",children:["Week of ",hs()]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 mb-6",children:[jsxRuntimeExports.jsx("label",{className:"field-label",children:"EXPORT FORMAT"}),jsxRuntimeExports.jsx("button",{onClick:()=>ls("pdf"),className:`w-full p-3 rounded-card border-2 text-left transition-all ${cs==="pdf"?"border-gold bg-gold-50":"border-border bg-input-bg hover:border-gold/50"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${cs==="pdf"?"bg-gold text-white":"bg-gray-200 text-text-muted"}`,children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-text-primary",children:"PDF Timesheet"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-text-muted",children:"Print-ready document"})]})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>ls("csv"),className:`w-full p-3 rounded-card border-2 text-left transition-all ${cs==="csv"?"border-gold bg-gold-50":"border-border bg-input-bg hover:border-gold/50"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${cs==="csv"?"bg-gold text-white":"bg-gray-200 text-text-muted"}`,children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-text-primary",children:"CSV Spreadsheet"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-text-muted",children:"For Excel/Google Sheets"})]})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>ls("invoice"),className:`w-full p-3 rounded-card border-2 text-left transition-all ${cs==="invoice"?"border-gold bg-gold-50":"border-border bg-input-bg hover:border-gold/50"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${cs==="invoice"?"bg-gold text-white":"bg-gray-200 text-text-muted"}`,children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-text-primary",children:"Invoice"}),jsxRuntimeExports.jsx("div",{className:"text-xs text-text-muted",children:"Ready to send to production"})]})]})})]}),jsxRuntimeExports.jsx("div",{className:"bg-input-bg rounded-card p-3 mb-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center text-sm",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-text-muted text-xs",children:"Days"}),jsxRuntimeExports.jsx("div",{className:"font-semibold text-text-primary",children:Es})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-text-muted text-xs",children:"Hours"}),jsxRuntimeExports.jsx("div",{className:"font-semibold text-text-primary",children:ss.totalHours.toFixed(1)})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-text-muted text-xs",children:"Total"}),jsxRuntimeExports.jsxs("div",{className:"font-semibold text-gold",children:["",ss.totalEarnings.toFixed(2)]})]})]})}),jsxRuntimeExports.jsx("button",{onClick:Rs,disabled:us,className:`w-full py-3 rounded-button font-medium transition-all ${xs?"bg-success text-white":"gold-gradient text-white active:scale-[0.98]"} ${us?"opacity-70":""}`,children:us?jsxRuntimeExports.jsxs("span",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Exporting..."]}):xs?jsxRuntimeExports.jsxs("span",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Exported!"]}):`Export ${cs==="pdf"?"PDF":cs==="csv"?"CSV":"Invoice"}`})]})]})})}const BASE_CONTRACT_OPTIONS=[{value:"10+1",label:"10+1 (10 hours work + 1hr lunch)",hours:10},{value:"11+1",label:"11+1 (11 hours work + 1hr lunch)",hours:11}];function RateCardSettings(){const{rateCard:es,updateRateCard:ts}=useTimesheetStore(),ss=ns=>{const rs=BASE_CONTRACT_OPTIONS.find(os=>os.value===ns);ts({baseContract:ns,baseDayHours:(rs==null?void 0:rs.hours)||11})};return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"DAILY RATE"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:""}),jsxRuntimeExports.jsx("input",{type:"number",value:es.dailyRate||"",onChange:ns=>ts({dailyRate:ns.target.value?parseFloat(ns.target.value):0}),placeholder:"0.00",min:"0",step:"0.01",className:"input-field flex-1"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Your agreed daily rate (BECTU minimum guarantee)"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"BASE CONTRACT (BECTU)"}),jsxRuntimeExports.jsx("select",{value:es.baseContract||"11+1",onChange:ns=>ss(ns.target.value),className:"input-field w-full",children:BASE_CONTRACT_OPTIONS.map(ns=>jsxRuntimeExports.jsx("option",{value:ns.value,children:ns.label},ns.value))}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Standard UK film industry contract. Hours worked beyond this trigger overtime."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-card p-4 space-y-4",children:[jsxRuntimeExports.jsx("h4",{className:"field-label",children:"RATE MULTIPLIERS"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Pre-Call"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"x"}),jsxRuntimeExports.jsx("input",{type:"number",value:es.preCallMultiplier,onChange:ns=>ts({preCallMultiplier:parseFloat(ns.target.value)||1.5}),min:"1",max:"5",step:"0.1",className:"input-field w-16 text-center text-gold font-medium"})]})]}),jsxRuntimeExports.jsx("p",{className:"text-[11px] text-text-light mt-1",children:"Hours before unit call"})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Overtime (after base hours)"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"x"}),jsxRuntimeExports.jsx("input",{type:"number",value:es.otMultiplier,onChange:ns=>ts({otMultiplier:parseFloat(ns.target.value)||1.5}),min:"1",max:"5",step:"0.1",className:"input-field w-16 text-center text-gold font-medium"})]})]})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Late Night (after 23:00)"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"x"}),jsxRuntimeExports.jsx("input",{type:"number",value:es.lateNightMultiplier,onChange:ns=>ts({lateNightMultiplier:parseFloat(ns.target.value)||2}),min:"1",max:"5",step:"0.1",className:"input-field w-16 text-center text-gold font-medium"})]})]})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"6th Day"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"x"}),jsxRuntimeExports.jsx("input",{type:"number",value:es.sixthDayMultiplier,onChange:ns=>ts({sixthDayMultiplier:parseFloat(ns.target.value)||1.5}),min:"1",max:"5",step:"0.1",className:"input-field w-16 text-center text-gold font-medium"})]})]}),jsxRuntimeExports.jsx("p",{className:"text-[11px] text-text-light mt-1",children:"Applied to entire day's earnings"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"7th Day"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"x"}),jsxRuntimeExports.jsx("input",{type:"number",value:es.seventhDayMultiplier,onChange:ns=>ts({seventhDayMultiplier:parseFloat(ns.target.value)||2}),min:"1",max:"5",step:"0.1",className:"input-field w-16 text-center text-orange-500 font-medium"})]})]}),jsxRuntimeExports.jsx("p",{className:"text-[11px] text-text-light mt-1",children:"7th consecutive day worked"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"KIT / BOX RENTAL"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:""}),jsxRuntimeExports.jsx("input",{type:"number",value:es.kitRental||"",onChange:ns=>ts({kitRental:ns.target.value?parseFloat(ns.target.value):0}),placeholder:"0.00",min:"0",step:"0.01",className:"input-field flex-1"}),jsxRuntimeExports.jsx("span",{className:"text-text-muted text-sm",children:"/day"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Daily kit rental added to each working day"})]}),es.dailyRate>0&&jsxRuntimeExports.jsxs("div",{className:"bg-gold-50 rounded-card p-4 mt-6",children:[jsxRuntimeExports.jsx("h4",{className:"field-label mb-3",children:"RATE SUMMARY"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:"Hourly Rate"}),jsxRuntimeExports.jsxs("span",{className:"text-text-primary font-medium",children:["",(es.dailyRate/es.baseDayHours).toFixed(2),"/hr"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:"Pre-Call Rate"}),jsxRuntimeExports.jsxs("span",{className:"text-text-primary font-medium",children:["",(es.dailyRate/es.baseDayHours*es.preCallMultiplier).toFixed(2),"/hr"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:"OT Rate"}),jsxRuntimeExports.jsxs("span",{className:"text-text-primary font-medium",children:["",(es.dailyRate/es.baseDayHours*es.otMultiplier).toFixed(2),"/hr"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:"Late Night Rate"}),jsxRuntimeExports.jsxs("span",{className:"text-text-primary font-medium",children:["",(es.dailyRate/es.baseDayHours*es.lateNightMultiplier).toFixed(2),"/hr"]})]})]})]})]})}function Timesheet(){const{viewMode:es,setViewMode:ts,selectedDate:ss,setSelectedDate:ns,getWeekSummary:rs,rateCard:os}=useTimesheetStore(),[as,cs]=reactExports.useState(()=>getWeekStart(ss)),[ls,us]=reactExports.useState(()=>{const vs=new Date(ss);return{year:vs.getFullYear(),month:vs.getMonth()}}),[ds,xs]=reactExports.useState(!1),[fs,gs]=reactExports.useState(!1),Es=vs=>{const ws=addDays(as,vs==="next"?7:-7);cs(ws)},js=vs=>{us(ws=>{let ys=ws.month+(vs==="next"?1:-1),Rs=ws.year;return ys>11?(ys=0,Rs++):ys<0&&(ys=11,Rs--),{year:Rs,month:ys}})},ps=vs=>{ns(vs),ts("week"),cs(getWeekStart(vs))},ms=rs(as),hs=()=>{const vs=[];return os.dailyRate>0&&vs.push(`${os.dailyRate}/day`),vs.push(`${os.baseDayHours}+1`),os.kitRental>0&&vs.push(`Kit ${os.kitRental}`),vs.join("  ")};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsxs("div",{className:"mobile-container",children:[jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Timesheet"}),jsxRuntimeExports.jsx("button",{onClick:()=>xs(!0),className:"p-2 text-text-muted hover:text-gold transition-colors","aria-label":"Export",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})})]}),jsxRuntimeExports.jsx("div",{className:"px-4 pb-3",children:jsxRuntimeExports.jsxs("div",{className:"flex bg-input-bg rounded-pill p-1 border border-border",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ts("week"),className:`flex-1 py-2 px-4 rounded-pill text-sm font-medium transition-all ${es==="week"?"bg-card text-text-primary border-2 border-gold":"text-text-muted"}`,children:"Week"}),jsxRuntimeExports.jsx("button",{onClick:()=>ts("month"),className:`flex-1 py-2 px-4 rounded-pill text-sm font-medium transition-all ${es==="month"?"bg-card text-text-primary border-2 border-gold":"text-text-muted"}`,children:"Month"})]})})]})}),jsxRuntimeExports.jsxs("div",{className:"mobile-container",children:[jsxRuntimeExports.jsx("div",{className:"mx-4 mt-4 mb-3",children:jsxRuntimeExports.jsxs("div",{className:`rounded-xl border overflow-hidden transition-all ${fs?"border-gold":"border-border"}`,style:{backgroundColor:"var(--color-card)"},children:[jsxRuntimeExports.jsxs("div",{onClick:()=>gs(!fs),className:"px-4 py-3 flex items-center justify-between cursor-pointer",style:{backgroundColor:"var(--color-input-bg)"},children:[jsxRuntimeExports.jsxs("span",{className:"text-xs font-medium flex items-center gap-2",style:{color:"var(--color-text-muted)"},children:[jsxRuntimeExports.jsx("span",{children:""})," Rate Card"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs",style:{color:"var(--color-text-placeholder)"},children:hs()}),jsxRuntimeExports.jsx("svg",{className:`w-2.5 h-2.5 transition-transform ${fs?"rotate-180":""}`,style:{color:"var(--color-text-muted)"},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),fs&&jsxRuntimeExports.jsx("div",{className:"px-4 py-3",style:{borderTop:"1px solid var(--color-border)"},children:jsxRuntimeExports.jsx(RateCardSettings,{})})]})}),es==="week"?jsxRuntimeExports.jsx(WeekView,{weekStartDate:as,onNavigate:Es,selectedDate:ss}):jsxRuntimeExports.jsx(MonthView,{year:ls.year,month:ls.month,onNavigate:js,onDaySelect:ps,selectedDate:ss}),jsxRuntimeExports.jsx("div",{className:"px-4 pb-24",children:jsxRuntimeExports.jsx(SummaryCard,{summary:ms})})]}),jsxRuntimeExports.jsx(ExportModal,{isOpen:ds,onClose:()=>xs(!1),weekSummary:ms,weekStartDate:as})]})}const emptyBudgetSummary={totalBudget:0,totalSpent:0,byCategory:{"Kit Supplies":0,Consumables:0,Transportation:0,Equipment:0,Other:0}},CATEGORIES=["Kit Supplies","Consumables","Transportation","Equipment","Other"];function Budget(){const{currentProject:es}=useProjectStore(),ts=(es==null?void 0:es.isDemoProject)===!0,[ss,ns]=reactExports.useState(ts?demoReceipts:[]),[rs]=reactExports.useState(ts?demoBudgetSummary:emptyBudgetSummary),[os,as]=reactExports.useState(null),[cs,ls]=reactExports.useState(!1),[us,ds]=reactExports.useState(!1),[xs,fs]=reactExports.useState(DEFAULT_CURRENCY),[gs,Es]=reactExports.useState(!1),js=reactExports.useRef(null),ps=reactExports.useRef(null),ms=getCurrencyByCode(xs),hs=rs.totalBudget-rs.totalSpent,vs=rs.totalBudget>0?rs.totalSpent/rs.totalBudget*100:0,ws=()=>{ds(!0)},ys=()=>{var Ts;ds(!1),(Ts=js.current)==null||Ts.click()},Rs=()=>{var Ts;ds(!1),(Ts=ps.current)==null||Ts.click()},bs=Ts=>{var Ms;const Cs=(Ms=Ts.target.files)==null?void 0:Ms[0];if(Cs){const Is=new FileReader;Is.onloadend=()=>{as(Is.result),ls(!0)},Is.readAsDataURL(Cs)}Ts.target.value=""},Ns=Ts=>{const Cs={...Ts,id:`r-${Date.now()}`,synced:!1};ns([Cs,...ss]),ls(!1),as(null)},Ss=()=>{ds(!1),as(null),ls(!0)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Budget"}),jsxRuntimeExports.jsxs("button",{onClick:()=>Es(!0),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-text-muted bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:[jsxRuntimeExports.jsx("span",{children:ms.symbol}),jsxRuntimeExports.jsx("span",{children:xs}),jsxRuntimeExports.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]})]}),jsxRuntimeExports.jsxs("button",{onClick:ws,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-gold active:opacity-70 transition-opacity",children:[jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),"Scan"]})]})})}),jsxRuntimeExports.jsx("input",{ref:js,type:"file",accept:"image/*",capture:"environment",onChange:bs,className:"hidden"}),jsxRuntimeExports.jsx("input",{ref:ps,type:"file",accept:"image/*",onChange:bs,className:"hidden"}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-4 space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("h2",{className:"section-header",children:"SPENDING OVERVIEW"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"This Production"})]}),jsxRuntimeExports.jsx("div",{className:"relative h-3 bg-gray-100 rounded-full overflow-hidden mb-3",children:jsxRuntimeExports.jsx("div",{className:`absolute left-0 top-0 h-full rounded-full transition-all ${vs>90?"bg-error":vs>70?"bg-amber-500":"bg-gold"}`,style:{width:`${Math.min(vs,100)}%`}})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-end",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-text-primary",children:formatCurrency(rs.totalSpent,xs)}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted ml-1",children:"spent"})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsx("span",{className:`text-lg font-semibold ${hs<0?"text-error":"text-green-600"}`,children:formatCurrency(hs,xs)}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted block",children:["remaining of ",formatCurrency(rs.totalBudget,xs)]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("h2",{className:"section-header mb-3",children:"BY CATEGORY"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:CATEGORIES.filter(Ts=>rs.byCategory[Ts]>0).map(Ts=>{const Cs=rs.byCategory[Ts],Ms=Cs/rs.totalSpent*100;return jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3",children:jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-text-primary",children:Ts}),jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:formatCurrency(Cs,xs)})]}),jsxRuntimeExports.jsx("div",{className:"h-1.5 bg-gray-100 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gold/60 rounded-full",style:{width:`${Ms}%`}})})]})},Ts)})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("h2",{className:"section-header",children:"RECENT RECEIPTS"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted",children:[ss.length," total"]})]}),ss.length===0?jsxRuntimeExports.jsxs("div",{className:"card text-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-gray-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-text-muted",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 14l6-6m-5.5.5h.01m4.99 5h.01M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16l3.5-2 3.5 2 3.5-2 3.5 2z"})})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-1",children:"No receipts yet"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-light",children:"Scan or add receipts to track expenses"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:ss.map(Ts=>jsxRuntimeExports.jsx("div",{className:"card",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-text-primary truncate",children:Ts.vendor}),!Ts.synced&&jsxRuntimeExports.jsx("span",{className:"px-1.5 py-0.5 text-[9px] font-medium rounded bg-amber-100 text-amber-700",children:"Pending"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:Ts.description}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 text-[10px] font-medium rounded-full bg-gray-100 text-text-muted",children:Ts.category}),jsxRuntimeExports.jsx("span",{className:"text-[11px] text-text-light",children:formatShortDate(Ts.date)})]})]}),jsxRuntimeExports.jsx("span",{className:"text-base font-bold text-text-primary ml-3",children:formatCurrency(Ts.amount,xs)})]})},Ts.id))})]}),jsxRuntimeExports.jsxs("button",{onClick:ws,className:"w-full card flex items-center justify-center gap-3 py-4 border-2 border-dashed border-gold/30 hover:border-gold hover:bg-gold/5 transition-colors",children:[jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gold",children:"Quick Scan Receipt"})]}),jsxRuntimeExports.jsx("div",{className:"text-center py-2",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-text-light",children:"Syncs with website budget page"})})]}),gs&&jsxRuntimeExports.jsx(CurrencyPickerModal,{currentCurrency:xs,onSelect:Ts=>{fs(Ts),Es(!1)},onClose:()=>Es(!1)}),cs&&jsxRuntimeExports.jsx(AddReceiptModal,{imageUri:os,currencySymbol:ms.symbol,onAdd:Ns,onClose:()=>{ls(!1),as(null)}}),us&&jsxRuntimeExports.jsx(ScanOptionsModal,{onTakePhoto:ys,onChooseFromLibrary:Rs,onManualEntry:Ss,onClose:()=>ds(!1)})]})}function CurrencyPickerModal({currentCurrency:es,onSelect:ts,onClose:ss}){return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/50",onClick:ss,children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-t-2xl w-full max-w-lg",onClick:ns=>ns.stopPropagation(),children:[jsxRuntimeExports.jsx("div",{className:"px-4 py-3 border-b border-border",children:jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-text-primary text-center",children:"Select Currency"})}),jsxRuntimeExports.jsx("div",{className:"p-2 max-h-[60vh] overflow-y-auto",children:CURRENCIES.map(ns=>jsxRuntimeExports.jsxs("button",{onClick:()=>ts(ns.code),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${es===ns.code?"bg-gold/10":"hover:bg-gray-50"}`,children:[jsxRuntimeExports.jsx("span",{className:"text-xl font-medium text-text-primary w-8",children:ns.symbol}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary",children:ns.code}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted ml-2",children:ns.name})]}),es===ns.code&&jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})]},ns.code))}),jsxRuntimeExports.jsx("div",{className:"p-4 border-t border-border",children:jsxRuntimeExports.jsx("button",{onClick:ss,className:"w-full px-4 py-3 rounded-button bg-gray-100 text-text-primary font-medium",children:"Cancel"})})]})})}function ScanOptionsModal({onTakePhoto:es,onChooseFromLibrary:ts,onManualEntry:ss,onClose:ns}){return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/50",onClick:ns,children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-t-2xl w-full max-w-lg animate-slideUp",onClick:rs=>rs.stopPropagation(),children:[jsxRuntimeExports.jsx("div",{className:"px-4 py-4 border-b border-border",children:jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-text-primary text-center",children:"Add Receipt"})}),jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-3",children:[jsxRuntimeExports.jsxs("button",{onClick:es,className:"w-full flex items-center gap-4 px-4 py-4 rounded-xl bg-gold/10 hover:bg-gold/20 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 rounded-full bg-gold/20 flex items-center justify-center",children:jsxRuntimeExports.jsxs("svg",{className:"w-6 h-6 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0z"})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("span",{className:"text-base font-semibold text-text-primary block",children:"Take Photo"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Capture receipt with camera"})]})]}),jsxRuntimeExports.jsxs("button",{onClick:ts,className:"w-full flex items-center gap-4 px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("span",{className:"text-base font-semibold text-text-primary block",children:"Choose from Library"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Select existing photo"})]})]}),jsxRuntimeExports.jsxs("button",{onClick:ss,className:"w-full flex items-center gap-4 px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("span",{className:"text-base font-semibold text-text-primary block",children:"Manual Entry"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Enter details without photo"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"p-4 border-t border-border",children:jsxRuntimeExports.jsx("button",{onClick:ns,className:"w-full px-4 py-3 rounded-button bg-gray-100 text-text-primary font-medium",children:"Cancel"})})]})})}function AddReceiptModal({imageUri:es,currencySymbol:ts,onAdd:ss,onClose:ns}){const[rs,os]=reactExports.useState(""),[as,cs]=reactExports.useState(""),[ls,us]=reactExports.useState("Kit Supplies"),[ds,xs]=reactExports.useState(""),[fs,gs]=reactExports.useState(new Date().toISOString().split("T")[0]),Es=js=>{js.preventDefault(),!(!rs||!as)&&ss({date:fs,vendor:rs,amount:parseFloat(as),category:ls,description:ds,imageUri:es||void 0})};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/50",children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-t-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"sticky top-0 bg-card border-b border-border px-4 py-3 flex items-center justify-between",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Add Receipt"}),jsxRuntimeExports.jsx("button",{onClick:ns,className:"p-2 -mr-2 text-text-muted hover:text-text-primary transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("form",{onSubmit:Es,className:"p-4 space-y-4",children:[es&&jsxRuntimeExports.jsx("div",{className:"relative aspect-[4/3] rounded-lg overflow-hidden bg-gray-100",children:jsxRuntimeExports.jsx("img",{src:es,alt:"Receipt",className:"w-full h-full object-contain"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:"Vendor / Store"}),jsxRuntimeExports.jsx("input",{type:"text",value:rs,onChange:js=>os(js.target.value),className:"input-field w-full",placeholder:"e.g., Camera Ready Cosmetics",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:"Amount"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted",children:ts}),jsxRuntimeExports.jsx("input",{type:"number",step:"0.01",value:as,onChange:js=>cs(js.target.value),className:"input-field w-full pl-7",placeholder:"0.00",required:!0})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:"Date"}),jsxRuntimeExports.jsx("input",{type:"date",value:fs,onChange:js=>gs(js.target.value),className:"input-field w-full"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:"Category"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:CATEGORIES.map(js=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>us(js),className:`px-3 py-1.5 text-xs font-medium rounded-full border transition-all ${ls===js?"bg-gold text-white border-gold":"bg-white text-text-secondary border-border hover:border-gold/50"}`,children:js},js))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1.5",children:"Description (optional)"}),jsxRuntimeExports.jsx("input",{type:"text",value:ds,onChange:js=>xs(js.target.value),className:"input-field w-full",placeholder:"e.g., Foundation restocks"})]}),jsxRuntimeExports.jsxs("div",{className:"pt-2 flex gap-3",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:ns,className:"flex-1 px-4 py-3 rounded-button bg-gray-100 text-text-primary font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 rounded-button gold-gradient text-white font-medium",disabled:!rs||!as,children:"Add Receipt"})]})]})]})})}const getSystemTheme=()=>typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",resolveTheme=es=>es==="system"?getSystemTheme():es,applyTheme=es=>{if(typeof document<"u"){const ts=document.documentElement;ts.classList.remove("light","dark"),ts.classList.add(es);const ss=document.querySelector('meta[name="theme-color"]');ss&&ss.setAttribute("content",es==="dark"?"#000000":"#f5f4f2")}},useThemeStore=create()(persist(es=>({theme:"light",resolvedTheme:"light",setTheme:ts=>{const ss=resolveTheme(ts);applyTheme(ss),es({theme:ts,resolvedTheme:ss})}}),{name:"hair-makeup-theme-storage",storage:createJSONStorage(()=>localStorage),onRehydrateStorage:()=>es=>{if(es){const ts=resolveTheme(es.theme);applyTheme(ts),es.resolvedTheme=ts}}}));typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",es=>{if(useThemeStore.getState().theme==="system"){const ss=es.matches?"dark":"light";applyTheme(ss),useThemeStore.setState({resolvedTheme:ss})}});const API_ENDPOINT="/api/ai",SYSTEM_PROMPT=`You are Claude, an AI assistant specialized in film and television hair, makeup, and continuity production. You're helping a hair and makeup professional manage their work on set.

You have access to their project data including:
- Characters and their looks
- Scene breakdowns with H&MU requirements
- Continuity tracking and events
- Timesheet and hours data
- Budget information

Be helpful, concise, and production-focused. Use industry terminology appropriately. When discussing looks or continuity, be specific about products, techniques, and timing.

Keep responses focused and practical - these users are often on set and need quick, actionable information.`,useChatStore=create()(persist((es,ts)=>({messages:[],isOpen:!1,isLoading:!1,error:null,toggleChat:()=>es(ss=>({isOpen:!ss.isOpen})),openChat:()=>es({isOpen:!0}),closeChat:()=>es({isOpen:!1}),addMessage:(ss,ns)=>{const rs={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:ss,content:ns,timestamp:new Date};es(os=>({messages:[...os.messages.slice(-49),rs]}))},clearMessages:()=>es({messages:[],error:null}),setLoading:ss=>es({isLoading:ss}),setError:ss=>es({error:ss}),sendMessage:async(ss,ns)=>{var cs,ls;const{addMessage:rs,setLoading:os,setError:as}=ts();rs("user",ss),os(!0),as(null);try{const us=ts().messages.slice(-10).map(Es=>({role:Es.role,content:Es.content})),ds=`${SYSTEM_PROMPT}

Current Project Context:
${ns}`,xs=await fetch(API_ENDPOINT,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:us,system:ds,maxTokens:1024,model:"claude-sonnet-4-20250514"})});if(!xs.ok){const Es=await xs.json().catch(()=>({}));throw new Error(Es.error||`API error: ${xs.status}`)}const fs=await xs.json(),gs=((ls=(cs=fs.content)==null?void 0:cs[0])==null?void 0:ls.text)||fs.completion||"Sorry, I could not generate a response.";rs("assistant",gs)}catch(us){const ds=us instanceof Error?us.message:"Failed to send message";as(ds),rs("assistant",`Sorry, I encountered an error: ${ds}`)}finally{os(!1)}}}),{name:"hair-makeup-chat-storage",storage:createJSONStorage(()=>localStorage),partialize:es=>({messages:es.messages.slice(-50)})})),scriptRel="modulepreload",assetsURL=function(es){return"/mobile/"+es},seen={},__vitePreload=function es(ts,ss,ns){let rs=Promise.resolve();if(ss&&ss.length>0){document.getElementsByTagName("link");const as=document.querySelector("meta[property=csp-nonce]"),cs=(as==null?void 0:as.nonce)||(as==null?void 0:as.getAttribute("nonce"));rs=Promise.allSettled(ss.map(ls=>{if(ls=assetsURL(ls),ls in seen)return;seen[ls]=!0;const us=ls.endsWith(".css"),ds=us?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${ls}"]${ds}`))return;const xs=document.createElement("link");if(xs.rel=us?"stylesheet":scriptRel,us||(xs.as="script"),xs.crossOrigin="",xs.href=ls,cs&&xs.setAttribute("nonce",cs),document.head.appendChild(xs),us)return new Promise((fs,gs)=>{xs.addEventListener("load",fs),xs.addEventListener("error",()=>gs(new Error(`Unable to preload CSS for ${ls}`)))})}))}function os(as){const cs=new Event("vite:preloadError",{cancelable:!0});if(cs.payload=as,window.dispatchEvent(cs),!cs.defaultPrevented)throw as}return rs.then(as=>{for(const cs of as||[])cs.status==="rejected"&&os(cs.reason);return ts().catch(os)})};function ProjectExportScreen({onBack:es,onExportComplete:ts}){var ys;const{currentProject:ss,lifecycle:ns,sceneCaptures:rs}=useProjectStore(),[os,as]=reactExports.useState(EXPORT_DOCUMENTS.map(Rs=>({...Rs}))),[cs,ls]=reactExports.useState("download"),[us,ds]=reactExports.useState({status:"idle",progress:0}),xs=()=>{let Rs=0;return os.filter(Ns=>Ns.selected).forEach(Ns=>{switch(Ns.id){case"continuity_bible":Rs+=2*1024*1024;break;case"scene_breakdown":Rs+=50*1024;break;case"character_lookbooks":Rs+=((ss==null?void 0:ss.characters.length)||0)*1024*1024;break;case"photo_archive":const Ss=Object.values(rs).reduce((Ts,Cs)=>{let Ms=0;return Cs.photos.front&&Ms++,Cs.photos.left&&Ms++,Cs.photos.right&&Ms++,Cs.photos.back&&Ms++,Ms+=Cs.additionalPhotos.length,Ts+Ms},0);Rs+=Ss*500*1024;break;case"timesheets":Rs+=200*1024;break;case"invoice_summary":Rs+=100*1024;break}}),Rs<1024*1024?`~${Math.round(Rs/1024)} KB`:`~${Math.round(Rs/(1024*1024))} MB`},fs=Rs=>{as(bs=>bs.map(Ns=>Ns.id===Rs?{...Ns,selected:!Ns.selected}:Ns))},gs=()=>{const Rs=os.every(bs=>bs.selected);as(bs=>bs.map(Ns=>({...Ns,selected:!Rs})))},Es=Rs=>{switch(Rs){case"pdf":return"bg-red-100 text-red-700";case"csv":case"excel":return"bg-green-100 text-green-700";case"zip":case"pdf_zip":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},js=Rs=>{switch(Rs){case"pdf":return"PDF";case"csv":return"CSV";case"excel":return"Excel";case"zip":return"ZIP";case"pdf_zip":return"PDF (zip)";default:return Rs.toUpperCase()}},ps=async()=>{const Rs=os.filter(bs=>bs.selected).map(bs=>bs.id);if(Rs.length!==0){ds({status:"preparing",progress:0});try{for(let bs=0;bs<Rs.length;bs++){const Ns=Rs[bs];ds({status:"generating",currentDocument:Ns,progress:Math.round(bs/Rs.length*80)}),await new Promise(Ss=>setTimeout(Ss,500))}ds({status:"packaging",progress:90}),await new Promise(bs=>setTimeout(bs,500)),await ms(Rs),ds({status:"complete",progress:100}),setTimeout(()=>{ts==null||ts()},1500)}catch(bs){ds({status:"error",progress:0,error:bs instanceof Error?bs.message:"Export failed"})}}},ms=async Rs=>{const{generateContinuityBiblePDF:bs}=await __vitePreload(async()=>{const{generateContinuityBiblePDF:Ts}=await import("./exportUtils-DCx8uTPJ.js");return{generateContinuityBiblePDF:Ts}},[]),{generateSceneBreakdownCSV:Ns}=await __vitePreload(async()=>{const{generateSceneBreakdownCSV:Ts}=await import("./exportUtils-DCx8uTPJ.js");return{generateSceneBreakdownCSV:Ts}},[]),Ss=[];if(ss){for(const Ts of Rs)switch(Ts){case"continuity_bible":const Cs=bs(ss,rs);Ss.push({filename:`${ss.name}_Continuity_Bible.html`,content:Cs,mimeType:"text/html"});break;case"scene_breakdown":const Ms=Ns(ss,rs);Ss.push({filename:`${ss.name}_Scene_Breakdown.csv`,content:Ms,mimeType:"text/csv"});break}for(const Ts of Ss){const Cs=new Blob([Ts.content],{type:Ts.mimeType}),Ms=URL.createObjectURL(Cs);if(Ts.mimeType==="text/html"){const Is=window.open(Ms,"_blank");Is&&Is.addEventListener("load",()=>{setTimeout(()=>Is.print(),500)})}else{const Is=document.createElement("a");Is.href=Ms,Is.download=Ts.filename,document.body.appendChild(Is),Is.click(),document.body.removeChild(Is)}URL.revokeObjectURL(Ms)}}},hs=os.filter(Rs=>Rs.selected).length,vs=os.every(Rs=>Rs.selected),ws=()=>ns.wrappedAt?new Date(ns.wrappedAt).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"}):new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});return ss?jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background pb-safe-bottom",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Export Project"}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted",children:[ss.name,"  Wrapped ",ws()]})]})]})})}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light",children:"SELECT DOCUMENTS"}),jsxRuntimeExports.jsx("button",{onClick:gs,className:"text-sm font-medium text-gold active:opacity-70 transition-opacity",children:vs?"Deselect All":"Select All"})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 mb-6",children:os.map(Rs=>jsxRuntimeExports.jsxs("button",{onClick:()=>fs(Rs.id),className:`w-full card flex items-start gap-3 text-left transition-all ${Rs.selected?"border-2 border-gold bg-gold/5":""}`,children:[jsxRuntimeExports.jsx("div",{className:`mt-0.5 w-5 h-5 rounded flex-shrink-0 flex items-center justify-center border-2 transition-colors ${Rs.selected?"bg-gold border-gold":"border-border"}`,children:Rs.selected&&jsxRuntimeExports.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold text-text-primary",children:Rs.name}),jsxRuntimeExports.jsx("span",{className:`px-2 py-0.5 text-[10px] font-medium rounded ${Es(Rs.format)}`,children:js(Rs.format)})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:Rs.description})]})]},Rs.id))}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"DELIVERY METHOD"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"download",label:"Save to Device",icon:"download"},{id:"share",label:"Share",icon:"share"}].map(Rs=>jsxRuntimeExports.jsxs("button",{onClick:()=>ls(Rs.id),className:`p-3 rounded-xl border-2 text-center transition-all ${cs===Rs.id?"border-gold bg-gold/5":"border-border bg-card"}`,children:[jsxRuntimeExports.jsx("div",{className:`w-8 h-8 mx-auto mb-2 rounded-lg flex items-center justify-center ${cs===Rs.id?"bg-gold text-white":"bg-gray-100 text-text-muted"}`,children:Rs.icon==="download"?jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}):jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium text-text-primary",children:Rs.label})]},Rs.id))})]}),us.status!=="idle"&&jsxRuntimeExports.jsx("div",{className:"mb-6 p-4 bg-card rounded-xl border border-border",children:us.status==="error"?jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-red-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-error",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-error font-medium",children:us.error})]}):us.status==="complete"?jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-green-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-primary font-medium",children:"Export Complete!"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm text-text-primary font-medium",children:[us.status==="preparing"&&"Preparing export...",us.status==="generating"&&`Generating ${((ys=os.find(Rs=>Rs.id===us.currentDocument))==null?void 0:ys.name)||""}...`,us.status==="packaging"&&"Packaging files..."]}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-text-muted",children:[us.progress,"%"]})]}),jsxRuntimeExports.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gold rounded-full transition-all duration-300",style:{width:`${us.progress}%`}})})]})}),jsxRuntimeExports.jsx("button",{onClick:ps,disabled:hs===0||["preparing","generating","packaging"].includes(us.status),className:`w-full py-4 rounded-button font-semibold text-base shadow-lg transition-all ${hs===0?"bg-gray-200 text-text-light cursor-not-allowed":["preparing","generating","packaging"].includes(us.status)?"bg-gold/70 text-white cursor-wait":"gold-gradient text-white active:scale-[0.98]"}`,children:["preparing","generating","packaging"].includes(us.status)?jsxRuntimeExports.jsxs("span",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Exporting..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["Export ",hs>0?`${hs} Selected`:"Documents",hs>0&&jsxRuntimeExports.jsxs("span",{className:"ml-2 opacity-80",children:["(",xs(),")"]})]})}),jsxRuntimeExports.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-xs font-semibold text-text-muted uppercase mb-3",children:"Project Summary"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-lg font-bold text-text-primary",children:ss.scenes.length}),jsxRuntimeExports.jsx("div",{className:"text-xs text-text-muted",children:"Scenes"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-lg font-bold text-text-primary",children:ss.characters.length}),jsxRuntimeExports.jsx("div",{className:"text-xs text-text-muted",children:"Characters"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-lg font-bold text-text-primary",children:ss.looks.length}),jsxRuntimeExports.jsx("div",{className:"text-xs text-text-muted",children:"Looks"})]})]})]})]})]}):null}const useBillingStore=create()(persist((es,ts)=>({billingDetails:createEmptyBillingDetails(),isLoading:!1,isSaving:!1,lastError:null,setBillingDetails:ss=>{es({billingDetails:{...ss,lastUpdated:new Date},lastError:null})},updatePersonalInfo:ss=>{es(ns=>({billingDetails:{...ns.billingDetails,...ss,lastUpdated:new Date},lastError:null}))},updateBankDetails:ss=>{es(ns=>({billingDetails:{...ns.billingDetails,bankDetails:{...ns.billingDetails.bankDetails,...ss},lastUpdated:new Date},lastError:null}))},updatePaymentTerms:ss=>{es(ns=>({billingDetails:{...ns.billingDetails,paymentTerms:ss,lastUpdated:new Date},lastError:null}))},updateVATSettings:ss=>{es(ns=>({billingDetails:{...ns.billingDetails,vatSettings:{...ns.billingDetails.vatSettings,...ss},lastUpdated:new Date},lastError:null}))},toggleVATRegistered:()=>{es(ss=>({billingDetails:{...ss.billingDetails,vatSettings:{...ss.billingDetails.vatSettings,isVATRegistered:!ss.billingDetails.vatSettings.isVATRegistered},lastUpdated:new Date},lastError:null}))},resetBillingDetails:()=>{es({billingDetails:createEmptyBillingDetails(),lastError:null})},isBillingComplete:()=>{const{billingDetails:ss}=ts(),{bankDetails:ns,vatSettings:rs}=ss,os=!!(ss.fullName&&ss.address&&ss.email),as=!!(ns.accountName&&ns.sortCode&&ns.accountNumber),cs=!rs.isVATRegistered||!!rs.vatNumber;return os&&as&&cs},getValidationErrors:()=>{const{billingDetails:ss}=ts(),{bankDetails:ns,vatSettings:rs}=ss,os=[];return ss.fullName||os.push("Full name is required"),ss.address||os.push("Address is required"),ss.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ss.email)||os.push("Email format is invalid"):os.push("Email is required"),ns.accountName||os.push("Bank account name is required"),ns.sortCode?/^\d{2}-?\d{2}-?\d{2}$/.test(ns.sortCode.replace(/\s/g,""))||os.push("Sort code should be 6 digits (e.g., 12-34-56)"):os.push("Sort code is required"),ns.accountNumber?/^\d{8}$/.test(ns.accountNumber.replace(/\s/g,""))||os.push("Account number should be 8 digits"):os.push("Account number is required"),rs.isVATRegistered&&!rs.vatNumber&&os.push("VAT number is required when VAT registered"),(rs.vatRate<0||rs.vatRate>100)&&os.push("VAT rate must be between 0 and 100"),os}}),{name:"checks-happy-billing",storage:createJSONStorage(()=>localStorage),partialize:es=>({billingDetails:es.billingDetails})})),formatSortCode=es=>{const ts=es.replace(/\D/g,"");return ts.length<=2?ts:ts.length<=4?`${ts.slice(0,2)}-${ts.slice(2)}`:`${ts.slice(0,2)}-${ts.slice(2,4)}-${ts.slice(4,6)}`},formatAccountNumber=es=>es.replace(/\D/g,"").slice(0,8),BILLING_TIERS=["supervisor","designer"];function BillingDetailsScreen({onBack:es,onUpgrade:ts}){const{user:ss}=useAuthStore(),{billingDetails:ns,updatePersonalInfo:rs,updateBankDetails:os,updatePaymentTerms:as,updateVATSettings:cs,toggleVATRegistered:ls,isBillingComplete:us,getValidationErrors:ds}=useBillingStore(),[xs,fs]=reactExports.useState(!1),[gs,Es]=reactExports.useState(null),js=ss&&BILLING_TIERS.includes(ss.tier);reactExports.useEffect(()=>{if(gs){const vs=setTimeout(()=>Es(null),2e3);return()=>clearTimeout(vs)}},[gs]);const ps=()=>{fs(!0),ds().length===0&&Es("Details saved successfully")},ms=xs?ds():[],hs=us();return js?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Billing Details"})]}),hs&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 text-green-600 text-xs font-medium",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Complete"]})]})})}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-4 pb-safe-bottom",children:[gs&&jsxRuntimeExports.jsx("div",{className:"mb-4 px-4 py-2 bg-green-50 border border-green-200 rounded-lg text-sm text-green-700",children:gs}),ms.length>0&&jsxRuntimeExports.jsxs("div",{className:"mb-4 px-4 py-3 bg-red-50 border border-red-200 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-red-700 mb-2",children:"Please fix the following:"}),jsxRuntimeExports.jsx("ul",{className:"text-xs text-red-600 space-y-1",children:ms.map((vs,ws)=>jsxRuntimeExports.jsxs("li",{children:[" ",vs]},ws))})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"PERSONAL / BUSINESS INFORMATION"}),jsxRuntimeExports.jsxs("div",{className:"card space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"FULL NAME *"}),jsxRuntimeExports.jsx("input",{type:"text",value:ns.fullName,onChange:vs=>rs({fullName:vs.target.value}),placeholder:"John Smith",className:"input-field w-full"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"BUSINESS NAME"}),jsxRuntimeExports.jsx("input",{type:"text",value:ns.businessName,onChange:vs=>rs({businessName:vs.target.value}),placeholder:"Optional - if trading under a business name",className:"input-field w-full"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:"For freelancers trading under a company or trading name"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"ADDRESS *"}),jsxRuntimeExports.jsx("textarea",{value:ns.address,onChange:vs=>rs({address:vs.target.value}),placeholder:`123 High Street
London
SW1A 1AA`,rows:3,className:"input-field w-full resize-none"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"PHONE"}),jsxRuntimeExports.jsx("input",{type:"tel",value:ns.phone,onChange:vs=>rs({phone:vs.target.value}),placeholder:"+44 7700 900000",className:"input-field w-full"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"EMAIL *"}),jsxRuntimeExports.jsx("input",{type:"email",value:ns.email,onChange:vs=>rs({email:vs.target.value}),placeholder:"john@example.com",className:"input-field w-full"})]})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"BANK DETAILS FOR PAYMENT"}),jsxRuntimeExports.jsxs("div",{className:"card space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"ACCOUNT NAME *"}),jsxRuntimeExports.jsx("input",{type:"text",value:ns.bankDetails.accountName,onChange:vs=>os({accountName:vs.target.value}),placeholder:"John Smith",className:"input-field w-full"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Name as it appears on your bank account"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"SORT CODE *"}),jsxRuntimeExports.jsx("input",{type:"text",value:ns.bankDetails.sortCode,onChange:vs=>{const ws=formatSortCode(vs.target.value);os({sortCode:ws})},placeholder:"12-34-56",maxLength:8,className:"input-field w-full"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"ACCOUNT NUMBER *"}),jsxRuntimeExports.jsx("input",{type:"text",value:ns.bankDetails.accountNumber,onChange:vs=>{const ws=formatAccountNumber(vs.target.value);os({accountNumber:ws})},placeholder:"12345678",maxLength:8,className:"input-field w-full"})]})]})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"PAYMENT TERMS"}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"TERMS"}),jsxRuntimeExports.jsxs("select",{value:ns.paymentTerms,onChange:vs=>as(vs.target.value),className:"input-field w-full",children:[jsxRuntimeExports.jsx("option",{value:"Payment upon receipt",children:"Payment upon receipt"}),jsxRuntimeExports.jsx("option",{value:"Payment within 7 days",children:"Payment within 7 days"}),jsxRuntimeExports.jsx("option",{value:"Payment within 14 days",children:"Payment within 14 days"}),jsxRuntimeExports.jsx("option",{value:"Payment within 30 days",children:"Payment within 30 days"}),jsxRuntimeExports.jsx("option",{value:"Payment within 60 days",children:"Payment within 60 days"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-2",children:"This will appear on generated invoices"})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"VAT / TAX SETTINGS"}),jsxRuntimeExports.jsxs("div",{className:"card space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary block",children:"VAT Registered"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"Are you registered for VAT?"})]}),jsxRuntimeExports.jsx("button",{onClick:ls,className:`relative w-12 h-7 rounded-full transition-colors ${ns.vatSettings.isVATRegistered?"bg-gold":"bg-gray-200"}`,children:jsxRuntimeExports.jsx("span",{className:`absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform ${ns.vatSettings.isVATRegistered?"left-6":"left-1"}`})})]}),ns.vatSettings.isVATRegistered&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"VAT NUMBER *"}),jsxRuntimeExports.jsx("input",{type:"text",value:ns.vatSettings.vatNumber,onChange:vs=>cs({vatNumber:vs.target.value.toUpperCase()}),placeholder:"GB123456789",className:"input-field w-full"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:"UK format: GB followed by 9 digits"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-1",children:"VAT RATE (%)"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{type:"number",value:ns.vatSettings.vatRate,onChange:vs=>cs({vatRate:parseFloat(vs.target.value)||0}),min:"0",max:"100",step:"0.1",className:"input-field w-24"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"%"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Standard UK rate is 20%"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-border",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-medium text-text-muted mb-2",children:"INVOICE PREVIEW"}),jsxRuntimeExports.jsxs("div",{className:"space-y-1 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-text-muted",children:"Subtotal (ex VAT)"}),jsxRuntimeExports.jsx("span",{className:"text-text-primary",children:"1,000.00"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsxs("span",{className:"text-text-muted",children:["VAT (",ns.vatSettings.vatRate,"%)"]}),jsxRuntimeExports.jsxs("span",{className:"text-text-primary",children:["",(1e3*ns.vatSettings.vatRate/100).toFixed(2)]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between font-semibold pt-1 border-t border-border",children:[jsxRuntimeExports.jsx("span",{className:"text-text-primary",children:"Total (inc VAT)"}),jsxRuntimeExports.jsxs("span",{className:"text-gold",children:["",(1e3*(1+ns.vatSettings.vatRate/100)).toFixed(2)]})]})]})]})]}),!ns.vatSettings.isVATRegistered&&jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"If you're not VAT registered, your invoices will not include VAT calculations. You can register for VAT at any time if your taxable turnover exceeds the threshold."})]})]}),jsxRuntimeExports.jsxs("div",{className:"sticky bottom-0 bg-background pt-4 pb-safe-bottom",children:[jsxRuntimeExports.jsx("button",{onClick:ps,className:"w-full py-3 rounded-button gold-gradient text-white font-medium active:scale-98 transition-transform",children:"Save Details"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted text-center mt-2",children:"Details are saved automatically and will appear on your invoices"})]})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Billing Details"})]})})}),jsxRuntimeExports.jsx("div",{className:"mobile-container px-4 py-8",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-full bg-gold/10 flex items-center justify-center mx-auto mb-4",children:jsxRuntimeExports.jsx("svg",{className:"w-10 h-10 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z"})})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Invoice Generation"}),jsxRuntimeExports.jsx("p",{className:"text-text-muted mb-6 max-w-xs mx-auto",children:"Upgrade to Supervisor or Designer to generate professional invoices with your billing details."}),jsxRuntimeExports.jsx("button",{onClick:ts,className:"px-6 py-2.5 rounded-button gold-gradient text-white text-sm font-medium active:scale-95 transition-transform",children:"Upgrade to Supervisor"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-3",children:"Starting at 9.99/month"})]})})]})}function FeatureList({features:es,variant:ts="default",showCheckmarks:ss=!0}){return jsxRuntimeExports.jsx("ul",{className:clsx("space-y-2",ts==="compact"&&"space-y-1.5"),children:es.map((ns,rs)=>jsxRuntimeExports.jsxs("li",{className:clsx("flex items-start gap-2",ts==="compact"?"text-xs":"text-sm","text-text-secondary"),children:[ss&&jsxRuntimeExports.jsx("span",{className:"flex-shrink-0 mt-0.5",children:jsxRuntimeExports.jsx("svg",{className:clsx("text-gold",ts==="compact"?"w-3.5 h-3.5":"w-4 h-4"),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})})}),jsxRuntimeExports.jsx("span",{children:ns})]},rs))})}function FeatureLossList({features:es}){return es.length===0?null:jsxRuntimeExports.jsx("ul",{className:"space-y-2",children:es.map((ts,ss)=>jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2 text-sm text-red-600",children:[jsxRuntimeExports.jsx("span",{className:"flex-shrink-0 mt-0.5",children:jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),jsxRuntimeExports.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),jsxRuntimeExports.jsx("span",{children:ts})]},ss))})}function TierCard({tier:es,billingPeriod:ts,isSelected:ss=!1,isCurrentPlan:ns=!1,onSelect:rs,disabled:os=!1}){const{id:as,name:cs,description:ls,pricing:us,featureList:ds,isPopular:xs,isPremium:fs}=es,gs=()=>as==="trainee"?"Free":ts==="per_project"&&as==="designer"&&us.perProject?formatPrice(us.perProject,us.currencySymbol):formatPrice(ts==="yearly"?us.yearly:us.monthly,us.currencySymbol),Es=()=>as==="trainee"?"forever":ts==="per_project"&&as==="designer"?"per project":ts==="yearly"?"/year":"/month",js=()=>as==="trainee"||ts!=="yearly"?null:`${formatMonthlyEquivalent(us.yearly,us.currencySymbol)}/mo`,ps=()=>ns?"Current Plan":as==="trainee"?"Start Free":"Subscribe",ms=()=>ss||ns?"primary":"outline",hs=js();return jsxRuntimeExports.jsxs("div",{className:clsx("relative rounded-xl p-4 transition-all duration-200","border-2",{"border-gold bg-gold-50/50":ss&&!ns,"border-gold bg-gold-50/30":ns,"border-gold/30 bg-gradient-to-br from-gold-50/20 to-transparent":fs&&!ss&&!ns,"border-border bg-card":!ss&&!ns&&!fs,"hover:border-gold/50":!ss&&!ns}),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[xs&&jsxRuntimeExports.jsx(Badge,{variant:"gold",size:"md",children:"Most Popular"}),fs&&jsxRuntimeExports.jsx(Badge,{variant:"gold",size:"md",children:"Premium"}),ns&&jsxRuntimeExports.jsx(Badge,{variant:"success",size:"md",children:"Current Plan"})]}),jsxRuntimeExports.jsx("h3",{className:clsx("text-lg font-bold mb-1",fs?"gold-text-gradient":"text-text-primary"),children:cs}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-secondary mb-4",children:ls}),jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-baseline gap-1",children:[jsxRuntimeExports.jsx("span",{className:clsx("text-3xl font-bold",as==="trainee"?"text-text-primary":"text-gold"),children:gs()}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:Es()})]}),hs&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["(",hs," billed annually)"]})]}),jsxRuntimeExports.jsx(FeatureList,{features:ds}),jsxRuntimeExports.jsx(Button,{variant:ms(),size:"md",fullWidth:!0,onClick:()=>rs(as),disabled:os||ns,className:"mt-4",children:ps()}),ss&&!ns&&jsxRuntimeExports.jsx("div",{className:"absolute top-3 right-3",children:jsxRuntimeExports.jsx("div",{className:"w-6 h-6 rounded-full bg-gold flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})})})})]})}function PriceToggle({value:es,onChange:ts,showPerProject:ss=!1}){const ns=[{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly",sublabel:"Save 20%"}];return ss&&ns.push({value:"per_project",label:"Per Project"}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center gap-1 p-1 bg-input-bg rounded-xl border border-border",children:ns.map(rs=>jsxRuntimeExports.jsxs("button",{onClick:()=>ts(rs.value),className:clsx("relative flex flex-col items-center justify-center px-4 py-2 rounded-lg transition-all duration-200","text-sm font-medium","min-w-[90px]",{"bg-gold text-white shadow-sm":es===rs.value,"text-text-secondary hover:text-text-primary":es!==rs.value}),children:[jsxRuntimeExports.jsx("span",{children:rs.label}),rs.sublabel&&jsxRuntimeExports.jsx("span",{className:clsx("text-[10px] font-semibold",es===rs.value?"text-white/80":"text-gold"),children:rs.sublabel})]},rs.value))})}const COMPARISON_FEATURES=[{label:"Photos per project",trainee:"50",artist:"500",supervisor:"1,000",designer:"Unlimited"},{label:"Projects",trainee:"3",artist:"10",supervisor:"25",designer:"Unlimited"},{label:"Archived projects",trainee:"1",artist:"Unlimited",supervisor:"15",designer:"Unlimited"},{label:"Offline mode",trainee:!1,artist:!0,supervisor:!0,designer:!0},{label:"Export PDF reports",trainee:!1,artist:!0,supervisor:!0,designer:!0},{label:"Personal templates",trainee:!1,artist:!0,supervisor:!0,designer:!0},{label:"Create projects",trainee:!1,artist:!1,supervisor:!0,designer:!0},{label:"Team management",trainee:!1,artist:!1,supervisor:!0,designer:!0},{label:"Team invite codes",trainee:!1,artist:!1,supervisor:!0,designer:!0},{label:"Character progression",trainee:!1,artist:!1,supervisor:!0,designer:!0},{label:"Shooting schedule",trainee:!1,artist:!1,supervisor:!0,designer:!0},{label:"Team photo storage",trainee:!1,artist:!1,supervisor:!1,designer:!0},{label:"Desktop web access",trainee:!1,artist:!1,supervisor:!1,designer:!0},{label:"Pre-production breakdown",trainee:!1,artist:!1,supervisor:!1,designer:!0},{label:"Character design docs",trainee:!1,artist:!1,supervisor:!1,designer:!0},{label:"Production books export",trainee:!1,artist:!1,supervisor:!1,designer:!0},{label:"Budget & scheduling",trainee:!1,artist:!1,supervisor:!1,designer:!0}],tierOrder=["trainee","artist","supervisor","designer"];function CheckIcon(){return jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-gold",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})})}function CrossIcon(){return jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4 text-text-muted",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),jsxRuntimeExports.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}function ComparisonModal({isOpen:es,onClose:ts,currentTier:ss}){const ns=SUBSCRIPTION_TIERS,rs=(os,as)=>typeof os=="boolean"?os?jsxRuntimeExports.jsx(CheckIcon,{}):jsxRuntimeExports.jsx(CrossIcon,{}):jsxRuntimeExports.jsx("span",{className:clsx("text-xs font-medium",as===ss?"text-gold":"text-text-secondary"),children:os});return jsxRuntimeExports.jsxs(BottomSheet,{isOpen:es,onClose:ts,title:"Compare Plans",height:"full",children:[jsxRuntimeExports.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:jsxRuntimeExports.jsxs("table",{className:"w-full min-w-[500px]",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-border",children:[jsxRuntimeExports.jsx("th",{className:"text-left py-3 pr-4 text-xs font-semibold text-text-muted uppercase tracking-wide",children:"Feature"}),ns.map(os=>jsxRuntimeExports.jsxs("th",{className:clsx("text-center py-3 px-2 text-xs font-bold uppercase tracking-wide",os.id===ss?"text-gold":"text-text-primary"),children:[os.name,os.id===ss&&jsxRuntimeExports.jsx("div",{className:"text-[9px] text-gold font-normal mt-0.5",children:"Current"})]},os.id))]})}),jsxRuntimeExports.jsxs("tbody",{children:[jsxRuntimeExports.jsxs("tr",{className:"border-b border-border bg-gold-50/30",children:[jsxRuntimeExports.jsx("td",{className:"py-3 pr-4 text-sm font-medium text-text-primary",children:"Price"}),ns.map(os=>jsxRuntimeExports.jsxs("td",{className:clsx("text-center py-3 px-2",os.id===ss?"bg-gold-50/50":""),children:[jsxRuntimeExports.jsx("span",{className:clsx("text-sm font-bold",os.id==="trainee"?"text-text-primary":"text-gold"),children:os.pricing.monthly===0?"Free":`${os.pricing.monthly.toFixed(2)}`}),os.pricing.monthly>0&&jsxRuntimeExports.jsx("span",{className:"text-[10px] text-text-muted block",children:"/month"})]},os.id))]}),COMPARISON_FEATURES.map((os,as)=>jsxRuntimeExports.jsxs("tr",{className:clsx("border-b border-border",as%2===0?"bg-transparent":"bg-input-bg/30"),children:[jsxRuntimeExports.jsx("td",{className:"py-2.5 pr-4 text-sm text-text-secondary",children:os.label}),tierOrder.map(cs=>jsxRuntimeExports.jsx("td",{className:clsx("text-center py-2.5 px-2",cs===ss?"bg-gold-50/30":""),children:jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:rs(os[cs],cs)})},cs))]},os.label))]})]})}),jsxRuntimeExports.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted text-center",children:"All prices in GBP. Cancel anytime. 7-day free trial on paid plans."})})]})}function SelectPlanScreen({isOnboarding:es=!0,currentTier:ts,onSelectTier:ss,onSkip:ns,onBack:rs,isLoading:os=!1}){const[as,cs]=reactExports.useState(es?null:ts||null),[ls,us]=reactExports.useState("monthly"),[ds,xs]=reactExports.useState(!1),[fs,gs]=reactExports.useState(!1),Es=ts&&as&&isTierHigher(ts,as)?getDowngradeWarnings(ts,as):[],js=ys=>{cs(ys),ts&&isTierHigher(ts,ys)?gs(!0):gs(!1)},ps=()=>{as&&ss&&ss(as,ls)},ms=()=>{ns?ns():ss&&ss("trainee","monthly")},hs=as!==null&&!os,vs=ts&&as&&isTierHigher(as,ts),ws=ts&&as&&isTierHigher(ts,as);return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[jsxRuntimeExports.jsxs("header",{className:"flex items-center px-4 py-3 safe-top border-b border-border bg-card",children:[rs&&jsxRuntimeExports.jsx("button",{onClick:rs,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 -ml-2","aria-label":"Go back",children:jsxRuntimeExports.jsxs("svg",{className:"w-6 h-6 text-text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M19 12H5"}),jsxRuntimeExports.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),jsxRuntimeExports.jsx("div",{className:clsx("flex-1",rs?"text-center pr-10":"text-center"),children:jsxRuntimeExports.jsx("h1",{className:"text-lg font-bold text-text-primary",children:"Choose Your Plan"})})]}),jsxRuntimeExports.jsx("div",{className:"px-6 pt-4 pb-2 text-center",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-text-secondary",children:"Select the tier that fits your role. You can upgrade anytime."})}),jsxRuntimeExports.jsx("div",{className:"px-6 py-4 flex justify-center",children:jsxRuntimeExports.jsx(PriceToggle,{value:ls,onChange:us,showPerProject:!1})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:[jsxRuntimeExports.jsx("div",{className:"space-y-4 max-w-md mx-auto",children:SUBSCRIPTION_TIERS.map(ys=>jsxRuntimeExports.jsx(TierCard,{tier:ys,billingPeriod:ls,isSelected:as===ys.id,isCurrentPlan:ts===ys.id,onSelect:js,disabled:os},ys.id))}),jsxRuntimeExports.jsx("div",{className:"text-center mt-6",children:jsxRuntimeExports.jsx("button",{onClick:()=>xs(!0),className:"text-sm text-gold font-medium hover:underline",children:"Compare all features"})}),jsxRuntimeExports.jsxs("div",{className:"mt-6 text-center space-y-1",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Cancel anytime"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"7-day free trial on paid plans"}),jsxRuntimeExports.jsx("button",{className:"text-xs text-gold hover:underline",children:"Questions? Contact us"})]}),fs&&Es.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg max-w-md mx-auto",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-semibold text-red-700 mb-2",children:"You'll lose access to:"}),jsxRuntimeExports.jsx(FeatureLossList,{features:Es}),jsxRuntimeExports.jsx("p",{className:"text-xs text-red-600 mt-3",children:"Changes take effect at the end of your billing period."})]})]}),jsxRuntimeExports.jsx("div",{className:"sticky bottom-0 left-0 right-0 p-4 pb-safe-bottom bg-card border-t border-border",children:jsxRuntimeExports.jsxs("div",{className:"max-w-md mx-auto space-y-3",children:[jsxRuntimeExports.jsx(Button,{variant:"primary",size:"lg",fullWidth:!0,onClick:ps,disabled:!hs,children:os?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",fill:"none",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Processing..."]}):as==="trainee"?"Start Free":ws?"Downgrade Plan":vs?"Upgrade Plan":as?"Subscribe":"Select a Plan"}),es&&jsxRuntimeExports.jsx("button",{onClick:ms,className:"w-full text-center text-sm text-text-muted hover:text-text-secondary",disabled:os,children:"Continue with Free for now"}),!es&&ts&&ts!=="trainee"&&jsxRuntimeExports.jsx("button",{className:"w-full text-center text-sm text-gold hover:underline",children:"Manage billing"})]})}),jsxRuntimeExports.jsx(ComparisonModal,{isOpen:ds,onClose:()=>xs(!1),currentTier:ts})]})}function SubscriptionSection({onChangePlan:es}){const{user:ts,subscription:ss}=useAuthStore();if(!ts)return null;const ns=getTierById(ts.tier);if(!ns)return null;const rs=()=>{if(!ss.billingPeriod||ts.tier==="trainee")return"Free forever";const cs=ss.billingPeriod==="yearly"?ns.pricing.yearly:ss.billingPeriod==="per_project"?ns.pricing.perProject:ns.pricing.monthly,ls=ss.billingPeriod==="yearly"?"/year":ss.billingPeriod==="per_project"?"/project":"/month";return`${formatPrice(cs||0,ns.pricing.currencySymbol)}${ls}`},as=!ss.currentPeriodEndsAt||ts.tier==="trainee"?null:new Date(ss.currentPeriodEndsAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});return jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"SUBSCRIPTION"}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-base font-semibold text-text-primary",children:ns.name}),ns.isPopular&&jsxRuntimeExports.jsx(Badge,{variant:"gold",size:"sm",children:"Popular"}),ns.isPremium&&jsxRuntimeExports.jsx(Badge,{variant:"gold",size:"sm",children:"Premium"})]}),ss.status==="active"&&jsxRuntimeExports.jsx(Badge,{variant:"success",size:"sm",children:"Active"}),ss.status==="trialing"&&jsxRuntimeExports.jsx(Badge,{variant:"gold",size:"sm",children:"Trial"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-secondary mb-4",children:ns.description}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 py-3 border-t border-border",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Current plan"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary",children:rs()})]}),as&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Next billing"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-primary",children:as})]}),ss.cancelAtPeriodEnd&&jsxRuntimeExports.jsx("div",{className:"mt-2 p-2 bg-amber-50 border border-amber-200 rounded-lg",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-amber-700",children:"Your subscription will cancel at the end of this billing period."})})]}),jsxRuntimeExports.jsxs("div",{className:"pt-3 border-t border-border space-y-2",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"w-full py-2.5 px-4 bg-gold-50/50 border border-gold/20 rounded-lg text-sm font-medium text-gold hover:bg-gold-100/50 transition-colors",children:ts.tier==="trainee"?"Upgrade Plan":"Change Plan"}),ts.tier!=="trainee"&&ss.status==="active"&&jsxRuntimeExports.jsx("button",{className:"w-full py-2.5 px-4 text-sm text-text-muted hover:text-text-secondary transition-colors",children:"Manage Billing"})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-3 card bg-input-bg/50",children:[jsxRuntimeExports.jsx("h3",{className:"text-xs font-semibold text-text-muted uppercase tracking-wide mb-2",children:"Your Limits"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-text-primary",children:ns.features.maxPhotosPerProject===-1?"Unlimited":ns.features.maxPhotosPerProject}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Photos/project"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-lg font-bold text-text-primary",children:ns.features.maxProjects===-1?"Unlimited":ns.features.maxProjects}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Active projects"})]})]})]})]})}function More({onNavigateToTab:es,onStartNewProject:ts,initialView:ss,resetKey:ns,subView:rs}){const os=()=>rs||(ss&&["script","schedule","callsheets","settings"].includes(ss)?ss:"menu"),[as,cs]=reactExports.useState(os),{isEditMenuOpen:ls,closeEditMenu:us,openEditMenu:ds}=useNavigationStore(),{projectMemberships:xs,user:fs}=useAuthStore(),{projectSettings:gs,clearState:Es}=useProjectSettingsStore(),js=xs.length>0?xs[0]:null,ps=(js==null?void 0:js.role)==="owner",ms=js&&fs?canManageProject(fs.tier,{isOwner:ps,role:ps?"designer":js.role==="supervisor"?"supervisor":"trainee"}):!1;reactExports.useEffect(()=>{rs?cs(rs):ss&&["script","schedule","callsheets","settings"].includes(ss)?cs(ss):ss==="more"&&cs("menu")},[ss,ns,rs]);const hs=ls?"editMenu":as,vs=bs=>{bs==="editMenu"?ds():cs(bs)},ws=()=>{us(),cs("menu")},ys=()=>{ss&&["script","schedule","callsheets","settings"].includes(ss)?es==null||es("today"):cs("menu")},Rs=()=>{switch(hs){case"script":return jsxRuntimeExports.jsx(ScriptViewer,{onBack:ys});case"schedule":return jsxRuntimeExports.jsx(ScheduleViewer,{onBack:ys});case"callsheets":return jsxRuntimeExports.jsx(CallSheetArchive,{onBack:ys});case"settings":return jsxRuntimeExports.jsx(Settings,{onBack:ys,onStartNewProject:ts,onNavigateToExport:()=>cs("export"),onNavigateToArchived:()=>cs("archivedProjects"),onNavigateToProjectSettings:()=>cs("projectSettings"),onNavigateToTeam:()=>cs("team"),onNavigateToInvite:()=>cs("invite"),onNavigateToStats:()=>cs("projectStats"),onNavigateToBilling:()=>cs("billing"),canManage:ms});case"editMenu":return jsxRuntimeExports.jsx(EditMenuScreen,{onDone:ws});case"export":return jsxRuntimeExports.jsx(ProjectExportScreen,{onBack:()=>cs("settings"),onExportComplete:()=>cs("settings")});case"archivedProjects":return jsxRuntimeExports.jsx(ArchivedProjectsScreen,{onBack:()=>cs("settings")});case"projectSettings":return jsxRuntimeExports.jsx(ProjectSettingsScreen,{projectId:(js==null?void 0:js.projectId)||"",onBack:()=>cs("settings"),onNavigateToSchedule:()=>cs("manualSchedule"),onProjectArchived:()=>{Es(),cs("settings")},onProjectDeleted:()=>{Es(),ts==null||ts()}});case"team":return jsxRuntimeExports.jsx(TeamScreen,{projectId:(js==null?void 0:js.projectId)||"",canManage:ms,isOwner:ps,onBack:()=>cs("settings"),onInvite:()=>cs("invite")});case"invite":return jsxRuntimeExports.jsx(InviteScreen,{inviteCode:(gs==null?void 0:gs.inviteCode)||(js==null?void 0:js.projectCode)||"",isOwner:ps,onBack:()=>cs("team")});case"projectStats":return jsxRuntimeExports.jsx(ProjectStatsScreen,{projectId:(js==null?void 0:js.projectId)||"",onBack:()=>cs("settings")});case"manualSchedule":return jsxRuntimeExports.jsx(ScheduleScreen,{onBack:()=>cs("projectSettings"),onSaved:()=>cs("projectSettings")});case"billing":return jsxRuntimeExports.jsx(BillingDetailsScreen,{onBack:()=>cs("settings"),onUpgrade:()=>{useAuthStore.getState().setScreen("select-plan")}});default:return jsxRuntimeExports.jsx(MoreMenu,{onNavigate:vs,onNavigateToTab:es})}};return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-background pb-safe-bottom",children:Rs()})}function MoreMenu({onNavigate:es,onNavigateToTab:ts}){const{getMoreMenuItems:ss}=useNavigationStore(),rs=ss().map(cs=>ALL_NAV_ITEMS.find(ls=>ls.id===cs)).filter(Boolean),os=cs=>{switch(cs){case"lookbook":return"Character looks and styles";case"script":return"View script PDF with scene search";case"schedule":return"Shooting schedule day-by-day";case"callsheets":return"Upload and manage call sheets";case"settings":return"Rate card, sync, preferences";case"today":return"Today's shooting schedule";case"breakdown":return"Scene breakdown by character";case"hours":return"Timesheet and earnings";case"budget":return"Expenses overview, scan receipts";default:return""}},as=cs=>{["script","schedule","callsheets","settings"].includes(cs)?es(cs):ts&&ts(cs)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsx("div",{className:"h-14 px-4 flex items-center",children:jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"More"})})})}),jsxRuntimeExports.jsx("div",{className:"mobile-container px-4 py-4",children:jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[rs.map(cs=>jsxRuntimeExports.jsxs("button",{onClick:()=>as(cs.id),className:"w-full card flex items-center gap-4 active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-xl bg-gold-100/50 flex items-center justify-center text-gold",children:jsxRuntimeExports.jsx(NavIcon,{name:cs.iconName,className:"w-6 h-6"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:cs.label}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:os(cs.id)})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]},cs.id)),jsxRuntimeExports.jsx("div",{className:"pt-4 border-t border-border mt-4",children:jsxRuntimeExports.jsxs("button",{onClick:()=>es("editMenu"),className:"w-full card flex items-center gap-4 active:scale-[0.98] transition-transform",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-text-muted",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"Edit Menu"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Customize bottom navigation"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})})]})})]})}function EditMenuScreen({onDone:es}){var Ks,Ds;const{bottomNavItems:ts,setBottomNavItems:ss,moveToBottomNav:ns,moveToMoreMenu:rs}=useNavigationStore(),[os,as]=reactExports.useState(null),[cs,ls]=reactExports.useState(null),[us,ds]=reactExports.useState(null),[xs,fs]=reactExports.useState(!1),[gs,Es]=reactExports.useState(null),js=reactExports.useRef(null),ps=reactExports.useRef(null),ms=reactExports.useRef(new Map),hs=reactExports.useRef(null),vs=reactExports.useRef(null),ws=ALL_NAV_ITEMS.filter($s=>!ts.includes($s.id)),ys=ts.map($s=>ALL_NAV_ITEMS.find(Xs=>Xs.id===$s)).filter(Boolean),Rs=reactExports.useCallback($s=>{as($s)},[]),bs=reactExports.useCallback(()=>{os&&cs!==null&&us&&(us==="bottom"?ns(os,cs):us==="more"&&rs(os)),as(null),ls(null),ds(null),fs(!1),Es(null)},[os,cs,us,ns,rs]),Ns=reactExports.useCallback(($s,Xs)=>{ds($s),ls(Xs)},[]),Ss=reactExports.useCallback($s=>{const Xs=hs.current,Fs=vs.current;if(Xs){const As=Xs.getBoundingClientRect();if($s>=As.top&&$s<=As.bottom){let _s=ys.length;for(let Ps=0;Ps<ys.length;Ps++){const Hs=ms.current.get(`bottom-${ys[Ps].id}`);if(Hs){const Ls=Hs.getBoundingClientRect(),Os=Ls.top+Ls.height/2;if($s<Os){_s=Ps;break}}}ds("bottom"),ls(_s);return}}if(Fs){const As=Fs.getBoundingClientRect();if($s>=As.top&&$s<=As.bottom){ds("more"),ls(0);return}}ds(null),ls(null)},[ys]),Ts=reactExports.useCallback(($s,Xs)=>{const Fs=$s.touches[0];js.current={x:Fs.clientX,y:Fs.clientY,item:Xs},ps.current=setTimeout(()=>{as(Xs),fs(!0),Es({x:Fs.clientX,y:Fs.clientY}),"vibrate"in navigator&&navigator.vibrate(50)},200)},[]),Cs=reactExports.useCallback($s=>{const Xs=$s.touches[0];if(!js.current)return;const Fs=Math.abs(Xs.clientX-js.current.x),As=Math.abs(Xs.clientY-js.current.y);if(!xs&&(Fs>10||As>10)&&ps.current){clearTimeout(ps.current),ps.current=null;return}xs&&($s.preventDefault(),Es({x:Xs.clientX,y:Xs.clientY}),Ss(Xs.clientY))},[xs,Ss]),Ms=reactExports.useCallback(()=>{ps.current&&(clearTimeout(ps.current),ps.current=null),js.current=null,xs&&bs()},[xs,bs]),Is=reactExports.useCallback(()=>{ps.current&&(clearTimeout(ps.current),ps.current=null),js.current=null,as(null),ls(null),ds(null),fs(!1),Es(null)},[]),Qs=reactExports.useCallback($s=>{$s.preventDefault(),$s.stopPropagation();const Xs=$s.touches[0];Es({x:Xs.clientX,y:Xs.clientY}),Ss(Xs.clientY)},[Ss]),Ys=reactExports.useCallback($s=>{$s.preventDefault(),Ms()},[Ms]),Zs=($s,Xs)=>{const Fs=[...ts],[As]=Fs.splice($s,1);Fs.splice(Xs,0,As),ss(Fs)},Vs=reactExports.useCallback(($s,Xs)=>{Xs?ms.current.set($s,Xs):ms.current.delete($s)},[]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Customize Menu"}),jsxRuntimeExports.jsx("button",{onClick:es,className:"px-4 py-1.5 text-sm font-semibold text-gold active:opacity-70 transition-opacity",children:"Done"})]})})}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-4",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm text-text-muted mb-6",children:["Drag items to reorder. Up to ",MAX_BOTTOM_NAV_ITEMS," appear in bottom nav."]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",ref:hs,children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"BOTTOM NAV"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[ys.map(($s,Xs)=>jsxRuntimeExports.jsx(DraggableItem,{item:$s,index:Xs,section:"bottom",isDragging:os===$s.id,isDragOver:us==="bottom"&&cs===Xs,onDragStart:()=>Rs($s.id),onDragEnd:bs,onDragOver:()=>Ns("bottom",Xs),onTouchStart:Fs=>Ts(Fs,$s.id),onTouchMove:Cs,onTouchEnd:Ms,onTouchCancel:Is,onMoveUp:Xs>0?()=>Zs(Xs,Xs-1):void 0,onMoveDown:Xs<ys.length-1?()=>Zs(Xs,Xs+1):void 0,onRemove:ys.length>1?()=>rs($s.id):void 0,refCallback:Fs=>Vs(`bottom-${$s.id}`,Fs)},$s.id)),ts.length<MAX_BOTTOM_NAV_ITEMS&&jsxRuntimeExports.jsx("div",{className:`border-2 border-dashed rounded-xl p-4 text-center transition-colors ${us==="bottom"&&cs===ts.length?"border-gold bg-gold/5":"border-border"}`,onDragOver:$s=>{$s.preventDefault(),Ns("bottom",ts.length)},onDrop:bs,children:jsxRuntimeExports.jsx("span",{className:"text-sm text-text-light",children:"Drop here to add"})})]})]}),jsxRuntimeExports.jsx("div",{className:"border-t border-border mb-6"}),jsxRuntimeExports.jsxs("div",{ref:vs,children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"MORE MENU"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[ws.map(($s,Xs)=>jsxRuntimeExports.jsx(DraggableItem,{item:$s,index:Xs,section:"more",isDragging:os===$s.id,isDragOver:us==="more"&&cs===Xs,onDragStart:()=>Rs($s.id),onDragEnd:bs,onDragOver:()=>Ns("more",Xs),onTouchStart:Fs=>Ts(Fs,$s.id),onTouchMove:Cs,onTouchEnd:Ms,onTouchCancel:Is,onAddToNav:ts.length<MAX_BOTTOM_NAV_ITEMS?()=>ns($s.id,ts.length):void 0,refCallback:Fs=>Vs(`more-${$s.id}`,Fs)},$s.id)),ws.length===0&&jsxRuntimeExports.jsx("div",{className:"text-center py-6 text-text-light text-sm",children:"All items are in the bottom nav"})]})]}),xs&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-30",style:{touchAction:"none"},onTouchMove:Qs,onTouchEnd:Ys,onTouchCancel:Is}),xs&&gs&&os&&jsxRuntimeExports.jsxs("div",{className:"fixed z-50 pointer-events-none",style:{left:gs.x-100,top:gs.y-30},children:[jsxRuntimeExports.jsxs("div",{className:"bg-gold text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 opacity-90",children:[jsxRuntimeExports.jsx(NavIcon,{name:((Ks=ALL_NAV_ITEMS.find($s=>$s.id===os))==null?void 0:Ks.iconName)||"ellipsis",className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:(Ds=ALL_NAV_ITEMS.find($s=>$s.id===os))==null?void 0:Ds.label})]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-center mt-1 text-gold font-medium",children:us==="bottom"?"Drop in Bottom Nav":us==="more"?"Drop in More Menu":"Drag to reorder"})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 p-3 bg-gray-50 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm text-text-muted",children:[jsxRuntimeExports.jsx(NavIcon,{name:"ellipsis",className:"w-5 h-5"}),jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("strong",{children:"More"})," button is always last and cannot be moved."]})]})})]})]})}function DraggableItem({item:es,isDragging:ts,isDragOver:ss,onDragStart:ns,onDragEnd:rs,onDragOver:os,onTouchStart:as,onTouchMove:cs,onTouchEnd:ls,onTouchCancel:us,onMoveUp:ds,onMoveDown:xs,onRemove:fs,onAddToNav:gs,refCallback:Es}){return jsxRuntimeExports.jsxs("div",{ref:Es,className:`card flex items-center gap-3 transition-all cursor-grab active:cursor-grabbing select-none ${ts?"opacity-50 scale-95":""} ${ss?"ring-2 ring-gold ring-offset-2":""}`,draggable:!0,onDragStart:ns,onDragEnd:rs,onDragOver:js=>{js.preventDefault(),os()},onTouchStart:as,onTouchMove:cs,onTouchEnd:ls,onTouchCancel:us,children:[jsxRuntimeExports.jsx("div",{className:"text-text-light touch-none",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{d:"M8 6a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM8 12a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM8 18a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM14 6a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM14 12a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM14 18a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"})})}),jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-gold-100/50 flex items-center justify-center text-gold",children:jsxRuntimeExports.jsx(NavIcon,{name:es.iconName,className:"w-5 h-5"})}),jsxRuntimeExports.jsx("span",{className:"flex-1 text-sm font-medium text-text-primary",children:es.label}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[ds&&jsxRuntimeExports.jsx("button",{onClick:js=>{js.stopPropagation(),ds()},className:"p-1.5 rounded-lg hover:bg-gray-100 text-text-light",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})})}),xs&&jsxRuntimeExports.jsx("button",{onClick:js=>{js.stopPropagation(),xs()},className:"p-1.5 rounded-lg hover:bg-gray-100 text-text-light",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})}),fs&&jsxRuntimeExports.jsx("button",{onClick:js=>{js.stopPropagation(),fs()},className:"p-1.5 rounded-lg hover:bg-red-50 text-text-light hover:text-error",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),gs&&jsxRuntimeExports.jsx("button",{onClick:js=>{js.stopPropagation(),gs()},className:"p-1.5 rounded-lg hover:bg-green-50 text-text-light hover:text-green-600",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})})]})]})}function ScriptViewer({onBack:es}){const[ts,ss]=reactExports.useState(""),[ns,rs]=reactExports.useState(null),[os,as]=reactExports.useState("full"),{currentProject:cs}=useProjectStore(),ls=reactExports.useRef(new Map),us=reactExports.useMemo(()=>cs!=null&&cs.scenes?[...cs.scenes].sort((gs,Es)=>gs.sceneNumber.localeCompare(Es.sceneNumber,void 0,{numeric:!0})):[],[cs==null?void 0:cs.scenes]),ds=us.some(gs=>gs.scriptContent),xs=reactExports.useMemo(()=>{if(!ts.trim())return us;const gs=ts.toLowerCase();return us.filter(Es=>{var js,ps;return((js=Es.scriptContent)==null?void 0:js.toLowerCase().includes(gs))||Es.slugline.toLowerCase().includes(gs)||((ps=Es.synopsis)==null?void 0:ps.toLowerCase().includes(gs))})},[us,ts]);reactExports.useEffect(()=>{if(ns){const gs=ls.current.get(ns);gs&&gs.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>rs(null),500)}},[ns]);const fs=(gs,Es)=>Es.trim()?gs.split(new RegExp(`(${Es.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi")).map((ps,ms)=>ps.toLowerCase()===Es.toLowerCase()?jsxRuntimeExports.jsx("mark",{className:"bg-gold/30 text-text-primary px-0.5 rounded",children:ps},ms):ps):gs;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsxs("div",{className:"mobile-container",children:[jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Script"}),ds&&jsxRuntimeExports.jsxs("span",{className:"ml-auto text-xs text-text-muted",children:[us.length," scenes"]})]}),ds&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"px-4 pb-3 flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>as("full"),className:`flex-1 py-1.5 text-xs font-medium rounded-lg transition-colors ${os==="full"?"bg-gold text-white":"bg-gray-100 text-text-muted"}`,children:"Full Script"}),jsxRuntimeExports.jsx("button",{onClick:()=>as("pdf"),disabled:!(cs!=null&&cs.scriptPdfData),className:`flex-1 py-1.5 text-xs font-medium rounded-lg transition-colors ${os==="pdf"?"bg-gold text-white":"bg-gray-100 text-text-muted"} ${cs!=null&&cs.scriptPdfData?"":"opacity-50 cursor-not-allowed"}`,children:"PDF Script"})]}),os==="full"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"px-4 pb-2 flex gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 relative",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search script...",value:ts,onChange:gs=>ss(gs.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border border-border rounded-lg bg-card text-text-primary"}),ts&&jsxRuntimeExports.jsx("button",{onClick:()=>ss(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-light hover:text-text-muted",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("select",{value:ns||"",onChange:gs=>rs(gs.target.value||null),className:"px-3 py-2 text-sm border border-border rounded-lg bg-card text-text-primary min-w-[100px]",children:[jsxRuntimeExports.jsx("option",{value:"",children:"Jump to..."}),us.map(gs=>jsxRuntimeExports.jsxs("option",{value:gs.sceneNumber,children:["Scene ",gs.sceneNumber]},gs.sceneNumber))]})]}),ts&&jsxRuntimeExports.jsx("div",{className:"px-4 pb-2",children:jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted",children:[xs.length," scene",xs.length!==1?"s":""," found"]})})]})]})]})}),jsxRuntimeExports.jsx("div",{className:"mobile-container pb-safe-bottom",children:ds?os==="full"?jsxRuntimeExports.jsx("div",{className:"px-4 py-4",children:xs.map(gs=>jsxRuntimeExports.jsxs("div",{ref:Es=>{Es&&ls.current.set(gs.sceneNumber,Es)},className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"sticky top-[120px] z-10 bg-gold/10 backdrop-blur-sm border-l-4 border-gold px-3 py-2 mb-2 rounded-r-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-xs font-bold text-gold",children:["SCENE ",gs.sceneNumber]}),jsxRuntimeExports.jsx("span",{className:`px-1.5 py-0.5 text-[10px] font-bold rounded ${gs.intExt==="INT"?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:gs.intExt}),jsxRuntimeExports.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium rounded bg-gray-100 text-text-muted",children:gs.timeOfDay})]}),jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-text-primary mt-1",children:gs.slugline}),gs.synopsis&&jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted italic mt-1",children:fs(gs.synopsis,ts)})]}),gs.scriptContent?jsxRuntimeExports.jsx("pre",{className:"whitespace-pre-wrap font-mono text-sm text-text-primary leading-relaxed pl-3",children:ts?fs(gs.scriptContent,ts):gs.scriptContent}):jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted italic pl-3",children:"No script content available for this scene"})]},gs.id))}):jsxRuntimeExports.jsx("div",{className:"h-[calc(100vh-180px)]",children:cs!=null&&cs.scriptPdfData?jsxRuntimeExports.jsx("iframe",{src:cs.scriptPdfData,className:"w-full h-full border-0",title:"Script PDF"}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full px-4",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})})}),jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-text-primary mb-1",children:"No PDF Available"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted text-center",children:"Upload a PDF script to view the original document here"})]})}):jsxRuntimeExports.jsx("div",{className:"px-4 py-8",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(NavIcon,{name:"document",className:"w-8 h-8 text-gray-300"})}),jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-text-primary mb-1",children:"No Script Content"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted text-center mb-6",children:"Upload a script (PDF, FDX, or Fountain) to view it here"}),jsxRuntimeExports.jsx("button",{className:"px-4 py-2.5 rounded-button gold-gradient text-white text-sm font-medium active:scale-95 transition-transform",children:"Upload Script"})]})})})]})}function ScheduleViewer({onBack:es}){const{schedule:ts,discrepancies:ss,isUploading:ns,uploadError:rs,showDiscrepancyModal:os,uploadSchedule:as,clearSchedule:cs,crossReferenceWithBreakdown:ls,getCastNamesForNumbers:us,setShowDiscrepancyModal:ds,aiProcessingStatus:xs,isAIProcessing:fs,startAIProcessing:gs}=useScheduleStore(),{currentProject:Es,updateSceneShootingDays:js}=useProjectStore(),ps=reactExports.useRef(null),[ms,hs]=reactExports.useState(null),[vs,ws]=reactExports.useState(!1),[ys,Rs]=reactExports.useState(!1),[bs,Ns]=reactExports.useState("parsed"),Ss=new Date().toISOString().split("T")[0],Ts=async Is=>{var Ys;const Qs=(Ys=Is.target.files)==null?void 0:Ys[0];if(Qs&&Qs.type==="application/pdf")try{const Zs=await as(Qs);if(Es!=null&&Es.scenes&&Es.scenes.length>0){const Vs=ls(Es.scenes);if(Zs&&js){const Ks={};for(const Ds of Zs.days)for(const $s of Ds.scenes)Ks[$s.sceneNumber]=Ds.dayNumber;js(Ks,Vs)}}}catch(Zs){console.error("Failed to upload schedule:",Zs)}ps.current&&(ps.current.value="")},Cs=()=>{cs(),Rs(!1)},Ms=Is=>Is.scenes.filter(Qs=>ss.some(Ys=>Ys.sceneNumber===Qs.sceneNumber)).length;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Schedule"})]}),ts?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Rs(!0),className:"p-2 text-red-500 active:opacity-70 transition-opacity touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),jsxRuntimeExports.jsx("button",{onClick:()=>{var Is;return(Is=ps.current)==null?void 0:Is.click()},className:"p-2 text-gold active:opacity-70 transition-opacity touch-manipulation",disabled:ns,children:ns?jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})})]}):jsxRuntimeExports.jsx("button",{onClick:()=>{var Is;return(Is=ps.current)==null?void 0:Is.click()},className:"p-2 text-gold active:opacity-70 transition-opacity touch-manipulation",disabled:ns,children:ns?jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})})]})})}),jsxRuntimeExports.jsx("input",{ref:ps,type:"file",accept:".pdf",onChange:Ts,className:"hidden"}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-4",children:[rs&&jsxRuntimeExports.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-600",children:rs})}),ts?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex rounded-lg overflow-hidden border border-border",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Ns("parsed"),className:`px-3 py-1.5 text-xs font-medium transition-colors ${bs==="parsed"?"bg-gold text-white":"bg-card text-text-muted"}`,children:"Breakdown"}),jsxRuntimeExports.jsx("button",{onClick:()=>Ns("pdf"),className:`px-3 py-1.5 text-xs font-medium transition-colors ${bs==="pdf"?"bg-gold text-white":"bg-card text-text-muted"}`,disabled:!ts.pdfUri,children:"View PDF"})]}),(fs||xs.status==="processing")&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4 animate-spin text-gold",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),jsxRuntimeExports.jsx("span",{children:"AI analyzing..."})]})]}),xs.status==="processing"&&jsxRuntimeExports.jsxs("div",{className:"card bg-blue-50 border-blue-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 text-blue-500 animate-spin flex-shrink-0",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Analyzing with AI"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-blue-600",children:xs.message})]}),jsxRuntimeExports.jsxs("span",{className:"text-xs font-semibold text-blue-600",children:[xs.progress,"%"]})]}),jsxRuntimeExports.jsx("div",{className:"mt-2 h-1.5 bg-blue-100 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-300",style:{width:`${xs.progress}%`}})})]}),xs.status==="error"&&jsxRuntimeExports.jsx("div",{className:"card bg-red-50 border-red-200",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-red-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-red-700",children:"AI Analysis Failed"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-red-600",children:xs.error||"Unknown error"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>gs(),className:"px-3 py-1 text-xs font-medium text-red-600 bg-red-100 rounded-lg hover:bg-red-200 transition-colors",children:"Retry"})]})}),bs==="pdf"&&ts.pdfUri&&jsxRuntimeExports.jsx("div",{className:"card p-0 overflow-hidden",children:jsxRuntimeExports.jsx("iframe",{src:ts.pdfUri,className:"w-full h-[calc(100vh-280px)] min-h-[400px] border-0",title:"Schedule PDF"})}),bs==="parsed"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("h2",{className:"text-base font-bold text-text-primary",children:ts.productionName||"Production Schedule"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted",children:[ts.totalDays," days, ",ts.days.reduce((Is,Qs)=>Is+Qs.scenes.length,0)," scenes"]})]}),ts.scriptVersion&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted",children:["Script: ",ts.scriptVersion]}),ts.scheduleVersion&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted",children:["Schedule: ",ts.scheduleVersion]}),ss.length>0&&jsxRuntimeExports.jsxs("button",{onClick:()=>ds(!0),className:"mt-3 w-full p-2.5 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-amber-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-amber-700 font-medium",children:[ss.length," discrepanc",ss.length===1?"y":"ies"," found"]}),jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-500 ml-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]}),ts.castList.length>0&&jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>ws(!vs),className:"w-full flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-muted",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-semibold text-text-primary",children:["Cast List (",ts.castList.length,")"]})]}),jsxRuntimeExports.jsx("svg",{className:`w-5 h-5 text-text-muted transition-transform ${vs?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),vs&&jsxRuntimeExports.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2",children:ts.castList.map(Is=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsx("span",{className:"w-6 h-6 flex items-center justify-center text-xs font-bold rounded-full bg-gold-100 text-gold",children:Is.number}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-primary truncate",children:Is.character||Is.name})]},Is.number))})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2.5",children:ts.days.map(Is=>{const Qs=Is.date===Ss,Ys=ms===Is.dayNumber,Zs=Ms(Is);return jsxRuntimeExports.jsxs("div",{className:`card ${Qs?"border-2 border-gold":""}`,children:[jsxRuntimeExports.jsxs("button",{onClick:()=>hs(Ys?null:Is.dayNumber),className:"w-full text-left",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-base font-bold text-text-primary",children:["Day ",Is.dayNumber]}),Qs&&jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 text-[10px] font-semibold rounded-full bg-gold text-white",children:"TODAY"}),Zs>0&&jsxRuntimeExports.jsxs("span",{className:"px-2 py-0.5 text-[10px] font-semibold rounded-full bg-amber-100 text-amber-600",children:[Zs," issue",Zs!==1?"s":""]})]}),Is.date&&jsxRuntimeExports.jsxs("span",{className:"text-sm text-text-muted",children:[Is.dayOfWeek?`${Is.dayOfWeek}, `:"",formatShortDate(Is.date)]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-light",children:[Is.scenes.length," scenes"]}),jsxRuntimeExports.jsx("svg",{className:`w-5 h-5 text-text-muted transition-transform ${Ys?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-text-muted",children:[Is.location&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),jsxRuntimeExports.jsx("span",{children:Is.location})]}),Is.hours&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsx("span",{children:Is.hours})]}),Is.totalPages&&jsxRuntimeExports.jsxs("span",{children:[Is.totalPages," pgs"]})]})]}),!Ys&&jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[Is.scenes.slice(0,8).map(Vs=>{const Ks=ss.some(Ds=>Ds.sceneNumber===Vs.sceneNumber);return jsxRuntimeExports.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${Ks?"bg-amber-100 text-amber-700":"bg-gray-100 text-text-muted"}`,children:Vs.sceneNumber},Vs.sceneNumber)}),Is.scenes.length>8&&jsxRuntimeExports.jsxs("span",{className:"px-2 py-0.5 text-xs font-medium rounded bg-gray-100 text-text-muted",children:["+",Is.scenes.length-8," more"]})]}),Ys&&jsxRuntimeExports.jsxs("div",{className:"mt-3 pt-3 border-t border-border space-y-2",children:[Is.notes&&Is.notes.length>0&&jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:Is.notes.map((Vs,Ks)=>jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 text-[10px] font-medium rounded bg-blue-100 text-blue-600",children:Vs},Ks))}),Is.scenes.map(Vs=>{const Ks=ss.some(Xs=>Xs.sceneNumber===Vs.sceneNumber),Ds=ss.find(Xs=>Xs.sceneNumber===Vs.sceneNumber),$s=us(Vs.castNumbers);return jsxRuntimeExports.jsxs("div",{className:`p-2.5 rounded-lg ${Ks?"bg-amber-50 border border-amber-200":"bg-gray-50"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"font-semibold text-sm text-text-primary",children:["Sc ",Vs.sceneNumber]}),Ks&&jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[jsxRuntimeExports.jsx("span",{className:Vs.intExt==="EXT"?"text-blue-500":"text-amber-500",children:Vs.intExt}),jsxRuntimeExports.jsx("span",{children:Vs.dayNight}),Vs.pages&&jsxRuntimeExports.jsx("span",{children:Vs.pages})]})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-secondary mb-1",children:Vs.setLocation}),Vs.description&&jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted italic mb-1",children:Vs.description}),$s.length>0&&jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1 mt-1.5",children:$s.map((Xs,Fs)=>jsxRuntimeExports.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium rounded bg-white text-text-muted border",children:Xs},Fs))}),Ds&&jsxRuntimeExports.jsx("p",{className:"mt-2 text-xs text-amber-600",children:Ds.message})]},Vs.sceneNumber)})]})]},Is.dayNumber)})})]})]}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(NavIcon,{name:"schedule",className:"w-8 h-8 text-gray-300"})}),jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-text-primary mb-1",children:"No Schedule Uploaded"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted text-center mb-6 max-w-xs",children:"Upload your production schedule PDF to see shooting days and cross-reference with your breakdown"}),jsxRuntimeExports.jsx("button",{onClick:()=>{var Is;return(Is=ps.current)==null?void 0:Is.click()},disabled:ns,className:"px-6 py-2.5 rounded-button gold-gradient text-white text-sm font-medium active:scale-95 transition-transform disabled:opacity-50",children:ns?"Uploading...":"Upload Schedule PDF"})]})]}),os&&ss.length>0&&jsxRuntimeExports.jsx(DiscrepancyModal,{discrepancies:ss,onClose:()=>ds(!1)}),ys&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-xl p-4 max-w-sm w-full",children:[jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-text-primary mb-2",children:"Delete Schedule?"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-4",children:"This will remove the schedule and all cross-reference data. You can upload a new schedule at any time."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Rs(!1),className:"flex-1 px-4 py-2.5 rounded-button text-sm font-medium text-text-primary bg-gray-100 active:bg-gray-200 transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:Cs,className:"flex-1 px-4 py-2.5 rounded-button text-sm font-medium text-white bg-red-500 active:bg-red-600 transition-colors",children:"Delete"})]})]})})]})}function DiscrepancyModal({discrepancies:es,onClose:ts}){const ss=ns=>{switch(ns){case"scene_not_in_breakdown":return jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"scene_not_in_schedule":return jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"character_mismatch":return jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})});default:return jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/50 p-4 safe-bottom",children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-xl w-full max-w-lg max-h-[80vh] flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-text-primary",children:"Schedule Discrepancies"})]}),jsxRuntimeExports.jsx("button",{onClick:ts,className:"p-2 text-text-muted active:text-text-primary transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-3",children:"The following scenes don't match between the schedule and your breakdown. Please check these scenes in the Breakdown page."}),es.map((ns,rs)=>jsxRuntimeExports.jsx("div",{className:"p-3 rounded-lg bg-gray-50 border border-gray-100",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2",children:[ss(ns.type),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsxs("span",{className:"font-semibold text-sm text-text-primary",children:["Scene ",ns.sceneNumber]}),jsxRuntimeExports.jsx("span",{className:`px-2 py-0.5 text-[10px] font-medium rounded ${ns.type==="scene_not_in_breakdown"?"bg-red-100 text-red-600":ns.type==="scene_not_in_schedule"?"bg-blue-100 text-blue-600":"bg-amber-100 text-amber-600"}`,children:ns.type.replace(/_/g," ")})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:ns.message})]})]})},rs))]}),jsxRuntimeExports.jsx("div",{className:"p-4 border-t border-border",children:jsxRuntimeExports.jsx("button",{onClick:ts,className:"w-full px-4 py-2.5 rounded-button gold-gradient text-white text-sm font-medium active:scale-95 transition-transform",children:"Understood"})})]})})}function CallSheetArchive({onBack:es}){const{callSheets:ts,activeCallSheetId:ss,setActiveCallSheet:ns,uploadCallSheet:rs,deleteCallSheet:os,isUploading:as,uploadError:cs}=useCallSheetStore(),ls=reactExports.useRef(null),[us,ds]=reactExports.useState(null),[xs,fs]=reactExports.useState(null),gs=async ms=>{var vs;const hs=(vs=ms.target.files)==null?void 0:vs[0];if(hs&&hs.type==="application/pdf")try{await rs(hs)}catch(ws){console.error("Failed to upload call sheet:",ws)}ls.current&&(ls.current.value="")},Es=(ms,hs)=>{hs.stopPropagation(),ns(ms)},js=ms=>{os(ms),fs(null)},ps=us?ts.find(ms=>ms.id===us):null;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Call Sheets"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>{var ms;return(ms=ls.current)==null?void 0:ms.click()},className:"p-2 text-gold active:opacity-70 transition-opacity touch-manipulation",disabled:as,children:as?jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})})]})})}),jsxRuntimeExports.jsx("input",{ref:ls,type:"file",accept:".pdf",onChange:gs,className:"hidden"}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-4",children:[cs&&jsxRuntimeExports.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-600",children:cs})}),ts.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(NavIcon,{name:"document",className:"w-8 h-8 text-gray-300"})}),jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-text-primary mb-1",children:"No Call Sheets"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted text-center mb-6",children:"Upload your daily call sheet PDFs to track scenes and times"}),jsxRuntimeExports.jsx("button",{onClick:()=>{var ms;return(ms=ls.current)==null?void 0:ms.click()},disabled:as,className:"px-6 py-2.5 rounded-button gold-gradient text-white text-sm font-medium active:scale-95 transition-transform disabled:opacity-50",children:as?"Uploading...":"Upload Call Sheet PDF"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"space-y-2",children:ts.map(ms=>jsxRuntimeExports.jsxs("div",{onClick:()=>ds(ms.id),className:"w-full card flex items-center justify-between active:scale-[0.98] transition-transform cursor-pointer",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${ms.id===ss?"bg-gold-100":"bg-gray-100"}`,children:jsxRuntimeExports.jsx(NavIcon,{name:"document",className:`w-5 h-5 ${ms.id===ss?"text-gold":"text-text-light"}`})}),jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-semibold text-text-primary",children:["Day ",ms.productionDay,ms.totalProductionDays&&` of ${ms.totalProductionDays}`]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted",children:[formatShortDate(ms.date),"  ",ms.scenes.length," scene",ms.scenes.length!==1?"s":"",ms.unitCallTime&&`  Call: ${ms.unitCallTime}`]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[ms.id===ss?jsxRuntimeExports.jsx("span",{className:"px-2.5 py-1 text-[10px] font-medium rounded-full bg-green-100 text-green-600",children:"Active"}):jsxRuntimeExports.jsx("button",{onClick:hs=>Es(ms.id,hs),className:"px-2.5 py-1 text-[10px] font-medium rounded-full bg-gold-100 text-gold hover:bg-gold-200 transition-colors",children:"Set Active"}),jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]},ms.id))}),jsxRuntimeExports.jsx("div",{className:"mt-6 text-center",children:jsxRuntimeExports.jsx("button",{onClick:()=>{var ms;return(ms=ls.current)==null?void 0:ms.click()},disabled:as,className:"px-6 py-2.5 rounded-button gold-gradient text-white text-sm font-medium active:scale-95 transition-transform disabled:opacity-50",children:as?"Uploading...":"Upload Call Sheet PDF"})})]})]}),ps&&jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 bg-black/90 flex flex-col",onClick:()=>ds(null),children:[jsxRuntimeExports.jsxs("div",{className:"flex-shrink-0 bg-card border-b border-border px-4 py-3 flex items-center justify-between safe-top",onClick:ms=>ms.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-base font-semibold text-text-primary",children:["Day ",ps.productionDay," Call Sheet"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:formatShortDate(ps.date)})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[xs===ps.id?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>fs(null),className:"px-3 py-1.5 text-xs text-text-muted",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:()=>{js(ps.id),ds(null)},className:"px-3 py-1.5 text-xs bg-red-500 text-white rounded-lg",children:"Delete"})]}):jsxRuntimeExports.jsx("button",{onClick:()=>fs(ps.id),className:"p-2 text-red-400 hover:text-red-500",title:"Delete call sheet",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})}),jsxRuntimeExports.jsx("button",{onClick:()=>ds(null),className:"p-2 text-text-muted hover:text-text-primary",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-hidden",onClick:ms=>ms.stopPropagation(),children:ps.pdfUri?jsxRuntimeExports.jsx("iframe",{src:ps.pdfUri,className:"w-full h-full border-0",title:`Day ${ps.productionDay} Call Sheet`}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-6",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-800 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"PDF Not Available"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"The original PDF for this call sheet was not saved."}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-500",children:["Day ",ps.productionDay,"  ",ps.scenes.length," scenes  Unit call ",ps.unitCallTime]})]})})]})]})}function Settings({onBack:es,onStartNewProject:ts,onNavigateToExport:ss,onNavigateToArchived:ns,onNavigateToProjectSettings:rs,onNavigateToTeam:os,onNavigateToInvite:as,onNavigateToStats:cs,onNavigateToBilling:ls,canManage:us}){const{clearProject:ds,currentProject:xs,lifecycle:fs,wrapProject:gs,restoreProject:Es,getDaysUntilDeletion:js,getArchivedProjects:ps}=useProjectStore(),{resetToDefaults:ms}=useNavigationStore(),{theme:hs,setTheme:vs}=useThemeStore(),{clearAll:ws}=useCallSheetStore(),{clearSchedule:ys}=useScheduleStore(),{clearMessages:Rs}=useChatStore(),{clearAll:bs}=useTimesheetStore(),{setScreen:Ns,isAuthenticated:Ss}=useAuthStore(),[Ts,Cs]=reactExports.useState(!1),[Ms,Is]=reactExports.useState(!1),[Qs,Ys]=reactExports.useState(!1),Zs=ps(),Vs=js(),Ks=()=>{Ns("select-plan")},Ds=[{value:"light",label:"Light",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})},{value:"dark",label:"Dark",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})},{value:"system",label:"System",icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}],$s=async()=>{ds(),ws(),ys(),Rs(),bs(),ms(),await clearAllData(),Is(!1),ts==null||ts()};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Settings"})]})})}),jsxRuntimeExports.jsxs("div",{className:"mobile-container px-4 py-4",children:[jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"CURRENT PROJECT"}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsx("div",{className:"text-base font-semibold text-text-primary",children:(xs==null?void 0:xs.name)??"No project loaded"}),xs&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"text-sm text-text-muted mt-1",children:[xs.scenes.length," scenes  ",xs.characters.length," characters"]}),fs.state==="wrapped"&&jsxRuntimeExports.jsx("div",{className:"mt-2 px-3 py-2 bg-amber-50 border border-amber-200 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm text-amber-800",children:["Wrapped  ",Vs," days until archive"]}),jsxRuntimeExports.jsx("button",{onClick:()=>Es(),className:"text-xs font-medium text-gold",children:"Restore"})]})}),fs.state==="archived"&&jsxRuntimeExports.jsx("div",{className:"mt-2 px-3 py-2 bg-red-50 border border-red-200 rounded-lg",children:jsxRuntimeExports.jsx("span",{className:"text-sm text-red-800",children:"Archived - Read Only"})})]})]})]}),xs&&jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"PROJECT MANAGEMENT"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("button",{onClick:os,className:"card w-full text-left flex items-center gap-3 hover:bg-gold/5 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary block",children:"Team"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"View and manage team members"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]}),jsxRuntimeExports.jsxs("button",{onClick:as,className:"card w-full text-left flex items-center gap-3 hover:bg-gold/5 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-50 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary block",children:"Share Invite Code"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"Invite team members to join"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]}),jsxRuntimeExports.jsxs("button",{onClick:cs,className:"card w-full text-left flex items-center gap-3 hover:bg-gold/5 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-50 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-purple-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary block",children:"Project Stats"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"View project statistics"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]}),us&&jsxRuntimeExports.jsxs("button",{onClick:rs,className:"card w-full text-left flex items-center gap-3 hover:bg-gold/5 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-gold/10 flex items-center justify-center",children:jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary block",children:"Project Settings"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"Configure permissions and details"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]})]}),Ss&&jsxRuntimeExports.jsx(SubscriptionSection,{onChangePlan:Ks}),Ss&&jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"ACCOUNT SETTINGS"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:jsxRuntimeExports.jsxs("button",{onClick:ls,className:"card w-full text-left flex items-center gap-3 hover:bg-gold/5 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-50 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary block",children:"Billing Details"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"Personal info, bank details, VAT for invoices"})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})})]}),xs&&jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"EXPORT & WRAP"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("button",{onClick:ss,className:"card w-full text-left flex items-center gap-3 hover:bg-gold/5 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-gold/10 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary block",children:"Export Project"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"Download continuity documents"})]})]}),fs.state==="active"&&jsxRuntimeExports.jsxs("button",{onClick:()=>Ys(!0),className:"card w-full text-left flex items-center gap-3 hover:bg-amber-50 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-50 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.875 1.875 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-amber-700 block",children:"Mark as Wrapped"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted",children:["Production complete, archive in ",PROJECT_RETENTION_DAYS," days"]})]})]})]})]}),Zs.length>0&&jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"ARCHIVED PROJECTS"}),jsxRuntimeExports.jsxs("button",{onClick:ns,className:"card w-full text-left flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-text-muted",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary block",children:"Archived Projects"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted",children:[Zs.length," project",Zs.length!==1?"s":""]})]})]}),jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-text-light",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"DATA RETENTION"}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-secondary",children:"Project Retention"}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-text-primary",children:[PROJECT_RETENTION_DAYS," days"]})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted mt-2",children:["Wrapped projects are stored for ",PROJECT_RETENTION_DAYS," days before being archived. Export your data to keep a permanent backup."]})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"APPEARANCE"}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary",children:"Theme"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted capitalize",children:hs})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ds.map(Xs=>jsxRuntimeExports.jsxs("button",{onClick:()=>vs(Xs.value),className:`flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all ${hs===Xs.value?"border-gold bg-gold/10 text-gold":"border-border bg-input-bg text-text-muted hover:border-gold/30"}`,children:[Xs.icon,jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:Xs.label})]},Xs.value))}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-3",children:hs==="dark"?"Dark mode matches the website aesthetic with gold accents.":hs==="system"?"Automatically matches your device settings.":"Classic light mode with warm tones."})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"PROJECT"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>Is(!0),className:"card w-full text-left flex items-center gap-3 hover:bg-gold/5 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-gold/10 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary block",children:"Start New Project"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"Upload a new script and start fresh"})]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Cs(!0),className:"card w-full text-left flex items-center gap-3 hover:bg-red-50 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-50 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-error",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-error block",children:"Clear All Data"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-muted",children:"Delete all photos and captured data"})]})]})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"NAVIGATION"}),jsxRuntimeExports.jsx("button",{onClick:ms,className:"card w-full text-left text-text-primary hover:bg-gray-50 transition-colors",children:"Reset Menu to Defaults"})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"SYNC STATUS"}),jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500 animate-pulse"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-primary",children:"Offline Mode"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted mt-2",children:"All data is stored locally on your device."}),jsxRuntimeExports.jsx("button",{className:"mt-3 text-sm text-gold font-medium",children:"Sync with Desktop"})]})]}),jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-[10px] font-bold tracking-wider uppercase text-text-light mb-3",children:"ABOUT"}),jsxRuntimeExports.jsxs("div",{className:"card space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Version"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-primary",children:"1.0.0"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"Platform"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-primary",children:"Mobile PWA"})]})]})]}),Ts&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-xl p-6 max-w-sm w-full",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Clear All Data?"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-6",children:"This will delete all captured photos and scene data. This cannot be undone."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Cs(!1),className:"flex-1 px-4 py-2.5 rounded-button bg-gray-100 text-text-primary font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:async()=>{ds(),ws(),ys(),Rs(),bs(),await clearAllData(),Cs(!1)},className:"flex-1 px-4 py-2.5 rounded-button bg-error text-white font-medium",children:"Clear Data"})]})]})}),Ms&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-xl p-6 max-w-sm w-full",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Start New Project?"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-6",children:"This will clear all current project data and take you to the setup screen. Make sure you've synced any important data first."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Is(!1),className:"flex-1 px-4 py-2.5 rounded-button bg-gray-100 text-text-primary font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:$s,className:"flex-1 px-4 py-2.5 rounded-button gold-gradient text-white font-medium",children:"Start New"})]})]})}),Qs&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-xl p-6 max-w-sm w-full",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 mx-auto mb-4 rounded-full bg-amber-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.875 1.875 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125"})})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-text-primary text-center mb-2",children:"Wrap Project?"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-text-muted text-center mb-4",children:['This will mark "',xs==null?void 0:xs.name,'" as wrapped. The project will be stored for ',PROJECT_RETENTION_DAYS," days before being automatically archived."]}),jsxRuntimeExports.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-6",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-amber-800",children:"You can still access and edit your project during this time. Export your continuity documents to keep a permanent backup."})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Ys(!1),className:"flex-1 px-4 py-2.5 rounded-button bg-gray-100 text-text-primary font-medium",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:()=>{gs("manual"),Ys(!1)},className:"flex-1 px-4 py-2.5 rounded-button bg-amber-500 text-white font-medium",children:"Wrap Project"})]})]})})]})]})}function ArchivedProjectsScreen({onBack:es}){const{getArchivedProjects:ts,loadArchivedProject:ss}=useProjectStore(),ns=ts();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-30 bg-card border-b border-border safe-top",children:jsxRuntimeExports.jsx("div",{className:"mobile-container",children:jsxRuntimeExports.jsxs("div",{className:"h-14 px-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors touch-manipulation",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Archived Projects"})]})})}),jsxRuntimeExports.jsx("div",{className:"mobile-container px-4 py-4",children:ns.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-12",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})}),jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-text-primary mb-1",children:"No Archived Projects"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-text-muted",children:["Wrapped projects will appear here after ",PROJECT_RETENTION_DAYS," days."]})]}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:ns.map(rs=>jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-2",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-text-primary",children:rs.name}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted",children:[rs.scenesCount," scenes  ",rs.charactersCount," characters  ",rs.photosCount," photos"]})]}),jsxRuntimeExports.jsx("span",{className:`px-2 py-1 text-[10px] font-medium rounded-full ${rs.state==="wrapped"?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-600"}`,children:rs.state==="wrapped"?"Wrapped":"Archived"})]}),rs.wrappedAt&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-light mb-3",children:["Wrapped ",formatShortDate(new Date(rs.wrappedAt).toISOString().split("T")[0]),rs.daysUntilDeletion>0&&`  ${rs.daysUntilDeletion} days until deletion`]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ss(rs.id),className:"flex-1 px-3 py-2 text-sm font-medium rounded-button bg-gold/10 text-gold active:scale-[0.98] transition-transform",children:"Restore Project"}),jsxRuntimeExports.jsx("button",{className:"px-3 py-2 text-sm font-medium rounded-button bg-gray-100 text-text-secondary active:scale-[0.98] transition-transform",children:"Export"})]})]},rs.id))})})]})}function WrapPopupModal({onExport:es}){const{currentProject:ts,showWrapPopup:ss,wrapTriggerReason:ns,lifecycle:rs,wrapProject:os,dismissWrapPopup:as}=useProjectStore();if(!ss||!ts)return null;const cs=()=>{if(rs.state==="wrapped"&&rs.deletionDate)return new Date(rs.deletionDate).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});const xs=new Date;return xs.setDate(xs.getDate()+PROJECT_RETENTION_DAYS),xs.toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})},ls=()=>{switch(ns){case"all_scenes_complete":return`All scenes for "${ts.name}" are marked complete.`;case"inactivity":return`"${ts.name}" has been inactive for 30 days.`;case"manual":return`"${ts.name}" has been marked as wrapped.`;default:return`"${ts.name}" is ready to be wrapped.`}},us=()=>{rs.state==="active"&&ns&&os(ns),es()},ds=()=>{rs.state==="active"&&ns&&os(ns),as(!0)};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-card rounded-2xl w-full max-w-sm overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[jsxRuntimeExports.jsxs("div",{className:"pt-8 pb-4 text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gold/10 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.875 1.875 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"})})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-text-primary mb-1",children:"That's a Wrap!"})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 pb-6",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-text-secondary text-center mb-4",children:ls()}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm text-amber-800",children:["Your project will be stored for ",PROJECT_RETENTION_DAYS," days in case of pickups, then automatically deleted."]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-amber-900 font-medium mt-2",children:"Export your continuity documents now to keep a permanent backup."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("button",{onClick:us,className:"w-full py-3.5 rounded-button gold-gradient text-white font-semibold text-base shadow-lg active:scale-[0.98] transition-transform flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Export Documents"]}),jsxRuntimeExports.jsx("button",{onClick:ds,className:"w-full py-3 rounded-button bg-gray-100 text-text-secondary font-medium text-base active:scale-[0.98] transition-transform",children:"Remind Me Later"})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-light text-center mt-4",children:["Project deletion: ",cs()]})]})]})})}function LifecycleBanner({onExport:es}){const{lifecycle:ts,getLifecycleBanner:ss,restoreProject:ns}=useProjectStore(),rs=ss();if(!(rs!=null&&rs.show))return null;const os=ts.state==="wrapped",as=ts.state==="archived";return jsxRuntimeExports.jsx("div",{className:`${as?"bg-red-50 border-b border-red-200":"bg-amber-50 border-b border-amber-200"}`,children:jsxRuntimeExports.jsx("div",{className:"mobile-container px-4 py-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[as?jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}):jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-amber-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),jsxRuntimeExports.jsx("span",{className:`text-xs font-medium truncate ${as?"text-red-800":"text-amber-800"}`,children:rs.message})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[os&&jsxRuntimeExports.jsx("button",{onClick:ns,className:"text-xs font-medium text-amber-700 hover:text-amber-900",children:"Restore"}),jsxRuntimeExports.jsx("button",{onClick:es,className:`px-2 py-1 text-[10px] font-semibold rounded ${as?"bg-red-600 text-white":"bg-amber-600 text-white"}`,children:"Export"})]})]})})})}pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;async function extractTextFromPDF(es){const ts=await es.arrayBuffer(),ss=await pdfExports.getDocument({data:ts}).promise;let ns="";for(let rs=1;rs<=ss.numPages;rs++){const as=await(await ss.getPage(rs)).getTextContent(),cs=new Map;for(const us of as.items){if(!us.str||us.str.trim()==="")continue;const ds=Math.round(us.transform[5]/2)*2,xs=us.transform[4];cs.has(ds)||cs.set(ds,[]),cs.get(ds).push({x:xs,text:us.str,width:us.width||0})}const ls=Array.from(cs.keys()).sort((us,ds)=>ds-us);for(const us of ls){const ds=cs.get(us);ds.sort((Es,js)=>Es.x-js.x);let xs="",fs=0,gs=0;for(const Es of ds){const js=Es.x-(fs+gs);fs>0&&js>3&&(js>20?xs+="    ":xs+=" "),xs+=Es.text,fs=Es.x,gs=Es.width}ns+=xs.trimEnd()+`
`}ns+=`
`}return normalizeScriptText(ns)}function normalizeScriptText(es){return es.replace(/\b(INT|EXT)\s*\n\s*\./g,"$1.").replace(/\b(INT|EXT)\s*\n\s*\/\s*(INT|EXT)/g,"$1/$2").replace(/CONTIN\s*\n\s*UED?/gi,"CONTINUOUS").replace(/CONT['']?D/gi,"CONT'D").replace(/\(\s*V\s*\.\s*O\s*\.\s*\)/gi,"(V.O.)").replace(/\(\s*O\s*\.\s*S\s*\.\s*\)/gi,"(O.S.)").replace(/[ \t]+/g," ").replace(/\n{4,}/g,`


`).replace(/(\d+[A-Z]?)\s+\./g,"$1.").trim()}function extractTextFromFDX(es){try{const ns=new DOMParser().parseFromString(es,"text/xml").querySelectorAll("Paragraph");let rs="";return ns.forEach(os=>{const as=os.getAttribute("Type"),cs=os.querySelectorAll("Text");let ls="";cs.forEach(us=>{ls+=us.textContent||""}),as==="Scene Heading"?rs+=`
`+ls.trim()+`
`:as==="Character"?rs+=`
`+ls.trim().toUpperCase()+`
`:as==="Dialogue"?rs+=ls.trim()+`
`:as==="Action"?rs+=`
`+ls.trim()+`
`:rs+=ls.trim()+`
`}),rs}catch(ts){return console.error("Error parsing FDX:",ts),es}}function normalizeTimeOfDayForScene(es){const ts=(es||"DAY").toUpperCase();return ts==="NIGHT"||ts==="NIGHTMARE"?"NIGHT":ts==="MORNING"||ts==="DAWN"||ts==="SUNRISE"?"MORNING":ts==="EVENING"||ts==="DUSK"||ts==="SUNSET"||ts==="MAGIC HOUR"||ts==="GOLDEN HOUR"?"EVENING":ts==="CONTINUOUS"||ts==="CONT"||ts==="LATER"||ts==="SAME"||ts==="SAME TIME"||ts==="MOMENTS LATER"||ts==="SIMULTANEOUS"?"CONTINUOUS":"DAY"}function normalizeCharacterName(es){let ts=es.toUpperCase();if(ts=ts.replace(/\s*\(.*?\)\s*/g,""),ts.includes("/")&&!ts.startsWith("INT")&&!ts.startsWith("EXT")){const ss=ts.split("/");ss[0].length>=2&&ss[0].length<=20&&(ts=ss[0].trim())}return ts.replace(/\s+/g," ").trim()}function extractCharactersFromActionLine(es){const ts=[],ss=es.trim();if(ss.length<5||/^(INT\.|EXT\.|INT\/EXT|CUT TO|FADE|DISSOLVE|CONTINUED)/i.test(ss))return ts;const ns=new Set(["INT","EXT","ROAD","STREET","AVENUE","HIGHWAY","PATH","TRAIL","LANE","DAY","NIGHT","MORNING","EVENING","CONTINUOUS","LATER","SAME","CONT","DAWN","DUSK","CONTINUED","CUT","FADE","DISSOLVE","SMASH","MATCH","WIPE","THE","AND","BUT","FOR","NOT","YOU","ALL","CAN","HER","HIS","HIM","SHE","HAS","HAD","WAS","ARE","BEEN","HAVE","THEIR","WHAT","WHEN","WHERE","WHICH","WHO","THIS","THAT","WITH","FROM","INTO","ONTO","UPON","BACK","OVER","UNDER","VERY","MUCH","MORE","MOST","JUST","ONLY","ALSO","EVEN","STILL","WELL","SUCH","SOME","MANY","BOTH","EACH","OTHER","CLOSE","WIDE","ANGLE","VIEW","SHOT","POV","INSERT","FLASHBACK","DREAM","TITLE","SUPER","CHYRON","SUBTITLE","TV","DVD","VHS","USA","NYC","NYPD","FBI","CIA","NSA","TAXI","STAND","CAR","DOOR","ROOM","HOUSE","BOAT","PHONE","GUN","KNIFE","TABLE","CHAIR","PARKA","WHEELCHAIR","VEHICLE","WINDOW","WALL","FLOOR","CEILING","BED","DESK","LAMP","MOUNTAINS","MOUNTAIN","HILLS","HILLSIDES","VALLEY","RIVER","RIVERS","STREAM","STREAMS","LAKE","OCEAN","SEA","BEACH","FOREST","WOODS","TREE","TREES","SKY","SUN","MOON","CLOUDS","RAIN","SNOW","WIND","WATER","MELTWATER","WILDFLOWER","FLOWERS","GRASS","EDENIC","VERDANT","LONELY","QUIET","LOUD","DARK","BRIGHT","SMALL","LARGE","BIG","TALL","SHORT","LONG","WIDE","NARROW","THICK","THIN","HEAVY","LIGHT","HARD","SOFT","HOT","COLD","WARM","COOL","WET","DRY","CLEAN","DIRTY","NEW","OLD","FRESH","STALE","GOOD","BAD","GREAT","POOR","RICH","SIMPLE","COMPLEX","EASY","DIFFICULT","FAST","SLOW","HIGH","LOW","NEAR","FAR","CLOSE","DISTANT","OPEN","CLOSED","EMPTY","FULL","BEAUTIFUL","GORGEOUS","STUNNING","SERENE","PEACEFUL","CALM","WILD","FIERCE","RED","BLUE","GREEN","YELLOW","ORANGE","PURPLE","PINK","BLACK","WHITE","GREY","GRAY","BROWN","GOLDEN","SILVER","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","TEN","FIRST","SECOND","THIRD","LAST","NEXT","ANOTHER","FEW","SEVERAL"]),rs=/^[A-Z]+(ING|ED|LY|TION|SION|NESS|MENT|ABLE|IBLE|ICAL|IOUS|EOUS|ULAR|TERN|ERN|WARD|WARDS|LIKE|LESS|FUL|IC|AL|ARY|ORY|IVE|OUS|ANT|ENT)$/,os=/^(INT|EXT)\s*[.\/]/,as=/\b([A-Z][A-Z.'-]+(?:\s+[A-Z][A-Z.'-]+){0,2})\b/g;let cs;for(;(cs=as.exec(ss))!==null;){const us=cs[1].trim();if(os.test(us)||us.split(/\s+/).length===1&&ns.has(us)||ns.has(us)||rs.test(us))continue;const ds=us.split(/\s+/);if(ds.some(Es=>rs.test(Es)||ns.has(Es))||/\b(TAXI|CAR|DOOR|ROOM|HOUSE|BOAT|PHONE|GUN|KNIFE|TABLE|CHAIR|STAND|PARKA|WHEELCHAIR|VEHICLE|ROAD|STREET|MOUNTAIN|RIVER|TREE)\b/i.test(us))continue;const gs=/\b(MAN|WOMAN|PERSON|DRIVER|OFFICER|DOCTOR|NURSE|GUARD|SOLDIER|WORKER|GIRL|BOY|LADY|GUY|KID|CHILD|TEEN|TEENAGER|CLERK|WAITER|WAITRESS|COP|DETECTIVE|AGENT|STRANGER|FIGURE)\b/i;if(ds.length>=2&&gs.test(us)){ts.push(us);continue}if(ds.length===1&&us.length>=3&&us.length<=15){const Es=ss.slice(cs.index+us.length),js=/^\s*(enters|exits|walks|runs|stands|sits|looks|turns|moves|says|speaks|watches|stares|smiles|nods|shakes|reaches|grabs|holds|opens|closes|steps|crosses|approaches|leaves|arrives|appears|disappears|rises|falls|jumps|climbs|crawls|lies|kneels|bends|leans|waves|points|gestures|signals|calls|shouts|whispers|laughs|cries|sighs|groans|screams|freezes|pauses|stops|starts|continues|begins|finishes|waits|hesitates)/i.test(Es),ps=/^('s\s|'s$)/i.test(Es),ms=/^\s+and\s+[A-Z][a-z]/i.test(Es);(js||ps||ms)&&ts.push(us)}}const ls=/(?:^|[,;]\s*|\.\s+)([A-Z][a-z]+(?:\s+(?:and|&)\s+[A-Z][a-z]+)*)\s+(and\s+)?(?=enters|exits|walks|runs|stands|sits|looks|turns|moves|says|speaks|watches|stares|smiles|nods|shakes|reaches|grabs|holds|opens|closes|steps|crosses|approaches|leaves|arrives|appears|disappears|rises|falls|jumps|climbs|crawls|lies|kneels|bends|leans|waves|points|gestures|signals|calls|shouts|whispers|laughs|cries|sighs|groans|screams|freezes|pauses|stops|starts|continues|begins|finishes|waits|hesitates|[a-z])/gi;for(;(cs=ls.exec(ss))!==null;){const us=cs[1].split(/\s+(?:and|&)\s+/i);for(const ds of us){const xs=ds.trim().toUpperCase();xs.length>=3&&xs.length<=20&&!ns.has(xs)&&!rs.test(xs)&&!["THE","AND","BUT","FOR","NOT","THIS","THAT","WHEN","WHERE","WHILE","THEN","THERE","HERE"].includes(xs)&&ts.push(xs)}}return[...new Set(ts)]}function isCharacterCue(es){const ts=es.trim();if(ts!==ts.toUpperCase()||ts.length>50)return!1;const ss=[/^(INT\.|EXT\.|INT\/EXT|EXT\/INT|I\/E\.)/i,/^(CUT TO|FADE|DISSOLVE|SMASH|MATCH|WIPE)/i,/^(THE END|CONTINUED|MORE|\(MORE\))/i,/^\d+\s*$/,/^\s*$/,/^(TITLE:|SUPER:|CHYRON:|CARD:|INSERT:|INTERCUT)/i,/^(FLASHBACK|END FLASHBACK|FLASH BACK|DREAM SEQUENCE)/i,/^(BACK TO|RESUME|ANGLE ON|CLOSE ON|WIDE ON|POV)/i,/^(LATER|CONTINUOUS|MOMENTS LATER|SAME TIME)/i,/^(SUPERIMPOSE|SUBTITLE|CAPTION)/i];for(const as of ss)if(as.test(ts))return!1;if(!/[A-Z]/.test(ts))return!1;const ns=[/^(A |AN |THE |HE |SHE |THEY |WE |IT |HIS |HER |THEIR )/,/^(IN THE |AT THE |ON THE |FROM THE |TO THE |INTO THE )/,/^(ARRIVING|ENTERING|LEAVING|WALKING|RUNNING|STANDING|SITTING)/,/ (ENTERS|EXITS|WALKS|RUNS|STANDS|SITS|LOOKS|TURNS|MOVES)$/,/ (IS |ARE |WAS |WERE |HAS |HAVE |THE |A |AN )/,/^[A-Z]+ [A-Z]+ [A-Z]+ [A-Z]+ [A-Z]+/,/\.$/,/^\d+[A-Z]?\s+/];for(const as of ns)if(as.test(ts))return!1;const rs=ts.replace(/\s*\(.*?\)\s*/g,"").trim(),os=rs.split(/\s+/).length;return os>4||os===1&&(/^[A-Z]+(ING|ED|LY|TION|SION|NESS|MENT|ABLE|IBLE|ICAL|IOUS|EOUS|ULAR|TERN|ERN|WARD|WARDS|LIKE|LESS|FUL|IC|AL|ARY|ORY|IVE|OUS|ANT|ENT)$/.test(rs)||new Set(["INT","EXT","ROAD","STREET","HOUSE","ROOM","OFFICE","BUILDING","DAY","NIGHT","MORNING","EVENING","DAWN","DUSK","LATER","CONTINUOUS","EDENIC","VERDANT","TOWERING","LONELY","BEAUTIFUL","GORGEOUS","STUNNING","SERENE","PEACEFUL","WILD","FIERCE","ANCIENT","MODERN","RUSTIC","MOUNTAINS","MOUNTAIN","HILLS","VALLEY","RIVER","STREAM","LAKE","OCEAN","FOREST","WOODS","TREE","TREES","SKY","SUN","MOON","MELTWATER","RED","BLUE","GREEN","YELLOW","ORANGE","PURPLE","BLACK","WHITE","GOLDEN","VERY","MUCH","MORE","MOST","JUST","ONLY","ALSO","EVEN","STILL","WELL","ONE","TWO","THREE","FIRST","SECOND","THIRD","LAST","NEXT","ANOTHER","CONTINUED","FADE","CUT","DISSOLVE","ANGLE","SHOT","VIEW","CLOSE","WIDE"]).has(rs))?!1:rs.length>=2&&rs.length<=35}function parseSceneHeadingLine(es){const ts=es.trim(),ss={sceneNumber:null,intExt:"INT",location:"",timeOfDay:"DAY",rawSlugline:ts,isValid:!1};if(!ts||ts.length<5)return ss;let ns=ts.replace(/\s*\*+\s*$/,"").trim();const rs=/^(\d+[A-Z]?)\s+/i,os=/\s+(\d+[A-Z]?)\s*$/i;let as=null,cs=ns;const ls=cs.match(rs);ls&&(as=ls[1].toUpperCase(),cs=cs.slice(ls[0].length).trim());const us=cs.match(os);if(us){const hs=us[1].toUpperCase();as||(as=hs),cs=cs.slice(0,-us[0].length).trim()}const ds=/^(INT\.?\/EXT\.?|EXT\.?\/INT\.?|I\/E\.?|INT\.?|EXT\.?)\s*/i,xs=cs.match(ds);if(!xs)return ss;const gs=xs[1].toUpperCase().replace(/\.$/,"").startsWith("EXT")?"EXT":"INT";cs=cs.slice(xs[0].length).trim(),cs=cs.replace(/^[\.\-]\s*/,"").trim();const Es=/(?:\s*[-\.]+\s*|\s+)(DAY|NIGHT|MORNING|EVENING|AFTERNOON|DAWN|DUSK|SUNSET|SUNRISE|CONTINUOUS|CONT|LATER|SAME|SAME TIME|MOMENTS LATER|SIMULTANEOUS|MAGIC HOUR|GOLDEN HOUR|FLASHBACK|PRESENT|DREAM|FANTASY|NIGHTMARE|ESTABLISHING)(?:\s*[-]?\s*(?:FLASHBACK|PRESENT|CONT(?:'D)?)?)?$/i;let js="DAY",ps=cs;const ms=cs.match(Es);return ms&&(js=ms[1].toUpperCase(),js==="CONT"&&(js="CONTINUOUS"),ps=cs.slice(0,ms.index).trim(),ps=ps.replace(/[\s\-\.,]+$/,"").trim()),!ms&&cs.length>0&&(ps=cs.replace(/[\s\-\.,]+$/,"").trim()),!ps||ps.length<2?ss:{sceneNumber:as,intExt:gs,location:ps,timeOfDay:js,rawSlugline:ts,isValid:!0}}function convertParsedScriptToProject(es,ts){const ss=new Map,ns=ts.map((os,as)=>{const cs=`char-${v4().slice(0,8)}`;ss.set(os,cs);const ls=os.split(" ").map(xs=>xs[0]).join("").slice(0,2),us=["#C9A961","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444","#3B82F6","#6366F1"],ds=us[as%us.length];return{id:cs,name:os,initials:ls,avatarColour:ds}});return{scenes:es.scenes.map(os=>{const as=os.characters.filter(cs=>ss.has(cs)).map(cs=>ss.get(cs));return{id:`scene-${os.sceneNumber}`,sceneNumber:os.sceneNumber,slugline:`${os.intExt}. ${os.location} - ${os.timeOfDay}`,intExt:os.intExt,timeOfDay:os.timeOfDay,synopsis:os.synopsis,scriptContent:os.content,characters:as,isComplete:!1}}),characters:ns}}async function parseScenesFast(es){const ts=es.name.toLowerCase();let ss;if(ts.endsWith(".pdf"))ss=await extractTextFromPDF(es);else if(ts.endsWith(".fdx")){const ds=await es.text();ss=extractTextFromFDX(ds)}else ss=await es.text();const ns=ss.split(`
`),rs=[];let os=null,as=0,cs="";for(let ds=0;ds<ns.length;ds++){const xs=ns[ds],fs=xs.trim(),gs=parseSceneHeadingLine(fs);if(gs.isValid){os&&(os.scriptContent=cs.trim(),rs.push(os)),as++;const Es=gs.sceneNumber||String(as),js=normalizeTimeOfDayForScene(gs.timeOfDay);os={sceneNumber:Es,slugline:fs,intExt:gs.intExt,location:gs.location,timeOfDay:js,scriptContent:""},cs=fs+`
`;continue}os&&(cs+=xs+`
`)}os&&(os.scriptContent=cs.trim(),rs.push(os));const ls=ss.slice(0,1e3).match(/^(?:title[:\s]*)?([A-Z][A-Z\s\d\-\'\"]+)(?:\n|by)/im);return{title:ls?ls[1].trim():"Untitled Script",scenes:rs,rawText:ss}}async function detectCharactersForScene(es,ts,ss){const ns=[],rs=new Set,os=es.split(`
`);let as=!1;for(let cs=0;cs<os.length;cs++){const us=os[cs].trim();if(isCharacterCue(us)){const ds=normalizeCharacterName(us);ds.length>=2&&!rs.has(ds)&&(rs.add(ds),ns.push(ds)),as=!0}else if(!(as&&us.length>0)){if(as=!1,us.length>10){const ds=extractCharactersFromActionLine(us);for(const xs of ds){const fs=normalizeCharacterName(xs);fs.length>=2&&!rs.has(fs)&&(rs.add(fs),ns.push(fs))}}}}return ns}async function detectCharactersForScenesBatch(es,ts,ss){var cs;const ns=new Map,rs=es.length;let os=0;const as=5;for(let ls=0;ls<es.length;ls+=as){const us=es.slice(ls,ls+as),ds=await Promise.all(us.map(async xs=>{const fs=await detectCharactersForScene(xs.scriptContent);return{sceneNumber:xs.sceneNumber,characters:fs}}));for(const xs of ds)ns.set(xs.sceneNumber,xs.characters),os++,(cs=ss==null?void 0:ss.onProgress)==null||cs.call(ss,os,rs)}return ns}function Home({onProjectReady:es,onBack:ts}){const[ss,ns]=reactExports.useState("welcome"),[rs,os]=reactExports.useState(""),[as,cs]=reactExports.useState(null),[ls,us]=reactExports.useState(null),[,ds]=reactExports.useState(null),[xs,fs]=reactExports.useState(0),[gs,Es]=reactExports.useState("Reading document..."),[js,ps]=reactExports.useState(null),[ms,hs]=reactExports.useState(new Set),[vs,ws]=reactExports.useState(new Map),ys=reactExports.useRef(null),Rs=reactExports.useRef(null),{setProject:bs,setScriptPdf:Ns}=useProjectStore(),{setSchedule:Ss,startAIProcessing:Ts,setAIProcessingStatus:Cs}=useScheduleStore(),Ms=reactExports.useCallback(async(As,_s)=>{try{fs(10),Es("Reading script..."),await new Promise(Gs=>setTimeout(Gs,200));let Ps=null;if(_s){fs(15),Es("Processing schedule...");try{Ps=await parseSchedulePDF(_s),ds(Ps),Ss(Ps),console.log(`Schedule parsed: ${Ps.castList.length} cast, ${Ps.days.length} days`),Cs({status:"idle",progress:0,message:"Initial parsing complete. Starting AI analysis..."}),setTimeout(()=>{Ts()},500)}catch(Gs){console.warn("Schedule parsing failed, continuing without:",Gs)}}fs(30),Es("Detecting scenes...");const Hs=await parseScenesFast(As);fs(60),Es("Matching schedule to scenes..."),await new Promise(Gs=>setTimeout(Gs,100));let Ls=null;if(Ps){const Gs=Hs.scenes.map(lr=>({sceneNumber:lr.sceneNumber,id:`scene-${lr.sceneNumber}`}));Ls=matchScheduleToScript(Ps,Gs)}fs(70),Es("Creating project..."),await new Promise(Gs=>setTimeout(Gs,100));const Os=Hs.scenes.map(Gs=>{const lr=Ls==null?void 0:Ls.get(Gs.sceneNumber);return{id:`scene-${Gs.sceneNumber}`,sceneNumber:Gs.sceneNumber,slugline:Gs.slugline,intExt:Gs.intExt,timeOfDay:Gs.timeOfDay,scriptContent:Gs.scriptContent,characters:[],isComplete:!1,characterConfirmationStatus:lr!=null&&lr.characterNames.length?"ready":"pending",suggestedCharacters:(lr==null?void 0:lr.characterNames)||void 0,shootingDay:lr==null?void 0:lr.shootingDay}}),Ws={id:`project-${Date.now()}`,name:rs||Hs.title||As.name.replace(/\.[^/.]+$/,"").replace(/[-_]/g," ")||"Untitled Project",createdAt:new Date,updatedAt:new Date,scenes:Os,characters:[],looks:[],characterDetectionStatus:Ps?"complete":"idle",scenesConfirmed:0};if(fs(90),Es("Almost done..."),await new Promise(Gs=>setTimeout(Gs,200)),fs(100),Es("Complete!"),Ws._rawText=Hs.rawText,Ps&&(Ws._scheduleCastList=Ps.castList),bs(Ws),As.type==="application/pdf"){const Gs=new FileReader;Gs.onload=()=>{const lr=Gs.result;Ns(lr)},Gs.readAsDataURL(As)}Ps||setTimeout(()=>{Is(Ws,Hs.rawText)},500),setTimeout(()=>es(),500)}catch(Ps){console.error("Script parsing error:",Ps),alert(Ps instanceof Error?Ps.message:"Failed to parse script"),ns("upload")}},[rs,bs,Ns,Ss,es]),Is=reactExports.useCallback(async(As,_s)=>{try{useProjectStore.getState().startCharacterDetection();const Ps=As.scenes.map(Os=>({sceneNumber:Os.sceneNumber,scriptContent:Os.scriptContent||""})),Hs=await detectCharactersForScenesBatch(Ps,_s,{useAI:!1,onProgress:(Os,Ws)=>{console.log(`Character detection: ${Os}/${Ws}`)}}),Ls=useProjectStore.getState();Hs.forEach((Os,Ws)=>{const Gs=As.scenes.find(lr=>lr.sceneNumber===Ws);Gs&&Ls.updateSceneSuggestedCharacters(Gs.id,Os)}),Ls.setCharacterDetectionStatus("complete")}catch(Ps){console.error("Background character detection failed:",Ps),useProjectStore.getState().setCharacterDetectionStatus("complete")}},[]),Qs=reactExports.useCallback(async(As,_s)=>Ms(As,_s),[Ms]),Ys=As=>{var Ps;const _s=(Ps=As.target.files)==null?void 0:Ps[0];if(_s){cs(_s);const Hs=_s.name.replace(/\.[^/.]+$/,"").replace(/[-_]/g," ");os(Hs)}},Zs=As=>{var Ps;const _s=(Ps=As.target.files)==null?void 0:Ps[0];_s&&us(_s)},Vs=()=>{as&&(ns("processing"),Qs(as,ls))},Ks=()=>{if(!js){const Os={id:`project-${Date.now()}`,name:rs||"Untitled Project",createdAt:new Date,updatedAt:new Date,scenes:[],characters:[],looks:[]};bs(Os),es();return}const As=Array.from(ms).filter(Os=>!vs.has(Os)),{scenes:_s,characters:Ps}=convertParsedScriptToProject(js,As),Hs=Ps.map(Os=>({id:`look-${Os.id}`,characterId:Os.id,name:"Look 1",scenes:_s.filter(Ws=>Ws.characters.includes(Os.id)).map(Ws=>Ws.sceneNumber),estimatedTime:30,makeup:createEmptyMakeupDetails(),hair:createEmptyHairDetails()})),Ls={id:`project-${Date.now()}`,name:rs||js.title||"Untitled Project",createdAt:new Date,updatedAt:new Date,scenes:_s,characters:Ps,looks:Hs};bs(Ls),es()},Ds=()=>{bs(demoProject),es()},$s=()=>{ps(null),hs(new Set),ns("setup")},Xs=As=>{hs(_s=>{const Ps=new Set(_s);return Ps.has(As)?Ps.delete(As):Ps.add(As),Ps})},Fs=(As,_s)=>{ws(Ps=>{const Hs=new Map(Ps);return As===_s?Hs.delete(As):Hs.set(As,_s),Hs}),hs(Ps=>{const Hs=new Set(Ps);return Hs.add(_s),Hs})};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background safe-top safe-bottom",children:[ss==="welcome"&&jsxRuntimeExports.jsx(WelcomeScreen$1,{onUploadScript:()=>ns("upload"),onLoadDemo:Ds,onBack:ts}),ss==="upload"&&jsxRuntimeExports.jsx(UploadScreen,{fileInputRef:ys,scheduleInputRef:Rs,uploadedFile:as,uploadedScheduleFile:ls,onBack:()=>ns("welcome"),onSkip:$s,onStartWithFiles:Vs}),ss==="processing"&&jsxRuntimeExports.jsx(ProcessingScreen,{fileName:(as==null?void 0:as.name)||"",progress:xs,status:gs}),ss==="characters"&&js&&jsxRuntimeExports.jsx(CharacterSelectionScreen,{parsedScript:js,selectedCharacters:ms,mergeMap:vs,onToggleCharacter:Xs,onMergeCharacter:Fs,onContinue:()=>ns("setup"),onBack:()=>ns("upload")}),ss==="setup"&&jsxRuntimeExports.jsx(SetupScreen,{projectName:rs,onNameChange:os,detectedScenes:(js==null?void 0:js.scenes.length)||0,detectedCharacters:Array.from(ms).filter(As=>!vs.has(As)),onStart:Ks,onBack:()=>ns(js?"characters":"upload")}),jsxRuntimeExports.jsx("input",{ref:ys,type:"file",accept:".pdf,.fdx,.fountain,.txt",onChange:Ys,className:"hidden"}),jsxRuntimeExports.jsx("input",{ref:Rs,type:"file",accept:".pdf",onChange:Zs,className:"hidden"})]})}function WelcomeScreen$1({onUploadScript:es,onLoadDemo:ts,onBack:ss}){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen",children:[ss&&jsxRuntimeExports.jsx("header",{className:"flex items-center px-4 py-3",children:jsxRuntimeExports.jsx("button",{onClick:ss,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 -ml-2","aria-label":"Go back",children:jsxRuntimeExports.jsxs("svg",{className:"w-6 h-6 text-text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M19 12H5"}),jsxRuntimeExports.jsx("path",{d:"M12 19l-7-7 7-7"})]})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-6 py-12",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-2xl gold-gradient flex items-center justify-center mb-6 shadow-lg",children:jsxRuntimeExports.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42"})})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Hair & Makeup Pro"}),jsxRuntimeExports.jsx("p",{className:"text-text-muted text-center max-w-xs mb-8",children:"Your mobile companion for on-set continuity tracking keeping checks happy"}),jsxRuntimeExports.jsxs("div",{className:"w-full max-w-sm space-y-3 mb-8",children:[jsxRuntimeExports.jsx(FeatureItem,{icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),text:"Import your script to auto-detect scenes & characters"}),jsxRuntimeExports.jsx(FeatureItem,{icon:jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]}),text:"Capture and organize continuity photos"}),jsxRuntimeExports.jsx(FeatureItem,{icon:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),text:"Track your hours and manage timesheets"})]})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 pb-8 space-y-3",children:[jsxRuntimeExports.jsx("button",{onClick:es,className:"w-full py-4 rounded-button gold-gradient text-white font-semibold text-base shadow-lg active:scale-[0.98] transition-transform",children:"Upload Files"}),jsxRuntimeExports.jsx("button",{onClick:ts,className:"w-full py-3 rounded-button bg-gray-100 text-text-secondary font-medium text-sm active:scale-[0.98] transition-transform",children:"Try with Demo Project"})]})]})}function FeatureItem({icon:es,text:ts}){return jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-card rounded-xl border border-border",children:[jsxRuntimeExports.jsx("div",{className:"text-gold",children:es}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-secondary",children:ts})]})}function UploadScreen({fileInputRef:es,scheduleInputRef:ts,uploadedFile:ss,uploadedScheduleFile:ns,onBack:rs,onSkip:os,onStartWithFiles:as}){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen",children:[jsxRuntimeExports.jsxs("div",{className:"px-4 py-3 flex items-center gap-3 border-b border-border",children:[jsxRuntimeExports.jsx("button",{onClick:rs,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Upload Files"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-6",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary",children:"Script"}),jsxRuntimeExports.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gold/10 text-gold",children:"Required"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>{var cs;return(cs=es.current)==null?void 0:cs.click()},className:`w-full rounded-2xl border-2 border-dashed transition-colors p-6 ${ss?"border-green-400 bg-green-50":"border-gold/40 bg-gold/5 active:bg-gold/10"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${ss?"bg-green-100":"bg-gold/10"}`,children:ss?jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})})}),jsxRuntimeExports.jsx("div",{className:"flex-1 text-left",children:ss?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-green-700 truncate",children:ss.name}),jsxRuntimeExports.jsx("p",{className:"text-xs text-green-600",children:"Tap to change"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Tap to upload script"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"PDF, Final Draft, or Fountain"})]})})]})})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary",children:"Production Schedule"}),jsxRuntimeExports.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-text-muted",children:"Optional"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>{var cs;return(cs=ts.current)==null?void 0:cs.click()},className:`w-full rounded-2xl border-2 border-dashed transition-colors p-6 ${ns?"border-green-400 bg-green-50":"border-gray-300 bg-gray-50 active:bg-gray-100"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${ns?"bg-green-100":"bg-gray-100"}`,children:ns?jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"})})}),jsxRuntimeExports.jsx("div",{className:"flex-1 text-left",children:ns?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-green-700 truncate",children:ns.name}),jsxRuntimeExports.jsx("p",{className:"text-xs text-green-600",children:"Tap to change"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-secondary",children:"Tap to upload schedule"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"PDF (strips, one-liner)"})]})})]})}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-light mt-2 px-2",children:"Uploading a schedule gives you accurate character assignments per scene and shooting day info"})]}),jsxRuntimeExports.jsx("div",{className:"rounded-xl bg-blue-50 border border-blue-100 p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-blue-700",children:[jsxRuntimeExports.jsx("p",{className:"font-medium mb-1",children:"Faster with Schedule"}),jsxRuntimeExports.jsx("p",{children:"The schedule contains the official cast list with character numbers. This allows instant, accurate character detection per scene without AI processing."})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 pb-8 pt-4 border-t border-border space-y-3",children:[jsxRuntimeExports.jsx("button",{onClick:as,disabled:!ss,className:"w-full py-4 rounded-button gold-gradient text-white font-semibold text-base shadow-lg active:scale-[0.98] transition-transform disabled:opacity-50 disabled:active:scale-100",children:ss?"Start Processing":"Upload a script to continue"}),jsxRuntimeExports.jsx("button",{onClick:os,className:"w-full py-3 text-sm text-text-muted font-medium active:text-gold transition-colors",children:"Skip - I'll add scenes manually"})]})]})}function ProcessingScreen({fileName:es,progress:ts,status:ss}){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen items-center justify-center px-6",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 rounded-full bg-gold/10 flex items-center justify-center mb-6",children:jsxRuntimeExports.jsx("svg",{className:"w-10 h-10 text-gold animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})})}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-2",children:"Processing Script"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-6 truncate max-w-full",children:es}),jsxRuntimeExports.jsxs("div",{className:"w-full max-w-xs",children:[jsxRuntimeExports.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden mb-2",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-gold rounded-full transition-all duration-300",style:{width:`${ts}%`}})}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-light text-center mb-4",children:ss}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted text-center leading-relaxed",children:"Detecting scenes in your script. You'll be able to confirm characters scene-by-scene."})]})]})}function CharacterSelectionScreen({parsedScript:es,selectedCharacters:ts,mergeMap:ss,onToggleCharacter:ns,onMergeCharacter:rs,onContinue:os,onBack:as}){const[cs,ls]=reactExports.useState(!1),[us,ds]=reactExports.useState(null),xs=[...es.characters].sort((gs,Es)=>Es.sceneCount-gs.sceneCount),fs=gs=>{ds(gs),ls(!0)};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen",children:[jsxRuntimeExports.jsxs("div",{className:"px-4 py-3 flex items-center gap-3 border-b border-border",children:[jsxRuntimeExports.jsx("button",{onClick:as,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Select Characters"})]}),jsxRuntimeExports.jsx("div",{className:"px-6 py-4 bg-gold/5 border-b border-border",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-around text-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-gold",children:es.scenes.length}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Scenes"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-gold",children:es.characters.length}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Characters Found"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-gold",children:ts.size-ss.size}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-muted",children:"Selected"})]})]})}),jsxRuntimeExports.jsx("div",{className:"px-6 py-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted",children:"Select the characters you want to track. Tap the merge icon to combine similar characters."})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto px-6 pb-6",children:jsxRuntimeExports.jsx("div",{className:"space-y-2",children:xs.map(gs=>{const Es=ts.has(gs.name),js=ss.get(gs.name),ps=!!js;return jsxRuntimeExports.jsx("div",{className:`rounded-xl border transition-all ${ps?"border-gray-200 bg-gray-50 opacity-60":Es?"border-gold bg-gold/5":"border-border bg-card"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 p-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>!ps&&ns(gs.name),disabled:ps,className:`w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all ${ps?"border-gray-300 bg-gray-200":Es?"border-gold bg-gold":"border-gray-300"}`,children:(Es||ps)&&jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:`font-medium truncate ${ps?"text-text-muted line-through":"text-text-primary"}`,children:gs.name}),ps&&jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted",children:[" ",js]})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-muted",children:[gs.sceneCount," scene",gs.sceneCount!==1?"s":"",gs.variants.length>1&&`  ${gs.variants.length} variants`]})]}),!ps&&jsxRuntimeExports.jsx("button",{onClick:()=>fs(gs.name),className:"p-2 text-text-muted hover:text-gold transition-colors",title:"Merge with another character",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 002.25-2.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v2.25A2.25 2.25 0 006 10.5zm0 9.75h2.25A2.25 2.25 0 0010.5 18v-2.25a2.25 2.25 0 00-2.25-2.25H6a2.25 2.25 0 00-2.25 2.25V18A2.25 2.25 0 006 20.25zm9.75-9.75H18a2.25 2.25 0 002.25-2.25V6A2.25 2.25 0 0018 3.75h-2.25A2.25 2.25 0 0013.5 6v2.25a2.25 2.25 0 002.25 2.25z"})})})]})},gs.name)})})}),jsxRuntimeExports.jsx("div",{className:"px-6 pb-8 pt-4 border-t border-border",children:jsxRuntimeExports.jsxs("button",{onClick:os,disabled:ts.size-ss.size===0,className:"w-full py-4 rounded-button gold-gradient text-white font-semibold text-base shadow-lg active:scale-[0.98] transition-transform disabled:opacity-50",children:["Continue with ",ts.size-ss.size," Character",ts.size-ss.size!==1?"s":""]})}),cs&&us&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-end justify-center",children:jsxRuntimeExports.jsxs("div",{className:"bg-card w-full max-w-lg rounded-t-3xl max-h-[70vh] flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:['Merge "',us,'" into...']}),jsxRuntimeExports.jsx("button",{onClick:()=>ls(!1),className:"p-2 text-text-muted",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[ss.has(us)&&jsxRuntimeExports.jsxs("button",{onClick:()=>{rs(us,us),ls(!1)},className:"w-full p-3 text-left rounded-lg border border-red-200 bg-red-50 text-red-700",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Remove merge"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-red-500 block",children:"Keep as separate character"})]}),xs.filter(gs=>gs.name!==us&&!ss.has(gs.name)).map(gs=>jsxRuntimeExports.jsxs("button",{onClick:()=>{rs(us,gs.name),ls(!1)},className:"w-full p-3 text-left rounded-lg border border-border bg-card hover:border-gold transition-colors",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-text-primary",children:gs.name}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-text-muted block",children:[gs.sceneCount," scenes"]})]},gs.name))]})})]})})]})}function SetupScreen({projectName:es,onNameChange:ts,detectedScenes:ss,detectedCharacters:ns,onStart:rs,onBack:os}){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen",children:[jsxRuntimeExports.jsxs("div",{className:"px-4 py-3 flex items-center gap-3 border-b border-border",children:[jsxRuntimeExports.jsx("button",{onClick:os,className:"p-2 -ml-2 text-text-muted active:text-gold transition-colors",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold text-text-primary",children:"Project Setup"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 px-6 py-6",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"Project Name"}),jsxRuntimeExports.jsx("input",{type:"text",value:es,onChange:as=>ts(as.target.value),placeholder:"Enter project name",className:"input-field w-full text-base"})]}),(ss>0||ns.length>0)&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("h3",{className:"section-header",children:"DETECTED FROM SCRIPT"}),ss>0&&jsxRuntimeExports.jsxs("div",{className:"card flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-gold/10 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.875 1.875 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"})})}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary",children:"Scenes"})]}),jsxRuntimeExports.jsx("span",{className:"text-lg font-bold text-gold",children:ss})]}),ns.length>0&&jsxRuntimeExports.jsxs("div",{className:"card",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-gold/10 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5 text-gold",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})})}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-text-primary",children:"Characters"}),jsxRuntimeExports.jsx("span",{className:"ml-auto text-lg font-bold text-gold",children:ns.length})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:ns.map(as=>jsxRuntimeExports.jsx("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-gray-100 text-text-secondary",children:as},as))})]})]}),ss===0&&ns.length===0&&jsxRuntimeExports.jsxs("div",{className:"card text-center py-8",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-2",children:"No script uploaded"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-text-light",children:"You can add scenes and characters manually after setup"})]})]}),jsxRuntimeExports.jsx("div",{className:"px-6 pb-8",children:jsxRuntimeExports.jsx("button",{onClick:rs,disabled:!es.trim(),className:"w-full py-4 rounded-button gold-gradient text-white font-semibold text-base shadow-lg active:scale-[0.98] transition-transform disabled:opacity-50 disabled:active:scale-100",children:"Start Project"})})]})}const SUGGESTIONS=[{label:"Character overview",prompt:"Give me an overview of all characters and their looks in this project"},{label:"Continuity tracking",prompt:"What continuity events should I track across scenes?"},{label:"Complex H&MU scenes",prompt:"Which scenes have the most complex hair and makeup requirements?"}];function ChatAssistant(){const{messages:es,isOpen:ts,isLoading:ss,error:ns,toggleChat:rs,closeChat:os,sendMessage:as,clearMessages:cs}=useChatStore(),[ls,us]=reactExports.useState(""),ds=reactExports.useRef(null),xs=reactExports.useRef(null);reactExports.useEffect(()=>{ts&&ds.current&&ds.current.scrollIntoView({behavior:"smooth"})},[es,ts]),reactExports.useEffect(()=>{ts&&xs.current&&xs.current.focus()},[ts]);const fs=()=>{const hs=useProjectStore.getState(),vs=useTimesheetStore.getState(),ws=[];if(hs.currentProject){const Rs=hs.currentProject;ws.push(`Project: ${Rs.name}`),ws.push(`Characters: ${Rs.characters.length}`),ws.push(`Scenes: ${Rs.scenes.length}`),ws.push(`Looks: ${Rs.looks.length}`),Rs.characters.length>0&&(ws.push(`
Characters:`),Rs.characters.slice(0,10).forEach(Ns=>{const Ss=Rs.looks.filter(Ts=>Ts.characterId===Ns.id);ws.push(`- ${Ns.name} (${Ns.initials}): ${Ss.length} looks`)}));const bs=Rs.scenes.filter(Ns=>Ns.isComplete).length;ws.push(`
Scenes: ${bs}/${Rs.scenes.length} complete`)}const ys=Object.values(vs.entries);if(ys.length>0){const Rs=ys.reduce((bs,Ns)=>{const Ss=vs.calculateEntry(Ns);return bs+Ss.totalHours},0);ws.push(`
Timesheet: ${ys.length} days logged, ${Rs.toFixed(1)} total hours`)}return ws.join(`
`)||"No project data available yet."},gs=async()=>{const hs=ls.trim();if(!hs||ss)return;us("");const vs=fs();await as(hs,vs)},Es=hs=>{us(hs);const vs=fs();as(hs,vs)},js=hs=>{hs.key==="Enter"&&!hs.shiftKey&&(hs.preventDefault(),gs())},ps=hs=>hs.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,'<code class="bg-black/20 px-1 rounded text-sm">$1</code>').replace(/\n/g,"<br />"),ms=es.length>0;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:rs,className:`fixed bottom-24 right-4 z-50 w-14 h-14 rounded-full shadow-lg flex items-center justify-center transition-all active:scale-95 ${ts?"gold-gradient rotate-0":"gold-gradient"}`,style:{boxShadow:"0 4px 20px rgba(201, 169, 97, 0.4)"},"aria-label":ts?"Close chat":"Open chat assistant",children:ts?jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),ts&&jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-30 flex flex-col",style:{backgroundColor:"var(--color-background)"},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-4 py-3 safe-top",style:{backgroundColor:"var(--color-card)",borderBottom:"1px solid var(--color-border)"},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 rounded-full bg-success animate-pulse"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--color-text-primary)"},children:"Claude Assistant"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:cs,className:"p-2 rounded-lg transition-colors",style:{color:"var(--color-text-muted)"},title:"Clear chat",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),jsxRuntimeExports.jsx("button",{onClick:os,className:"p-2 rounded-lg transition-colors",style:{color:"var(--color-text-muted)"},children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4",children:ms?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[es.map(hs=>jsxRuntimeExports.jsx("div",{className:`flex ${hs.role==="user"?"justify-end":"justify-start"}`,children:jsxRuntimeExports.jsx("div",{className:`max-w-[85%] rounded-2xl px-4 py-3 ${hs.role==="user"?"gold-gradient text-white rounded-br-sm":"rounded-bl-sm"}`,style:hs.role==="assistant"?{backgroundColor:"var(--color-card)",border:"1px solid var(--color-border)",color:"var(--color-text-primary)"}:void 0,children:jsxRuntimeExports.jsx("div",{className:"text-sm leading-relaxed",dangerouslySetInnerHTML:{__html:ps(hs.content)}})})},hs.id)),ss&&jsxRuntimeExports.jsx("div",{className:"flex justify-start",children:jsxRuntimeExports.jsx("div",{className:"rounded-2xl rounded-bl-sm px-4 py-3",style:{backgroundColor:"var(--color-card)",border:"1px solid var(--color-border)"},children:jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-2 h-2 rounded-full animate-bounce",style:{backgroundColor:"var(--color-text-muted)",animationDelay:"0ms"}}),jsxRuntimeExports.jsx("span",{className:"w-2 h-2 rounded-full animate-bounce",style:{backgroundColor:"var(--color-text-muted)",animationDelay:"150ms"}}),jsxRuntimeExports.jsx("span",{className:"w-2 h-2 rounded-full animate-bounce",style:{backgroundColor:"var(--color-text-muted)",animationDelay:"300ms"}})]})})}),ns&&jsxRuntimeExports.jsx("div",{className:"text-center py-2",children:jsxRuntimeExports.jsx("span",{className:"text-sm text-error",children:ns})}),jsxRuntimeExports.jsx("div",{ref:ds})]}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[jsxRuntimeExports.jsx("div",{className:"text-5xl mb-4",children:""}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--color-text-primary)"},children:"Project Assistant"}),jsxRuntimeExports.jsx("p",{className:"text-sm mb-6",style:{color:"var(--color-text-muted)"},children:"I have access to your project data including characters, looks, scenes, and timesheets. How can I help?"}),jsxRuntimeExports.jsx("div",{className:"space-y-2 w-full max-w-sm",children:SUGGESTIONS.map((hs,vs)=>jsxRuntimeExports.jsx("button",{onClick:()=>Es(hs.prompt),className:"w-full p-3 rounded-card text-left transition-all active:scale-[0.98]",style:{backgroundColor:"var(--color-card)",border:"1px solid var(--color-border)"},children:jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:hs.label})},vs))})]})}),jsxRuntimeExports.jsx("div",{className:"px-4 pt-3 pb-24",style:{backgroundColor:"var(--color-card)",borderTop:"1px solid var(--color-border)"},children:jsxRuntimeExports.jsxs("div",{className:"flex items-end gap-2",children:[jsxRuntimeExports.jsx("textarea",{ref:xs,value:ls,onChange:hs=>us(hs.target.value),onKeyDown:js,placeholder:"Ask about your project...",rows:1,className:"flex-1 input-field resize-none max-h-32",style:{minHeight:"44px"},disabled:ss}),jsxRuntimeExports.jsx("button",{onClick:gs,disabled:!ls.trim()||ss,className:"p-3 rounded-button gold-gradient text-white disabled:opacity-50 transition-all active:scale-95",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})]})}class ErrorBoundary extends reactExports.Component{constructor(ss){super(ss);eo(this,"handleTryAgain",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});eo(this,"handleReload",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(ss){return{hasError:!0,error:ss}}componentDidCatch(ss,ns){console.error("ErrorBoundary caught an error:",ss,ns),this.setState({errorInfo:ns})}render(){return this.state.hasError?jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:jsxRuntimeExports.jsxs("div",{className:"max-w-md w-full text-center",children:[jsxRuntimeExports.jsx("div",{className:"mx-auto w-16 h-16 mb-6 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),jsxRuntimeExports.jsx("h1",{className:"text-xl font-semibold text-text-primary mb-2",children:"Something went wrong"}),jsxRuntimeExports.jsx("p",{className:"text-text-muted mb-6",children:"The app encountered an unexpected error. Please try again or reload the page."}),!1,jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:this.handleTryAgain,className:"w-full py-3 px-4 rounded-button gold-gradient text-white font-semibold shadow-md active:scale-[0.98] transition-transform",children:"Try Again"}),jsxRuntimeExports.jsx("button",{onClick:this.handleReload,className:"w-full py-3 px-4 rounded-button bg-card border border-border text-text-primary font-medium hover:bg-background-secondary transition-colors",children:"Reload Page"})]})]})}):this.props.children}}function WelcomeScreen(){const{setScreen:es}=useAuthStore();return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-8",children:[jsxRuntimeExports.jsx("div",{className:"mb-6 animate-scaleIn",style:{animationDelay:"0.1s",opacity:0,animationFillMode:"forwards"},children:jsxRuntimeExports.jsx("div",{className:"w-24 h-24 flex items-center justify-center",children:jsxRuntimeExports.jsxs("svg",{className:"w-20 h-20",viewBox:"0 0 80 80",fill:"none",children:[jsxRuntimeExports.jsx("circle",{cx:"40",cy:"40",r:"38",className:"stroke-gold/30 dark:stroke-transparent",strokeWidth:"1.5",fill:"none"}),jsxRuntimeExports.jsx("defs",{children:jsxRuntimeExports.jsxs("linearGradient",{id:"goldGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[jsxRuntimeExports.jsx("stop",{offset:"0%",stopColor:"#D4BC7D"}),jsxRuntimeExports.jsx("stop",{offset:"50%",stopColor:"#C9A962"}),jsxRuntimeExports.jsx("stop",{offset:"100%",stopColor:"#B8962E"})]})}),jsxRuntimeExports.jsx("path",{d:"M24 42L35 53L56 28",stroke:"url(#goldGradient)",strokeWidth:"5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})]})})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-semibold tracking-[0.3em] text-text-primary mb-3 animate-fadeInUp",style:{animationDelay:"0.2s",opacity:0,animationFillMode:"forwards"},children:"CHECKS HAPPY"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-secondary tracking-wide mb-12 animate-fadeInUp",style:{animationDelay:"0.25s",opacity:0,animationFillMode:"forwards"},children:"Hair & Makeup Continuity Simplified"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-0 mb-12 animate-fadeInUp",style:{animationDelay:"0.3s",opacity:0,animationFillMode:"forwards"},children:[jsxRuntimeExports.jsx(FeatureIcon,{icon:jsxRuntimeExports.jsxs("svg",{className:"w-7 h-7",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[jsxRuntimeExports.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),jsxRuntimeExports.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),jsxRuntimeExports.jsx("path",{d:"M21 15l-5-5L5 21"})]}),label:"Capture"}),jsxRuntimeExports.jsx("div",{className:"w-px h-12 bg-border mx-6"}),jsxRuntimeExports.jsx(FeatureIcon,{icon:jsxRuntimeExports.jsxs("svg",{className:"w-7 h-7",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[jsxRuntimeExports.jsx("path",{d:"M12 2v4"}),jsxRuntimeExports.jsx("path",{d:"M12 18v4"}),jsxRuntimeExports.jsx("path",{d:"M4.93 4.93l2.83 2.83"}),jsxRuntimeExports.jsx("path",{d:"M16.24 16.24l2.83 2.83"}),jsxRuntimeExports.jsx("path",{d:"M2 12h4"}),jsxRuntimeExports.jsx("path",{d:"M18 12h4"}),jsxRuntimeExports.jsx("path",{d:"M4.93 19.07l2.83-2.83"}),jsxRuntimeExports.jsx("path",{d:"M16.24 7.76l2.83-2.83"})]}),label:"Track"}),jsxRuntimeExports.jsx("div",{className:"w-px h-12 bg-border mx-6"}),jsxRuntimeExports.jsx(FeatureIcon,{icon:jsxRuntimeExports.jsxs("svg",{className:"w-7 h-7",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[jsxRuntimeExports.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),jsxRuntimeExports.jsx("circle",{cx:"9",cy:"7",r:"4"}),jsxRuntimeExports.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),jsxRuntimeExports.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),label:"Collaborate"})]})]}),jsxRuntimeExports.jsxs("div",{className:"px-8 pb-12 space-y-3 animate-fadeInUp",style:{animationDelay:"0.4s",opacity:0,animationFillMode:"forwards"},children:[jsxRuntimeExports.jsx("button",{onClick:()=>es("signin"),className:`w-full h-14 rounded-lg font-semibold text-base transition-all duration-200
            bg-text-primary text-background hover:opacity-90 active:scale-[0.98]
            dark:gold-gradient dark:text-white dark:shadow-lg dark:shadow-gold/20`,children:"Sign In"}),jsxRuntimeExports.jsx("button",{onClick:()=>es("signup"),className:`w-full h-14 rounded-lg font-semibold text-base transition-all duration-200
            border-2 border-text-primary text-text-primary hover:bg-text-primary/5 active:scale-[0.98]
            dark:border-gold dark:text-gold dark:hover:bg-gold/10`,children:"Create Account"}),jsxRuntimeExports.jsx("div",{className:"pt-6 text-center",children:jsxRuntimeExports.jsx("button",{className:"text-sm text-text-muted hover:text-text-secondary transition-colors",onClick:()=>es("signin"),children:"Forgot Password?"})})]})]})}function FeatureIcon({icon:es,label:ts}){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"text-gold",children:es}),jsxRuntimeExports.jsx("span",{className:"text-xs text-text-secondary tracking-wide",children:ts})]})}function SignInScreen(){const{setScreen:es,goBack:ts,signIn:ss,isLoading:ns,error:rs,clearError:os}=useAuthStore(),[as,cs]=reactExports.useState(""),[ls,us]=reactExports.useState(""),[ds,xs]=reactExports.useState(!1),fs=async Es=>{Es.preventDefault(),os(),as.trim()&&ls&&await ss(as.trim(),ls)},gs=as.trim()&&ls;return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"flex items-center px-4 py-3 safe-top",children:jsxRuntimeExports.jsx("button",{onClick:ts,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 -ml-2","aria-label":"Go back",children:jsxRuntimeExports.jsxs("svg",{className:"w-6 h-6 text-text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M19 12H5"}),jsxRuntimeExports.jsx("path",{d:"M12 19l-7-7 7-7"})]})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 px-6 pt-4",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Welcome back"}),jsxRuntimeExports.jsx("p",{className:"text-text-secondary mb-8",children:"Sign in to access your projects"}),jsxRuntimeExports.jsxs("form",{onSubmit:fs,className:"space-y-4",children:[jsxRuntimeExports.jsx(Input,{type:"email",label:"Email",placeholder:"your@email.com",value:as,onChange:Es=>cs(Es.target.value),autoComplete:"email",autoCapitalize:"none",disabled:ns}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Input,{type:ds?"text":"password",label:"Password",placeholder:"Enter your password",value:ls,onChange:Es=>us(Es.target.value),autoComplete:"current-password",disabled:ns}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>xs(!ds),className:"absolute right-3 top-8 text-text-muted hover:text-text-secondary",tabIndex:-1,children:ds?jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"}),jsxRuntimeExports.jsx("path",{d:"M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"}),jsxRuntimeExports.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),jsxRuntimeExports.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]}),rs&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-700",children:rs})}),jsxRuntimeExports.jsx("div",{className:"text-right",children:jsxRuntimeExports.jsx("button",{type:"button",className:"text-sm text-gold hover:underline",onClick:()=>{},children:"Forgot password?"})}),jsxRuntimeExports.jsx(Button,{type:"submit",fullWidth:!0,size:"lg",disabled:!gs||ns,children:ns?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",fill:"none",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Signing in..."]}):"Sign In"})]})]}),jsxRuntimeExports.jsx("div",{className:"px-6 py-6 pb-safe-bottom text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-text-secondary",children:["Don't have an account?"," ",jsxRuntimeExports.jsx("button",{onClick:()=>es("signup"),className:"text-gold font-medium hover:underline",children:"Sign up"})]})})]})}function SignUpScreen(){const{setScreen:es,goBack:ts,signUp:ss,isLoading:ns,error:rs,clearError:os}=useAuthStore(),[as,cs]=reactExports.useState(""),[ls,us]=reactExports.useState(""),[ds,xs]=reactExports.useState(""),[fs,gs]=reactExports.useState(""),[Es,js]=reactExports.useState(!1),[ps,ms]=reactExports.useState({}),hs=()=>{const ys={};return as.trim()||(ys.name="Name is required"),ls.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ls)||(ys.email="Please enter a valid email"):ys.email="Email is required",ds?ds.length<8&&(ys.password="Password must be at least 8 characters"):ys.password="Password is required",fs?ds!==fs&&(ys.confirmPassword="Passwords do not match"):ys.confirmPassword="Please confirm your password",ms(ys),Object.keys(ys).length===0},vs=async ys=>{ys.preventDefault(),os(),hs()&&await ss(as.trim(),ls.trim(),ds)},ws=as.trim()&&ls.trim()&&ds&&fs;return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"flex items-center px-4 py-3 safe-top",children:jsxRuntimeExports.jsx("button",{onClick:ts,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 -ml-2","aria-label":"Go back",children:jsxRuntimeExports.jsxs("svg",{className:"w-6 h-6 text-text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M19 12H5"}),jsxRuntimeExports.jsx("path",{d:"M12 19l-7-7 7-7"})]})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 px-6 pt-4 overflow-y-auto",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Create account"}),jsxRuntimeExports.jsx("p",{className:"text-text-secondary mb-8",children:"Join Checks Happy and start tracking"}),jsxRuntimeExports.jsxs("form",{onSubmit:vs,className:"space-y-4",children:[jsxRuntimeExports.jsx(Input,{type:"text",label:"Name",placeholder:"Your name",value:as,onChange:ys=>{cs(ys.target.value),ps.name&&ms(Rs=>({...Rs,name:void 0}))},autoComplete:"name",disabled:ns,error:ps.name}),jsxRuntimeExports.jsx(Input,{type:"email",label:"Email",placeholder:"your@email.com",value:ls,onChange:ys=>{us(ys.target.value),ps.email&&ms(Rs=>({...Rs,email:void 0}))},autoComplete:"email",autoCapitalize:"none",disabled:ns,error:ps.email}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Input,{type:Es?"text":"password",label:"Password",placeholder:"At least 8 characters",value:ds,onChange:ys=>{xs(ys.target.value),ps.password&&ms(Rs=>({...Rs,password:void 0}))},autoComplete:"new-password",disabled:ns,error:ps.password}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>js(!Es),className:"absolute right-3 top-8 text-text-muted hover:text-text-secondary",tabIndex:-1,children:Es?jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"}),jsxRuntimeExports.jsx("path",{d:"M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"}),jsxRuntimeExports.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),jsxRuntimeExports.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]}),jsxRuntimeExports.jsx(Input,{type:Es?"text":"password",label:"Confirm Password",placeholder:"Re-enter your password",value:fs,onChange:ys=>{gs(ys.target.value),ps.confirmPassword&&ms(Rs=>({...Rs,confirmPassword:void 0}))},autoComplete:"new-password",disabled:ns,error:ps.confirmPassword}),rs&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-700",children:rs})}),jsxRuntimeExports.jsx("div",{className:"pt-2",children:jsxRuntimeExports.jsx(Button,{type:"submit",fullWidth:!0,size:"lg",disabled:!ws||ns,children:ns?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",fill:"none",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Creating account..."]}):"Create Account"})})]})]}),jsxRuntimeExports.jsx("div",{className:"px-6 py-6 pb-safe-bottom text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-text-secondary",children:["Already have an account?"," ",jsxRuntimeExports.jsx("button",{onClick:()=>es("signin"),className:"text-gold font-medium hover:underline",children:"Sign in"})]})})]})}function JoinProjectScreen(){const{setScreen:es,goBack:ts,joinProject:ss,isLoading:ns,error:rs,clearError:os,isAuthenticated:as}=useAuthStore(),[cs,ls]=reactExports.useState(""),[us,ds]=reactExports.useState(null),xs=js=>{const ps=formatProjectCode(js.target.value);ls(ps),rs&&os()},fs=async js=>{if(js.preventDefault(),os(),ds(null),!isValidProjectCode(cs))return;const ps=await ss(cs);ps.success&&ps.projectName&&ds({projectName:ps.projectName})},gs=isValidProjectCode(cs),Es=us&&!as;return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"flex items-center px-4 py-3 safe-top",children:jsxRuntimeExports.jsx("button",{onClick:ts,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 -ml-2","aria-label":"Go back",children:jsxRuntimeExports.jsxs("svg",{className:"w-6 h-6 text-text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M19 12H5"}),jsxRuntimeExports.jsx("path",{d:"M12 19l-7-7 7-7"})]})})}),jsxRuntimeExports.jsx("div",{className:"flex-1 px-6 pt-4",children:Es?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mb-6",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-green-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:jsxRuntimeExports.jsx("path",{d:"M20 6L9 17l-5-5"})})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-text-primary mb-2",children:"You're in!"}),jsxRuntimeExports.jsxs("p",{className:"text-text-secondary text-center mb-8",children:["Joined ",jsxRuntimeExports.jsx("span",{className:"font-medium text-text-primary",children:us.projectName})]}),jsxRuntimeExports.jsx(Button,{fullWidth:!0,size:"lg",onClick:()=>{},children:"Open Project"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Join a Team"}),jsxRuntimeExports.jsx("p",{className:"text-text-secondary mb-8",children:"Enter the project code shared by your supervisor"}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"Project Code"}),jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsx(Input,{type:"text",placeholder:"ABC-1234",value:cs,onChange:xs,className:"text-center text-2xl tracking-[0.2em] font-mono uppercase",maxLength:8,disabled:ns,autoComplete:"off",autoCapitalize:"characters"})}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-xs text-text-muted text-center",children:"Format: ABC-1234"})]}),rs&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg mb-4",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-700",children:rs})}),jsxRuntimeExports.jsx(Button,{fullWidth:!0,size:"lg",disabled:!gs||ns,onClick:fs,children:ns?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",fill:"none",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Joining..."]}):"Join"}),jsxRuntimeExports.jsx("div",{className:"mt-8 p-4 bg-gold-50 border border-gold-200 rounded-xl",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-gold-100 flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4 text-gold",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("circle",{cx:"12",cy:"12",r:"10"}),jsxRuntimeExports.jsx("path",{d:"M12 16v-4"}),jsxRuntimeExports.jsx("path",{d:"M12 8h.01"})]})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("p",{className:"text-sm text-gold-800",children:as?"The project will be added to your hub.":"You can join without an account. Create one later to access multiple projects."})})]})})]})}),!Es&&!as&&jsxRuntimeExports.jsx("div",{className:"px-6 py-6 pb-safe-bottom text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-text-secondary",children:["Want to manage multiple projects?"," ",jsxRuntimeExports.jsx("button",{onClick:()=>es("signup"),className:"text-gold font-medium hover:underline",children:"Create an account"})]})})]})}const formatRelativeTime=es=>{const ts=new Date,ss=new Date(es),ns=ts.getTime()-ss.getTime(),rs=Math.floor(ns/6e4),os=Math.floor(rs/60),as=Math.floor(os/24);return rs<1?"Just now":rs<60?`${rs}m ago`:os<24?`${os}h ago`:as===1?"Yesterday":as<7?`${as}d ago`:ss.toLocaleDateString()},getRoleLabel=es=>({owner:"HOD",supervisor:"Makeup Supervisor",artist:"Floor Artist",viewer:"Viewer"})[es]||es,getProductionTypeLabel=es=>({film:"Feature Film",tv_series:"TV Series",short_film:"Short Film",commercial:"Commercial",music_video:"Music Video",other:"Production"})[es]||"Production";function ProjectCard({project:es,isActive:ts=!1,onOpen:ss,onSettings:ns}){const{projectName:rs,productionType:os,role:as,teamMemberCount:cs,sceneCount:ls,lastAccessedAt:us,status:ds}=es,xs=as==="owner"||as==="supervisor";return jsxRuntimeExports.jsxs("div",{className:clsx("relative rounded-xl p-4 transition-all duration-200","bg-card border","shadow-sm hover:shadow-md",ts?"border-l-4 border-l-gold border-t-border border-r-border border-b-border":"border-border",ds==="archived"&&"opacity-70"),children:[ts&&jsxRuntimeExports.jsx("div",{className:"mb-3",children:jsxRuntimeExports.jsx(Badge,{variant:"gold",size:"sm",children:"ACTIVE"})}),ds==="archived"&&jsxRuntimeExports.jsx("div",{className:"mb-3",children:jsxRuntimeExports.jsx(Badge,{variant:"default",size:"sm",children:"ARCHIVED"})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-text-primary mb-1",children:rs}),jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-4",children:getProductionTypeLabel(os)}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm text-text-secondary",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Your role:"}),jsxRuntimeExports.jsx("span",{children:getRoleLabel(as)})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 text-sm text-text-muted",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),jsxRuntimeExports.jsx("circle",{cx:"9",cy:"7",r:"4"}),jsxRuntimeExports.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),jsxRuntimeExports.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),cs," team member",cs!==1?"s":""]}),jsxRuntimeExports.jsx("span",{className:"text-text-light",children:""}),jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),jsxRuntimeExports.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),jsxRuntimeExports.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),jsxRuntimeExports.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),jsxRuntimeExports.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),jsxRuntimeExports.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),jsxRuntimeExports.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"}),jsxRuntimeExports.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"})]}),ls," scene",ls!==1?"s":""]})]})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-text-light mb-4",children:["Last opened ",formatRelativeTime(us)]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"md",fullWidth:!0,onClick:ss,children:"Open Project"}),xs&&ns&&jsxRuntimeExports.jsx("button",{onClick:fs=>{fs.stopPropagation(),ns()},className:"p-2.5 rounded-lg border border-border bg-card hover:bg-gray-50 transition-colors","aria-label":"Project settings",children:jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 text-text-muted",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("circle",{cx:"12",cy:"12",r:"3"}),jsxRuntimeExports.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]})]})}function EmptyState({canCreate:es,onJoinClick:ts,onCreateClick:ss,onSyncClick:ns}){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-12 px-6",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 rounded-full bg-gold-50 flex items-center justify-center mb-6",children:jsxRuntimeExports.jsxs("svg",{className:"w-12 h-12 text-gold",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),jsxRuntimeExports.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),jsxRuntimeExports.jsx("line",{x1:"9",y1:"14",x2:"15",y2:"14"})]})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-text-primary mb-2",children:"No projects yet"}),jsxRuntimeExports.jsx("p",{className:"text-text-secondary mb-8 max-w-xs",children:"Create a new project, join your team, or sync from desktop."}),jsxRuntimeExports.jsxs("div",{className:"w-full max-w-xs space-y-4",children:[es?jsxRuntimeExports.jsx(Button,{fullWidth:!0,size:"lg",variant:"primary",onClick:ss,children:"Create Project"}):jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-text-muted mb-3",children:"Supervisor or Designer?"}),jsxRuntimeExports.jsx(Button,{fullWidth:!0,size:"lg",variant:"primary",onClick:ss,children:"Create Project"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 h-px bg-border"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-text-muted",children:"or"}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-px bg-border"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx(Button,{fullWidth:!0,size:"lg",variant:"outline",onClick:ts,children:"Join Team"}),ns&&jsxRuntimeExports.jsx(Button,{fullWidth:!0,size:"lg",variant:"outline",onClick:ns,children:"Sync"})]})]})]})}function UpgradeModal({isOpen:es,onClose:ts,onUpgrade:ss}){return jsxRuntimeExports.jsx(Modal,{isOpen:es,onClose:ts,title:"Upgrade to Create Projects",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-full bg-gold-50 flex items-center justify-center mx-auto mb-4",children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-gold",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:jsxRuntimeExports.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),jsxRuntimeExports.jsxs("p",{className:"text-text-secondary mb-6",children:["Creating projects requires a"," ",jsxRuntimeExports.jsx("span",{className:"font-semibold text-text-primary",children:"Supervisor"})," or"," ",jsxRuntimeExports.jsx("span",{className:"font-semibold text-text-primary",children:"Designer"})," subscription."]}),jsxRuntimeExports.jsxs("div",{className:"bg-gold-50/50 rounded-lg p-4 mb-6 text-left",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-text-primary mb-2",children:"With Supervisor or higher, you can:"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-1.5 text-sm text-text-secondary",children:[jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-gold flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Create and manage projects"]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-gold flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Generate team invite codes"]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-gold flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Team management tools"]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-gold flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:jsxRuntimeExports.jsx("polyline",{points:"20 6 9 17 4 12"})}),"1000+ photos per project"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx(Button,{fullWidth:!0,size:"lg",variant:"primary",onClick:ss,children:"Upgrade Now"}),jsxRuntimeExports.jsx("button",{onClick:ts,className:"w-full py-2 text-sm text-text-muted hover:text-text-secondary",children:"Not now"})]})]})})}function QuickAccessBar({project:es,onReturn:ts}){return jsxRuntimeExports.jsxs("button",{onClick:ts,className:"w-full flex items-center justify-between gap-3 px-4 py-3 bg-gold-50 border-b border-gold/20 hover:bg-gold-100/50 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-gold",children:[jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("polyline",{points:"9 14 4 9 9 4"}),jsxRuntimeExports.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium",children:["Return to ",es.projectName]})]}),jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 text-gold",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:jsxRuntimeExports.jsx("path",{d:"M9 18l6-6-6-6"})})]})}function SyncProjectModal({isOpen:es,onClose:ts}){return es?jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:ts}),jsxRuntimeExports.jsxs("div",{className:"relative bg-card rounded-2xl p-6 max-w-sm w-full shadow-xl",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-text-primary mb-2",children:"Sync with Desktop"}),jsxRuntimeExports.jsx("p",{className:"text-text-secondary text-sm mb-6",children:"Connect to your desktop project to sync data between devices. This feature is coming soon."}),jsxRuntimeExports.jsx("div",{className:"p-4 bg-gold-50 border border-gold-200 rounded-xl mb-6",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-gold-100 flex items-center justify-center flex-shrink-0",children:jsxRuntimeExports.jsxs("svg",{className:"w-4 h-4 text-gold",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[jsxRuntimeExports.jsx("circle",{cx:"12",cy:"12",r:"10"}),jsxRuntimeExports.jsx("path",{d:"M12 16v-4"}),jsxRuntimeExports.jsx("path",{d:"M12 8h.01"})]})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("p",{className:"text-sm text-gold-800",children:"To sync, you'll need to be logged into the same account on the desktop app."})})]})}),jsxRuntimeExports.jsx(Button,{fullWidth:!0,variant:"primary",onClick:ts,children:"Got it"})]})]}):null}function createProjectFromMembership(es){return{id:es.projectId,name:es.projectName,createdAt:es.joinedAt,updatedAt:es.lastAccessedAt,scenes:[],characters:[],looks:[]}}function ProjectHubScreen(){const{user:es,setScreen:ts,goBack:ss,signOut:ns,projectMemberships:rs,canCreateProjects:os,updateLastAccessed:as,hasCompletedOnboarding:cs}=useAuthStore(),[ls,us]=reactExports.useState(!1),[ds,xs]=reactExports.useState(!1),fs=[...rs].sort((vs,ws)=>new Date(ws.lastAccessedAt).getTime()-new Date(vs.lastAccessedAt).getTime()),gs=fs.length>0?fs[0]:null,Es=es?getTierById(es.tier):null,js=vs=>{as(vs.projectId);const ws=useProjectStore.getState();if(ws.hasSavedProject(vs.projectId)){ws.restoreSavedProject(vs.projectId);return}const ys=createProjectFromMembership(vs);ws.setProjectNeedsSetup(ys)},ps=()=>{os()?ts("create-project"):us(!0)},ms=()=>{us(!1),ts("select-plan")},hs=()=>{if(!(es!=null&&es.name))return"?";const vs=es.name.split(" ");return vs.length>=2?`${vs[0][0]}${vs[1][0]}`.toUpperCase():es.name.slice(0,2).toUpperCase()};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"px-4 py-4 safe-top border-b border-border bg-card",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[!cs&&jsxRuntimeExports.jsx("button",{onClick:ss,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 -ml-2","aria-label":"Go back",children:jsxRuntimeExports.jsxs("svg",{className:"w-6 h-6 text-text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M19 12H5"}),jsxRuntimeExports.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Your Projects"}),Es&&jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2 mt-1",children:jsxRuntimeExports.jsx(Badge,{variant:Es.isPremium?"gold":"default",size:"sm",children:Es.displayName})})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>ts("select-plan"),className:"flex items-center gap-2",children:jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full bg-gold flex items-center justify-center text-white font-semibold text-sm",children:hs()})})]})}),gs&&fs.length>1&&jsxRuntimeExports.jsx(QuickAccessBar,{project:gs,onReturn:()=>js(gs)}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4",children:fs.length===0?jsxRuntimeExports.jsx(EmptyState,{canCreate:os(),onJoinClick:()=>ts("join"),onCreateClick:ps,onSyncClick:()=>xs(!0)}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-3 mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx(Button,{fullWidth:!0,size:"md",variant:"primary",onClick:ps,children:"Create Project"}),jsxRuntimeExports.jsx(Button,{fullWidth:!0,size:"md",variant:"outline",onClick:()=>ts("join"),children:"Join Team"})]}),jsxRuntimeExports.jsxs(Button,{fullWidth:!0,size:"md",variant:"ghost",onClick:()=>xs(!0),className:"text-gold",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-2",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:jsxRuntimeExports.jsx("path",{d:"M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m9 9a9 9 0 0 1-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9"})}),"Sync Project from Desktop"]})]}),fs.map((vs,ws)=>jsxRuntimeExports.jsx(ProjectCard,{project:vs,isActive:ws===0,onOpen:()=>js(vs),onSettings:vs.role==="owner"||vs.role==="supervisor"?()=>{console.log("Project settings for:",vs.projectId)}:void 0},vs.projectId))]})}),jsxRuntimeExports.jsx("div",{className:"px-4 py-4 pb-safe-bottom border-t border-border",children:jsxRuntimeExports.jsx("button",{onClick:ns,className:"w-full text-center text-sm text-text-muted hover:text-text-secondary",children:"Sign Out"})}),jsxRuntimeExports.jsx(UpgradeModal,{isOpen:ls,onClose:()=>us(!1),onUpgrade:ms}),jsxRuntimeExports.jsx(SyncProjectModal,{isOpen:ds,onClose:()=>xs(!1)})]})}function CreateProjectScreen(){const{goBack:es,createProject:ts,isLoading:ss,error:ns,clearError:rs}=useAuthStore(),[os,as]=reactExports.useState(""),[cs,ls]=reactExports.useState("film"),us=async xs=>{if(xs.preventDefault(),rs(),!os.trim())return;const fs=await ts(os.trim(),cs);if(fs.success&&fs.code){const{projectMemberships:gs}=useAuthStore.getState(),Es=gs.find(js=>js.projectCode===fs.code);if(Es){const js={id:Es.projectId,name:Es.projectName,createdAt:Es.joinedAt,updatedAt:Es.lastAccessedAt,scenes:[],characters:[],looks:[]};useProjectStore.getState().setProjectNeedsSetup(js)}}},ds=os.trim();return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"flex items-center px-4 py-3 safe-top",children:jsxRuntimeExports.jsx("button",{onClick:es,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 -ml-2","aria-label":"Go back",children:jsxRuntimeExports.jsxs("svg",{className:"w-6 h-6 text-text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M19 12H5"}),jsxRuntimeExports.jsx("path",{d:"M12 19l-7-7 7-7"})]})})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 px-6 pt-4",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"Create Project"}),jsxRuntimeExports.jsx("p",{className:"text-text-secondary mb-8",children:"Set up a new production for your team"}),jsxRuntimeExports.jsxs("form",{onSubmit:us,className:"space-y-6",children:[jsxRuntimeExports.jsx(Input,{type:"text",label:"Production Name",placeholder:"e.g., The Crown S6",value:os,onChange:xs=>as(xs.target.value),disabled:ss,autoComplete:"off"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"field-label block mb-2",children:"Production Type"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-2",children:PRODUCTION_TYPES.map(xs=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>ls(xs.value),className:`px-4 py-3 rounded-lg border text-sm font-medium transition-colors ${cs===xs.value?"border-gold bg-gold-50 text-gold":"border-border bg-card text-text-secondary hover:border-gold-300"}`,children:xs.label},xs.value))})]}),ns&&jsxRuntimeExports.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-700",children:ns})}),jsxRuntimeExports.jsx(Button,{type:"submit",fullWidth:!0,size:"lg",disabled:!ds||ss,children:ss?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",fill:"none",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Creating..."]}):"Create Project"})]})]})]})}function AppContent(){const{currentProject:es,activeTab:ts,setActiveTab:ss,currentSceneId:ns,setCurrentScene:rs,setCurrentCharacter:os,checkWrapTrigger:as,lifecycle:cs,updateActivity:ls,needsSetup:us,clearNeedsSetup:ds}=useProjectStore(),{isAuthenticated:xs,hasCompletedOnboarding:fs,currentScreen:gs,guestProjectCode:Es,selectTier:js,setScreen:ps,goBack:ms,user:hs}=useAuthStore(),[vs,ws]=reactExports.useState(!1),[ys,Rs]=reactExports.useState(!1),bs=reactExports.useRef(!1);reactExports.useEffect(()=>{if(bs.current)return;bs.current=!0,migrateToIndexedDB().then(({migrated:Ls,errors:Os})=>{Ls.length>0&&console.log("[Storage] Migrated to IndexedDB:",Ls),Os.length>0&&console.warn("[Storage] Migration errors:",Os)}).catch(Ls=>{console.error("[Storage] Migration failed:",Ls)});const Hs=()=>{flushPendingWrites()};return window.addEventListener("beforeunload",Hs),()=>window.removeEventListener("beforeunload",Hs)},[]);const[Ns,Ss]=reactExports.useState(0),[Ts,Cs]=reactExports.useState(void 0);reactExports.useEffect(()=>{fs&&!xs&&!es&&!Es&&ps("hub")},[fs,xs,es,Es,ps]);const Ms=reactExports.useMemo(()=>(es==null?void 0:es.scenes.filter(Hs=>Hs.isComplete).length)??0,[es==null?void 0:es.scenes]);reactExports.useEffect(()=>{es&&as()},[es,Ms,as]),reactExports.useEffect(()=>{es&&ls()},[es,ns,ts,ls]);const Is=()=>{ws(!1),ds(),ss("today")},Qs=()=>{useProjectStore.getState().saveAndClearProject(),ws(!1),ps("hub")},Ys=()=>{ws(!0)},Zs=Hs=>{rs(Hs),os(null)},Vs=()=>{rs(null),os(null)},Ks=Hs=>{Hs===ts&&Ss(Ls=>Ls+1),ss(Hs),Cs(void 0),ns&&(rs(null),os(null))},Ds=Hs=>{Cs(Hs),ss("settings")},$s=Hs=>{Ks(Hs)},Xs=async(Hs,Ls)=>{await js(Hs,Ls)},Fs=async()=>{await js("trainee","monthly")};if(!fs&&!Es)switch(gs){case"welcome":return jsxRuntimeExports.jsx(WelcomeScreen,{});case"signin":return jsxRuntimeExports.jsx(SignInScreen,{});case"signup":return jsxRuntimeExports.jsx(SignUpScreen,{});case"join":return jsxRuntimeExports.jsx(JoinProjectScreen,{});case"hub":return jsxRuntimeExports.jsx(ProjectHubScreen,{});case"create-project":return jsxRuntimeExports.jsx(CreateProjectScreen,{});case"select-plan":return jsxRuntimeExports.jsx(SelectPlanScreen,{isOnboarding:!0,currentTier:hs==null?void 0:hs.tier,onSelectTier:Xs,onSkip:Fs,onBack:ms});default:return jsxRuntimeExports.jsx(WelcomeScreen,{})}if(xs&&!es&&!vs)switch(gs){case"hub":return jsxRuntimeExports.jsx(ProjectHubScreen,{});case"join":return jsxRuntimeExports.jsx(JoinProjectScreen,{});case"create-project":return jsxRuntimeExports.jsx(CreateProjectScreen,{});case"select-plan":return jsxRuntimeExports.jsx(SelectPlanScreen,{isOnboarding:!1,currentTier:hs==null?void 0:hs.tier,onSelectTier:Xs,onBack:ms});default:return jsxRuntimeExports.jsx(ProjectHubScreen,{})}if(fs&&!xs&&!es&&!Es)return jsxRuntimeExports.jsx(ProjectHubScreen,{});const As=()=>{ws(!1),ds(),ms()};if(vs||!es||us)return jsxRuntimeExports.jsx(Home,{onProjectReady:Is,onBack:As});if(ys)return jsxRuntimeExports.jsx(ProjectExportScreen,{onBack:()=>Rs(!1),onExportComplete:()=>Rs(!1)});const _s=()=>{if(ns&&(ts==="today"||ts==="breakdown"))return jsxRuntimeExports.jsx(SceneView,{sceneId:ns,onBack:Vs});switch(ts){case"today":return jsxRuntimeExports.jsx(Today,{onSceneSelect:Zs});case"breakdown":return jsxRuntimeExports.jsx(Breakdown,{onSceneSelect:Zs});case"lookbook":return jsxRuntimeExports.jsx(Lookbooks,{});case"hours":return jsxRuntimeExports.jsx(Timesheet,{});case"budget":return jsxRuntimeExports.jsx(Budget,{});case"script":case"schedule":case"callsheets":case"settings":case"more":return jsxRuntimeExports.jsx(More,{onNavigateToTab:$s,onStartNewProject:Ys,initialView:ts,resetKey:Ns,subView:Ts});default:return jsxRuntimeExports.jsx(Today,{onSceneSelect:Zs})}},Ps=!ns&&!["more","settings","script","schedule","callsheets"].includes(ts);return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-background",children:[cs.state!=="active"&&jsxRuntimeExports.jsx(LifecycleBanner,{onExport:()=>Rs(!0)}),Ps&&jsxRuntimeExports.jsx(ProjectHeader,{onNavigateToTab:$s,onNavigateToSubView:Ds,onSwitchProject:Qs}),_s(),jsxRuntimeExports.jsx(BottomNav,{activeTab:ts,onTabChange:Ks}),jsxRuntimeExports.jsx(ChatAssistant,{}),jsxRuntimeExports.jsx(WrapPopupModal,{onExport:()=>Rs(!0)})]})}function App(){return jsxRuntimeExports.jsx(ErrorBoundary,{children:jsxRuntimeExports.jsx(AppContent,{})})}const initTheme=()=>{const ts=useThemeStore.getState().theme,ss=ts==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":ts;document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(ss);const ns=document.querySelector('meta[name="theme-color"]');ns&&ns.setAttribute("content",ss==="dark"?"#000000":"#f5f4f2")};initTheme();"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(es=>{console.log("SW registration failed:",es)})});client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React$2.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
